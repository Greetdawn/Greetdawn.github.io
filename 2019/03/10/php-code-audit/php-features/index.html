<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="theme-color" content="#0078E7"><meta name="author" content="ä¸¨Mr.zhangä¸¨"><meta name="copyright" content="ä¸¨Mr.zhangä¸¨"><meta name="generator" content="Hexo 5.4.0"><meta name="theme" content="hexo-theme-yun"><title>phpè¯­è¨€ç‰¹æ€§ç±»å‹è®²è§£ | Mr.zhang's Blog</title><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@900&amp;display=swap" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/star-markdown-css@0.1.24/dist/yun/yun-markdown.min.css"><script src="//at.alicdn.com/t/font_1140697_ed8vp4atwoj.js" async></script><script src="https://cdn.jsdelivr.net/npm/scrollreveal/dist/scrollreveal.min.js" defer></script><script>document.addEventListener("DOMContentLoaded", () => {
  [".post-card",".post-content img"].forEach((target)=> {
    ScrollReveal().reveal(target);
  })
});
</script><link id="light-prism-css" rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@latest/themes/prism.css" media="(prefers-color-scheme: light)"><link id="dark-prism-css" rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@latest/themes/prism-tomorrow.css" media="(prefers-color-scheme: dark)"><link rel="shortcut icon" type="image/svg+xml" href="/yun.svg"><link rel="mask-icon" href="/yun.svg" color="#0078E7"><link rel="alternate icon" href="/yun.ico"><link rel="preload" href="/css/hexo-theme-yun.css" as="style"><link rel="preload" href="/js/utils.js" as="script"><link rel="preload" href="/js/hexo-theme-yun.js" as="script"><link rel="prefetch" href="/js/sidebar.js" as="script"><link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin><script id="yun-config">
    const Yun = window.Yun || {};
    window.CONFIG = {"hostname":"www.greetdawn.top","root":"/","title":"ç¾¤å“¥çš„åšå®¢","version":"1.5.2","mode":"auto","copycode":true,"page":{"isPost":true},"i18n":{"placeholder":"æœç´¢...","empty":"æ‰¾ä¸åˆ°æ‚¨æŸ¥è¯¢çš„å†…å®¹: ${query}","hits":"æ‰¾åˆ° ${hits} æ¡ç»“æœ","hits_time":"æ‰¾åˆ° ${hits} æ¡ç»“æœï¼ˆç”¨æ—¶ ${time} æ¯«ç§’ï¼‰"},"anonymous_image":"https://cdn.jsdelivr.net/gh/YunYouJun/cdn/img/avatar/none.jpg","say":{"api":"https://el-bot-api.vercel.app/api/words/young"},"fireworks":{"colors":["102, 167, 221","62, 131, 225","33, 78, 194"]}};
  </script><link rel="stylesheet" href="/css/hexo-theme-yun.css"><script src="/js/utils.js"></script><script src="/js/hexo-theme-yun.js"></script><link rel="alternate" href="/atom.xml" title="Mr.zhang's Blog" type="application/atom+xml"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin><script async src="https://www.googletagmanager.com/gtag/js?id=UA-121354150-1"></script><script>if (CONFIG.hostname === location.hostname) {
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-121354150-1');
}</script><script data-ad-client="ca-pub-2245427233262012" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script>(function(){
  var bp = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  if (curProtocol === 'https') {
    bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
  }
  else {
    bp.src = 'http://push.zhanzhang.baidu.com/push.js';
  }
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(bp, s);
})();</script><!-- Google Tag Manager --><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-M9KWR9L');</script><!-- End Google Tag Manager --><meta property="og:type" content="article">
<meta property="og:title" content="phpè¯­è¨€ç‰¹æ€§ç±»å‹è®²è§£">
<meta property="og:url" content="http://www.greetdawn.top/2019/03/10/php-code-audit/php-features/index.html">
<meta property="og:site_name" content="Mr.zhang&#39;s Blog">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://gitee.com/greetdawn/blogImages/raw/master/img/aaa.jpg">
<meta property="og:image" content="https://gitee.com/greetdawn/blogImages/raw/master/img/20201224152749.png">
<meta property="og:image" content="https://gitee.com/greetdawn/blogImages/raw/master/img/20201225091551.png">
<meta property="og:image" content="https://gitee.com/greetdawn/blogImages/raw/master/img/20201225150821.png">
<meta property="og:image" content="https://gitee.com/greetdawn/blogImages/raw/master/img/20201225155527.png">
<meta property="og:image" content="https://gitee.com/greetdawn/blogImages/raw/master/img/20201225164056.png">
<meta property="og:image" content="https://gitee.com/greetdawn/blogImages/raw/master/img/20201228135450.png">
<meta property="og:image" content="https://gitee.com/greetdawn/blogImages/raw/master/img/20201228140800.png">
<meta property="article:published_time" content="2019-03-10T01:19:57.000Z">
<meta property="article:modified_time" content="2021-01-29T08:04:16.200Z">
<meta property="article:author" content="ä¸¨Mr.zhangä¸¨">
<meta property="article:tag" content="CTF">
<meta property="article:tag" content="PHPè¯­è¨€ç‰¹æ€§">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://gitee.com/greetdawn/blogImages/raw/master/img/aaa.jpg"><script src="/js/ui/mode.js"></script></head><body><script defer src="https://cdn.jsdelivr.net/npm/animejs@latest"></script><script defer src="/js/ui/fireworks.js"></script><canvas class="fireworks"></canvas><div class="container"><a class="sidebar-toggle hty-icon-button" id="menu-btn"><div class="hamburger hamburger--spin" type="button"><span class="hamburger-box"><span class="hamburger-inner"></span></span></div></a><div class="sidebar-toggle sidebar-overlay"></div><aside class="sidebar"><script src="/js/sidebar.js"></script><ul class="sidebar-nav"><li class="sidebar-nav-item sidebar-nav-toc hty-icon-button sidebar-nav-active" data-target="post-toc-wrap" title="æ–‡ç« ç›®å½•"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-list-ordered"></use></svg></li><li class="sidebar-nav-item sidebar-nav-overview hty-icon-button" data-target="site-overview-wrap" title="ç«™ç‚¹æ¦‚è§ˆ"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-passport-line"></use></svg></li></ul><div class="sidebar-panel" id="site-overview-wrap"><div class="site-info fix-top"><a class="site-author-avatar" href="/about/" title="ä¸¨Mr.zhangä¸¨"><img width="96" loading="lazy" src="/images/avatar.jpg" alt="ä¸¨Mr.zhangä¸¨"><span class="site-author-status" title="ä¸æƒ³ä¸Šç­">ğŸ˜­</span></a><div class="site-author-name"><a href="/about/">ä¸¨Mr.zhangä¸¨</a></div><a class="site-name" href="/about/site.html">Mr.zhang's Blog</a><sub class="site-subtitle">The God love people</sub><div class="site-desciption">Love coding,Love life!</div></div><nav class="site-state"><a class="site-state-item hty-icon-button icon-home" href="/" title="é¦–é¡µ"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-home-4-line"></use></svg></span></a><div class="site-state-item"><a href="/archives/" title="å½’æ¡£"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-archive-line"></use></svg></span><span class="site-state-item-count">40</span></a></div><div class="site-state-item"><a href="/categories/" title="åˆ†ç±»"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-folder-2-line"></use></svg></span><span class="site-state-item-count">11</span></a></div><div class="site-state-item"><a href="/tags/" title="æ ‡ç­¾"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-price-tag-3-line"></use></svg></span><span class="site-state-item-count">40</span></a></div><a class="site-state-item hty-icon-button" href="/about/#comment" title="ç•™è¨€æ¿"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-clipboard-line"></use></svg></span></a></nav><hr style="margin-bottom:0.5rem"><div class="links-of-author"><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://wpa.qq.com/msgrd?v=3&amp;uin=910426929&amp;site=qq&amp;menu=yes" title="QQ" target="_blank" style="color:#12B7F5"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-qq-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://github.com/greetdawn" title="GitHub" target="_blank" style="color:#181717"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-github-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="mailto:953640552@qq.com" title="E-Mail" target="_blank" style="color:#8E71C1"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-mail-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://weibo.com/" title="å¾®åš" target="_blank" style="color:#E6162D"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-weibo-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://music.163.com/#/user/home?id=372656460" title="ç½‘æ˜“äº‘éŸ³ä¹" target="_blank" style="color:#C10D0C"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-netease-cloud-music-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://www.zhihu.com/" title="çŸ¥ä¹" target="_blank" style="color:#0084FF"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-zhihu-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://space.bilibili.com/478304087" title="å“”å“©å“”å“©åŠ¨ç”»" target="_blank" style="color:#FF8EB3"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-bilibili-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://twitter.com/" title="Twitter" target="_blank" style="color:#1da1f2"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-twitter-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://t.me/" title="Telegram" target="_blank" style="color:#0088CC"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-telegram-line"></use></svg></a></div><hr style="margin:0.5rem 1rem"><div class="links"><a class="links-item hty-icon-button" href="/links/" title="æˆ‘çš„å°ä¼™ä¼´ä»¬" style="color:dodgerblue"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-genderless-line"></use></svg></a><a class="links-item hty-icon-button" href="/girls/" title="å–œæ¬¢çš„å¥³å­©å­" style="color:hotpink"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-women-line"></use></svg></a></div><br><a class="links-item hty-icon-button" id="toggle-mode-btn" href="javascript:;" title="Mode" style="color: #f1cb64"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-contrast-2-line"></use></svg></a></div><div class="sidebar-panel sidebar-panel-active" id="post-toc-wrap"><div class="post-toc"><div class="post-toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#PHP%E8%AF%AD%E8%A8%80%E7%89%B9%E6%80%A7"><span class="toc-number">1.</span> <span class="toc-text">PHPè¯­è¨€ç‰¹æ€§</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#extract%E5%8F%98%E9%87%8F%E8%A6%86%E7%9B%96"><span class="toc-number">1.1.</span> <span class="toc-text">extractå˜é‡è¦†ç›–</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%BC%8F%E6%B4%9E%E6%BA%90%E7%A0%81"><span class="toc-number">1.1.1.</span> <span class="toc-text">æ¼æ´æºç </span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90"><span class="toc-number">1.1.2.</span> <span class="toc-text">æ¼æ´åˆ†æ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8"><span class="toc-number">1.1.3.</span> <span class="toc-text">æ¼æ´åˆ©ç”¨</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BB%95%E8%BF%87%E8%BF%87%E6%BB%A4%E7%9A%84%E7%A9%BA%E7%99%BD%E5%AD%97%E7%AC%A6"><span class="toc-number">1.2.</span> <span class="toc-text">ç»•è¿‡è¿‡æ»¤çš„ç©ºç™½å­—ç¬¦</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%BC%8F%E6%B4%9E%E6%BA%90%E7%A0%81-1"><span class="toc-number">1.2.1.</span> <span class="toc-text">æ¼æ´æºç </span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90-1"><span class="toc-number">1.2.2.</span> <span class="toc-text">æ¼æ´åˆ†æ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8-1"><span class="toc-number">1.2.3.</span> <span class="toc-text">æ¼æ´åˆ©ç”¨</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ereg%E6%AD%A3%E5%88%99%E7%BB%95%E8%BF%87"><span class="toc-number">1.3.</span> <span class="toc-text">eregæ­£åˆ™ç»•è¿‡</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%BC%8F%E6%B4%9E%E6%BA%90%E7%A0%81-2"><span class="toc-number">1.3.1.</span> <span class="toc-text">æ¼æ´æºç </span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90-2"><span class="toc-number">1.3.2.</span> <span class="toc-text">æ¼æ´åˆ†æ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8-2"><span class="toc-number">1.3.3.</span> <span class="toc-text">æ¼æ´åˆ©ç”¨</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#strcmp%E6%AF%94%E8%BE%83%E5%AD%97%E7%AC%A6%E4%B8%B2"><span class="toc-number">1.4.</span> <span class="toc-text">strcmpæ¯”è¾ƒå­—ç¬¦ä¸²</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%BC%8F%E6%B4%9E%E6%BA%90%E7%A0%81-3"><span class="toc-number">1.4.1.</span> <span class="toc-text">æ¼æ´æºç </span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90-3"><span class="toc-number">1.4.2.</span> <span class="toc-text">æ¼æ´åˆ†æ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8-3"><span class="toc-number">1.4.3.</span> <span class="toc-text">æ¼æ´åˆ©ç”¨</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#sha-%E5%87%BD%E6%95%B0%E6%AF%94%E8%BE%83%E7%BB%95%E8%BF%87"><span class="toc-number">1.5.</span> <span class="toc-text">sha()å‡½æ•°æ¯”è¾ƒç»•è¿‡</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%BC%8F%E6%B4%9E%E6%BA%90%E7%A0%81-4"><span class="toc-number">1.5.1.</span> <span class="toc-text">æ¼æ´æºç </span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90-4"><span class="toc-number">1.5.2.</span> <span class="toc-text">æ¼æ´åˆ†æ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8-4"><span class="toc-number">1.5.3.</span> <span class="toc-text">æ¼æ´åˆ©ç”¨</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#session%E9%AA%8C%E8%AF%81%E7%BB%95%E8%BF%87"><span class="toc-number">1.6.</span> <span class="toc-text">sessionéªŒè¯ç»•è¿‡</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%BC%8F%E6%B4%9E%E6%BA%90%E7%A0%81-5"><span class="toc-number">1.6.1.</span> <span class="toc-text">æ¼æ´æºç </span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90-5"><span class="toc-number">1.6.2.</span> <span class="toc-text">æ¼æ´åˆ†æ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8-5"><span class="toc-number">1.6.3.</span> <span class="toc-text">æ¼æ´åˆ©ç”¨</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#md5%E6%AF%94%E8%BE%83%E7%BB%95%E8%BF%87"><span class="toc-number">1.7.</span> <span class="toc-text">md5æ¯”è¾ƒç»•è¿‡</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%BC%8F%E6%B4%9E%E6%BA%90%E7%A0%81-6"><span class="toc-number">1.7.1.</span> <span class="toc-text">æ¼æ´æºç </span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90-6"><span class="toc-number">1.7.2.</span> <span class="toc-text">æ¼æ´åˆ†æ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8-6"><span class="toc-number">1.7.3.</span> <span class="toc-text">æ¼æ´åˆ©ç”¨</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#md5%E5%8A%A0%E5%AF%86%E7%9B%B8%E7%AD%89%E7%BB%95%E8%BF%87"><span class="toc-number">1.8.</span> <span class="toc-text">md5åŠ å¯†ç›¸ç­‰ç»•è¿‡</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%BC%8F%E6%B4%9E%E6%BA%90%E7%A0%81-7"><span class="toc-number">1.8.1.</span> <span class="toc-text">æ¼æ´æºç </span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90-7"><span class="toc-number">1.8.2.</span> <span class="toc-text">æ¼æ´åˆ†æ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8-7"><span class="toc-number">1.8.3.</span> <span class="toc-text">æ¼æ´åˆ©ç”¨</span></a></li></ol></li></ol></li></ol></div></div></div></aside><main class="sidebar-translate" id="content"><div id="post"><article class="hty-card post-block" itemscope itemtype="https://schema.org/Article"><link itemprop="mainEntityOfPage" href="http://www.greetdawn.top/2019/03/10/php-code-audit/php-features/"><span hidden itemprop="author" itemscope itemtype="https://schema.org/Person"><meta itemprop="name" content="ä¸¨Mr.zhangä¸¨"><meta itemprop="description"></span><span hidden itemprop="publisher" itemscope itemtype="https://schema.org/Organization"><meta itemprop="name" content="Mr.zhang's Blog"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">phpè¯­è¨€ç‰¹æ€§ç±»å‹è®²è§£<a class="post-edit-link" href="https://github.com/greetdawn/_posts/php-code-audit/php-features.md" target="_blank" title="ç¼–è¾‘" rel="noopener"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-edit-line"></use></svg></a></h1><div class="post-meta"><div class="post-time" style="display:block"><span class="post-meta-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-calendar-line"></use></svg></span> <time title="åˆ›å»ºæ—¶é—´ï¼š2019-03-10 09:19:57" itemprop="dateCreated datePublished" datetime="2019-03-10T09:19:57+08:00">2019-03-10</time><span class="post-meta-divider">-</span><span class="post-meta-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-calendar-2-line"></use></svg></span> <time title="ä¿®æ”¹æ—¶é—´ï¼š2021-01-29 16:04:16" itemprop="dateModified" datetime="2021-01-29T16:04:16+08:00">2021-01-29</time></div><span class="post-count"><span class="post-symbolcount"><span class="post-meta-item-icon" title="æœ¬æ–‡å­—æ•°"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-file-word-line"></use></svg></span> <span title="æœ¬æ–‡å­—æ•°">2.2k</span><span class="post-meta-divider">-</span><span class="post-meta-item-icon" title="é˜…è¯»æ—¶é•¿"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-timer-line"></use></svg></span> <span title="é˜…è¯»æ—¶é•¿">10m</span></span></span><span class="leancloud_visitors" id="/2019/03/10/php-code-audit/php-features/" data-flag-title="phpè¯­è¨€ç‰¹æ€§ç±»å‹è®²è§£"><span class="post-meta-divider">-</span><span class="post-meta-item-icon" title="é˜…è¯»æ¬¡æ•°"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-eye-line"></use></svg> <span class="leancloud-visitors-count"></span></span></span><div class="post-classify"><span class="post-category"> <span class="post-meta-item-icon" style="margin-right:3px;"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-folder-line"></use></svg></span><span itemprop="about" itemscope itemtype="https://schema.org/Thing"><a class="category" href="/categories/PHP%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/" style="--text-color:#FB7299" itemprop="url" rel="index"><span itemprop="text">PHPä»£ç å®¡è®¡</span></a></span></span><span class="post-tag"><span class="post-meta-divider">-</span><a class="tag" href="/tags/CTF/" style="--text-color:#4fc08d"><span class="post-meta-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-price-tag-3-line"></use></svg></span><span class="tag-name">CTF</span></a><a class="tag" href="/tags/PHP%E8%AF%AD%E8%A8%80%E7%89%B9%E6%80%A7/" style="--text-color:#F14E32"><span class="post-meta-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-price-tag-3-line"></use></svg></span><span class="tag-name">PHPè¯­è¨€ç‰¹æ€§</span></a></span></div></div></header><section class="post-body" itemprop="articleBody"><div class="post-content markdown-body" style="--smc-primary:#0078E7;"><p><img src="https://gitee.com/greetdawn/blogImages/raw/master/img/aaa.jpg" loading="lazy"></p>
<span id="more"></span>

<h1 id="PHPè¯­è¨€ç‰¹æ€§"><a href="#PHPè¯­è¨€ç‰¹æ€§" class="headerlink" title="PHPè¯­è¨€ç‰¹æ€§"></a>PHPè¯­è¨€ç‰¹æ€§</h1><h2 id="extractå˜é‡è¦†ç›–"><a href="#extractå˜é‡è¦†ç›–" class="headerlink" title="extractå˜é‡è¦†ç›–"></a>extractå˜é‡è¦†ç›–</h2><h3 id="æ¼æ´æºç "><a href="#æ¼æ´æºç " class="headerlink" title="æ¼æ´æºç "></a>æ¼æ´æºç </h3><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> 
<span class="token variable">$flag</span><span class="token operator">=</span><span class="token string single-quoted-string">'cimer'</span><span class="token punctuation">;</span> 
<span class="token function">extract</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$shiyan</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span> 
    <span class="token variable">$content</span><span class="token operator">=</span><span class="token function">trim</span><span class="token punctuation">(</span><span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token variable">$flag</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$shiyan</span><span class="token operator">==</span><span class="token variable">$content</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span> 
        <span class="token keyword">echo</span><span class="token string single-quoted-string">'ctf&#123;cimer_2021_come_on&#125;'</span><span class="token punctuation">;</span> 
    <span class="token punctuation">&#125;</span>
   <span class="token keyword">else</span>
   <span class="token punctuation">&#123;</span> 
    <span class="token keyword">echo</span><span class="token string single-quoted-string">'Oh.no'</span><span class="token punctuation">;</span>
   <span class="token punctuation">&#125;</span> 
<span class="token punctuation">&#125;</span>
<span class="token delimiter important">?></span></span></code></pre>



<h3 id="æ¼æ´åˆ†æ"><a href="#æ¼æ´åˆ†æ" class="headerlink" title="æ¼æ´åˆ†æ"></a>æ¼æ´åˆ†æ</h3><p><code>extract()</code>å‡½æ•°</p>
<ul>
<li><p>ä»æ•°ç»„ä¸­å°†å˜é‡å¯¼å…¥åˆ°å½“å‰çš„ç¬¦å·è¡¨</p>
</li>
<li><p>è¯¥å‡½æ•°ä½¿ç”¨æ•°ç»„é”®åä½œä¸ºå˜é‡åï¼Œä½¿ç”¨æ•°ç»„é”®å€¼ä½œä¸ºå˜é‡å€¼ã€‚é’ˆå¯¹æ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ ï¼Œå°†åœ¨å½“å‰ç¬¦å·è¡¨ä¸­åˆ›å»ºå¯¹åº”çš„ä¸€ä¸ªå˜é‡</p>
</li>
<li><p>è¯­æ³•ï¼šextract(array,extract_rules,prefix)</p>
</li>
<li><p>array,å¿…éœ€ï¼Œè¦ä½¿ç”¨çš„æ•°ç»„</p>
</li>
</ul>
<p>GETä¼ å‚æˆ–è€…POSTä¼ å‚æ—¶ï¼Œå¸¦å…¥åˆ°extactå‡½æ•°ä¸­ï¼Œç›´æ¥ä¼ å…¥åŒåå˜é‡åï¼Œå³å¯è¦†ç›–åŸæœ‰å˜é‡å€¼ã€‚</p>
<p>flagå˜é‡å€¼ä¸ºcimer</p>
<p>extract()é€šè¿‡GETæ–¹å¼æ¥å—ä¸€ä¸ªæ•°ç»„ï¼Œé”®åä½œä¸ºå˜é‡åï¼Œå€¼ä¸ºå˜é‡å€¼</p>
<p>å¦‚æœå˜é‡$shiyanä¸ºç©ºï¼Œåˆ™$flagå€¼é€šè¿‡file_get_contents()èµ‹å€¼ç»™å˜é‡$content</p>
<p>å¦‚æœå˜é‡$shiyanä¸$contentå€¼ç›¸åŒï¼Œåˆ™è¾“å‡ºflag</p>
<h3 id="æ¼æ´åˆ©ç”¨"><a href="#æ¼æ´åˆ©ç”¨" class="headerlink" title="æ¼æ´åˆ©ç”¨"></a>æ¼æ´åˆ©ç”¨</h3><p>payloadæ„é€ <code>index.php?shiyan=&amp;flag=</code></p>
<p><img src="https://gitee.com/greetdawn/blogImages/raw/master/img/20201224152749.png" loading="lazy"></p>
<h2 id="ç»•è¿‡è¿‡æ»¤çš„ç©ºç™½å­—ç¬¦"><a href="#ç»•è¿‡è¿‡æ»¤çš„ç©ºç™½å­—ç¬¦" class="headerlink" title="ç»•è¿‡è¿‡æ»¤çš„ç©ºç™½å­—ç¬¦"></a>ç»•è¿‡è¿‡æ»¤çš„ç©ºç™½å­—ç¬¦</h2><h3 id="æ¼æ´æºç -1"><a href="#æ¼æ´æºç -1" class="headerlink" title="æ¼æ´æºç "></a>æ¼æ´æºç </h3><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token keyword">include</span> <span class="token string single-quoted-string">'flag.php'</span><span class="token punctuation">;</span> 
<span class="token variable">$info</span> <span class="token operator">=</span> <span class="token string double-quoted-string">""</span><span class="token punctuation">;</span> 
<span class="token variable">$req</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
 
<span class="token function">ini_set</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"display_error"</span><span class="token punctuation">,</span> <span class="token constant boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
 
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'number'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
   <span class="token function">header</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"hint:26966dc52e85af40f59b4fe73d8c323a.txt"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
   <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"have a fun!!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
 
<span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token variable">$_GET</span><span class="token punctuation">,</span> <span class="token variable">$_POST</span><span class="token punctuation">]</span> <span class="token keyword">as</span> <span class="token variable">$global_var</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
    <span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token variable">$global_var</span> <span class="token keyword">as</span> <span class="token variable">$key</span> <span class="token operator">=></span> <span class="token variable">$value</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> 
        <span class="token variable">$value</span> <span class="token operator">=</span> <span class="token function">trim</span><span class="token punctuation">(</span><span class="token variable">$value</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
        <span class="token function">is_string</span><span class="token punctuation">(</span><span class="token variable">$value</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token variable">$req</span><span class="token punctuation">[</span><span class="token variable">$key</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">addslashes</span><span class="token punctuation">(</span><span class="token variable">$value</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
    <span class="token punctuation">&#125;</span> 
<span class="token punctuation">&#125;</span> 
 
<span class="token keyword">function</span> <span class="token function-definition function">is_palindrome_number</span><span class="token punctuation">(</span><span class="token variable">$number</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> 
    <span class="token variable">$number</span> <span class="token operator">=</span> <span class="token function">strval</span><span class="token punctuation">(</span><span class="token variable">$number</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
    <span class="token variable">$i</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> 
    <span class="token variable">$j</span> <span class="token operator">=</span> <span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$number</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token variable">$i</span> <span class="token operator">&lt;</span> <span class="token variable">$j</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> 
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$number</span><span class="token punctuation">[</span><span class="token variable">$i</span><span class="token punctuation">]</span> <span class="token operator">!==</span> <span class="token variable">$number</span><span class="token punctuation">[</span><span class="token variable">$j</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> 
            <span class="token keyword">return</span> <span class="token constant boolean">false</span><span class="token punctuation">;</span> 
        <span class="token punctuation">&#125;</span> 
        <span class="token variable">$i</span><span class="token operator">++</span><span class="token punctuation">;</span> 
        <span class="token variable">$j</span><span class="token operator">--</span><span class="token punctuation">;</span> 
    <span class="token punctuation">&#125;</span> 
    <span class="token keyword">return</span> <span class="token constant boolean">true</span><span class="token punctuation">;</span> 
<span class="token punctuation">&#125;</span>
 
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">is_numeric</span><span class="token punctuation">(</span><span class="token variable">$_REQUEST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'number'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
   <span class="token variable">$info</span><span class="token operator">=</span><span class="token string double-quoted-string">"sorry, you cann't input a number!"</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">elseif</span><span class="token punctuation">(</span><span class="token variable">$req</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'number'</span><span class="token punctuation">]</span><span class="token operator">!=</span><span class="token function">strval</span><span class="token punctuation">(</span><span class="token function">intval</span><span class="token punctuation">(</span><span class="token variable">$req</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'number'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> 
<span class="token punctuation">&#123;</span>
     <span class="token variable">$info</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"number must be equal to it's integer!! "</span><span class="token punctuation">;</span>  
<span class="token punctuation">&#125;</span>
<span class="token keyword">else</span>
<span class="token punctuation">&#123;</span>
     <span class="token variable">$value1</span> <span class="token operator">=</span> <span class="token function">intval</span><span class="token punctuation">(</span><span class="token variable">$req</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"number"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token variable">$value2</span> <span class="token operator">=</span> <span class="token function">intval</span><span class="token punctuation">(</span><span class="token function">strrev</span><span class="token punctuation">(</span><span class="token variable">$req</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"number"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
     <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$value1</span><span class="token operator">!=</span><span class="token variable">$value2</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
          <span class="token variable">$info</span><span class="token operator">=</span><span class="token string double-quoted-string">"no, this is not a palindrome number!"</span><span class="token punctuation">;</span>
     <span class="token punctuation">&#125;</span>
     <span class="token keyword">else</span>
     <span class="token punctuation">&#123;</span>
          <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">is_palindrome_number</span><span class="token punctuation">(</span><span class="token variable">$req</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"number"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
              <span class="token variable">$info</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"nice! <span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token variable">$value1</span><span class="token punctuation">&#125;</span></span> is a palindrome number!"</span><span class="token punctuation">;</span> 
     <span class="token punctuation">&#125;</span>
          <span class="token keyword">else</span><span class="token punctuation">&#123;</span>
             <span class="token variable">$info</span><span class="token operator">=</span><span class="token variable">$flag</span><span class="token punctuation">;</span>
          <span class="token punctuation">&#125;</span>
     <span class="token punctuation">&#125;</span>
 
<span class="token punctuation">&#125;</span> 
<span class="token keyword">echo</span> <span class="token variable">$info</span><span class="token punctuation">;</span>
<span class="token delimiter important">?></span></span></code></pre>



<h3 id="æ¼æ´åˆ†æ-1"><a href="#æ¼æ´åˆ†æ-1" class="headerlink" title="æ¼æ´åˆ†æ"></a>æ¼æ´åˆ†æ</h3><p>å‡½æ•°åˆ†æ</p>
<ul>
<li>trim â€” å»é™¤å­—ç¬¦ä¸²é¦–å°¾å¤„çš„ç©ºç™½å­—ç¬¦ï¼ˆæˆ–è€…å…¶ä»–å­—ç¬¦ï¼‰</li>
<li>is_string â€” æ£€æµ‹å˜é‡æ˜¯å¦æ˜¯å­—ç¬¦ä¸²ï¼Œaddslashes â€” ä½¿ç”¨åæ–œçº¿å¼•ç”¨å­—ç¬¦ä¸²</li>
<li>strval â€” è·å–å˜é‡çš„å­—ç¬¦ä¸²å€¼</li>
<li>strlen â€” è·å–å­—ç¬¦ä¸²é•¿åº¦</li>
<li>is_numeric â€” æ£€æµ‹å˜é‡æ˜¯å¦ä¸ºæ•°å­—æˆ–æ•°å­—å­—ç¬¦ä¸² </li>
<li>intval â€” è·å–å˜é‡çš„æ•´æ•°å€¼</li>
<li>is_palindrome_number â€”â€” è‡ªå®šä¹‰å‡½æ•°åˆ¤æ–­æ•°å­—æ˜¯å¦ä¸ºéå›æ–‡æ•°</li>
</ul>
<p>é€»è¾‘åˆ†æ</p>
<p>numberä¸ºgetæ¥å—å‚æ•°å˜é‡ï¼›</p>
<p>ç¬¬ä¸€ä¸ªåˆ¤æ–­å¦‚æœå˜é‡numberä¸ºç©ºå€¼ï¼Œåˆ™è®¾ç½®headeræœ‰hintå­—æ®µï¼Œå¹¶dieå‡ºä¸€å¥è¯;</p>
<p>æ¡ä»¶ä¸€ï¼š<code>if(is_numeric($_REQUEST[&#39;number&#39;]))</code> æ£€æµ‹å˜é‡æ˜¯å¦ä¸ºæ•°å­—æˆ–è€…æ•°å­—å­—ç¬¦ä¸²ï¼Œæ¡ä»¶æ˜¯falseï¼›</p>
<p>æ¡ä»¶äºŒï¼š<code>elseif($req[&#39;number&#39;]!=strval(intval($req[&#39;number&#39;])))</code>æ£€æµ‹å˜é‡æ˜¯å¦ä¸ºå›æ–‡æ•°ï¼›</p>
<p>æ¡ä»¶ä¸‰ï¼š<code>if(is_palindrome_number($req[&quot;number&quot;]))</code>è°ƒç”¨å‡½æ•°<code>is_palindrome_number</code>åˆ¤æ–­å½“å‰æ•°å­—ä¸ºéå›æ–‡æ•°</p>
<p>ç»•è¿‡æ¡ä»¶ä¸€çš„æ–¹å¼æ˜¯ï¼š%00ä¸ºç©ºå­—ç¬¦ï¼Œä¸ä¼šå½±å“åé¢çš„æ•°å€¼ï¼›</p>
<p>å’‹çœ¼ä¸€çœ‹æ¡ä»¶äºŒå’Œæ¡ä»¶ä¸‰æ˜¯å†²çªçš„ï¼Œè¿™è¾¹æˆ‘ä»¬å¿…é¡»æƒ³æ³•å­ç»•è¿‡ï¼›ä¸ºäº†åŒæ—¶æ»¡è¶³æ¡ä»¶äºŒå’Œç»•è¿‡å‡½æ•°<code>is_palindrome_number</code>ã€‚å¯ä»¥å¯¹æºä»£ç è¿›è¡Œç›¸å…³ç®€åŒ–ï¼Œå¾—åˆ°å¦‚ä¸‹ç®€åŒ–ä»£ç ï¼š</p>
<pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token keyword">function</span> <span class="token function-definition function">is_palindrome_number</span><span class="token punctuation">(</span><span class="token variable">$number</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token variable">$number</span> <span class="token operator">=</span> <span class="token function">strval</span><span class="token punctuation">(</span><span class="token variable">$number</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//strval â€” è·å–å˜é‡çš„å­—ç¬¦ä¸²å€¼</span>
    <span class="token variable">$i</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token variable">$j</span> <span class="token operator">=</span> <span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$number</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment">//strlen â€” è·å–å­—ç¬¦ä¸²é•¿åº¦</span>
    <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token variable">$i</span> <span class="token operator">&lt;</span> <span class="token variable">$j</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$number</span><span class="token punctuation">[</span><span class="token variable">$i</span><span class="token punctuation">]</span> <span class="token operator">!==</span> <span class="token variable">$number</span><span class="token punctuation">[</span><span class="token variable">$j</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">return</span> <span class="token constant boolean">false</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
        <span class="token variable">$i</span><span class="token operator">++</span><span class="token punctuation">;</span>
        <span class="token variable">$j</span><span class="token operator">--</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">return</span> <span class="token constant boolean">true</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token variable">$a</span> <span class="token operator">=</span> <span class="token function">trim</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'number'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">var_dump</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token operator">==</span><span class="token function">strval</span><span class="token punctuation">(</span><span class="token function">intval</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">&amp;</span><span class="token punctuation">(</span><span class="token function">intval</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token function">intval</span><span class="token punctuation">(</span><span class="token function">strrev</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">&amp;</span><span class="token operator">!</span><span class="token function">is_palindrome_number</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token delimiter important">?></span></span>
</code></pre>

<p>fuzzingä»£ç å¦‚ä¸‹ï¼š</p>
<pre class="language-python" data-language="python"><code class="language-python"><span class="token comment">#!/usr/local/env python2</span>
<span class="token comment">#conding:utf-8</span>

<span class="token keyword">import</span> requests
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">256</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
	rq <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"http://192.168.1.191:32776/stage/2/index2.php?number=%s191"</span><span class="token operator">%</span><span class="token punctuation">(</span><span class="token string">"%%%02X"</span><span class="token operator">%</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token comment">#print(rq.text)</span>
	<span class="token keyword">if</span> <span class="token string">'1'</span> <span class="token keyword">in</span> rq<span class="token punctuation">.</span>text<span class="token punctuation">:</span>
		<span class="token keyword">print</span> <span class="token string">"%%%02X"</span><span class="token operator">%</span>i
      
output<span class="token punctuation">:</span>
    <span class="token operator">%</span>0C
	<span class="token operator">%</span>2B</code></pre>



<h3 id="æ¼æ´åˆ©ç”¨-1"><a href="#æ¼æ´åˆ©ç”¨-1" class="headerlink" title="æ¼æ´åˆ©ç”¨"></a>æ¼æ´åˆ©ç”¨</h3><p>payload:<code>http://192.168.1.191:32776/stage/2/index2.php?number=%00%0C191</code></p>
<p><img src="https://gitee.com/greetdawn/blogImages/raw/master/img/20201225091551.png" loading="lazy"></p>
<h2 id="eregæ­£åˆ™ç»•è¿‡"><a href="#eregæ­£åˆ™ç»•è¿‡" class="headerlink" title="eregæ­£åˆ™ç»•è¿‡"></a>eregæ­£åˆ™ç»•è¿‡</h2><h3 id="æ¼æ´æºç -2"><a href="#æ¼æ´æºç -2" class="headerlink" title="æ¼æ´æºç "></a>æ¼æ´æºç </h3><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> 

<span class="token keyword">include</span> <span class="token string single-quoted-string">'flag.php'</span><span class="token punctuation">;</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">isset</span> <span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'password'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> 
<span class="token punctuation">&#123;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">ereg</span> <span class="token punctuation">(</span><span class="token string double-quoted-string">"^[a-zA-Z0-9]+$"</span><span class="token punctuation">,</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'password'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token constant boolean">FALSE</span><span class="token punctuation">)</span>
  <span class="token punctuation">&#123;</span>
    <span class="token keyword">echo</span> <span class="token string single-quoted-string">'&lt;p>You password must be alphanumeric&lt;/p>'</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
  <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'password'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">8</span> <span class="token operator">&amp;&amp;</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'password'</span><span class="token punctuation">]</span> <span class="token operator">></span> <span class="token number">9999999</span><span class="token punctuation">)</span>
   <span class="token punctuation">&#123;</span>
     <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">strpos</span> <span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'password'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'*-*'</span><span class="token punctuation">)</span> <span class="token operator">!==</span> <span class="token constant boolean">FALSE</span><span class="token punctuation">)</span> 
      <span class="token punctuation">&#123;</span>
      <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'Flag: '</span> <span class="token operator">.</span> <span class="token variable">$flag</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">&#125;</span>
      <span class="token keyword">else</span>
      <span class="token punctuation">&#123;</span>
        <span class="token keyword">echo</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'&lt;p>*-* have not been found&lt;/p>'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
       <span class="token punctuation">&#125;</span>
      <span class="token punctuation">&#125;</span>
     <span class="token keyword">else</span> 
     <span class="token punctuation">&#123;</span>
        <span class="token keyword">echo</span> <span class="token string single-quoted-string">'&lt;p>Invalid password&lt;/p>'</span><span class="token punctuation">;</span> 
      <span class="token punctuation">&#125;</span>
   <span class="token punctuation">&#125;</span> 
<span class="token delimiter important">?></span></span></code></pre>



<h3 id="æ¼æ´åˆ†æ-2"><a href="#æ¼æ´åˆ†æ-2" class="headerlink" title="æ¼æ´åˆ†æ"></a>æ¼æ´åˆ†æ</h3><p>eregå‡½æ•°:å‡½æ•°ç”¨æŒ‡å®šçš„æ¨¡å¼æœç´¢ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­æŒ‡å®šçš„å­—ç¬¦ä¸²,å¦‚æœåŒ¹é…æˆåŠŸè¿”å›true,å¦åˆ™,åˆ™è¿”å›falseã€‚æœç´¢å­—æ¯çš„å­—ç¬¦æ˜¯å¤§å°å†™æ•æ„Ÿçš„ã€‚æ­¤å‡½æ•°å­˜åœ¨%00æˆªæ–­é—®é¢˜ï¼Œåªè¦é‡åˆ°%00å°±åœæ­¢åŒ¹é…ã€‚</p>
<p>æ¡ä»¶ä¸€ï¼šé¦–å…ˆergeæ­£åˆ™åŒ¹é…ä½¿å¾—å˜é‡passwordå¿…é¡»æ»¡è¶³æ•°å­—å­—æ¯ç»„æˆï¼›</p>
<p>æ¡ä»¶äºŒï¼šé™åˆ¶passwordé•¿åº¦å¿…é¡»å°äº8ï¼Œå¹¶ä¸”å€¼è¦å¤§äº9999999ï¼›</p>
<p>æ¡ä»¶ä¸‰ï¼šå¯†ç ä¸­å¿…é¡»è¦å«æœ‰å­—ç¬¦*-*;</p>
<h3 id="æ¼æ´åˆ©ç”¨-2"><a href="#æ¼æ´åˆ©ç”¨-2" class="headerlink" title="æ¼æ´åˆ©ç”¨"></a>æ¼æ´åˆ©ç”¨</h3><p>ç»•è¿‡æ¡ä»¶ä¸€ä½¿ç”¨%00æˆªæ–­ï¼›</p>
<p>ç»•è¿‡æ¡ä»¶è€Œä½¿ç”¨ç§‘å­¦è®¡æ•°æ³•1e9;</p>
<p>æ»¡è¶³æ¡ä»¶ä¸‰%00åé¢æ‹¼æ¥*-*;</p>
<p>payload:?password=1e9%00*-*</p>
<p><img src="https://gitee.com/greetdawn/blogImages/raw/master/img/20201225150821.png" loading="lazy"></p>
<h2 id="strcmpæ¯”è¾ƒå­—ç¬¦ä¸²"><a href="#strcmpæ¯”è¾ƒå­—ç¬¦ä¸²" class="headerlink" title="strcmpæ¯”è¾ƒå­—ç¬¦ä¸²"></a>strcmpæ¯”è¾ƒå­—ç¬¦ä¸²</h2><h3 id="æ¼æ´æºç -3"><a href="#æ¼æ´æºç -3" class="headerlink" title="æ¼æ´æºç "></a>æ¼æ´æºç </h3><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token keyword">include</span> <span class="token string single-quoted-string">'flag.php'</span><span class="token punctuation">;</span>
<span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'a'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">strcmp</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'a'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token variable">$flag</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> 
        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'Flag: '</span><span class="token operator">.</span><span class="token variable">$flag</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token keyword">else</span>  
        <span class="token keyword">print</span> <span class="token string single-quoted-string">'No'</span><span class="token punctuation">;</span>  
<span class="token punctuation">&#125;</span>

<span class="token delimiter important">?></span></span></code></pre>



<h3 id="æ¼æ´åˆ†æ-3"><a href="#æ¼æ´åˆ†æ-3" class="headerlink" title="æ¼æ´åˆ†æ"></a>æ¼æ´åˆ†æ</h3><p>strcmp()</p>
<p>è¿™ä¸ªå‡½æ•°ç”¨äºå­—ç¬¦ä¸²æ¯”è¾ƒ</p>
<pre class="language-php" data-language="php"><code class="language-php"><span class="token keyword type-declaration">int</span> <span class="token function">strcmp</span> <span class="token punctuation">(</span> <span class="token keyword type-hint">string</span> <span class="token variable">$str1</span> <span class="token punctuation">,</span> <span class="token keyword type-hint">string</span> <span class="token variable">$str2</span> <span class="token punctuation">)</span>
<span class="token comment">// å‚æ•° str1ç¬¬ä¸€ä¸ªå­—ç¬¦ä¸²ã€‚str2ç¬¬äºŒä¸ªå­—ç¬¦ä¸²ã€‚å¦‚æœ str1 å°äº str2 è¿”å› &lt; 0ï¼› å¦‚æœ str1 å¤§äº str2 è¿”å› > 0ï¼›å¦‚æœä¸¤è€…ç›¸ç­‰ï¼Œè¿”å› 0ã€‚</span></code></pre>

<p>å¯çŸ¥ï¼Œä¼ å…¥çš„æœŸæœ›ç±»å‹æ˜¯å­—ç¬¦ä¸²ç±»å‹çš„æ•°æ®ï¼Œä½†æ˜¯å¦‚æœæˆ‘ä»¬ä¼ å…¥éå­—ç¬¦ä¸²ç±»å‹çš„æ•°æ®çš„æ—¶å€™ï¼Œè¿™ä¸ªå‡½æ•°å°†ä¼šæœ‰æ€ä¹ˆæ ·çš„è¡Œä¸ºå‘¢ï¼Ÿå®é™…ä¸Šï¼Œå½“è¿™ä¸ªå‡½æ•°æ¥å—åˆ°äº†ä¸ç¬¦åˆçš„ç±»å‹ï¼Œè¿™ä¸ªå‡½æ•°å°†å‘ç”Ÿé”™è¯¯ï¼Œä½†æ˜¯åœ¨<code>5.3</code>ä¹‹å‰çš„phpä¸­ï¼Œæ˜¾ç¤ºäº†æŠ¥é”™çš„è­¦å‘Šä¿¡æ¯åï¼Œå°†<code>return 0</code> !!!! ä¹Ÿå°±æ˜¯è™½ç„¶æŠ¥äº†é”™ï¼Œä½†å´åˆ¤å®šå…¶ç›¸ç­‰äº†ã€‚è¿™å¯¹äºä½¿ç”¨è¿™ä¸ªå‡½æ•°æ¥åšé€‰æ‹©è¯­å¥ä¸­çš„åˆ¤æ–­çš„ä»£ç æ¥è¯´ç®€ç›´æ˜¯ä¸€ä¸ªè‡´å‘½çš„æ¼æ´ï¼Œå½“ç„¶ï¼Œphpå®˜æ–¹åœ¨åé¢çš„ç‰ˆæœ¬ä¸­ä¿®å¤äº†è¿™ä¸ªæ¼æ´ï¼Œä½¿å¾—æŠ¥é”™çš„æ—¶å€™å‡½æ•°ä¸è¿”å›ä»»ä½•å€¼ã€‚<code>strcmp</code>åªä¼šå¤„ç†å­—ç¬¦ä¸²å‚æ•°ï¼Œå¦‚æœç»™ä¸ªæ•°ç»„çš„è¯å‘¢ï¼Œå°±ä¼šè¿”å›<code>NULL</code>,è€Œåˆ¤æ–­ä½¿ç”¨çš„æ˜¯<code>==</code>ï¼Œ<code>NULL==0</code>æ˜¯ <code>bool(true)</code></p>
<h3 id="æ¼æ´åˆ©ç”¨-3"><a href="#æ¼æ´åˆ©ç”¨-3" class="headerlink" title="æ¼æ´åˆ©ç”¨"></a>æ¼æ´åˆ©ç”¨</h3><p>payload:?a[]=1</p>
<h2 id="sha-å‡½æ•°æ¯”è¾ƒç»•è¿‡"><a href="#sha-å‡½æ•°æ¯”è¾ƒç»•è¿‡" class="headerlink" title="sha()å‡½æ•°æ¯”è¾ƒç»•è¿‡"></a>sha()å‡½æ•°æ¯”è¾ƒç»•è¿‡</h2><h3 id="æ¼æ´æºç -4"><a href="#æ¼æ´æºç -4" class="headerlink" title="æ¼æ´æºç "></a>æ¼æ´æºç </h3><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token keyword">include</span> <span class="token string single-quoted-string">'flag.php'</span><span class="token punctuation">;</span>
<span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'name'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token keyword">and</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'password'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> 
<span class="token punctuation">&#123;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'name'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'password'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        <span class="token keyword">echo</span> <span class="token string single-quoted-string">'&lt;p>Your password can not be your name!&lt;/p>'</span><span class="token punctuation">;</span>
    <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">sha1</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'name'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token function">sha1</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'password'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'Flag: '</span><span class="token operator">.</span><span class="token variable">$flag</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">else</span>
        <span class="token keyword">echo</span> <span class="token string single-quoted-string">'&lt;p>Invalid password.&lt;/p>'</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">else</span>
    <span class="token keyword">echo</span> <span class="token string single-quoted-string">'&lt;p>Login first!&lt;/p>'</span><span class="token punctuation">;</span>

<span class="token delimiter important">?></span></span></code></pre>



<h3 id="æ¼æ´åˆ†æ-4"><a href="#æ¼æ´åˆ†æ-4" class="headerlink" title="æ¼æ´åˆ†æ"></a>æ¼æ´åˆ†æ</h3><p>sha1()å‡½æ•°è®¡ç®—å­—ç¬¦ä¸²sha-1æ•£åˆ—ï¼Œæ¥å—å‚æ•°ä½å­—ç¬¦ä¸²ç±»å‹</p>
<p>=== ä¸ºæ’ç­‰å¼ä¼šå¯¹å˜é‡ç±»å‹è¿›è¡Œæ¯”è¾ƒ</p>
<p>è‹¥ä¼ å…¥å˜é‡ä¸ºæ•°ç»„ç±»å‹ï¼Œå°±ä¼šä½¿sha1å‡½æ•°è¿”å›é”™è¯¯ï¼Œå³falseï¼›éƒ½æŠ¥é”™çš„æƒ…å†µä¸‹ï¼Œ æ’ç­‰å¼å³æˆç«‹</p>
<h3 id="æ¼æ´åˆ©ç”¨-4"><a href="#æ¼æ´åˆ©ç”¨-4" class="headerlink" title="æ¼æ´åˆ©ç”¨"></a>æ¼æ´åˆ©ç”¨</h3><p>payload:?name[]=1&amp;passwordp[]=2</p>
<p><img src="https://gitee.com/greetdawn/blogImages/raw/master/img/20201225155527.png" loading="lazy"></p>
<h2 id="sessionéªŒè¯ç»•è¿‡"><a href="#sessionéªŒè¯ç»•è¿‡" class="headerlink" title="sessionéªŒè¯ç»•è¿‡"></a>sessionéªŒè¯ç»•è¿‡</h2><h3 id="æ¼æ´æºç -5"><a href="#æ¼æ´æºç -5" class="headerlink" title="æ¼æ´æºç "></a>æ¼æ´æºç </h3><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token keyword">include</span> <span class="token string single-quoted-string">'flag.php'</span><span class="token punctuation">;</span>
<span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">session_start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">isset</span> <span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'password'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'password'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'password'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        <span class="token keyword">die</span> <span class="token punctuation">(</span><span class="token string single-quoted-string">'Flag: '</span><span class="token operator">.</span><span class="token variable">$flag</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">else</span>
        <span class="token keyword">print</span> <span class="token string single-quoted-string">'&lt;p>Wrong guess.&lt;/p>'</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token function">mt_srand</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">microtime</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token function">rand</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">10000</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token function">rand</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">10000</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token function">rand</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">10000</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token delimiter important">?></span></span></code></pre>



<h3 id="æ¼æ´åˆ†æ-5"><a href="#æ¼æ´åˆ†æ-5" class="headerlink" title="æ¼æ´åˆ†æ"></a>æ¼æ´åˆ†æ</h3><p>è‹¥sessioné‡Œçš„passwordçš„å€¼å’Œgetä¼ å‚è¿›å»çš„å€¼ç›¸ç­‰ï¼Œåˆ™ä¼šè¾“å‡ºflagï¼›</p>
<p>å¯¹å…¶$_SESSION[â€˜passwordâ€™]è¿›è¡Œè¾“å‡ºå‘ç°ç»“æœä¸ºnullï¼Œæ‰€ä»¥è¿™é‡Œæ„é€ passwordä¼ å…¥ç©ºå€¼ï¼Œä½¿å…¶ç›¸ç­‰ï¼›</p>
<h3 id="æ¼æ´åˆ©ç”¨-5"><a href="#æ¼æ´åˆ©ç”¨-5" class="headerlink" title="æ¼æ´åˆ©ç”¨"></a>æ¼æ´åˆ©ç”¨</h3><p>payload:?password=</p>
<p><img src="https://gitee.com/greetdawn/blogImages/raw/master/img/20201225164056.png" loading="lazy"></p>
<h2 id="md5æ¯”è¾ƒç»•è¿‡"><a href="#md5æ¯”è¾ƒç»•è¿‡" class="headerlink" title="md5æ¯”è¾ƒç»•è¿‡"></a>md5æ¯”è¾ƒç»•è¿‡</h2><h3 id="æ¼æ´æºç -6"><a href="#æ¼æ´æºç -6" class="headerlink" title="æ¼æ´æºç "></a>æ¼æ´æºç </h3><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
	<span class="token keyword">include</span> <span class="token string single-quoted-string">'flag.php'</span><span class="token punctuation">;</span>

	<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'user'</span><span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'pass'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
		<span class="token variable">$conn</span> <span class="token operator">=</span> <span class="token function">mysql_connect</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"localhost"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"ctf"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"ctf"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token function">mysql_select_db</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"md5bypass"</span><span class="token punctuation">)</span> <span class="token keyword">or</span> <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"Could not select database"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$conn</span><span class="token operator">-></span><span class="token property">connect_error</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
			<span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"Connection failed: "</span> <span class="token operator">.</span> <span class="token function">mysql_error</span><span class="token punctuation">(</span><span class="token variable">$conn</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span> 
	<span class="token variable">$user</span> <span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'user'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token variable">$pass</span> <span class="token operator">=</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'pass'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"select pw from php where user='<span class="token interpolation"><span class="token variable">$user</span></span>'"</span><span class="token punctuation">;</span>
	<span class="token variable">$query</span> <span class="token operator">=</span> <span class="token function">mysql_query</span><span class="token punctuation">(</span><span class="token variable">$sql</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token variable">$query</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"Error: %s\n"</span><span class="token punctuation">,</span> <span class="token function">mysql_error</span><span class="token punctuation">(</span><span class="token variable">$conn</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">exit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>
	<span class="token variable">$row</span> <span class="token operator">=</span> <span class="token function">mysql_fetch_array</span><span class="token punctuation">(</span><span class="token variable">$query</span><span class="token punctuation">,</span> <span class="token constant">MYSQL_ASSOC</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token variable">$row</span><span class="token punctuation">[</span>pw<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">strcasecmp</span><span class="token punctuation">(</span><span class="token variable">$pass</span><span class="token punctuation">,</span> <span class="token variable">$row</span><span class="token punctuation">[</span>pw<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
		<span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;p>Logged in!"</span> <span class="token operator">.</span> <span class="token variable">$flag</span> <span class="token operator">.</span> <span class="token string double-quoted-string">"&lt;/p>"</span><span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>
	<span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
		<span class="token keyword">echo</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"&lt;p>Log in failure!&lt;/p>"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	  <span class="token punctuation">&#125;</span>
	<span class="token punctuation">&#125;</span>
<span class="token delimiter important">?></span></span></code></pre>



<h3 id="æ¼æ´åˆ†æ-6"><a href="#æ¼æ´åˆ†æ-6" class="headerlink" title="æ¼æ´åˆ†æ"></a>æ¼æ´åˆ†æ</h3><p>strcasecmp(string1, string2) å‡½æ•°æ¯”è¾ƒä¸¤ä¸ªå­—ç¬¦ä¸²ã€‚å¦‚æœç›¸ç­‰è¿”å›0ï¼Œå¦‚æœstring1&lt;string2è¿”å›&lt;0,å¦‚æœstring1&gt;string2è¿”å›&gt;0</p>
<p>æç¤ºï¼šstrcasecmp() å‡½æ•°æ˜¯äºŒè¿›åˆ¶å®‰å…¨çš„ï¼Œä¸”ä¸åŒºåˆ†å¤§å°å†™ã€‚</p>
<p>æ ¹æ®ä»£ç åªè¦è®©$row[pw]ä¸å˜é‡$passç›¸ç­‰å³å¯è¾“å‡ºflagï¼›</p>
<p>$passæ˜¯ç»è¿‡md5ä¹‹åçš„å€¼ï¼Œè¿™ä¸ªå€¼ç”¨æˆ·å¯ä»¥é€šè¿‡è¾“å…¥æ§åˆ¶ï¼›</p>
<p>$row[pw]çš„å€¼æ˜¯é€šè¿‡sqlæŸ¥è¯¢è·å–åˆ°ï¼›</p>
<p>é€šè¿‡ä»£ç å¾ˆæ˜æ˜¾å¯ä»¥çœ‹å‡ºæ¥ï¼Œåœ¨userå˜é‡å¤„æ²¡æœ‰ä»»ä½•è¿‡æ»¤å­˜åœ¨ï¼Œæ˜¯æ˜æ˜¾å­˜åœ¨æ³¨å…¥çš„ï¼›</p>
<p>é€šè¿‡æ³¨å…¥æ„é€ æ§åˆ¶$row[pw]ä¸ºç”¨æˆ·è‡ªå·±è¾“å…¥çš„md5å€¼å³å¯ï¼Œpassçš„å€¼å¯æ§ï¼Œç›´æ¥è¾“å…¥å¯¹åº”md5çš„æ˜æ–‡å³å¯ï¼›</p>
<h3 id="æ¼æ´åˆ©ç”¨-6"><a href="#æ¼æ´åˆ©ç”¨-6" class="headerlink" title="æ¼æ´åˆ©ç”¨"></a>æ¼æ´åˆ©ç”¨</h3><p>payload:<code>admin&#39; AND 0=1 union select &#39;202cb962ac59075b964b07152d234b70&#39;#</code>&amp;pass=123</p>
<p><img src="https://gitee.com/greetdawn/blogImages/raw/master/img/20201228135450.png" loading="lazy"></p>
<h2 id="md5åŠ å¯†ç›¸ç­‰ç»•è¿‡"><a href="#md5åŠ å¯†ç›¸ç­‰ç»•è¿‡" class="headerlink" title="md5åŠ å¯†ç›¸ç­‰ç»•è¿‡"></a>md5åŠ å¯†ç›¸ç­‰ç»•è¿‡</h2><h3 id="æ¼æ´æºç -7"><a href="#æ¼æ´æºç -7" class="headerlink" title="æ¼æ´æºç "></a>æ¼æ´æºç </h3><pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token keyword">include</span> <span class="token string single-quoted-string">'flag.php'</span><span class="token punctuation">;</span>
<span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token variable">$md51</span> <span class="token operator">=</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'QNKCDZO'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$a</span> <span class="token operator">=</span> @<span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'a'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token variable">$md52</span> <span class="token operator">=</span> @<span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$a</span> <span class="token operator">!=</span> <span class="token string single-quoted-string">'QNKCDZO'</span> <span class="token operator">&amp;&amp;</span> <span class="token variable">$md51</span> <span class="token operator">==</span> <span class="token variable">$md52</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">echo</span> <span class="token string double-quoted-string">"flag:"</span> <span class="token operator">.</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">echo</span> <span class="token string double-quoted-string">"false!!!"</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>
<span class="token keyword">else</span><span class="token punctuation">&#123;</span><span class="token keyword">echo</span> <span class="token string double-quoted-string">"please input a"</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>

<span class="token delimiter important">?></span></span></code></pre>



<h3 id="æ¼æ´åˆ†æ-7"><a href="#æ¼æ´åˆ†æ-7" class="headerlink" title="æ¼æ´åˆ†æ"></a>æ¼æ´åˆ†æ</h3><p>phpä¸­md5å€¼è‹¥æ˜¯0eå¼€å¤´ï¼Œé‚£ä¹ˆä¸å…¶ä»–çš„0eå¼€å¤´çš„md5å€¼ç›¸ç­‰ï¼Œè¿™ä¹Ÿæˆä¸ºmd5ç¢°æ’</p>
<pre class="language-none"><code class="language-none">s878926199a
0e545993274517709034328855841020
s155964671a
0e342768416822451524974117254469
s214587387a
0e848240448830537924465865611904
s214587387a
0e848240448830537924465865611904
s878926199a
0e545993274517709034328855841020
s1091221200a
0e940624217856561557816327384675
s1885207154a
0e509367213418206700842008763514
s1502113478a
0e861580163291561247404381396064
s1885207154a
0e509367213418206700842008763514
s1836677006a
0e481036490867661113260034900752
s155964671a
0e342768416822451524974117254469
s1184209335a
0e072485820392773389523109082030
s1665632922a
0e731198061491163073197128363787
s1502113478a
0e861580163291561247404381396064
s1836677006a
0e481036490867661113260034900752
s1091221200a
0e940624217856561557816327384675
s155964671a
0e342768416822451524974117254469
s1502113478a
0e861580163291561247404381396064
s155964671a
0e342768416822451524974117254469
s1665632922a
0e731198061491163073197128363787
s155964671a
0e342768416822451524974117254469
s1091221200a
0e940624217856561557816327384675
s1836677006a
0e481036490867661113260034900752
s1885207154a
0e509367213418206700842008763514
s532378020a
0e220463095855511507588041205815
s878926199a
0e545993274517709034328855841020
s1091221200a
0e940624217856561557816327384675
s214587387a
0e848240448830537924465865611904
s1502113478a
0e861580163291561247404381396064
s1091221200a
0e940624217856561557816327384675
s1665632922a
0e731198061491163073197128363787
s1885207154a
0e509367213418206700842008763514
s1836677006a
0e481036490867661113260034900752
s1665632922a
0e731198061491163073197128363787
s878926199a
æ‰€ä»¥éšä¾¿æŒ‘ä¸€ä¸ª0eå¼€å¤´çš„md5å¯¹åº”çš„åŸç  æ„é€  playloadå³å¯</code></pre>



<h3 id="æ¼æ´åˆ©ç”¨-7"><a href="#æ¼æ´åˆ©ç”¨-7" class="headerlink" title="æ¼æ´åˆ©ç”¨"></a>æ¼æ´åˆ©ç”¨</h3><p>payload:?a=s878926199a</p>
<p><img src="https://gitee.com/greetdawn/blogImages/raw/master/img/20201228140800.png" loading="lazy"></p>
</div><div id="reward-container"><span class="hty-icon-button button-glow" id="reward-button" title="æ‰“èµ" onclick="var qr = document.getElementById(&quot;qr&quot;); qr.style.display = (qr.style.display === &quot;none&quot;) ? &quot;block&quot; : &quot;none&quot;;"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-hand-coin-line"></use></svg></span><div id="reward-comment">é’±æ˜¯ä¸‡èƒ½çš„</div><div id="qr" style="display:none;"><div style="display:inline-block"><a target="_blank" rel="noopener" href="https://gitee.com/greetdawn/blogImages/raw/master/img/qr-wechat.png"><img loading="lazy" src="https://gitee.com/greetdawn/blogImages/raw/master/img/qr-wechat.png" alt="æ”¯ä»˜å®" title="æ”¯ä»˜å®"></a><div><span style="color:#00A3EE"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-alipay-line"></use></svg></span></div></div><div style="display:inline-block"><a target="_blank" rel="noopener" href="https://gitee.com/greetdawn/blogImages/raw/master/img/qr-alipay.png"><img loading="lazy" src="https://gitee.com/greetdawn/blogImages/raw/master/img/qr-alipay.png" alt="å¾®ä¿¡æ”¯ä»˜" title="å¾®ä¿¡æ”¯ä»˜"></a><div><span style="color:#2DC100"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-wechat-pay-line"></use></svg></span></div></div></div></div><ul class="post-copyright"><li class="post-copyright-author"><strong>æœ¬æ–‡ä½œè€…ï¼š</strong>ä¸¨Mr.zhangä¸¨</li><li class="post-copyright-link"><strong>æœ¬æ–‡é“¾æ¥ï¼š</strong><a href="http://www.greetdawn.top/2019/03/10/php-code-audit/php-features/" title="phpè¯­è¨€ç‰¹æ€§ç±»å‹è®²è§£">http://www.greetdawn.top/2019/03/10/php-code-audit/php-features/</a></li><li class="post-copyright-license"><strong>ç‰ˆæƒå£°æ˜ï¼š</strong>æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é»˜è®¤é‡‡ç”¨ <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" target="_blank" rel="noopener" title="CC BY-NC-SA 4.0 "><svg class="icon"><use xlink:href="#icon-creative-commons-line"></use></svg><svg class="icon"><use xlink:href="#icon-creative-commons-by-line"></use></svg><svg class="icon"><use xlink:href="#icon-creative-commons-nc-line"></use></svg><svg class="icon"><use xlink:href="#icon-creative-commons-sa-line"></use></svg></a> è®¸å¯åè®®ã€‚</li></ul></section></article><div class="post-nav"><div class="post-nav-item"><a class="post-nav-prev" href="/2019/05/14/php-code-audit/php-unserialize-vul/" rel="prev" title="phpååºåˆ—åŒ–æ¼æ´è§£æ"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-arrow-left-s-line"></use></svg><span class="post-nav-text">phpååºåˆ—åŒ–æ¼æ´è§£æ</span></a></div><div class="post-nav-item"><a class="post-nav-next" href="/2019/03/07/php-code-audit/php-audit-thinkphp5-readfile/" rel="next" title="thinkphp5æ–‡ä»¶åŒ…å«æ¼æ´åˆ†æ"><span class="post-nav-text">thinkphp5æ–‡ä»¶åŒ…å«æ¼æ´åˆ†æ</span><svg class="icon" aria-hidden="true"><use xlink:href="#icon-arrow-right-s-line"></use></svg></a></div></div></div><div class="hty-card" id="comment"><div class="comment-tooltip text-center"><span>å°è¯•ä½¿ç”¨ Disqus è¯„è®ºç³»ç»Ÿã€‚</span><br><span>æ‚¨å¯ä»¥ç‚¹å‡»ä¸‹æ–¹æŒ‰é’®åˆ‡æ¢å¯¹åº”è¯„è®ºç³»ç»Ÿã€‚</span><br><a class="hty-button hty-button--raised" id="github-issues" target="_blank" rel="noopener" href="https://github.com/greetdawn/greetdawn.github.io/issues?q=is:issue+phpè¯­è¨€ç‰¹æ€§ç±»å‹è®²è§£">GitHub Issues</a></div><div class="toggle-comment-system" style="margin: 1rem auto"><a class="toggle-comment-btn hty-button hty-button--raised text-uppercase" data-target="#valine-container" onclick="showComment(this.dataset.target)">valine</a><style>#disqus_thread {
  display: none;
}</style><a class="toggle-comment-btn hty-button hty-button--raised text-uppercase" data-target="#disqus_thread" onclick="showComment(this.dataset.target)">disqusjs</a><script>function hideAllComment() {
  //- hide all
  document.querySelectorAll('.toggle-comment-btn').forEach((btn) => {
    const container = document.querySelector(btn.dataset.target);
    if (container) {
      container.style.display = "none";
    }
  });
}
function showComment(target) {
  hideAllComment();
  //- show target
  const targetContainer = document.querySelector(target);
  if (targetContainer) {
    targetContainer.style.display = "block";
  }
}
</script></div><div id="disqus_thread"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/disqusjs@latest/dist/disqusjs.css"><script src="https://cdn.jsdelivr.net/npm/disqusjs@latest/dist/disqus.js"></script><script>const disqusjsConfig = {"enable":true,"shortname":"yunyoujun","apikey":"ouoGQCaamOKdJgyZU5DKcpFnRIg3SNzvk0nwygPtlcTRJuE68c8igvrZGW4wAJoN"}
function loadDisqus() {
  const dsqjs = new DisqusJS(disqusjsConfig)
}</script><script src="/js/comments/disqus.js"></script><div id="valine-container"></div><script>Yun.utils.getScript("https://cdn.jsdelivr.net/npm/valine@latest/dist/Valine.min.js", () => {
  const valineConfig = {"enable":true,"appId":"4x0IwQ1sy95mOGQDTO8MYCeA-gzGzoHsz","appKey":"9loqwF3UDklPDHaP9IN2uwN8","placeholder":"å¤§ä½¬æ±‚æŒ‡æ•™&nbsp_(:Ğ·ã€âˆ )_ ï¼ˆå¡«å†™é‚®ç®±å¯ä»¥æ”¶åˆ°å›å¤é€šçŸ¥ï½ï¼‰","avatar":null,"pageSize":10,"visitor":true,"highlight":true,"recordIP":true,"enableQQ":true,"serverURLs":"https://lncld.yunyoujun.cn","requiredFields":["nick","mail"],"emojiCDN":"//i0.hdslb.com/bfs/emote/","emojiMaps":{"tv_doge":"6ea59c827c414b4a2955fe79e0f6fd3dcd515e24.png","tv_äº²äº²":"a8111ad55953ef5e3be3327ef94eb4a39d535d06.png","tv_å·ç¬‘":"bb690d4107620f1c15cff29509db529a73aee261.png","tv_å†è§":"180129b8ea851044ce71caf55cc8ce44bd4a4fc8.png","tv_å†·æ¼ ":"b9cbc755c2b3ee43be07ca13de84e5b699a3f101.png","tv_å‘æ€’":"34ba3cd204d5b05fec70ce08fa9fa0dd612409ff.png","tv_å‘è´¢":"34db290afd2963723c6eb3c4560667db7253a21a.png","tv_å¯çˆ±":"9e55fd9b500ac4b96613539f1ce2f9499e314ed9.png","tv_åè¡€":"09dd16a7aa59b77baa1155d47484409624470c77.png","tv_å‘†":"fe1179ebaa191569b0d31cecafe7a2cd1c951c9d.png","tv_å‘•å":"9f996894a39e282ccf5e66856af49483f81870f3.png","tv_å›°":"241ee304e44c0af029adceb294399391e4737ef2.png","tv_åç¬‘":"1f0b87f731a671079842116e0991c91c2c88645a.png","tv_å¤§ä½¬":"093c1e2c490161aca397afc45573c877cdead616.png","tv_å¤§å“­":"23269aeb35f99daee28dda129676f6e9ea87934f.png","tv_å§”å±ˆ":"d04dba7b5465779e9755d2ab6f0a897b9b33bb77.png","tv_å®³ç¾":"a37683fb5642fa3ddfc7f4e5525fd13e42a2bdb1.png","tv_å°´å°¬":"7cfa62dafc59798a3d3fb262d421eeeff166cfa4.png","tv_å¾®ç¬‘":"70dc5c7b56f93eb61bddba11e28fb1d18fddcd4c.png","tv_æ€è€ƒ":"90cf159733e558137ed20aa04d09964436f618a1.png","tv_æƒŠå“":"0d15c7e2ee58e935adc6a7193ee042388adc22af.png","tv_æ‰“è„¸":"56ab10b624063e966bfcb76ea5dc4794d87dfd47.png","tv_æŠ“ç‹‚":"fe31c08edad661d63762b04e17b8d5ae3c71a757.png","tv_æŠ é¼»":"c666f55e88d471e51bbd9fab9bb308110824a6eb.png","tv_æ–œçœ¼ç¬‘":"911f987aa8bc1bee12d52aafe62bc41ef4474e6c.png","tv_æ— å¥ˆ":"ea8ed89ee9878f2fece2dda0ea8a5dbfe21b5751.png","tv_æ™•":"5443c22b4d07fb1907ccc610c8e6db254f2461b7.png","tv_æµæ±—":"cead1c351ab8d79e9f369605beb90148db0fbed3.png","tv_æµæ³ª":"7e71cde7858f0cd50d74b0264aa26db612a8a167.png","tv_æµé¼»è¡€":"c32d39db2737f89b904ca32700d140a9241b0767.png","tv_ç‚¹èµ":"f85c354995bd99e28fc76c869bfe42ba6438eff4.png","tv_ç”Ÿæ°”":"26702dcafdab5e8225b43ffd23c94ac1ff932654.png","tv_ç”Ÿç—…":"8b0ec90e6b86771092a498c54f09fc94621c1900.png","tv_ç–‘é—®":"0793d949b18d7be716078349c202c15ff166f314.png","tv_ç™½çœ¼":"c1d59f439e379ee50eef488bcb5e5378e5044ea4.png","tv_çš±çœ‰":"72ccad6679fea0d14cce648b4d818e09b8ffea2d.png","tv_ç›®çªå£å‘†":"0b8cb81a68de5d5365212c99375e7ace3e7891b7.png","tv_ç¡ç€":"8b196675b53af58264f383c50ad0945048290b33.png","tv_ç¬‘å“­":"1abc628f6d4f4caf9d0e7800878f4697abbc8273.png","tv_è…¼è…†":"89712c0d4af73e67f89e35cbc518420380a7f6f4.png","tv_è‰²":"61822c7e9aae5da76475e7892534545336b23a6f.png","tv_è°ƒä¾ƒ":"4bc022533ef31544ca0d72c12c808cf4a1cce3e3.png","tv_è°ƒçš®":"b9c41de8e82dd7a8515ae5e3cb63e898bf245186.png","tv_é„™è§†":"6e72339f346a692a495b123174b49e4e8e781303.png","tv_é—­å˜´":"c9e990da7f6e93975e25fd8b70e2e290aa4086ef.png","tv_éš¾è¿‡":"87f46748d3f142ebc6586ff58860d0e2fc8263ba.png","tv_é¦‹":"fc7e829b845c43c623c8b490ee3602b7f0e76a31.png","tv_é¬¼è„¸":"0ffbbddf8a94d124ca2f54b360bbc04feb6bbfea.png","tv_é»‘äººé—®å·":"45821a01f51bc867da9edbaa2e070410819a95b2.png","tv_é¼“æŒ":"1d21793f96ef4e6f48b23e53e3b9e42da833a0f6.png"},"el":"#valine-container","lang":"zh-cn"}
  valineConfig.path = "/2019/03/10/php-code-audit/php-features/"
  new Valine(valineConfig)
}, window.Valine);</script></div></main><footer class="sidebar-translate" id="footer"><div class="beian"><a rel="noopener" href="https://beian.miit.gov.cn/" target="_blank">greetdawn</a></div><div class="copyright"><span>&copy; 2018 â€“ 2021 </span><span class="with-love" id="animate"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-cloud-line"></use></svg></span><span class="author"> ä¸¨Mr.zhangä¸¨</span></div><div class="powered"><span>ç”± <a href="https://hexo.io" target="_blank" rel="noopener">Hexo</a> é©±åŠ¨ v5.4.0</span><span class="footer-separator">|</span><span>ä¸»é¢˜ - <a rel="noopener" href="https://github.com/YunYouJun/hexo-theme-yun" target="_blank"><span>Yun</span></a> v1.5.2</span></div><div class="live_time"><span>æœ¬åšå®¢å·²èŒèŒå“’åœ°è¿è¡Œ</span><span id="display_live_time"></span><span class="moe-text">(â—'â—¡'â—)</span><script>function blog_live_time() {
  setTimeout(blog_live_time, 1000);
  const start = new Date('2019-04-12T00:00:00');
  const now = new Date();
  const timeDiff = (now.getTime() - start.getTime());
  const msPerMinute = 60 * 1000;
  const msPerHour = 60 * msPerMinute;
  const msPerDay = 24 * msPerHour;
  const passDay = Math.floor(timeDiff / msPerDay);
  const passHour = Math.floor((timeDiff % msPerDay) / 60 / 60 / 1000);
  const passMinute = Math.floor((timeDiff % msPerHour) / 60 / 1000);
  const passSecond = Math.floor((timeDiff % msPerMinute) / 1000);
  display_live_time.innerHTML = " " + passDay + " å¤© " + passHour + " å°æ—¶ " + passMinute + " åˆ† " + passSecond + " ç§’";
}
blog_live_time();
</script></div></footer><a class="hty-icon-button" id="goUp" aria-label="back-to-top" href="#"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-arrow-up-s-line"></use></svg><svg class="progress-circle-container" viewBox="0 0 100 100"><circle class="progress-circle" id="progressCircle" cx="50" cy="50" r="48" fill="none" stroke="#0078E7" stroke-width="2" stroke-linecap="round"></circle></svg></a></div></body></html>